11/05/2024 05:19:48 - WARNING - llamafactory.hparams.parser - We recommend enable mixed precision training.
11/05/2024 05:19:48 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: None
[INFO|configuration_utils.py:673] 2024-11-05 05:19:48,273 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:19:48,273 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,274 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,274 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,274 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,275 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,275 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-05 05:19:48,677 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:673] 2024-11-05 05:19:48,678 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:19:48,679 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,680 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,680 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,680 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,680 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-05 05:19:48,680 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-05 05:19:49,035 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
11/05/2024 05:19:49 - WARNING - llamafactory.model.loader - Processor was not found: 'LlamaConfig' object has no attribute 'vision_config'.
11/05/2024 05:19:49 - INFO - llamafactory.data.template - Replace eos token: <|eot_id|>
11/05/2024 05:19:49 - INFO - llamafactory.data.template - Add pad token: <|eot_id|>
11/05/2024 05:19:49 - INFO - llamafactory.data.loader - Loading dataset ../../Training_Dataset/C3/train.json...
Converting format of dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  75%|███████▌  | 5252/7000 [00:00<00:00, 51336.48 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 7000/7000 [00:00<00:00, 37293.22 examples/s]
Running tokenizer on dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6%|▋         | 438/7000 [00:01<00:16, 408.17 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 876/7000 [00:01<00:08, 729.01 examples/s]Running tokenizer on dataset (num_proc=16):  25%|██▌       | 1752/7000 [00:01<00:03, 1382.94 examples/s]Running tokenizer on dataset (num_proc=16):  38%|███▊      | 2628/7000 [00:01<00:02, 2129.14 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▍     | 3066/7000 [00:01<00:01, 2303.53 examples/s]Running tokenizer on dataset (num_proc=16):  50%|█████     | 3504/7000 [00:02<00:01, 2029.42 examples/s]Running tokenizer on dataset (num_proc=16):  63%|██████▎   | 4378/7000 [00:02<00:00, 2658.29 examples/s]Running tokenizer on dataset (num_proc=16):  75%|███████▌  | 5252/7000 [00:02<00:00, 2891.35 examples/s]Running tokenizer on dataset (num_proc=16):  88%|████████▊ | 6126/7000 [00:03<00:00, 2682.12 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 3058.12 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 2094.97 examples/s]
[INFO|configuration_utils.py:673] 2024-11-05 05:19:53,616 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:19:53,617 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|modeling_utils.py:3729] 2024-11-05 05:19:53,642 >> loading weights file /home/models/Llama-3.2-3B/model.safetensors.index.json
[INFO|modeling_utils.py:1622] 2024-11-05 05:19:53,642 >> Instantiating LlamaForCausalLM model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1099] 2024-11-05 05:19:53,643 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "eos_token_id": 128001
}

training example:
input_ids:
[128000, 128006, 882, 128007, 271, 14711, 32215, 459, 8029, 3319, 3196, 389, 279, 3984, 3488, 323, 4729, 11036, 627, 14711, 7998, 25, 4438, 1690, 14971, 315, 279, 26280, 527, 9191, 1109, 220, 3487, 23285, 17010, 2042, 1292, 25, 364, 28414, 46463, 518, 14711, 12494, 26443, 25, 5324, 29543, 1401, 794, 4482, 43573, 16427, 851, 405, 2025, 16427, 851, 498, 330, 43573, 67300, 851, 405, 28414, 67300, 851, 8073, 330, 6682, 1401, 794, 4482, 28414, 67300, 851, 498, 330, 2025, 16427, 851, 498, 330, 43573, 67300, 851, 8073, 330, 33210, 794, 4482, 28414, 13089, 37091, 887, 11, 836, 11, 9886, 11, 23862, 11, 8199, 304, 33151, 11, 1661, 8420, 11844, 330, 2025, 26408, 887, 11, 836, 11, 9405, 1614, 11, 4325, 11844, 330, 43573, 13089, 37091, 887, 11, 2010, 887, 11, 13643, 15718, 8, 93546, 128009, 128006, 78191, 128007, 271, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128009]
inputs:
<|begin_of_text|><|start_header_id|>user<|end_header_id|>

###Generate an SQL query based on the provided question and database schema.
###question:How many heads of the departments are older than 56?, ###db_name: 'department_management',###database_schema: {"foreign key": ["management.head_id->head.head_id", "management.department_id->department.department_id"], "primary key": ["department.department_id", "head.head_id", "management.department_id"], "tables": ["department(department id, name, creation, ranking, budget in billions, num employees)", "head(head id, name, born state, age)", "management(department id, head id, temporary acting)"]}<|eot_id|><|start_header_id|>assistant<|end_header_id|>

SELECT count(*) FROM head WHERE age  >  56<|eot_id|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128009]
labels:
SELECT count(*) FROM head WHERE age  >  56<|eot_id|>
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.00it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.12s/it]
[INFO|modeling_utils.py:4574] 2024-11-05 05:19:55,956 >> All model checkpoint weights were used when initializing LlamaForCausalLM.

[INFO|modeling_utils.py:4582] 2024-11-05 05:19:55,957 >> All the weights of LlamaForCausalLM were initialized from the model checkpoint at /home/models/Llama-3.2-3B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1052] 2024-11-05 05:19:55,959 >> loading configuration file /home/models/Llama-3.2-3B/generation_config.json
[INFO|configuration_utils.py:1099] 2024-11-05 05:19:55,959 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "do_sample": true,
  "eos_token_id": 128001,
  "temperature": 0.6,
  "top_p": 0.9
}

11/05/2024 05:19:55 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
11/05/2024 05:19:55 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
11/05/2024 05:19:55 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
11/05/2024 05:19:55 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
11/05/2024 05:19:55 - INFO - llamafactory.model.model_utils.misc - Found linear modules: q_proj,gate_proj,up_proj,down_proj,o_proj,k_proj,v_proj
11/05/2024 05:19:56 - INFO - llamafactory.model.loader - trainable params: 12,156,928 || all params: 3,224,906,752 || trainable%: 0.3770
[INFO|trainer.py:2243] 2024-11-05 05:19:56,583 >> ***** Running training *****
[INFO|trainer.py:2244] 2024-11-05 05:19:56,583 >>   Num examples = 6,300
[INFO|trainer.py:2245] 2024-11-05 05:19:56,583 >>   Num Epochs = 5
[INFO|trainer.py:2246] 2024-11-05 05:19:56,583 >>   Instantaneous batch size per device = 2
[INFO|trainer.py:2249] 2024-11-05 05:19:56,583 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:2250] 2024-11-05 05:19:56,583 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2251] 2024-11-05 05:19:56,583 >>   Total optimization steps = 1,965
[INFO|trainer.py:2252] 2024-11-05 05:19:56,586 >>   Number of trainable parameters = 12,156,928
  0%|          | 0/1965 [00:00<?, ?it/s]  0%|          | 1/1965 [00:02<1:33:23,  2.85s/it]  0%|          | 2/1965 [00:04<1:13:29,  2.25s/it]  0%|          | 3/1965 [00:06<1:09:47,  2.13s/it]  0%|          | 4/1965 [00:08<1:09:59,  2.14s/it]  0%|          | 5/1965 [00:11<1:13:49,  2.26s/it]  0%|          | 6/1965 [00:13<1:09:12,  2.12s/it]  0%|          | 7/1965 [00:15<1:10:42,  2.17s/it]  0%|          | 8/1965 [00:17<1:07:32,  2.07s/it]  0%|          | 9/1965 [00:19<1:07:57,  2.08s/it]  1%|          | 10/1965 [00:21<1:06:56,  2.05s/it]                                                     1%|          | 10/1965 [00:21<1:06:56,  2.05s/it]  1%|          | 11/1965 [00:23<1:07:26,  2.07s/it]  1%|          | 12/1965 [00:25<1:10:53,  2.18s/it]  1%|          | 13/1965 [00:27<1:09:05,  2.12s/it]  1%|          | 14/1965 [00:30<1:11:04,  2.19s/it]  1%|          | 15/1965 [00:32<1:10:30,  2.17s/it]  1%|          | 16/1965 [00:34<1:08:53,  2.12s/it]  1%|          | 17/1965 [00:36<1:07:00,  2.06s/it]  1%|          | 18/1965 [00:38<1:09:05,  2.13s/it]  1%|          | 19/1965 [00:40<1:09:53,  2.15s/it]  1%|          | 20/1965 [00:43<1:14:06,  2.29s/it]                                                     1%|          | 20/1965 [00:43<1:14:06,  2.29s/it]  1%|          | 21/1965 [00:45<1:12:01,  2.22s/it]  1%|          | 22/1965 [00:47<1:10:27,  2.18s/it]  1%|          | 23/1965 [00:49<1:06:12,  2.05s/it]  1%|          | 24/1965 [00:51<1:10:31,  2.18s/it]  1%|▏         | 25/1965 [00:53<1:08:16,  2.11s/it]  1%|▏         | 26/1965 [00:55<1:08:15,  2.11s/it]  1%|▏         | 27/1965 [00:57<1:06:18,  2.05s/it]  1%|▏         | 28/1965 [00:59<1:07:05,  2.08s/it]  1%|▏         | 29/1965 [01:02<1:10:10,  2.17s/it]  2%|▏         | 30/1965 [01:04<1:06:35,  2.06s/it]                                                     2%|▏         | 30/1965 [01:04<1:06:35,  2.06s/it]  2%|▏         | 31/1965 [01:05<1:04:27,  2.00s/it]  2%|▏         | 32/1965 [01:08<1:09:13,  2.15s/it]  2%|▏         | 33/1965 [01:10<1:08:18,  2.12s/it]  2%|▏         | 34/1965 [01:12<1:07:09,  2.09s/it]  2%|▏         | 35/1965 [01:14<1:06:54,  2.08s/it]  2%|▏         | 36/1965 [01:16<1:05:54,  2.05s/it]  2%|▏         | 37/1965 [01:18<1:04:16,  2.00s/it]  2%|▏         | 38/1965 [01:20<1:06:53,  2.08s/it]  2%|▏         | 39/1965 [01:22<1:04:06,  2.00s/it]  2%|▏         | 40/1965 [01:24<1:06:09,  2.06s/it]                                                     2%|▏         | 40/1965 [01:24<1:06:09,  2.06s/it]  2%|▏         | 41/1965 [01:26<1:06:31,  2.07s/it]  2%|▏         | 42/1965 [01:28<1:06:47,  2.08s/it]  2%|▏         | 43/1965 [01:30<1:04:27,  2.01s/it]  2%|▏         | 44/1965 [01:32<1:05:08,  2.03s/it]  2%|▏         | 45/1965 [01:34<1:03:31,  1.99s/it]  2%|▏         | 46/1965 [01:36<1:03:24,  1.98s/it]  2%|▏         | 47/1965 [01:38<1:03:14,  1.98s/it]  2%|▏         | 48/1965 [01:40<1:04:45,  2.03s/it]  2%|▏         | 49/1965 [01:43<1:06:25,  2.08s/it]  3%|▎         | 50/1965 [01:44<1:04:06,  2.01s/it]                                                     3%|▎         | 50/1965 [01:44<1:04:06,  2.01s/it]  3%|▎         | 51/1965 [01:46<1:02:21,  1.95s/it]  3%|▎         | 52/1965 [01:48<1:00:55,  1.91s/it]  3%|▎         | 53/1965 [01:50<1:01:56,  1.94s/it]  3%|▎         | 54/1965 [01:52<1:04:34,  2.03s/it]  3%|▎         | 55/1965 [01:54<1:02:36,  1.97s/it]  3%|▎         | 56/1965 [01:56<1:04:45,  2.04s/it]  3%|▎         | 57/1965 [01:58<1:06:06,  2.08s/it]  3%|▎         | 58/1965 [02:00<1:05:02,  2.05s/it]  3%|▎         | 59/1965 [02:03<1:06:55,  2.11s/it]  3%|▎         | 60/1965 [02:05<1:08:02,  2.14s/it]                                                     3%|▎         | 60/1965 [02:05<1:08:02,  2.14s/it]  3%|▎         | 61/1965 [02:07<1:07:36,  2.13s/it]  3%|▎         | 62/1965 [02:09<1:06:24,  2.09s/it]  3%|▎         | 63/1965 [02:11<1:04:35,  2.04s/it]  3%|▎         | 64/1965 [02:13<1:04:37,  2.04s/it]  3%|▎         | 65/1965 [02:15<1:06:49,  2.11s/it]  3%|▎         | 66/1965 [02:17<1:05:17,  2.06s/it]  3%|▎         | 67/1965 [02:19<1:03:39,  2.01s/it]  3%|▎         | 68/1965 [02:21<1:05:33,  2.07s/it]  4%|▎         | 69/1965 [02:23<1:03:00,  1.99s/it]  4%|▎         | 70/1965 [02:25<1:03:51,  2.02s/it]                                                     4%|▎         | 70/1965 [02:25<1:03:51,  2.02s/it]  4%|▎         | 71/1965 [02:27<1:02:55,  1.99s/it]  4%|▎         | 72/1965 [02:29<1:00:51,  1.93s/it]  4%|▎         | 73/1965 [02:31<1:01:17,  1.94s/it]  4%|▍         | 74/1965 [02:33<1:03:10,  2.00s/it]  4%|▍         | 75/1965 [02:35<1:07:15,  2.14s/it]  4%|▍         | 76/1965 [02:38<1:09:43,  2.21s/it]  4%|▍         | 77/1965 [02:40<1:06:26,  2.11s/it]  4%|▍         | 78/1965 [02:42<1:05:27,  2.08s/it]  4%|▍         | 79/1965 [02:44<1:04:40,  2.06s/it]  4%|▍         | 80/1965 [02:46<1:04:19,  2.05s/it]                                                     4%|▍         | 80/1965 [02:46<1:04:19,  2.05s/it]  4%|▍         | 81/1965 [02:48<1:02:09,  1.98s/it]  4%|▍         | 82/1965 [02:50<1:03:23,  2.02s/it]  4%|▍         | 83/1965 [02:52<1:03:51,  2.04s/it]  4%|▍         | 84/1965 [02:54<1:07:59,  2.17s/it]  4%|▍         | 85/1965 [02:56<1:07:06,  2.14s/it]  4%|▍         | 86/1965 [02:59<1:11:29,  2.28s/it]  4%|▍         | 87/1965 [03:01<1:07:34,  2.16s/it]  4%|▍         | 88/1965 [03:03<1:04:49,  2.07s/it]  5%|▍         | 89/1965 [03:04<1:02:09,  1.99s/it]  5%|▍         | 90/1965 [03:07<1:02:44,  2.01s/it]                                                     5%|▍         | 90/1965 [03:07<1:02:44,  2.01s/it]  5%|▍         | 91/1965 [03:08<1:00:46,  1.95s/it]  5%|▍         | 92/1965 [03:11<1:03:03,  2.02s/it]  5%|▍         | 93/1965 [03:13<1:02:41,  2.01s/it]  5%|▍         | 94/1965 [03:14<1:01:56,  1.99s/it]  5%|▍         | 95/1965 [03:16<1:02:19,  2.00s/it]  5%|▍         | 96/1965 [03:19<1:03:58,  2.05s/it]  5%|▍         | 97/1965 [03:21<1:03:45,  2.05s/it]  5%|▍         | 98/1965 [03:23<1:02:53,  2.02s/it]  5%|▌         | 99/1965 [03:24<1:01:16,  1.97s/it]  5%|▌         | 100/1965 [03:26<1:01:21,  1.97s/it]                                                      5%|▌         | 100/1965 [03:26<1:01:21,  1.97s/it][INFO|trainer.py:4021] 2024-11-05 05:23:23,566 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:23:23,566 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:23:23,566 >>   Batch size = 2
{'loss': 2.2831, 'grad_norm': 3.7130565643310547, 'learning_rate': 2.7918781725888327e-06, 'epoch': 0.03}
{'loss': 2.2787, 'grad_norm': 2.0812342166900635, 'learning_rate': 5.583756345177665e-06, 'epoch': 0.05}
{'loss': 2.0609, 'grad_norm': 4.010174751281738, 'learning_rate': 8.375634517766498e-06, 'epoch': 0.08}
{'loss': 1.8934, 'grad_norm': 2.733511447906494, 'learning_rate': 1.116751269035533e-05, 'epoch': 0.1}
{'loss': 1.6309, 'grad_norm': 1.9259637594223022, 'learning_rate': 1.3959390862944163e-05, 'epoch': 0.13}
{'loss': 1.3399, 'grad_norm': 0.8226620554924011, 'learning_rate': 1.6751269035532997e-05, 'epoch': 0.15}
{'loss': 1.2145, 'grad_norm': 1.7114404439926147, 'learning_rate': 1.9543147208121827e-05, 'epoch': 0.18}
{'loss': 1.0042, 'grad_norm': 1.278808832168579, 'learning_rate': 2.233502538071066e-05, 'epoch': 0.2}
{'loss': 0.8414, 'grad_norm': 1.6052449941635132, 'learning_rate': 2.5126903553299492e-05, 'epoch': 0.23}
{'loss': 0.7633, 'grad_norm': 1.4146437644958496, 'learning_rate': 2.7918781725888326e-05, 'epoch': 0.25}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.44it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.41it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.47it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.93it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.07it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.19it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.82it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.95it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.48it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.50it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.58it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.28it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.40it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.29it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.31it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.54it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.30it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.06it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.77it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.32it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.19it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.82it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.26it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.78it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.35it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.95it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.41it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 114/350 [00:07<00:17, 13.73it/s][A
 33%|███▎      | 116/350 [00:07<00:16, 14.49it/s][A
 34%|███▎      | 118/350 [00:07<00:15, 14.89it/s][A
 34%|███▍      | 120/350 [00:08<00:20, 11.42it/s][A
 35%|███▍      | 122/350 [00:08<00:18, 12.55it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.09it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.64it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.84it/s][A
 38%|███▊      | 133/350 [00:09<00:13, 16.56it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.32it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.87it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.45it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.37it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.36it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.64it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.44it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.83it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.25it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.38it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.57it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.22it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.65it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.41it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.62it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.54it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.06it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.33it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.28it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.63it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.44it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.14it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.81it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.43it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.81it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.65it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.34it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.01it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.55it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.12it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.13it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.58it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 18.00it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.02it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.26it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.25it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.97it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.64it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.50it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.35it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.51it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.44it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.39it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.39it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.06it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.83it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.03it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.78it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.07it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.26it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.11it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.18it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                    
                                                 [A  5%|▌         | 100/1965 [03:51<1:01:21,  1.97s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:23:47,604 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-100
[INFO|configuration_utils.py:673] 2024-11-05 05:23:47,626 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:23:47,627 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:23:47,719 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:23:47,719 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-100/special_tokens_map.json
  5%|▌         | 101/1965 [03:53<4:51:41,  9.39s/it]  5%|▌         | 102/1965 [03:55<3:45:03,  7.25s/it]  5%|▌         | 103/1965 [03:57<2:55:25,  5.65s/it]  5%|▌         | 104/1965 [03:59<2:20:42,  4.54s/it]  5%|▌         | 105/1965 [04:01<1:55:36,  3.73s/it]  5%|▌         | 106/1965 [04:03<1:42:09,  3.30s/it]  5%|▌         | 107/1965 [04:06<1:32:47,  3.00s/it]  5%|▌         | 108/1965 [04:08<1:24:35,  2.73s/it]  6%|▌         | 109/1965 [04:10<1:20:44,  2.61s/it]  6%|▌         | 110/1965 [04:12<1:14:46,  2.42s/it]                                                      6%|▌         | 110/1965 [04:12<1:14:46,  2.42s/it]  6%|▌         | 111/1965 [04:14<1:08:00,  2.20s/it]  6%|▌         | 112/1965 [04:16<1:06:53,  2.17s/it]  6%|▌         | 113/1965 [04:18<1:04:58,  2.11s/it]  6%|▌         | 114/1965 [04:21<1:10:41,  2.29s/it]  6%|▌         | 115/1965 [04:23<1:08:02,  2.21s/it]  6%|▌         | 116/1965 [04:25<1:06:17,  2.15s/it]  6%|▌         | 117/1965 [04:26<1:02:48,  2.04s/it]  6%|▌         | 118/1965 [04:28<1:01:38,  2.00s/it]  6%|▌         | 119/1965 [04:30<1:01:56,  2.01s/it]  6%|▌         | 120/1965 [04:32<1:02:24,  2.03s/it]                                                      6%|▌         | 120/1965 [04:32<1:02:24,  2.03s/it]  6%|▌         | 121/1965 [04:34<1:02:41,  2.04s/it]  6%|▌         | 122/1965 [04:37<1:02:31,  2.04s/it]  6%|▋         | 123/1965 [04:38<1:00:20,  1.97s/it]  6%|▋         | 124/1965 [04:40<58:17,  1.90s/it]    6%|▋         | 125/1965 [04:42<59:17,  1.93s/it]  6%|▋         | 126/1965 [04:44<1:01:04,  1.99s/it]  6%|▋         | 127/1965 [04:46<1:00:02,  1.96s/it]  7%|▋         | 128/1965 [04:48<1:03:19,  2.07s/it]  7%|▋         | 129/1965 [04:51<1:04:11,  2.10s/it]  7%|▋         | 130/1965 [04:53<1:08:23,  2.24s/it]                                                      7%|▋         | 130/1965 [04:53<1:08:23,  2.24s/it]  7%|▋         | 131/1965 [04:56<1:09:38,  2.28s/it]  7%|▋         | 132/1965 [04:57<1:04:56,  2.13s/it]  7%|▋         | 133/1965 [04:59<1:03:56,  2.09s/it]  7%|▋         | 134/1965 [05:01<1:00:54,  2.00s/it]  7%|▋         | 135/1965 [05:03<1:01:46,  2.03s/it]  7%|▋         | 136/1965 [05:05<1:00:18,  1.98s/it]  7%|▋         | 137/1965 [05:07<1:00:38,  1.99s/it]  7%|▋         | 138/1965 [05:10<1:05:23,  2.15s/it]  7%|▋         | 139/1965 [05:11<1:01:45,  2.03s/it]  7%|▋         | 140/1965 [05:13<1:00:39,  1.99s/it]                                                      7%|▋         | 140/1965 [05:13<1:00:39,  1.99s/it]  7%|▋         | 141/1965 [05:15<58:44,  1.93s/it]    7%|▋         | 142/1965 [05:17<1:00:00,  1.98s/it]  7%|▋         | 143/1965 [05:19<1:02:48,  2.07s/it]  7%|▋         | 144/1965 [05:21<1:00:11,  1.98s/it]  7%|▋         | 145/1965 [05:23<1:00:40,  2.00s/it]  7%|▋         | 146/1965 [05:25<1:03:00,  2.08s/it]  7%|▋         | 147/1965 [05:28<1:03:08,  2.08s/it]  8%|▊         | 148/1965 [05:30<1:04:57,  2.15s/it]  8%|▊         | 149/1965 [05:32<1:05:10,  2.15s/it]  8%|▊         | 150/1965 [05:34<1:03:38,  2.10s/it]                                                      8%|▊         | 150/1965 [05:34<1:03:38,  2.10s/it]  8%|▊         | 151/1965 [05:36<1:01:35,  2.04s/it]  8%|▊         | 152/1965 [05:38<1:00:52,  2.01s/it]  8%|▊         | 153/1965 [05:40<1:01:46,  2.05s/it]  8%|▊         | 154/1965 [05:42<1:00:50,  2.02s/it]  8%|▊         | 155/1965 [05:44<1:02:30,  2.07s/it]  8%|▊         | 156/1965 [05:46<1:04:17,  2.13s/it]  8%|▊         | 157/1965 [05:48<1:03:46,  2.12s/it]  8%|▊         | 158/1965 [05:51<1:03:59,  2.12s/it]  8%|▊         | 159/1965 [05:53<1:04:02,  2.13s/it]  8%|▊         | 160/1965 [05:55<1:06:09,  2.20s/it]                                                      8%|▊         | 160/1965 [05:55<1:06:09,  2.20s/it]  8%|▊         | 161/1965 [05:57<1:02:06,  2.07s/it]  8%|▊         | 162/1965 [05:59<1:00:20,  2.01s/it]  8%|▊         | 163/1965 [06:01<1:01:13,  2.04s/it]  8%|▊         | 164/1965 [06:03<1:01:19,  2.04s/it]  8%|▊         | 165/1965 [06:05<1:02:04,  2.07s/it]  8%|▊         | 166/1965 [06:07<1:01:37,  2.06s/it]  8%|▊         | 167/1965 [06:09<1:00:53,  2.03s/it]  9%|▊         | 168/1965 [06:11<59:32,  1.99s/it]    9%|▊         | 169/1965 [06:13<58:06,  1.94s/it]  9%|▊         | 170/1965 [06:15<57:31,  1.92s/it]                                                    9%|▊         | 170/1965 [06:15<57:31,  1.92s/it]  9%|▊         | 171/1965 [06:17<1:01:52,  2.07s/it]  9%|▉         | 172/1965 [06:19<58:46,  1.97s/it]    9%|▉         | 173/1965 [06:21<1:00:43,  2.03s/it]  9%|▉         | 174/1965 [06:23<1:03:42,  2.13s/it]  9%|▉         | 175/1965 [06:25<1:01:16,  2.05s/it]  9%|▉         | 176/1965 [06:27<1:02:37,  2.10s/it]  9%|▉         | 177/1965 [06:29<1:00:16,  2.02s/it]  9%|▉         | 178/1965 [06:31<59:07,  1.99s/it]    9%|▉         | 179/1965 [06:34<1:02:44,  2.11s/it]  9%|▉         | 180/1965 [06:36<1:03:09,  2.12s/it]                                                      9%|▉         | 180/1965 [06:36<1:03:09,  2.12s/it]  9%|▉         | 181/1965 [06:38<1:03:32,  2.14s/it]  9%|▉         | 182/1965 [06:40<1:01:28,  2.07s/it]  9%|▉         | 183/1965 [06:42<1:04:26,  2.17s/it]  9%|▉         | 184/1965 [06:44<1:02:13,  2.10s/it]  9%|▉         | 185/1965 [06:46<1:01:28,  2.07s/it]  9%|▉         | 186/1965 [06:48<1:01:16,  2.07s/it] 10%|▉         | 187/1965 [06:50<59:51,  2.02s/it]   10%|▉         | 188/1965 [06:52<1:00:31,  2.04s/it] 10%|▉         | 189/1965 [06:54<1:00:54,  2.06s/it] 10%|▉         | 190/1965 [06:56<59:16,  2.00s/it]                                                     10%|▉         | 190/1965 [06:56<59:16,  2.00s/it] 10%|▉         | 191/1965 [06:58<56:49,  1.92s/it] 10%|▉         | 192/1965 [07:00<57:23,  1.94s/it] 10%|▉         | 193/1965 [07:02<57:45,  1.96s/it] 10%|▉         | 194/1965 [07:04<56:04,  1.90s/it] 10%|▉         | 195/1965 [07:06<56:46,  1.92s/it] 10%|▉         | 196/1965 [07:07<55:20,  1.88s/it] 10%|█         | 197/1965 [07:09<57:13,  1.94s/it] 10%|█         | 198/1965 [07:12<1:01:09,  2.08s/it] 10%|█         | 199/1965 [07:14<59:40,  2.03s/it]   10%|█         | 200/1965 [07:16<57:55,  1.97s/it]                                                   10%|█         | 200/1965 [07:16<57:55,  1.97s/it][INFO|trainer.py:4021] 2024-11-05 05:27:12,702 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:27:12,702 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:27:12,702 >>   Batch size = 2
{'eval_loss': 0.7135130763053894, 'eval_runtime': 24.0378, 'eval_samples_per_second': 29.121, 'eval_steps_per_second': 14.56, 'epoch': 0.25}
{'loss': 0.6905, 'grad_norm': 0.9454280734062195, 'learning_rate': 3.071065989847716e-05, 'epoch': 0.28}
{'loss': 0.7097, 'grad_norm': 1.4927915334701538, 'learning_rate': 3.3502538071065994e-05, 'epoch': 0.3}
{'loss': 0.6574, 'grad_norm': 1.327488899230957, 'learning_rate': 3.629441624365482e-05, 'epoch': 0.33}
{'loss': 0.6533, 'grad_norm': 1.49789297580719, 'learning_rate': 3.9086294416243655e-05, 'epoch': 0.36}
{'loss': 0.5709, 'grad_norm': 1.3112608194351196, 'learning_rate': 4.187817258883249e-05, 'epoch': 0.38}
{'loss': 0.6083, 'grad_norm': 1.2180160284042358, 'learning_rate': 4.467005076142132e-05, 'epoch': 0.41}
{'loss': 0.5751, 'grad_norm': 1.2366993427276611, 'learning_rate': 4.7461928934010156e-05, 'epoch': 0.43}
{'loss': 0.5393, 'grad_norm': 1.4197144508361816, 'learning_rate': 5.0253807106598984e-05, 'epoch': 0.46}
{'loss': 0.5691, 'grad_norm': 1.2310739755630493, 'learning_rate': 5.304568527918782e-05, 'epoch': 0.48}
{'loss': 0.515, 'grad_norm': 1.3146289587020874, 'learning_rate': 5.4999609267619564e-05, 'epoch': 0.51}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.47it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.43it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.48it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.09it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.21it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.84it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.96it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.42it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.54it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.30it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.51it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.51it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.17it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.90it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.11it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.24it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 14.99it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.73it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.63it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.57it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.25it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.28it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.52it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.45it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.65it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.18it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.80it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.78it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.45it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.34it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.95it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.41it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.44it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.40it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.20it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.76it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.94it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.50it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.41it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.38it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.43it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.81it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.55it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.19it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.63it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.62it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.36it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.43it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.05it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.54it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.83it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.05it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.33it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.26it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.59it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.40it/s][A
 61%|██████    | 213/350 [00:14<00:08, 17.04it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.75it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.45it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.01it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.40it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.55it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.80it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.65it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.02it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.61it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.57it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.10it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.58it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.30it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.95it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.92it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.99it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.01it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.25it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.22it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.94it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.56it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.25it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 15.00it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.84it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.71it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.35it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.49it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.42it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.39it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.40it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.01it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.09it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.87it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.79it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.07it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.26it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.11it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.61it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.88it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.33it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 10%|█         | 200/1965 [07:40<57:55,  1.97s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:27:36,738 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-200
[INFO|configuration_utils.py:673] 2024-11-05 05:27:36,758 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:27:36,759 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:27:36,854 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:27:36,854 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-200/special_tokens_map.json
 10%|█         | 201/1965 [07:42<4:35:38,  9.38s/it] 10%|█         | 202/1965 [07:44<3:29:23,  7.13s/it] 10%|█         | 203/1965 [07:46<2:42:35,  5.54s/it] 10%|█         | 204/1965 [07:48<2:14:22,  4.58s/it] 10%|█         | 205/1965 [07:50<1:49:35,  3.74s/it] 10%|█         | 206/1965 [07:52<1:36:05,  3.28s/it] 11%|█         | 207/1965 [07:54<1:24:36,  2.89s/it] 11%|█         | 208/1965 [07:57<1:21:25,  2.78s/it] 11%|█         | 209/1965 [07:59<1:13:43,  2.52s/it] 11%|█         | 210/1965 [08:01<1:08:08,  2.33s/it]                                                     11%|█         | 210/1965 [08:01<1:08:08,  2.33s/it] 11%|█         | 211/1965 [08:03<1:05:58,  2.26s/it] 11%|█         | 212/1965 [08:04<1:01:54,  2.12s/it] 11%|█         | 213/1965 [08:07<1:04:47,  2.22s/it] 11%|█         | 214/1965 [08:09<1:01:52,  2.12s/it] 11%|█         | 215/1965 [08:11<1:01:05,  2.09s/it] 11%|█         | 216/1965 [08:13<59:47,  2.05s/it]   11%|█         | 217/1965 [08:15<57:20,  1.97s/it] 11%|█         | 218/1965 [08:17<59:33,  2.05s/it] 11%|█         | 219/1965 [08:19<57:46,  1.99s/it] 11%|█         | 220/1965 [08:21<57:46,  1.99s/it]                                                   11%|█         | 220/1965 [08:21<57:46,  1.99s/it] 11%|█         | 221/1965 [08:23<57:37,  1.98s/it] 11%|█▏        | 222/1965 [08:24<56:14,  1.94s/it] 11%|█▏        | 223/1965 [08:26<56:44,  1.95s/it] 11%|█▏        | 224/1965 [08:28<55:33,  1.91s/it] 11%|█▏        | 225/1965 [08:30<57:08,  1.97s/it] 12%|█▏        | 226/1965 [08:32<56:22,  1.95s/it] 12%|█▏        | 227/1965 [08:34<57:14,  1.98s/it] 12%|█▏        | 228/1965 [08:36<55:29,  1.92s/it] 12%|█▏        | 229/1965 [08:38<53:57,  1.86s/it] 12%|█▏        | 230/1965 [08:40<53:26,  1.85s/it]                                                   12%|█▏        | 230/1965 [08:40<53:26,  1.85s/it] 12%|█▏        | 231/1965 [08:42<55:27,  1.92s/it] 12%|█▏        | 232/1965 [08:44<56:52,  1.97s/it] 12%|█▏        | 233/1965 [08:46<1:00:44,  2.10s/it] 12%|█▏        | 234/1965 [08:48<58:06,  2.01s/it]   12%|█▏        | 235/1965 [08:50<1:00:47,  2.11s/it] 12%|█▏        | 236/1965 [08:52<57:38,  2.00s/it]   12%|█▏        | 237/1965 [08:54<57:35,  2.00s/it] 12%|█▏        | 238/1965 [08:56<56:53,  1.98s/it] 12%|█▏        | 239/1965 [08:58<56:28,  1.96s/it] 12%|█▏        | 240/1965 [09:00<55:21,  1.93s/it]                                                   12%|█▏        | 240/1965 [09:00<55:21,  1.93s/it] 12%|█▏        | 241/1965 [09:02<54:01,  1.88s/it] 12%|█▏        | 242/1965 [09:04<57:35,  2.01s/it] 12%|█▏        | 243/1965 [09:06<59:49,  2.08s/it] 12%|█▏        | 244/1965 [09:08<56:47,  1.98s/it] 12%|█▏        | 245/1965 [09:10<55:49,  1.95s/it] 13%|█▎        | 246/1965 [09:12<58:18,  2.03s/it] 13%|█▎        | 247/1965 [09:14<58:19,  2.04s/it] 13%|█▎        | 248/1965 [09:16<57:14,  2.00s/it] 13%|█▎        | 249/1965 [09:18<56:41,  1.98s/it] 13%|█▎        | 250/1965 [09:20<55:31,  1.94s/it]                                                   13%|█▎        | 250/1965 [09:20<55:31,  1.94s/it] 13%|█▎        | 251/1965 [09:21<53:20,  1.87s/it] 13%|█▎        | 252/1965 [09:24<55:14,  1.93s/it] 13%|█▎        | 253/1965 [09:26<56:29,  1.98s/it] 13%|█▎        | 254/1965 [09:27<54:43,  1.92s/it] 13%|█▎        | 255/1965 [09:30<56:29,  1.98s/it] 13%|█▎        | 256/1965 [09:31<56:23,  1.98s/it] 13%|█▎        | 257/1965 [09:34<58:48,  2.07s/it] 13%|█▎        | 258/1965 [09:36<58:40,  2.06s/it] 13%|█▎        | 259/1965 [09:38<58:53,  2.07s/it] 13%|█▎        | 260/1965 [09:40<58:46,  2.07s/it]                                                   13%|█▎        | 260/1965 [09:40<58:46,  2.07s/it] 13%|█▎        | 261/1965 [09:42<56:30,  1.99s/it] 13%|█▎        | 262/1965 [09:44<57:26,  2.02s/it] 13%|█▎        | 263/1965 [09:46<59:06,  2.08s/it] 13%|█▎        | 264/1965 [09:48<58:13,  2.05s/it] 13%|█▎        | 265/1965 [09:50<57:53,  2.04s/it] 14%|█▎        | 266/1965 [09:52<57:43,  2.04s/it] 14%|█▎        | 267/1965 [09:54<56:13,  1.99s/it] 14%|█▎        | 268/1965 [09:56<57:58,  2.05s/it] 14%|█▎        | 269/1965 [09:58<55:34,  1.97s/it] 14%|█▎        | 270/1965 [10:00<56:08,  1.99s/it]                                                   14%|█▎        | 270/1965 [10:00<56:08,  1.99s/it] 14%|█▍        | 271/1965 [10:02<54:30,  1.93s/it] 14%|█▍        | 272/1965 [10:04<54:26,  1.93s/it] 14%|█▍        | 273/1965 [10:06<53:36,  1.90s/it] 14%|█▍        | 274/1965 [10:07<53:05,  1.88s/it] 14%|█▍        | 275/1965 [10:09<53:09,  1.89s/it] 14%|█▍        | 276/1965 [10:11<54:55,  1.95s/it] 14%|█▍        | 277/1965 [10:13<53:34,  1.90s/it] 14%|█▍        | 278/1965 [10:15<53:29,  1.90s/it] 14%|█▍        | 279/1965 [10:17<52:50,  1.88s/it] 14%|█▍        | 280/1965 [10:19<55:03,  1.96s/it]                                                   14%|█▍        | 280/1965 [10:19<55:03,  1.96s/it] 14%|█▍        | 281/1965 [10:21<54:21,  1.94s/it] 14%|█▍        | 282/1965 [10:23<55:10,  1.97s/it] 14%|█▍        | 283/1965 [10:25<55:58,  2.00s/it] 14%|█▍        | 284/1965 [10:27<55:07,  1.97s/it] 15%|█▍        | 285/1965 [10:29<53:29,  1.91s/it] 15%|█▍        | 286/1965 [10:31<53:43,  1.92s/it] 15%|█▍        | 287/1965 [10:33<56:34,  2.02s/it] 15%|█▍        | 288/1965 [10:35<55:40,  1.99s/it] 15%|█▍        | 289/1965 [10:37<53:15,  1.91s/it] 15%|█▍        | 290/1965 [10:39<53:52,  1.93s/it]                                                   15%|█▍        | 290/1965 [10:39<53:52,  1.93s/it] 15%|█▍        | 291/1965 [10:41<54:33,  1.96s/it] 15%|█▍        | 292/1965 [10:42<54:17,  1.95s/it] 15%|█▍        | 293/1965 [10:45<55:19,  1.99s/it] 15%|█▍        | 294/1965 [10:47<55:38,  2.00s/it] 15%|█▌        | 295/1965 [10:49<55:07,  1.98s/it] 15%|█▌        | 296/1965 [10:51<58:37,  2.11s/it] 15%|█▌        | 297/1965 [10:53<58:00,  2.09s/it] 15%|█▌        | 298/1965 [10:55<57:26,  2.07s/it] 15%|█▌        | 299/1965 [10:57<58:32,  2.11s/it] 15%|█▌        | 300/1965 [10:59<58:34,  2.11s/it]                                                   15%|█▌        | 300/1965 [10:59<58:34,  2.11s/it][INFO|trainer.py:4021] 2024-11-05 05:30:56,393 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:30:56,394 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:30:56,394 >>   Batch size = 2
{'eval_loss': 0.5425659418106079, 'eval_runtime': 24.0352, 'eval_samples_per_second': 29.124, 'eval_steps_per_second': 14.562, 'epoch': 0.51}
{'loss': 0.5445, 'grad_norm': 1.3761019706726074, 'learning_rate': 5.499266322307003e-05, 'epoch': 0.53}
{'loss': 0.513, 'grad_norm': 1.3041255474090576, 'learning_rate': 5.497703676111777e-05, 'epoch': 0.56}
{'loss': 0.5658, 'grad_norm': 1.1521376371383667, 'learning_rate': 5.495273481559593e-05, 'epoch': 0.58}
{'loss': 0.5207, 'grad_norm': 1.8757541179656982, 'learning_rate': 5.491976505949815e-05, 'epoch': 0.61}
{'loss': 0.529, 'grad_norm': 1.891473412513733, 'learning_rate': 5.4878137902556025e-05, 'epoch': 0.63}
{'loss': 0.5168, 'grad_norm': 1.8292886018753052, 'learning_rate': 5.4827866487952314e-05, 'epoch': 0.66}
{'loss': 0.4916, 'grad_norm': 1.3956317901611328, 'learning_rate': 5.476896668817121e-05, 'epoch': 0.69}
{'loss': 0.4548, 'grad_norm': 1.0647997856140137, 'learning_rate': 5.47014570999868e-05, 'epoch': 0.71}
{'loss': 0.4913, 'grad_norm': 1.9315439462661743, 'learning_rate': 5.4625359038591406e-05, 'epoch': 0.74}
{'loss': 0.4728, 'grad_norm': 1.5515189170837402, 'learning_rate': 5.4540696530865614e-05, 'epoch': 0.76}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.48it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.43it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.47it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.26it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.09it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.84it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.21it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.84it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.95it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.98it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.49it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.96it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.51it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.29it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.06it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.32it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.32it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.56it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.49it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.80it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.13it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.34it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.95it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.40it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.20it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.92it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.46it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.14it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.40it/s][A
 35%|███▌      | 123/350 [00:08<00:17, 13.33it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.07it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.06it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.65it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.85it/s][A
 38%|███▊      | 133/350 [00:09<00:13, 16.52it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.32it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.86it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.44it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.38it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.36it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.41it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.46it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.64it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.07it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.97it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.43it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.81it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.36it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.55it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.20it/s][A
 50%|█████     | 175/350 [00:12<00:11, 14.64it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.43it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.64it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.39it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.46it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.90it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.43it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.07it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.85it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.77it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.05it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.33it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.28it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.64it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.46it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.17it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.51it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.44it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.58it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.82it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.67it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.37it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.04it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.62it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.87it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.25it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.14it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.99it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.91it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.12it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.95it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.15it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.82it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 18.03it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.04it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.27it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.26it/s][A
 83%|████████▎ | 291/350 [00:20<00:03, 16.40it/s][A
 84%|████████▎ | 293/350 [00:20<00:03, 16.29it/s][A
 84%|████████▍ | 295/350 [00:20<00:03, 15.12it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.45it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.48it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.50it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.34it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.61it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.47it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.36it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.39it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.01it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.10it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.88it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.81it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.10it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.13it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.61it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.88it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 15%|█▌        | 300/1965 [11:23<58:34,  2.11s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:31:20,425 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-300
[INFO|configuration_utils.py:673] 2024-11-05 05:31:20,446 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:31:20,446 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:31:20,548 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:31:20,548 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-300/special_tokens_map.json
 15%|█▌        | 301/1965 [11:26<4:19:52,  9.37s/it] 15%|█▌        | 302/1965 [11:28<3:19:38,  7.20s/it] 15%|█▌        | 303/1965 [11:30<2:37:01,  5.67s/it] 15%|█▌        | 304/1965 [11:32<2:07:16,  4.60s/it] 16%|█▌        | 305/1965 [11:34<1:44:13,  3.77s/it] 16%|█▌        | 306/1965 [11:36<1:31:05,  3.29s/it] 16%|█▌        | 307/1965 [11:38<1:20:11,  2.90s/it] 16%|█▌        | 308/1965 [11:40<1:13:48,  2.67s/it] 16%|█▌        | 309/1965 [11:42<1:10:17,  2.55s/it] 16%|█▌        | 310/1965 [11:44<1:06:16,  2.40s/it]                                                     16%|█▌        | 310/1965 [11:44<1:06:16,  2.40s/it] 16%|█▌        | 311/1965 [11:47<1:04:09,  2.33s/it] 16%|█▌        | 312/1965 [11:49<1:02:00,  2.25s/it] 16%|█▌        | 313/1965 [11:51<1:01:10,  2.22s/it] 16%|█▌        | 314/1965 [11:53<1:01:55,  2.25s/it] 16%|█▌        | 315/1965 [11:55<1:00:29,  2.20s/it] 16%|█▌        | 316/1965 [11:57<58:19,  2.12s/it]   16%|█▌        | 317/1965 [12:00<1:04:53,  2.36s/it] 16%|█▌        | 318/1965 [12:02<1:01:14,  2.23s/it] 16%|█▌        | 319/1965 [12:04<1:00:49,  2.22s/it] 16%|█▋        | 320/1965 [12:06<58:06,  2.12s/it]                                                     16%|█▋        | 320/1965 [12:06<58:06,  2.12s/it] 16%|█▋        | 321/1965 [12:08<56:21,  2.06s/it] 16%|█▋        | 322/1965 [12:10<54:38,  2.00s/it] 16%|█▋        | 323/1965 [12:12<54:06,  1.98s/it] 16%|█▋        | 324/1965 [12:14<52:47,  1.93s/it] 17%|█▋        | 325/1965 [12:16<55:18,  2.02s/it] 17%|█▋        | 326/1965 [12:18<55:26,  2.03s/it] 17%|█▋        | 327/1965 [12:20<56:42,  2.08s/it] 17%|█▋        | 328/1965 [12:22<53:54,  1.98s/it] 17%|█▋        | 329/1965 [12:24<54:30,  2.00s/it] 17%|█▋        | 330/1965 [12:26<56:05,  2.06s/it]                                                   17%|█▋        | 330/1965 [12:26<56:05,  2.06s/it] 17%|█▋        | 331/1965 [12:28<53:27,  1.96s/it] 17%|█▋        | 332/1965 [12:30<53:45,  1.98s/it] 17%|█▋        | 333/1965 [12:32<51:45,  1.90s/it] 17%|█▋        | 334/1965 [12:34<53:37,  1.97s/it] 17%|█▋        | 335/1965 [12:36<54:36,  2.01s/it] 17%|█▋        | 336/1965 [12:38<53:21,  1.97s/it] 17%|█▋        | 337/1965 [12:39<51:40,  1.90s/it] 17%|█▋        | 338/1965 [12:41<51:22,  1.89s/it] 17%|█▋        | 339/1965 [12:43<51:59,  1.92s/it] 17%|█▋        | 340/1965 [12:45<52:25,  1.94s/it]                                                   17%|█▋        | 340/1965 [12:45<52:25,  1.94s/it] 17%|█▋        | 341/1965 [12:47<54:36,  2.02s/it] 17%|█▋        | 342/1965 [12:50<57:04,  2.11s/it] 17%|█▋        | 343/1965 [12:52<55:18,  2.05s/it] 18%|█▊        | 344/1965 [12:53<52:58,  1.96s/it] 18%|█▊        | 345/1965 [12:55<51:26,  1.91s/it] 18%|█▊        | 346/1965 [12:57<53:11,  1.97s/it] 18%|█▊        | 347/1965 [12:59<55:02,  2.04s/it] 18%|█▊        | 348/1965 [13:02<57:34,  2.14s/it] 18%|█▊        | 349/1965 [13:04<55:56,  2.08s/it] 18%|█▊        | 350/1965 [13:06<54:01,  2.01s/it]                                                   18%|█▊        | 350/1965 [13:06<54:01,  2.01s/it] 18%|█▊        | 351/1965 [13:07<52:05,  1.94s/it] 18%|█▊        | 352/1965 [13:09<52:58,  1.97s/it] 18%|█▊        | 353/1965 [13:11<51:25,  1.91s/it] 18%|█▊        | 354/1965 [13:13<50:39,  1.89s/it] 18%|█▊        | 355/1965 [13:15<50:18,  1.87s/it] 18%|█▊        | 356/1965 [13:17<50:52,  1.90s/it] 18%|█▊        | 357/1965 [13:19<50:53,  1.90s/it] 18%|█▊        | 358/1965 [13:21<52:23,  1.96s/it] 18%|█▊        | 359/1965 [13:23<52:57,  1.98s/it] 18%|█▊        | 360/1965 [13:25<54:13,  2.03s/it]                                                   18%|█▊        | 360/1965 [13:25<54:13,  2.03s/it] 18%|█▊        | 361/1965 [13:27<53:48,  2.01s/it] 18%|█▊        | 362/1965 [13:29<52:19,  1.96s/it] 18%|█▊        | 363/1965 [13:31<52:17,  1.96s/it] 19%|█▊        | 364/1965 [13:33<51:51,  1.94s/it] 19%|█▊        | 365/1965 [13:34<50:30,  1.89s/it] 19%|█▊        | 366/1965 [13:36<50:35,  1.90s/it] 19%|█▊        | 367/1965 [13:39<53:05,  1.99s/it] 19%|█▊        | 368/1965 [13:41<53:21,  2.00s/it] 19%|█▉        | 369/1965 [13:43<53:53,  2.03s/it] 19%|█▉        | 370/1965 [13:45<55:53,  2.10s/it]                                                   19%|█▉        | 370/1965 [13:45<55:53,  2.10s/it] 19%|█▉        | 371/1965 [13:47<54:32,  2.05s/it] 19%|█▉        | 372/1965 [13:49<54:08,  2.04s/it] 19%|█▉        | 373/1965 [13:51<53:23,  2.01s/it] 19%|█▉        | 374/1965 [13:53<53:18,  2.01s/it] 19%|█▉        | 375/1965 [13:55<50:57,  1.92s/it] 19%|█▉        | 376/1965 [13:57<52:12,  1.97s/it] 19%|█▉        | 377/1965 [13:59<51:43,  1.95s/it] 19%|█▉        | 378/1965 [14:01<53:20,  2.02s/it] 19%|█▉        | 379/1965 [14:03<52:57,  2.00s/it] 19%|█▉        | 380/1965 [14:05<51:36,  1.95s/it]                                                   19%|█▉        | 380/1965 [14:05<51:36,  1.95s/it] 19%|█▉        | 381/1965 [14:07<53:04,  2.01s/it] 19%|█▉        | 382/1965 [14:09<53:59,  2.05s/it] 19%|█▉        | 383/1965 [14:11<53:26,  2.03s/it] 20%|█▉        | 384/1965 [14:13<51:36,  1.96s/it] 20%|█▉        | 385/1965 [14:14<49:26,  1.88s/it] 20%|█▉        | 386/1965 [14:16<49:42,  1.89s/it] 20%|█▉        | 387/1965 [14:18<50:25,  1.92s/it] 20%|█▉        | 388/1965 [14:20<49:43,  1.89s/it] 20%|█▉        | 389/1965 [14:22<54:04,  2.06s/it] 20%|█▉        | 390/1965 [14:25<56:04,  2.14s/it]                                                   20%|█▉        | 390/1965 [14:25<56:04,  2.14s/it] 20%|█▉        | 391/1965 [14:27<56:12,  2.14s/it] 20%|█▉        | 392/1965 [14:29<56:55,  2.17s/it] 20%|██        | 393/1965 [14:31<54:35,  2.08s/it] 20%|██        | 394/1965 [14:33<54:30,  2.08s/it] 20%|██        | 395/1965 [14:36<59:48,  2.29s/it] 20%|██        | 396/1965 [14:38<57:40,  2.21s/it] 20%|██        | 397/1965 [14:40<55:38,  2.13s/it] 20%|██        | 398/1965 [14:42<54:08,  2.07s/it] 20%|██        | 399/1965 [14:44<54:33,  2.09s/it] 20%|██        | 400/1965 [14:46<52:59,  2.03s/it]                                                   20%|██        | 400/1965 [14:46<52:59,  2.03s/it][INFO|trainer.py:4021] 2024-11-05 05:34:42,952 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:34:42,952 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:34:42,953 >>   Batch size = 2
{'eval_loss': 0.4798460304737091, 'eval_runtime': 24.0312, 'eval_samples_per_second': 29.129, 'eval_steps_per_second': 14.564, 'epoch': 0.76}
{'loss': 0.4778, 'grad_norm': 1.7174309492111206, 'learning_rate': 5.444749630779217e-05, 'epoch': 0.79}
{'loss': 0.4255, 'grad_norm': 1.5282037258148193, 'learning_rate': 5.4345787796015945e-05, 'epoch': 0.81}
{'loss': 0.4625, 'grad_norm': 1.291440725326538, 'learning_rate': 5.423560310855302e-05, 'epoch': 0.84}
{'loss': 0.4721, 'grad_norm': 1.8739683628082275, 'learning_rate': 5.411697703465137e-05, 'epoch': 0.86}
{'loss': 0.4742, 'grad_norm': 1.2894953489303589, 'learning_rate': 5.39899470288067e-05, 'epoch': 0.89}
{'loss': 0.4372, 'grad_norm': 1.7963944673538208, 'learning_rate': 5.385455319893668e-05, 'epoch': 0.91}
{'loss': 0.4535, 'grad_norm': 1.7587155103683472, 'learning_rate': 5.371083829371748e-05, 'epoch': 0.94}
{'loss': 0.4666, 'grad_norm': 1.863932728767395, 'learning_rate': 5.355884768908647e-05, 'epoch': 0.97}
{'loss': 0.4397, 'grad_norm': 1.1188290119171143, 'learning_rate': 5.339862937391538e-05, 'epoch': 0.99}
{'loss': 0.4595, 'grad_norm': 1.8292138576507568, 'learning_rate': 5.323023393485856e-05, 'epoch': 1.02}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.49it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.46it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.52it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.96it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.41it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.29it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.11it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.84it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.21it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.84it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.96it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.49it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.48it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.42it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.30it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.34it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.52it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.58it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.79it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.54it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.19it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.91it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.16it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.32it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.32it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.33it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.57it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.80it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.79it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.93it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.45it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.36it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.43it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.54it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.22it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.95it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.49it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.18it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.46it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.41it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.16it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.22it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.79it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.96it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.67it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.45it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.96it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.42it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.39it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.44it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.49it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.48it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.38it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.66it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.10it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.31it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.83it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.25it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.39it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.58it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.23it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.66it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.44it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.61it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.36it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.43it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.88it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.85it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.08it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.35it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.29it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.66it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.47it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.19it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.84it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.53it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.07it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.45it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.58it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.83it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.69it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.37it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.04it/s][A
 67%|██████▋   | 233/350 [00:15<00:07, 14.63it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.89it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.26it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.69it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.59it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.15it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.16it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.22it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.01it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.94it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.95it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.95it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.15it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.83it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.03it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.04it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.28it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.24it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.97it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.95it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.58it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.27it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.05it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 15.00it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.87it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.79it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.72it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.44it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.67it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.52it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.40it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.54it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.47it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.42it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.43it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.02it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.10it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.88it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.81it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.10it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.07it/s][A
 96%|█████████▋| 337/350 [00:22<00:00, 15.57it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.86it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 20%|██        | 400/1965 [15:10<52:59,  2.03s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:35:06,957 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-400
[INFO|configuration_utils.py:673] 2024-11-05 05:35:06,978 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:35:06,978 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:35:07,083 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:35:07,084 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-400/special_tokens_map.json
 20%|██        | 401/1965 [15:12<4:05:20,  9.41s/it] 20%|██        | 402/1965 [15:15<3:10:30,  7.31s/it] 21%|██        | 403/1965 [15:17<2:28:30,  5.70s/it] 21%|██        | 404/1965 [15:19<1:59:16,  4.58s/it] 21%|██        | 405/1965 [15:21<1:37:56,  3.77s/it] 21%|██        | 406/1965 [15:23<1:23:45,  3.22s/it] 21%|██        | 407/1965 [15:25<1:15:55,  2.92s/it] 21%|██        | 408/1965 [15:27<1:08:07,  2.63s/it] 21%|██        | 409/1965 [15:29<1:03:47,  2.46s/it] 21%|██        | 410/1965 [15:31<59:31,  2.30s/it]                                                     21%|██        | 410/1965 [15:31<59:31,  2.30s/it] 21%|██        | 411/1965 [15:33<56:44,  2.19s/it] 21%|██        | 412/1965 [15:35<53:54,  2.08s/it] 21%|██        | 413/1965 [15:37<55:33,  2.15s/it] 21%|██        | 414/1965 [15:39<54:32,  2.11s/it] 21%|██        | 415/1965 [15:41<52:02,  2.01s/it] 21%|██        | 416/1965 [15:43<55:43,  2.16s/it] 21%|██        | 417/1965 [15:45<54:36,  2.12s/it] 21%|██▏       | 418/1965 [15:47<52:39,  2.04s/it] 21%|██▏       | 419/1965 [15:49<52:38,  2.04s/it] 21%|██▏       | 420/1965 [15:51<53:34,  2.08s/it]                                                   21%|██▏       | 420/1965 [15:51<53:34,  2.08s/it] 21%|██▏       | 421/1965 [15:53<52:48,  2.05s/it] 21%|██▏       | 422/1965 [15:55<53:36,  2.08s/it] 22%|██▏       | 423/1965 [15:58<55:45,  2.17s/it] 22%|██▏       | 424/1965 [16:00<53:48,  2.10s/it] 22%|██▏       | 425/1965 [16:02<52:35,  2.05s/it] 22%|██▏       | 426/1965 [16:04<52:01,  2.03s/it] 22%|██▏       | 427/1965 [16:06<52:48,  2.06s/it] 22%|██▏       | 428/1965 [16:08<50:40,  1.98s/it] 22%|██▏       | 429/1965 [16:10<51:21,  2.01s/it] 22%|██▏       | 430/1965 [16:12<50:45,  1.98s/it]                                                   22%|██▏       | 430/1965 [16:12<50:45,  1.98s/it] 22%|██▏       | 431/1965 [16:13<50:25,  1.97s/it] 22%|██▏       | 432/1965 [16:15<49:19,  1.93s/it] 22%|██▏       | 433/1965 [16:17<47:52,  1.88s/it] 22%|██▏       | 434/1965 [16:19<49:44,  1.95s/it] 22%|██▏       | 435/1965 [16:21<50:35,  1.98s/it] 22%|██▏       | 436/1965 [16:24<52:48,  2.07s/it] 22%|██▏       | 437/1965 [16:25<50:30,  1.98s/it] 22%|██▏       | 438/1965 [16:27<49:59,  1.96s/it] 22%|██▏       | 439/1965 [16:29<47:51,  1.88s/it] 22%|██▏       | 440/1965 [16:31<51:34,  2.03s/it]                                                   22%|██▏       | 440/1965 [16:31<51:34,  2.03s/it] 22%|██▏       | 441/1965 [16:33<49:52,  1.96s/it] 22%|██▏       | 442/1965 [16:35<51:55,  2.05s/it] 23%|██▎       | 443/1965 [16:38<54:36,  2.15s/it] 23%|██▎       | 444/1965 [16:40<52:37,  2.08s/it] 23%|██▎       | 445/1965 [16:41<50:21,  1.99s/it] 23%|██▎       | 446/1965 [16:44<52:02,  2.06s/it] 23%|██▎       | 447/1965 [16:46<52:41,  2.08s/it] 23%|██▎       | 448/1965 [16:48<50:18,  1.99s/it] 23%|██▎       | 449/1965 [16:50<51:24,  2.03s/it] 23%|██▎       | 450/1965 [16:52<51:43,  2.05s/it]                                                   23%|██▎       | 450/1965 [16:52<51:43,  2.05s/it] 23%|██▎       | 451/1965 [16:54<49:35,  1.97s/it] 23%|██▎       | 452/1965 [16:56<50:30,  2.00s/it] 23%|██▎       | 453/1965 [16:58<50:13,  1.99s/it] 23%|██▎       | 454/1965 [17:00<50:05,  1.99s/it] 23%|██▎       | 455/1965 [17:01<49:23,  1.96s/it] 23%|██▎       | 456/1965 [17:04<53:04,  2.11s/it] 23%|██▎       | 457/1965 [17:06<52:04,  2.07s/it] 23%|██▎       | 458/1965 [17:08<52:50,  2.10s/it] 23%|██▎       | 459/1965 [17:10<51:15,  2.04s/it] 23%|██▎       | 460/1965 [17:12<48:55,  1.95s/it]                                                   23%|██▎       | 460/1965 [17:12<48:55,  1.95s/it] 23%|██▎       | 461/1965 [17:14<51:12,  2.04s/it] 24%|██▎       | 462/1965 [17:16<50:50,  2.03s/it] 24%|██▎       | 463/1965 [17:18<48:59,  1.96s/it] 24%|██▎       | 464/1965 [17:20<47:48,  1.91s/it] 24%|██▎       | 465/1965 [17:22<48:57,  1.96s/it] 24%|██▎       | 466/1965 [17:24<48:14,  1.93s/it] 24%|██▍       | 467/1965 [17:25<46:43,  1.87s/it] 24%|██▍       | 468/1965 [17:28<49:35,  1.99s/it] 24%|██▍       | 469/1965 [17:29<48:48,  1.96s/it] 24%|██▍       | 470/1965 [17:31<47:15,  1.90s/it]                                                   24%|██▍       | 470/1965 [17:31<47:15,  1.90s/it] 24%|██▍       | 471/1965 [17:33<49:30,  1.99s/it] 24%|██▍       | 472/1965 [17:35<48:05,  1.93s/it] 24%|██▍       | 473/1965 [17:37<50:29,  2.03s/it] 24%|██▍       | 474/1965 [17:39<50:10,  2.02s/it] 24%|██▍       | 475/1965 [17:41<48:19,  1.95s/it] 24%|██▍       | 476/1965 [17:43<47:36,  1.92s/it] 24%|██▍       | 477/1965 [17:45<47:44,  1.92s/it] 24%|██▍       | 478/1965 [17:47<49:35,  2.00s/it] 24%|██▍       | 479/1965 [17:49<50:52,  2.05s/it] 24%|██▍       | 480/1965 [17:51<48:43,  1.97s/it]                                                   24%|██▍       | 480/1965 [17:51<48:43,  1.97s/it] 24%|██▍       | 481/1965 [17:53<48:08,  1.95s/it] 25%|██▍       | 482/1965 [17:55<51:07,  2.07s/it] 25%|██▍       | 483/1965 [17:57<50:38,  2.05s/it] 25%|██▍       | 484/1965 [17:59<50:16,  2.04s/it] 25%|██▍       | 485/1965 [18:01<50:39,  2.05s/it] 25%|██▍       | 486/1965 [18:04<51:11,  2.08s/it] 25%|██▍       | 487/1965 [18:06<50:32,  2.05s/it] 25%|██▍       | 488/1965 [18:07<48:50,  1.98s/it] 25%|██▍       | 489/1965 [18:10<50:23,  2.05s/it] 25%|██▍       | 490/1965 [18:12<49:21,  2.01s/it]                                                   25%|██▍       | 490/1965 [18:12<49:21,  2.01s/it] 25%|██▍       | 491/1965 [18:14<49:04,  2.00s/it] 25%|██▌       | 492/1965 [18:15<48:14,  1.96s/it] 25%|██▌       | 493/1965 [18:17<48:10,  1.96s/it] 25%|██▌       | 494/1965 [18:19<47:52,  1.95s/it] 25%|██▌       | 495/1965 [18:21<46:43,  1.91s/it] 25%|██▌       | 496/1965 [18:23<46:27,  1.90s/it] 25%|██▌       | 497/1965 [18:25<48:37,  1.99s/it] 25%|██▌       | 498/1965 [18:27<50:22,  2.06s/it] 25%|██▌       | 499/1965 [18:30<50:45,  2.08s/it] 25%|██▌       | 500/1965 [18:32<51:31,  2.11s/it]                                                   25%|██▌       | 500/1965 [18:32<51:31,  2.11s/it][INFO|trainer.py:4021] 2024-11-05 05:38:28,782 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:38:28,782 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:38:28,782 >>   Batch size = 2
{'eval_loss': 0.433764785528183, 'eval_runtime': 24.0046, 'eval_samples_per_second': 29.161, 'eval_steps_per_second': 14.581, 'epoch': 1.02}
{'loss': 0.3697, 'grad_norm': 1.4948930740356445, 'learning_rate': 5.305371454038091e-05, 'epoch': 1.04}
{'loss': 0.4418, 'grad_norm': 1.6107878684997559, 'learning_rate': 5.286912692397073e-05, 'epoch': 1.07}
{'loss': 0.4455, 'grad_norm': 1.3002244234085083, 'learning_rate': 5.2676529366542614e-05, 'epoch': 1.09}
{'loss': 0.4314, 'grad_norm': 1.4165253639221191, 'learning_rate': 5.247598267803614e-05, 'epoch': 1.12}
{'loss': 0.4296, 'grad_norm': 1.8242131471633911, 'learning_rate': 5.226755017821597e-05, 'epoch': 1.14}
{'loss': 0.391, 'grad_norm': 1.7291299104690552, 'learning_rate': 5.2051297676679517e-05, 'epoch': 1.17}
{'loss': 0.3956, 'grad_norm': 1.1632969379425049, 'learning_rate': 5.1827293452078525e-05, 'epoch': 1.19}
{'loss': 0.3948, 'grad_norm': 2.017491102218628, 'learning_rate': 5.1595608230561047e-05, 'epoch': 1.22}
{'loss': 0.4267, 'grad_norm': 1.3681553602218628, 'learning_rate': 5.135631516344067e-05, 'epoch': 1.24}
{'loss': 0.4035, 'grad_norm': 1.4414889812469482, 'learning_rate': 5.110948980410004e-05, 'epoch': 1.27}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.50it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.47it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.52it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.95it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.42it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.28it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.11it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.85it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.22it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.85it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.97it/s][A
  7%|▋         | 26/350 [00:01<00:21, 15.00it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.28it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.96it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.47it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.41it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.30it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.51it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.57it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.78it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.53it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.18it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.91it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.70it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.34it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.34it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.58it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.50it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.75it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.91it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.16it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.78it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.22it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.12it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.92it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.45it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.35it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.43it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.22it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.95it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.49it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.18it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.40it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.16it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.22it/s][A
 37%|███▋      | 129/350 [00:08<00:13, 15.79it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.96it/s][A
 38%|███▊      | 133/350 [00:08<00:12, 16.69it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.47it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.97it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.54it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.45it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.40it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.41it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.08it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.97it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.44it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.82it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.24it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.39it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.58it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.22it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.66it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.43it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.65it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.39it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.45it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.91it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.43it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.08it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.86it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.77it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.11it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.59it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.86it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.08it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.35it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.30it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.65it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.47it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.18it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.83it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.52it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.06it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.44it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.59it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.83it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.69it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.35it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.01it/s][A
 67%|██████▋   | 233/350 [00:15<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.59it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.15it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.15it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.23it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.01it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.94it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.10it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.59it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.90it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.32it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.97it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.97it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.16it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.83it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.04it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.05it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.28it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.24it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.97it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.96it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.59it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.28it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.07it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 15.02it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.87it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.79it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.72it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.44it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.68it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.52it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.40it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.55it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.48it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.42it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.44it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.02it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.10it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.89it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.10it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.14it/s][A
 96%|█████████▋| 337/350 [00:22<00:00, 15.62it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.88it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.30it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.33it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.31it/s][A                                                  
                                                 [A 25%|██▌       | 500/1965 [18:56<51:31,  2.11s/it]
100%|██████████| 350/350 [00:23<00:00, 13.31it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:38:52,784 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-500
[INFO|configuration_utils.py:673] 2024-11-05 05:38:52,804 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:38:52,805 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:38:52,907 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:38:52,907 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-500/special_tokens_map.json
 25%|██▌       | 501/1965 [18:58<3:48:28,  9.36s/it] 26%|██▌       | 502/1965 [19:00<2:52:10,  7.06s/it] 26%|██▌       | 503/1965 [19:02<2:15:09,  5.55s/it] 26%|██▌       | 504/1965 [19:04<1:51:57,  4.60s/it] 26%|██▌       | 505/1965 [19:07<1:36:13,  3.95s/it] 26%|██▌       | 506/1965 [19:08<1:20:09,  3.30s/it] 26%|██▌       | 507/1965 [19:10<1:11:29,  2.94s/it] 26%|██▌       | 508/1965 [19:12<1:03:20,  2.61s/it] 26%|██▌       | 509/1965 [19:15<1:01:36,  2.54s/it] 26%|██▌       | 510/1965 [19:17<59:00,  2.43s/it]                                                     26%|██▌       | 510/1965 [19:17<59:00,  2.43s/it] 26%|██▌       | 511/1965 [19:19<58:59,  2.43s/it] 26%|██▌       | 512/1965 [19:21<56:07,  2.32s/it] 26%|██▌       | 513/1965 [19:24<56:57,  2.35s/it] 26%|██▌       | 514/1965 [19:26<54:27,  2.25s/it] 26%|██▌       | 515/1965 [19:27<50:50,  2.10s/it] 26%|██▋       | 516/1965 [19:30<50:39,  2.10s/it] 26%|██▋       | 517/1965 [19:31<47:59,  1.99s/it] 26%|██▋       | 518/1965 [19:33<49:04,  2.04s/it] 26%|██▋       | 519/1965 [19:35<48:30,  2.01s/it] 26%|██▋       | 520/1965 [19:38<50:01,  2.08s/it]                                                   26%|██▋       | 520/1965 [19:38<50:01,  2.08s/it] 27%|██▋       | 521/1965 [19:40<48:38,  2.02s/it] 27%|██▋       | 522/1965 [19:41<47:34,  1.98s/it] 27%|██▋       | 523/1965 [19:43<47:44,  1.99s/it] 27%|██▋       | 524/1965 [19:45<46:42,  1.94s/it] 27%|██▋       | 525/1965 [19:47<48:47,  2.03s/it] 27%|██▋       | 526/1965 [19:50<48:40,  2.03s/it] 27%|██▋       | 527/1965 [19:52<48:55,  2.04s/it] 27%|██▋       | 528/1965 [19:53<46:34,  1.94s/it] 27%|██▋       | 529/1965 [19:55<44:50,  1.87s/it] 27%|██▋       | 530/1965 [19:57<46:20,  1.94s/it]                                                   27%|██▋       | 530/1965 [19:57<46:20,  1.94s/it] 27%|██▋       | 531/1965 [19:59<46:35,  1.95s/it] 27%|██▋       | 532/1965 [20:01<47:16,  1.98s/it] 27%|██▋       | 533/1965 [20:03<45:41,  1.91s/it] 27%|██▋       | 534/1965 [20:05<45:41,  1.92s/it] 27%|██▋       | 535/1965 [20:07<46:52,  1.97s/it] 27%|██▋       | 536/1965 [20:09<46:51,  1.97s/it] 27%|██▋       | 537/1965 [20:11<46:26,  1.95s/it] 27%|██▋       | 538/1965 [20:13<49:05,  2.06s/it] 27%|██▋       | 539/1965 [20:15<47:44,  2.01s/it] 27%|██▋       | 540/1965 [20:17<48:22,  2.04s/it]                                                   27%|██▋       | 540/1965 [20:17<48:22,  2.04s/it] 28%|██▊       | 541/1965 [20:19<48:41,  2.05s/it] 28%|██▊       | 542/1965 [20:21<48:19,  2.04s/it] 28%|██▊       | 543/1965 [20:23<48:02,  2.03s/it] 28%|██▊       | 544/1965 [20:25<46:41,  1.97s/it] 28%|██▊       | 545/1965 [20:27<44:56,  1.90s/it] 28%|██▊       | 546/1965 [20:29<44:46,  1.89s/it] 28%|██▊       | 547/1965 [20:31<45:59,  1.95s/it] 28%|██▊       | 548/1965 [20:33<48:05,  2.04s/it] 28%|██▊       | 549/1965 [20:35<46:42,  1.98s/it] 28%|██▊       | 550/1965 [20:37<46:53,  1.99s/it]                                                   28%|██▊       | 550/1965 [20:37<46:53,  1.99s/it] 28%|██▊       | 551/1965 [20:39<46:08,  1.96s/it] 28%|██▊       | 552/1965 [20:40<44:37,  1.89s/it] 28%|██▊       | 553/1965 [20:42<45:20,  1.93s/it] 28%|██▊       | 554/1965 [20:45<47:42,  2.03s/it] 28%|██▊       | 555/1965 [20:47<47:28,  2.02s/it] 28%|██▊       | 556/1965 [20:49<51:18,  2.18s/it] 28%|██▊       | 557/1965 [20:51<50:02,  2.13s/it] 28%|██▊       | 558/1965 [20:53<47:26,  2.02s/it] 28%|██▊       | 559/1965 [20:55<45:18,  1.93s/it] 28%|██▊       | 560/1965 [20:57<44:22,  1.89s/it]                                                   28%|██▊       | 560/1965 [20:57<44:22,  1.89s/it] 29%|██▊       | 561/1965 [20:59<45:00,  1.92s/it] 29%|██▊       | 562/1965 [21:00<44:19,  1.90s/it] 29%|██▊       | 563/1965 [21:02<43:39,  1.87s/it] 29%|██▊       | 564/1965 [21:04<42:50,  1.83s/it] 29%|██▉       | 565/1965 [21:06<43:52,  1.88s/it] 29%|██▉       | 566/1965 [21:08<46:15,  1.98s/it] 29%|██▉       | 567/1965 [21:10<47:47,  2.05s/it] 29%|██▉       | 568/1965 [21:13<48:15,  2.07s/it] 29%|██▉       | 569/1965 [21:15<47:58,  2.06s/it] 29%|██▉       | 570/1965 [21:16<46:57,  2.02s/it]                                                   29%|██▉       | 570/1965 [21:16<46:57,  2.02s/it] 29%|██▉       | 571/1965 [21:19<47:25,  2.04s/it] 29%|██▉       | 572/1965 [21:21<46:56,  2.02s/it] 29%|██▉       | 573/1965 [21:23<47:09,  2.03s/it] 29%|██▉       | 574/1965 [21:24<45:31,  1.96s/it] 29%|██▉       | 575/1965 [21:27<47:22,  2.05s/it] 29%|██▉       | 576/1965 [21:28<45:09,  1.95s/it] 29%|██▉       | 577/1965 [21:31<46:50,  2.02s/it] 29%|██▉       | 578/1965 [21:33<49:15,  2.13s/it] 29%|██▉       | 579/1965 [21:35<47:53,  2.07s/it] 30%|██▉       | 580/1965 [21:37<45:46,  1.98s/it]                                                   30%|██▉       | 580/1965 [21:37<45:46,  1.98s/it] 30%|██▉       | 581/1965 [21:39<46:04,  2.00s/it] 30%|██▉       | 582/1965 [21:41<46:59,  2.04s/it] 30%|██▉       | 583/1965 [21:43<49:24,  2.15s/it] 30%|██▉       | 584/1965 [21:45<46:44,  2.03s/it] 30%|██▉       | 585/1965 [21:47<46:39,  2.03s/it] 30%|██▉       | 586/1965 [21:49<45:01,  1.96s/it] 30%|██▉       | 587/1965 [21:51<44:35,  1.94s/it] 30%|██▉       | 588/1965 [21:53<45:42,  1.99s/it] 30%|██▉       | 589/1965 [21:55<43:46,  1.91s/it] 30%|███       | 590/1965 [21:56<43:33,  1.90s/it]                                                   30%|███       | 590/1965 [21:56<43:33,  1.90s/it] 30%|███       | 591/1965 [21:59<46:43,  2.04s/it] 30%|███       | 592/1965 [22:01<47:42,  2.08s/it] 30%|███       | 593/1965 [22:03<48:20,  2.11s/it] 30%|███       | 594/1965 [22:05<47:01,  2.06s/it] 30%|███       | 595/1965 [22:07<45:53,  2.01s/it] 30%|███       | 596/1965 [22:09<47:37,  2.09s/it] 30%|███       | 597/1965 [22:11<45:45,  2.01s/it] 30%|███       | 598/1965 [22:13<47:17,  2.08s/it] 30%|███       | 599/1965 [22:15<45:58,  2.02s/it] 31%|███       | 600/1965 [22:17<44:44,  1.97s/it]                                                   31%|███       | 600/1965 [22:17<44:44,  1.97s/it][INFO|trainer.py:4021] 2024-11-05 05:42:14,098 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:42:14,098 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:42:14,098 >>   Batch size = 2
{'eval_loss': 0.41246652603149414, 'eval_runtime': 24.0018, 'eval_samples_per_second': 29.165, 'eval_steps_per_second': 14.582, 'epoch': 1.27}
{'loss': 0.383, 'grad_norm': 1.9876819849014282, 'learning_rate': 5.085521008413592e-05, 'epoch': 1.3}
{'loss': 0.4331, 'grad_norm': 1.9762297868728638, 'learning_rate': 5.0593556288753446e-05, 'epoch': 1.32}
{'loss': 0.3829, 'grad_norm': 1.293381690979004, 'learning_rate': 5.0324611031417176e-05, 'epoch': 1.35}
{'loss': 0.3901, 'grad_norm': 1.908718466758728, 'learning_rate': 5.004845922776709e-05, 'epoch': 1.37}
{'loss': 0.3929, 'grad_norm': 1.4431322813034058, 'learning_rate': 4.976518806880766e-05, 'epoch': 1.4}
{'loss': 0.39, 'grad_norm': 1.4790682792663574, 'learning_rate': 4.9474886993378554e-05, 'epoch': 1.42}
{'loss': 0.4089, 'grad_norm': 2.611419439315796, 'learning_rate': 4.917764765991558e-05, 'epoch': 1.45}
{'loss': 0.3882, 'grad_norm': 1.0593427419662476, 'learning_rate': 4.887356391751083e-05, 'epoch': 1.47}
{'loss': 0.3654, 'grad_norm': 1.1837884187698364, 'learning_rate': 4.856273177628121e-05, 'epoch': 1.5}
{'loss': 0.3662, 'grad_norm': 1.9413297176361084, 'learning_rate': 4.824524937705451e-05, 'epoch': 1.52}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.50it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.47it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.53it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.96it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.42it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.28it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.10it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.84it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.84it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.96it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.42it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.96it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.47it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.41it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.30it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.34it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.52it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.58it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.79it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.54it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.19it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.91it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.16it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.32it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.70it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.33it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.33it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.19it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.81it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.26it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.79it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.93it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.45it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.36it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.44it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.54it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.22it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.95it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.50it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.19it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.46it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.41it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.17it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.23it/s][A
 37%|███▋      | 129/350 [00:08<00:13, 15.79it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.97it/s][A
 38%|███▊      | 133/350 [00:08<00:12, 16.70it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.46it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.97it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.53it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.45it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.41it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.45it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.50it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.49it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.38it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.08it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.83it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.25it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.39it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.58it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.22it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.67it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.44it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.65it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.39it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.46it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.91it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.44it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.08it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.86it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.77it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.06it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.28it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.24it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.62it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.44it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.16it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.44it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.59it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.84it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.69it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.38it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:15<00:08, 14.62it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.88it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.25it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.59it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.16it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.16it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.23it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.01it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.94it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.58it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.96it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.17it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.84it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.03it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.04it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.28it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.24it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.97it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.96it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.58it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.28it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.05it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 15.01it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.87it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.80it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.72it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.45it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.68it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.53it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.40it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.56it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.47it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.41it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.02it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.11it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.90it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.08it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.82it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.10it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.15it/s][A
 96%|█████████▋| 337/350 [00:22<00:00, 15.62it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.20it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.89it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.31it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.34it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.32it/s][A                                                  
                                                 [A 31%|███       | 600/1965 [22:41<44:44,  1.97s/it]
100%|██████████| 350/350 [00:23<00:00, 13.32it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:42:38,098 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-600
[INFO|configuration_utils.py:673] 2024-11-05 05:42:38,118 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:42:38,119 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:42:38,219 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:42:38,219 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-600/special_tokens_map.json
 31%|███       | 601/1965 [22:43<3:29:58,  9.24s/it] 31%|███       | 602/1965 [22:45<2:42:05,  7.14s/it] 31%|███       | 603/1965 [22:48<2:08:47,  5.67s/it] 31%|███       | 604/1965 [22:50<1:45:42,  4.66s/it] 31%|███       | 605/1965 [22:52<1:27:26,  3.86s/it] 31%|███       | 606/1965 [22:54<1:15:12,  3.32s/it] 31%|███       | 607/1965 [22:56<1:05:26,  2.89s/it] 31%|███       | 608/1965 [22:58<58:53,  2.60s/it]   31%|███       | 609/1965 [23:00<54:52,  2.43s/it] 31%|███       | 610/1965 [23:02<52:59,  2.35s/it]                                                   31%|███       | 610/1965 [23:02<52:59,  2.35s/it] 31%|███       | 611/1965 [23:05<54:18,  2.41s/it] 31%|███       | 612/1965 [23:06<49:49,  2.21s/it] 31%|███       | 613/1965 [23:09<49:56,  2.22s/it] 31%|███       | 614/1965 [23:10<47:17,  2.10s/it] 31%|███▏      | 615/1965 [23:13<50:02,  2.22s/it] 31%|███▏      | 616/1965 [23:15<48:46,  2.17s/it] 31%|███▏      | 617/1965 [23:17<46:46,  2.08s/it] 31%|███▏      | 618/1965 [23:19<44:48,  2.00s/it] 32%|███▏      | 619/1965 [23:21<45:06,  2.01s/it] 32%|███▏      | 620/1965 [23:23<45:01,  2.01s/it]                                                   32%|███▏      | 620/1965 [23:23<45:01,  2.01s/it] 32%|███▏      | 621/1965 [23:24<43:39,  1.95s/it] 32%|███▏      | 622/1965 [23:26<43:09,  1.93s/it] 32%|███▏      | 623/1965 [23:28<42:47,  1.91s/it] 32%|███▏      | 624/1965 [23:30<41:41,  1.87s/it] 32%|███▏      | 625/1965 [23:32<41:26,  1.86s/it] 32%|███▏      | 626/1965 [23:34<41:54,  1.88s/it] 32%|███▏      | 627/1965 [23:36<41:42,  1.87s/it] 32%|███▏      | 628/1965 [23:37<40:27,  1.82s/it] 32%|███▏      | 629/1965 [23:39<41:36,  1.87s/it] 32%|███▏      | 630/1965 [23:42<44:02,  1.98s/it]                                                   32%|███▏      | 630/1965 [23:42<44:02,  1.98s/it] 32%|███▏      | 631/1965 [23:44<45:13,  2.03s/it] 32%|███▏      | 632/1965 [23:46<44:00,  1.98s/it] 32%|███▏      | 633/1965 [23:47<42:54,  1.93s/it] 32%|███▏      | 634/1965 [23:49<43:27,  1.96s/it] 32%|███▏      | 635/1965 [23:51<43:05,  1.94s/it] 32%|███▏      | 636/1965 [23:54<45:29,  2.05s/it] 32%|███▏      | 637/1965 [23:55<43:01,  1.94s/it] 32%|███▏      | 638/1965 [23:57<44:38,  2.02s/it] 33%|███▎      | 639/1965 [24:00<45:57,  2.08s/it] 33%|███▎      | 640/1965 [24:02<45:15,  2.05s/it]                                                   33%|███▎      | 640/1965 [24:02<45:15,  2.05s/it] 33%|███▎      | 641/1965 [24:04<44:55,  2.04s/it] 33%|███▎      | 642/1965 [24:06<45:38,  2.07s/it] 33%|███▎      | 643/1965 [24:08<47:22,  2.15s/it] 33%|███▎      | 644/1965 [24:10<47:06,  2.14s/it] 33%|███▎      | 645/1965 [24:12<45:17,  2.06s/it] 33%|███▎      | 646/1965 [24:14<46:25,  2.11s/it] 33%|███▎      | 647/1965 [24:16<45:21,  2.07s/it] 33%|███▎      | 648/1965 [24:18<43:29,  1.98s/it] 33%|███▎      | 649/1965 [24:20<44:40,  2.04s/it] 33%|███▎      | 650/1965 [24:22<45:14,  2.06s/it]                                                   33%|███▎      | 650/1965 [24:22<45:14,  2.06s/it] 33%|███▎      | 651/1965 [24:24<43:46,  2.00s/it] 33%|███▎      | 652/1965 [24:26<42:56,  1.96s/it] 33%|███▎      | 653/1965 [24:28<42:37,  1.95s/it] 33%|███▎      | 654/1965 [24:30<44:25,  2.03s/it] 33%|███▎      | 655/1965 [24:32<43:41,  2.00s/it] 33%|███▎      | 656/1965 [24:34<44:24,  2.04s/it] 33%|███▎      | 657/1965 [24:36<43:43,  2.01s/it] 33%|███▎      | 658/1965 [24:38<42:20,  1.94s/it] 34%|███▎      | 659/1965 [24:40<43:37,  2.00s/it] 34%|███▎      | 660/1965 [24:42<44:07,  2.03s/it]                                                   34%|███▎      | 660/1965 [24:42<44:07,  2.03s/it] 34%|███▎      | 661/1965 [24:45<46:28,  2.14s/it] 34%|███▎      | 662/1965 [24:47<44:57,  2.07s/it] 34%|███▎      | 663/1965 [24:48<42:42,  1.97s/it] 34%|███▍      | 664/1965 [24:50<42:09,  1.94s/it] 34%|███▍      | 665/1965 [24:52<42:02,  1.94s/it] 34%|███▍      | 666/1965 [24:54<43:14,  2.00s/it] 34%|███▍      | 667/1965 [24:56<42:18,  1.96s/it] 34%|███▍      | 668/1965 [24:58<43:34,  2.02s/it] 34%|███▍      | 669/1965 [25:00<42:28,  1.97s/it] 34%|███▍      | 670/1965 [25:02<43:08,  2.00s/it]                                                   34%|███▍      | 670/1965 [25:02<43:08,  2.00s/it] 34%|███▍      | 671/1965 [25:04<42:29,  1.97s/it] 34%|███▍      | 672/1965 [25:06<41:04,  1.91s/it] 34%|███▍      | 673/1965 [25:08<43:14,  2.01s/it] 34%|███▍      | 674/1965 [25:10<41:44,  1.94s/it] 34%|███▍      | 675/1965 [25:12<40:55,  1.90s/it] 34%|███▍      | 676/1965 [25:14<42:36,  1.98s/it] 34%|███▍      | 677/1965 [25:16<41:12,  1.92s/it] 35%|███▍      | 678/1965 [25:18<42:10,  1.97s/it] 35%|███▍      | 679/1965 [25:20<42:14,  1.97s/it] 35%|███▍      | 680/1965 [25:22<43:40,  2.04s/it]                                                   35%|███▍      | 680/1965 [25:22<43:40,  2.04s/it] 35%|███▍      | 681/1965 [25:25<46:53,  2.19s/it] 35%|███▍      | 682/1965 [25:26<44:30,  2.08s/it] 35%|███▍      | 683/1965 [25:28<42:29,  1.99s/it] 35%|███▍      | 684/1965 [25:30<41:10,  1.93s/it] 35%|███▍      | 685/1965 [25:32<41:11,  1.93s/it] 35%|███▍      | 686/1965 [25:34<42:21,  1.99s/it] 35%|███▍      | 687/1965 [25:36<42:05,  1.98s/it] 35%|███▌      | 688/1965 [25:38<42:51,  2.01s/it] 35%|███▌      | 689/1965 [25:40<41:19,  1.94s/it] 35%|███▌      | 690/1965 [25:42<40:45,  1.92s/it]                                                   35%|███▌      | 690/1965 [25:42<40:45,  1.92s/it] 35%|███▌      | 691/1965 [25:44<40:41,  1.92s/it] 35%|███▌      | 692/1965 [25:46<42:45,  2.02s/it] 35%|███▌      | 693/1965 [25:48<41:47,  1.97s/it] 35%|███▌      | 694/1965 [25:50<41:21,  1.95s/it] 35%|███▌      | 695/1965 [25:51<39:37,  1.87s/it] 35%|███▌      | 696/1965 [25:53<40:52,  1.93s/it] 35%|███▌      | 697/1965 [25:56<44:59,  2.13s/it] 36%|███▌      | 698/1965 [25:58<44:00,  2.08s/it] 36%|███▌      | 699/1965 [26:00<43:19,  2.05s/it] 36%|███▌      | 700/1965 [26:02<42:59,  2.04s/it]                                                   36%|███▌      | 700/1965 [26:02<42:59,  2.04s/it][INFO|trainer.py:4021] 2024-11-05 05:45:58,969 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:45:58,969 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:45:58,969 >>   Batch size = 2
{'eval_loss': 0.3953292965888977, 'eval_runtime': 24.0001, 'eval_samples_per_second': 29.167, 'eval_steps_per_second': 14.583, 'epoch': 1.52}
{'loss': 0.386, 'grad_norm': 1.4943420886993408, 'learning_rate': 4.792121696038298e-05, 'epoch': 1.55}
{'loss': 0.3716, 'grad_norm': 2.999788999557495, 'learning_rate': 4.7590736834893674e-05, 'epoch': 1.57}
{'loss': 0.4017, 'grad_norm': 1.1502386331558228, 'learning_rate': 4.725391334498602e-05, 'epoch': 1.6}
{'loss': 0.3692, 'grad_norm': 1.2002062797546387, 'learning_rate': 4.691085283788653e-05, 'epoch': 1.63}
{'loss': 0.3496, 'grad_norm': 2.183641195297241, 'learning_rate': 4.65616636300712e-05, 'epoch': 1.65}
{'loss': 0.4164, 'grad_norm': 1.6013665199279785, 'learning_rate': 4.6206455973066126e-05, 'epoch': 1.68}
{'loss': 0.3936, 'grad_norm': 1.4916309118270874, 'learning_rate': 4.5845342018637105e-05, 'epoch': 1.7}
{'loss': 0.3679, 'grad_norm': 0.90714430809021, 'learning_rate': 4.547843578337937e-05, 'epoch': 1.73}
{'loss': 0.3779, 'grad_norm': 1.7167164087295532, 'learning_rate': 4.5105853112718424e-05, 'epoch': 1.75}
{'loss': 0.3777, 'grad_norm': 1.3261806964874268, 'learning_rate': 4.472771164433355e-05, 'epoch': 1.78}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.48it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.43it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.48it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.40it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.27it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.09it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.19it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.81it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.95it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.98it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.48it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.51it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.58it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.27it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.95it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.40it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.29it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.54it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.52it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.17it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.30it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.06it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.76it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.30it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.53it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.46it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.65it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.19it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.81it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.78it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.43it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.33it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.93it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.40it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.20it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.16it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.21it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.78it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.67it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.95it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.45it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.40it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.43it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.49it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.48it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.83it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.24it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.38it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.57it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.65it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.64it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.45it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.58it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.86it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.08it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.35it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.30it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.65it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.47it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.18it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.83it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.51it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.06it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.43it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.58it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.82it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.68it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.02it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.67it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.56it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.22it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.95it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.95it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.15it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.83it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.03it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.03it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.26it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.89it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.53it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.22it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.02it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.75it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.41it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.66it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.50it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.38it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.53it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.46it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.41it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.43it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.02it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.11it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.90it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.81it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.10it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.14it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.62it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.18it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 36%|███▌      | 700/1965 [26:26<42:59,  2.04s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:46:22,992 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-700
[INFO|configuration_utils.py:673] 2024-11-05 05:46:23,012 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:46:23,013 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:46:23,116 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:46:23,116 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-700/special_tokens_map.json
 36%|███▌      | 701/1965 [26:28<3:17:02,  9.35s/it] 36%|███▌      | 702/1965 [26:31<2:31:57,  7.22s/it] 36%|███▌      | 703/1965 [26:33<1:59:41,  5.69s/it] 36%|███▌      | 704/1965 [26:35<1:37:01,  4.62s/it] 36%|███▌      | 705/1965 [26:37<1:20:32,  3.84s/it] 36%|███▌      | 706/1965 [26:39<1:11:27,  3.41s/it] 36%|███▌      | 707/1965 [26:41<1:01:56,  2.95s/it] 36%|███▌      | 708/1965 [26:43<58:13,  2.78s/it]   36%|███▌      | 709/1965 [26:46<54:42,  2.61s/it] 36%|███▌      | 710/1965 [26:48<50:30,  2.41s/it]                                                   36%|███▌      | 710/1965 [26:48<50:30,  2.41s/it] 36%|███▌      | 711/1965 [26:50<48:06,  2.30s/it] 36%|███▌      | 712/1965 [26:52<46:33,  2.23s/it] 36%|███▋      | 713/1965 [26:54<46:15,  2.22s/it] 36%|███▋      | 714/1965 [26:56<44:37,  2.14s/it] 36%|███▋      | 715/1965 [26:58<44:32,  2.14s/it] 36%|███▋      | 716/1965 [27:00<44:27,  2.14s/it] 36%|███▋      | 717/1965 [27:02<42:42,  2.05s/it] 37%|███▋      | 718/1965 [27:04<41:21,  1.99s/it] 37%|███▋      | 719/1965 [27:06<41:01,  1.98s/it] 37%|███▋      | 720/1965 [27:08<43:48,  2.11s/it]                                                   37%|███▋      | 720/1965 [27:08<43:48,  2.11s/it] 37%|███▋      | 721/1965 [27:10<42:29,  2.05s/it] 37%|███▋      | 722/1965 [27:12<42:25,  2.05s/it] 37%|███▋      | 723/1965 [27:14<41:28,  2.00s/it] 37%|███▋      | 724/1965 [27:16<42:35,  2.06s/it] 37%|███▋      | 725/1965 [27:18<43:25,  2.10s/it] 37%|███▋      | 726/1965 [27:20<42:44,  2.07s/it] 37%|███▋      | 727/1965 [27:22<41:18,  2.00s/it] 37%|███▋      | 728/1965 [27:24<42:07,  2.04s/it] 37%|███▋      | 729/1965 [27:27<43:20,  2.10s/it] 37%|███▋      | 730/1965 [27:29<44:44,  2.17s/it]                                                   37%|███▋      | 730/1965 [27:29<44:44,  2.17s/it] 37%|███▋      | 731/1965 [27:31<45:29,  2.21s/it] 37%|███▋      | 732/1965 [27:33<44:06,  2.15s/it] 37%|███▋      | 733/1965 [27:35<41:59,  2.05s/it] 37%|███▋      | 734/1965 [27:37<42:52,  2.09s/it] 37%|███▋      | 735/1965 [27:39<41:27,  2.02s/it] 37%|███▋      | 736/1965 [27:41<41:44,  2.04s/it] 38%|███▊      | 737/1965 [27:43<40:33,  1.98s/it] 38%|███▊      | 738/1965 [27:45<41:45,  2.04s/it] 38%|███▊      | 739/1965 [27:47<42:14,  2.07s/it] 38%|███▊      | 740/1965 [27:49<40:56,  2.01s/it]                                                   38%|███▊      | 740/1965 [27:49<40:56,  2.01s/it] 38%|███▊      | 741/1965 [27:51<40:08,  1.97s/it] 38%|███▊      | 742/1965 [27:53<42:21,  2.08s/it] 38%|███▊      | 743/1965 [27:56<43:03,  2.11s/it] 38%|███▊      | 744/1965 [27:58<42:26,  2.09s/it] 38%|███▊      | 745/1965 [28:00<41:57,  2.06s/it] 38%|███▊      | 746/1965 [28:02<41:43,  2.05s/it] 38%|███▊      | 747/1965 [28:04<40:40,  2.00s/it] 38%|███▊      | 748/1965 [28:06<42:17,  2.09s/it] 38%|███▊      | 749/1965 [28:08<42:50,  2.11s/it] 38%|███▊      | 750/1965 [28:10<43:18,  2.14s/it]                                                   38%|███▊      | 750/1965 [28:10<43:18,  2.14s/it] 38%|███▊      | 751/1965 [28:12<42:45,  2.11s/it] 38%|███▊      | 752/1965 [28:14<42:22,  2.10s/it] 38%|███▊      | 753/1965 [28:16<41:32,  2.06s/it] 38%|███▊      | 754/1965 [28:19<42:47,  2.12s/it] 38%|███▊      | 755/1965 [28:21<42:17,  2.10s/it] 38%|███▊      | 756/1965 [28:22<40:23,  2.00s/it] 39%|███▊      | 757/1965 [28:25<41:10,  2.05s/it] 39%|███▊      | 758/1965 [28:27<40:48,  2.03s/it] 39%|███▊      | 759/1965 [28:28<39:36,  1.97s/it] 39%|███▊      | 760/1965 [28:30<39:03,  1.94s/it]                                                   39%|███▊      | 760/1965 [28:30<39:03,  1.94s/it] 39%|███▊      | 761/1965 [28:33<41:12,  2.05s/it] 39%|███▉      | 762/1965 [28:34<40:04,  2.00s/it] 39%|███▉      | 763/1965 [28:36<38:28,  1.92s/it] 39%|███▉      | 764/1965 [28:38<39:45,  1.99s/it] 39%|███▉      | 765/1965 [28:40<38:34,  1.93s/it] 39%|███▉      | 766/1965 [28:42<37:53,  1.90s/it] 39%|███▉      | 767/1965 [28:44<37:36,  1.88s/it] 39%|███▉      | 768/1965 [28:46<40:29,  2.03s/it] 39%|███▉      | 769/1965 [28:48<38:43,  1.94s/it] 39%|███▉      | 770/1965 [28:50<40:45,  2.05s/it]                                                   39%|███▉      | 770/1965 [28:50<40:45,  2.05s/it] 39%|███▉      | 771/1965 [28:52<40:27,  2.03s/it] 39%|███▉      | 772/1965 [28:54<41:02,  2.06s/it] 39%|███▉      | 773/1965 [28:57<41:55,  2.11s/it] 39%|███▉      | 774/1965 [28:59<41:02,  2.07s/it] 39%|███▉      | 775/1965 [29:00<39:58,  2.02s/it] 39%|███▉      | 776/1965 [29:02<39:06,  1.97s/it] 40%|███▉      | 777/1965 [29:04<40:10,  2.03s/it] 40%|███▉      | 778/1965 [29:06<38:57,  1.97s/it] 40%|███▉      | 779/1965 [29:08<39:38,  2.01s/it] 40%|███▉      | 780/1965 [29:10<39:38,  2.01s/it]                                                   40%|███▉      | 780/1965 [29:10<39:38,  2.01s/it] 40%|███▉      | 781/1965 [29:12<38:14,  1.94s/it] 40%|███▉      | 782/1965 [29:14<37:56,  1.92s/it] 40%|███▉      | 783/1965 [29:16<39:53,  2.02s/it] 40%|███▉      | 784/1965 [29:18<39:41,  2.02s/it] 40%|███▉      | 785/1965 [29:20<38:43,  1.97s/it] 40%|████      | 786/1965 [29:22<39:02,  1.99s/it] 40%|████      | 787/1965 [29:24<38:04,  1.94s/it] 40%|████      | 788/1965 [29:26<36:35,  1.87s/it] 40%|████      | 789/1965 [29:28<37:38,  1.92s/it] 40%|████      | 790/1965 [29:30<37:24,  1.91s/it]                                                   40%|████      | 790/1965 [29:30<37:24,  1.91s/it] 40%|████      | 791/1965 [29:32<38:03,  1.94s/it] 40%|████      | 792/1965 [29:34<37:58,  1.94s/it] 40%|████      | 793/1965 [29:36<40:24,  2.07s/it] 40%|████      | 794/1965 [29:38<41:11,  2.11s/it] 40%|████      | 795/1965 [29:41<42:11,  2.16s/it] 41%|████      | 796/1965 [29:42<40:45,  2.09s/it] 41%|████      | 797/1965 [29:44<40:19,  2.07s/it] 41%|████      | 798/1965 [29:46<39:59,  2.06s/it] 41%|████      | 799/1965 [29:48<39:38,  2.04s/it] 41%|████      | 800/1965 [29:50<38:26,  1.98s/it]                                                   41%|████      | 800/1965 [29:50<38:26,  1.98s/it][INFO|trainer.py:4021] 2024-11-05 05:49:47,416 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:49:47,416 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:49:47,416 >>   Batch size = 2
{'eval_loss': 0.38327711820602417, 'eval_runtime': 24.0227, 'eval_samples_per_second': 29.139, 'eval_steps_per_second': 14.57, 'epoch': 1.78}
{'loss': 0.393, 'grad_norm': 1.915734887123108, 'learning_rate': 4.4344130771015335e-05, 'epoch': 1.8}
{'loss': 0.3557, 'grad_norm': 1.3492438793182373, 'learning_rate': 4.39552316029691e-05, 'epoch': 1.83}
{'loss': 0.3967, 'grad_norm': 1.6628841161727905, 'learning_rate': 4.356113692957611e-05, 'epoch': 1.85}
{'loss': 0.3617, 'grad_norm': 1.6884427070617676, 'learning_rate': 4.3161971180624536e-05, 'epoch': 1.88}
{'loss': 0.3731, 'grad_norm': 0.9550858736038208, 'learning_rate': 4.2757860387022544e-05, 'epoch': 1.9}
{'loss': 0.3685, 'grad_norm': 0.8748341202735901, 'learning_rate': 4.23489321410058e-05, 'epoch': 1.93}
{'loss': 0.4066, 'grad_norm': 2.022411346435547, 'learning_rate': 4.193531555585208e-05, 'epoch': 1.96}
{'loss': 0.3785, 'grad_norm': 1.1981770992279053, 'learning_rate': 4.1517141225115555e-05, 'epoch': 1.98}
{'loss': 0.3564, 'grad_norm': 1.2623072862625122, 'learning_rate': 4.109454118139372e-05, 'epoch': 2.01}
{'loss': 0.3604, 'grad_norm': 1.8731006383895874, 'learning_rate': 4.0667648854640036e-05, 'epoch': 2.03}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.43it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.39it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.26it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.85it/s][A
  3%|▎         | 12/350 [00:00<00:22, 15.33it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.21it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.03it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.77it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.16it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.80it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.92it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.98it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.48it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.50it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.58it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.28it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.96it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.27it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.56it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.77it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.52it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.17it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.30it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.05it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.76it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.68it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.31it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.54it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.47it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.77it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.19it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.09it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.75it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.89it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.42it/s][A
 30%|██▉       | 104/350 [00:07<00:18, 13.33it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.94it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.40it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.51it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.20it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.92it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.46it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.16it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.15it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.21it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.77it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s][A
 38%|███▊      | 133/350 [00:09<00:13, 16.65it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.42it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.93it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.49it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.41it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.38it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.46it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.46it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.35it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.62it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.07it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.95it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.28it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.42it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.22it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.36it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.19it/s][A
 50%|█████     | 175/350 [00:12<00:11, 14.61it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.40it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.62it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.36it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.43it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.88it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.41it/s][A
 54%|█████▍    | 190/350 [00:13<00:09, 16.05it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.08it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.55it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.83it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.03it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.31it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.25it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.61it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.42it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.14it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.81it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.04it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.41it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.55it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.80it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.61it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.23it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.66it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.56it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.12it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.13it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.97it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.89it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.10it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.05it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.53it/s][A
 74%|███████▍  | 260/350 [00:18<00:07, 12.86it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.27it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.92it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.92it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.99it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.00it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.25it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.19it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.92it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.55it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.24it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.63it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.47it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.36it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.44it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.39it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.40it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.06it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.85it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.79it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.08it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.35it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.59it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 41%|████      | 800/1965 [30:14<38:26,  1.98s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:50:11,465 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-800
[INFO|configuration_utils.py:673] 2024-11-05 05:50:11,485 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:50:11,486 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:50:11,594 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:50:11,594 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-800/special_tokens_map.json
 41%|████      | 801/1965 [30:17<3:01:07,  9.34s/it] 41%|████      | 802/1965 [30:19<2:18:31,  7.15s/it] 41%|████      | 803/1965 [30:21<1:48:03,  5.58s/it] 41%|████      | 804/1965 [30:23<1:25:57,  4.44s/it] 41%|████      | 805/1965 [30:25<1:12:12,  3.74s/it] 41%|████      | 806/1965 [30:27<1:01:54,  3.20s/it] 41%|████      | 807/1965 [30:29<54:29,  2.82s/it]   41%|████      | 808/1965 [30:31<49:26,  2.56s/it] 41%|████      | 809/1965 [30:33<49:13,  2.56s/it] 41%|████      | 810/1965 [30:35<48:23,  2.51s/it]                                                   41%|████      | 810/1965 [30:35<48:23,  2.51s/it] 41%|████▏     | 811/1965 [30:37<44:13,  2.30s/it] 41%|████▏     | 812/1965 [30:39<42:55,  2.23s/it] 41%|████▏     | 813/1965 [30:41<40:58,  2.13s/it] 41%|████▏     | 814/1965 [30:43<38:57,  2.03s/it] 41%|████▏     | 815/1965 [30:45<39:09,  2.04s/it] 42%|████▏     | 816/1965 [30:47<38:29,  2.01s/it] 42%|████▏     | 817/1965 [30:49<38:11,  2.00s/it] 42%|████▏     | 818/1965 [30:51<36:50,  1.93s/it] 42%|████▏     | 819/1965 [30:53<37:29,  1.96s/it] 42%|████▏     | 820/1965 [30:55<37:14,  1.95s/it]                                                   42%|████▏     | 820/1965 [30:55<37:14,  1.95s/it] 42%|████▏     | 821/1965 [30:57<36:41,  1.92s/it] 42%|████▏     | 822/1965 [30:59<38:23,  2.02s/it] 42%|████▏     | 823/1965 [31:01<39:54,  2.10s/it] 42%|████▏     | 824/1965 [31:03<39:28,  2.08s/it] 42%|████▏     | 825/1965 [31:05<37:41,  1.98s/it] 42%|████▏     | 826/1965 [31:07<38:01,  2.00s/it] 42%|████▏     | 827/1965 [31:09<37:43,  1.99s/it] 42%|████▏     | 828/1965 [31:11<39:45,  2.10s/it] 42%|████▏     | 829/1965 [31:13<38:53,  2.05s/it] 42%|████▏     | 830/1965 [31:15<37:12,  1.97s/it]                                                   42%|████▏     | 830/1965 [31:15<37:12,  1.97s/it] 42%|████▏     | 831/1965 [31:17<38:16,  2.03s/it] 42%|████▏     | 832/1965 [31:19<38:33,  2.04s/it] 42%|████▏     | 833/1965 [31:21<38:26,  2.04s/it] 42%|████▏     | 834/1965 [31:23<37:39,  2.00s/it] 42%|████▏     | 835/1965 [31:25<36:35,  1.94s/it] 43%|████▎     | 836/1965 [31:27<38:41,  2.06s/it] 43%|████▎     | 837/1965 [31:29<37:06,  1.97s/it] 43%|████▎     | 838/1965 [31:31<35:39,  1.90s/it] 43%|████▎     | 839/1965 [31:33<37:14,  1.98s/it] 43%|████▎     | 840/1965 [31:35<38:41,  2.06s/it]                                                   43%|████▎     | 840/1965 [31:35<38:41,  2.06s/it] 43%|████▎     | 841/1965 [31:37<39:22,  2.10s/it] 43%|████▎     | 842/1965 [31:40<39:12,  2.09s/it] 43%|████▎     | 843/1965 [31:41<37:38,  2.01s/it] 43%|████▎     | 844/1965 [31:43<36:57,  1.98s/it] 43%|████▎     | 845/1965 [31:45<36:58,  1.98s/it] 43%|████▎     | 846/1965 [31:47<36:30,  1.96s/it] 43%|████▎     | 847/1965 [31:49<36:45,  1.97s/it] 43%|████▎     | 848/1965 [31:51<36:53,  1.98s/it] 43%|████▎     | 849/1965 [31:53<35:48,  1.93s/it] 43%|████▎     | 850/1965 [31:55<35:45,  1.92s/it]                                                   43%|████▎     | 850/1965 [31:55<35:45,  1.92s/it] 43%|████▎     | 851/1965 [31:57<37:37,  2.03s/it] 43%|████▎     | 852/1965 [31:59<37:28,  2.02s/it] 43%|████▎     | 853/1965 [32:01<36:59,  2.00s/it] 43%|████▎     | 854/1965 [32:03<37:13,  2.01s/it] 44%|████▎     | 855/1965 [32:05<37:11,  2.01s/it] 44%|████▎     | 856/1965 [32:07<36:18,  1.96s/it] 44%|████▎     | 857/1965 [32:09<37:20,  2.02s/it] 44%|████▎     | 858/1965 [32:11<37:59,  2.06s/it] 44%|████▎     | 859/1965 [32:13<37:28,  2.03s/it] 44%|████▍     | 860/1965 [32:15<37:32,  2.04s/it]                                                   44%|████▍     | 860/1965 [32:15<37:32,  2.04s/it] 44%|████▍     | 861/1965 [32:17<37:26,  2.03s/it] 44%|████▍     | 862/1965 [32:19<36:32,  1.99s/it] 44%|████▍     | 863/1965 [32:22<38:44,  2.11s/it] 44%|████▍     | 864/1965 [32:24<38:42,  2.11s/it] 44%|████▍     | 865/1965 [32:26<38:50,  2.12s/it] 44%|████▍     | 866/1965 [32:28<38:29,  2.10s/it] 44%|████▍     | 867/1965 [32:30<37:48,  2.07s/it] 44%|████▍     | 868/1965 [32:32<37:22,  2.04s/it] 44%|████▍     | 869/1965 [32:34<36:43,  2.01s/it] 44%|████▍     | 870/1965 [32:36<35:38,  1.95s/it]                                                   44%|████▍     | 870/1965 [32:36<35:38,  1.95s/it] 44%|████▍     | 871/1965 [32:37<34:30,  1.89s/it] 44%|████▍     | 872/1965 [32:39<35:39,  1.96s/it] 44%|████▍     | 873/1965 [32:41<35:46,  1.97s/it] 44%|████▍     | 874/1965 [32:43<34:42,  1.91s/it] 45%|████▍     | 875/1965 [32:45<34:10,  1.88s/it] 45%|████▍     | 876/1965 [32:47<33:25,  1.84s/it] 45%|████▍     | 877/1965 [32:49<32:55,  1.82s/it] 45%|████▍     | 878/1965 [32:51<34:42,  1.92s/it] 45%|████▍     | 879/1965 [32:53<34:47,  1.92s/it] 45%|████▍     | 880/1965 [32:55<35:29,  1.96s/it]                                                   45%|████▍     | 880/1965 [32:55<35:29,  1.96s/it] 45%|████▍     | 881/1965 [32:57<35:15,  1.95s/it] 45%|████▍     | 882/1965 [32:59<37:11,  2.06s/it] 45%|████▍     | 883/1965 [33:01<36:21,  2.02s/it] 45%|████▍     | 884/1965 [33:03<35:04,  1.95s/it] 45%|████▌     | 885/1965 [33:04<34:27,  1.91s/it] 45%|████▌     | 886/1965 [33:07<35:22,  1.97s/it] 45%|████▌     | 887/1965 [33:09<36:08,  2.01s/it] 45%|████▌     | 888/1965 [33:11<35:20,  1.97s/it] 45%|████▌     | 889/1965 [33:13<36:07,  2.01s/it] 45%|████▌     | 890/1965 [33:15<36:59,  2.07s/it]                                                   45%|████▌     | 890/1965 [33:15<36:59,  2.07s/it] 45%|████▌     | 891/1965 [33:17<38:34,  2.16s/it] 45%|████▌     | 892/1965 [33:19<37:41,  2.11s/it] 45%|████▌     | 893/1965 [33:21<37:32,  2.10s/it] 45%|████▌     | 894/1965 [33:23<36:49,  2.06s/it] 46%|████▌     | 895/1965 [33:26<37:58,  2.13s/it] 46%|████▌     | 896/1965 [33:27<35:45,  2.01s/it] 46%|████▌     | 897/1965 [33:30<37:30,  2.11s/it] 46%|████▌     | 898/1965 [33:32<39:24,  2.22s/it] 46%|████▌     | 899/1965 [33:34<38:54,  2.19s/it] 46%|████▌     | 900/1965 [33:36<37:38,  2.12s/it]                                                   46%|████▌     | 900/1965 [33:36<37:38,  2.12s/it][INFO|trainer.py:4021] 2024-11-05 05:53:33,286 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:53:33,286 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:53:33,286 >>   Batch size = 2
{'eval_loss': 0.37489479780197144, 'eval_runtime': 24.0482, 'eval_samples_per_second': 29.108, 'eval_steps_per_second': 14.554, 'epoch': 2.03}
{'loss': 0.3517, 'grad_norm': 1.4752165079116821, 'learning_rate': 4.0236599030035264e-05, 'epoch': 2.06}
{'loss': 0.3265, 'grad_norm': 1.60627281665802, 'learning_rate': 3.980152780543098e-05, 'epoch': 2.08}
{'loss': 0.3395, 'grad_norm': 0.9563857316970825, 'learning_rate': 3.936257254837863e-05, 'epoch': 2.11}
{'loss': 0.3107, 'grad_norm': 1.6812896728515625, 'learning_rate': 3.891987185275766e-05, 'epoch': 2.13}
{'loss': 0.3316, 'grad_norm': 2.50685453414917, 'learning_rate': 3.847356549501645e-05, 'epoch': 2.16}
{'loss': 0.3566, 'grad_norm': 1.5167691707611084, 'learning_rate': 3.8023794390039973e-05, 'epoch': 2.18}
{'loss': 0.3581, 'grad_norm': 0.9873818755149841, 'learning_rate': 3.75707005466578e-05, 'epoch': 2.21}
{'loss': 0.3069, 'grad_norm': 0.9045695066452026, 'learning_rate': 3.7114427022806944e-05, 'epoch': 2.23}
{'loss': 0.3166, 'grad_norm': 1.722723126411438, 'learning_rate': 3.665511788036327e-05, 'epoch': 2.26}
{'loss': 0.3266, 'grad_norm': 2.8688414096832275, 'learning_rate': 3.6192918139656054e-05, 'epoch': 2.29}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.46it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.48it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.52it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.93it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.97it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.48it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.77it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.30it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.05it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.77it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.68it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.60it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.30it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.29it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.53it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.45it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.64it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.70it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.92it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.14it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.76it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.21it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.10it/s][A
 28%|██▊       | 98/350 [00:06<00:16, 15.74it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.88it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.41it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.34it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.95it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.41it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.20it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.91it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.45it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.14it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.41it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.37it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.12it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.18it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.75it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.93it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.94it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.41it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.37it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.31it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.82it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.24it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.38it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.19it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.63it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.41it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.61it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.31it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.40it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.85it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.40it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.04it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.83it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.34it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.29it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.65it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.45it/s][A
 61%|██████    | 213/350 [00:14<00:08, 17.10it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.78it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.47it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.03it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.41it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.81it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.62it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.15it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.15it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.01it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.12it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.93it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.12it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.82it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 18.01it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.03it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.26it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.25it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.99it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.84it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.66it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.53it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.46it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.01it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.87it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.35it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.86it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                  
                                                 [A 46%|████▌     | 900/1965 [34:00<37:38,  2.12s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:53:57,320 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-900
[INFO|configuration_utils.py:673] 2024-11-05 05:53:57,340 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:53:57,341 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:53:57,441 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:53:57,442 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-900/special_tokens_map.json
 46%|████▌     | 901/1965 [34:03<2:48:48,  9.52s/it] 46%|████▌     | 902/1965 [34:05<2:08:35,  7.26s/it] 46%|████▌     | 903/1965 [34:07<1:42:18,  5.78s/it] 46%|████▌     | 904/1965 [34:09<1:22:52,  4.69s/it] 46%|████▌     | 905/1965 [34:11<1:08:35,  3.88s/it] 46%|████▌     | 906/1965 [34:13<57:41,  3.27s/it]   46%|████▌     | 907/1965 [34:15<51:05,  2.90s/it] 46%|████▌     | 908/1965 [34:17<45:27,  2.58s/it] 46%|████▋     | 909/1965 [34:19<41:15,  2.34s/it] 46%|████▋     | 910/1965 [34:21<39:11,  2.23s/it]                                                   46%|████▋     | 910/1965 [34:21<39:11,  2.23s/it] 46%|████▋     | 911/1965 [34:23<37:20,  2.13s/it] 46%|████▋     | 912/1965 [34:25<36:06,  2.06s/it] 46%|████▋     | 913/1965 [34:27<36:45,  2.10s/it] 47%|████▋     | 914/1965 [34:29<36:20,  2.08s/it] 47%|████▋     | 915/1965 [34:31<36:29,  2.09s/it] 47%|████▋     | 916/1965 [34:33<35:00,  2.00s/it] 47%|████▋     | 917/1965 [34:35<34:28,  1.97s/it] 47%|████▋     | 918/1965 [34:37<34:24,  1.97s/it] 47%|████▋     | 919/1965 [34:39<34:56,  2.00s/it] 47%|████▋     | 920/1965 [34:41<35:45,  2.05s/it]                                                   47%|████▋     | 920/1965 [34:41<35:45,  2.05s/it] 47%|████▋     | 921/1965 [34:43<36:37,  2.11s/it] 47%|████▋     | 922/1965 [34:45<34:45,  2.00s/it] 47%|████▋     | 923/1965 [34:47<35:05,  2.02s/it] 47%|████▋     | 924/1965 [34:49<34:51,  2.01s/it] 47%|████▋     | 925/1965 [34:51<33:36,  1.94s/it] 47%|████▋     | 926/1965 [34:53<34:00,  1.96s/it] 47%|████▋     | 927/1965 [34:55<33:02,  1.91s/it] 47%|████▋     | 928/1965 [34:57<34:31,  2.00s/it] 47%|████▋     | 929/1965 [34:59<34:01,  1.97s/it] 47%|████▋     | 930/1965 [35:01<34:55,  2.02s/it]                                                   47%|████▋     | 930/1965 [35:01<34:55,  2.02s/it] 47%|████▋     | 931/1965 [35:03<34:56,  2.03s/it] 47%|████▋     | 932/1965 [35:05<36:44,  2.13s/it] 47%|████▋     | 933/1965 [35:08<37:27,  2.18s/it] 48%|████▊     | 934/1965 [35:10<37:31,  2.18s/it] 48%|████▊     | 935/1965 [35:12<40:01,  2.33s/it] 48%|████▊     | 936/1965 [35:15<39:29,  2.30s/it] 48%|████▊     | 937/1965 [35:17<41:06,  2.40s/it] 48%|████▊     | 938/1965 [35:19<39:31,  2.31s/it] 48%|████▊     | 939/1965 [35:21<37:59,  2.22s/it] 48%|████▊     | 940/1965 [35:23<36:12,  2.12s/it]                                                   48%|████▊     | 940/1965 [35:23<36:12,  2.12s/it] 48%|████▊     | 941/1965 [35:25<35:42,  2.09s/it] 48%|████▊     | 942/1965 [35:27<34:41,  2.04s/it] 48%|████▊     | 943/1965 [35:29<34:25,  2.02s/it] 48%|████▊     | 944/1965 [35:31<33:00,  1.94s/it] 48%|████▊     | 945/1965 [35:33<32:15,  1.90s/it] 48%|████▊     | 946/1965 [35:34<31:41,  1.87s/it] 48%|████▊     | 947/1965 [35:36<32:09,  1.89s/it] 48%|████▊     | 948/1965 [35:39<34:30,  2.04s/it] 48%|████▊     | 949/1965 [35:41<34:15,  2.02s/it] 48%|████▊     | 950/1965 [35:43<33:05,  1.96s/it]                                                   48%|████▊     | 950/1965 [35:43<33:05,  1.96s/it] 48%|████▊     | 951/1965 [35:44<32:08,  1.90s/it] 48%|████▊     | 952/1965 [35:46<32:48,  1.94s/it] 48%|████▊     | 953/1965 [35:48<33:25,  1.98s/it] 49%|████▊     | 954/1965 [35:50<33:16,  1.97s/it] 49%|████▊     | 955/1965 [35:53<34:07,  2.03s/it] 49%|████▊     | 956/1965 [35:55<34:14,  2.04s/it] 49%|████▊     | 957/1965 [35:56<32:57,  1.96s/it] 49%|████▉     | 958/1965 [35:59<34:17,  2.04s/it] 49%|████▉     | 959/1965 [36:01<33:18,  1.99s/it] 49%|████▉     | 960/1965 [36:03<33:34,  2.00s/it]                                                   49%|████▉     | 960/1965 [36:03<33:34,  2.00s/it] 49%|████▉     | 961/1965 [36:05<35:08,  2.10s/it] 49%|████▉     | 962/1965 [36:07<36:08,  2.16s/it] 49%|████▉     | 963/1965 [36:09<34:54,  2.09s/it] 49%|████▉     | 964/1965 [36:11<34:49,  2.09s/it] 49%|████▉     | 965/1965 [36:13<34:10,  2.05s/it] 49%|████▉     | 966/1965 [36:16<35:51,  2.15s/it] 49%|████▉     | 967/1965 [36:18<35:22,  2.13s/it] 49%|████▉     | 968/1965 [36:20<35:30,  2.14s/it] 49%|████▉     | 969/1965 [36:22<35:19,  2.13s/it] 49%|████▉     | 970/1965 [36:24<35:07,  2.12s/it]                                                   49%|████▉     | 970/1965 [36:24<35:07,  2.12s/it] 49%|████▉     | 971/1965 [36:27<37:28,  2.26s/it] 49%|████▉     | 972/1965 [36:29<36:24,  2.20s/it] 50%|████▉     | 973/1965 [36:31<34:57,  2.11s/it] 50%|████▉     | 974/1965 [36:32<33:31,  2.03s/it] 50%|████▉     | 975/1965 [36:34<32:08,  1.95s/it] 50%|████▉     | 976/1965 [36:36<31:51,  1.93s/it] 50%|████▉     | 977/1965 [36:38<31:12,  1.90s/it] 50%|████▉     | 978/1965 [36:40<32:07,  1.95s/it] 50%|████▉     | 979/1965 [36:42<31:34,  1.92s/it] 50%|████▉     | 980/1965 [36:44<32:05,  1.96s/it]                                                   50%|████▉     | 980/1965 [36:44<32:05,  1.96s/it] 50%|████▉     | 981/1965 [36:46<31:16,  1.91s/it] 50%|████▉     | 982/1965 [36:48<31:37,  1.93s/it] 50%|█████     | 983/1965 [36:50<32:05,  1.96s/it] 50%|█████     | 984/1965 [36:52<33:40,  2.06s/it] 50%|█████     | 985/1965 [36:54<34:05,  2.09s/it] 50%|█████     | 986/1965 [36:56<34:43,  2.13s/it] 50%|█████     | 987/1965 [36:58<34:03,  2.09s/it] 50%|█████     | 988/1965 [37:00<33:18,  2.05s/it] 50%|█████     | 989/1965 [37:02<32:42,  2.01s/it] 50%|█████     | 990/1965 [37:04<31:59,  1.97s/it]                                                   50%|█████     | 990/1965 [37:04<31:59,  1.97s/it] 50%|█████     | 991/1965 [37:06<32:26,  2.00s/it] 50%|█████     | 992/1965 [37:08<31:59,  1.97s/it] 51%|█████     | 993/1965 [37:10<33:30,  2.07s/it] 51%|█████     | 994/1965 [37:12<33:19,  2.06s/it] 51%|█████     | 995/1965 [37:14<33:23,  2.07s/it] 51%|█████     | 996/1965 [37:17<35:05,  2.17s/it] 51%|█████     | 997/1965 [37:19<33:47,  2.09s/it] 51%|█████     | 998/1965 [37:21<32:46,  2.03s/it] 51%|█████     | 999/1965 [37:23<31:57,  1.99s/it] 51%|█████     | 1000/1965 [37:24<30:56,  1.92s/it]                                                    51%|█████     | 1000/1965 [37:24<30:56,  1.92s/it][INFO|trainer.py:4021] 2024-11-05 05:57:21,417 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 05:57:21,417 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 05:57:21,417 >>   Batch size = 2
{'eval_loss': 0.36814984679222107, 'eval_runtime': 24.0334, 'eval_samples_per_second': 29.126, 'eval_steps_per_second': 14.563, 'epoch': 2.29}
{'loss': 0.3173, 'grad_norm': 1.8339238166809082, 'learning_rate': 3.572797373367987e-05, 'epoch': 2.31}
{'loss': 0.3601, 'grad_norm': 0.9750805497169495, 'learning_rate': 3.526043146201831e-05, 'epoch': 2.34}
{'loss': 0.354, 'grad_norm': 1.648240327835083, 'learning_rate': 3.4790438944494105e-05, 'epoch': 2.36}
{'loss': 0.3341, 'grad_norm': 1.4861252307891846, 'learning_rate': 3.431814457456026e-05, 'epoch': 2.39}
{'loss': 0.3243, 'grad_norm': 1.4316930770874023, 'learning_rate': 3.3843697472446966e-05, 'epoch': 2.41}
{'loss': 0.3533, 'grad_norm': 1.671022891998291, 'learning_rate': 3.3367247438078965e-05, 'epoch': 2.44}
{'loss': 0.3234, 'grad_norm': 1.816967248916626, 'learning_rate': 3.2888944903778364e-05, 'epoch': 2.46}
{'loss': 0.309, 'grad_norm': 2.172464370727539, 'learning_rate': 3.240894088676781e-05, 'epoch': 2.49}
{'loss': 0.3704, 'grad_norm': 1.5881624221801758, 'learning_rate': 3.1927386941488854e-05, 'epoch': 2.51}
{'loss': 0.3439, 'grad_norm': 1.3181986808776855, 'learning_rate': 3.1444435111750936e-05, 'epoch': 2.54}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.41it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.38it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.44it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.92it/s][A
  3%|▎         | 12/350 [00:00<00:22, 15.35it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.20it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.04it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.78it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.16it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.79it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.91it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.96it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.38it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.46it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.50it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.57it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.27it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.95it/s][A
 12%|█▏        | 41/350 [00:02<00:23, 13.42it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.33it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.23it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.29it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.46it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.51it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.71it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.45it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.12it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.86it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.13it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.27it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.04it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.75it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.67it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.59it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.29it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.30it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.53it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.46it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.64it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.70it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.93it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.14it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.76it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.21it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.08it/s][A
 28%|██▊       | 98/350 [00:06<00:16, 15.74it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.86it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.40it/s][A
 30%|██▉       | 104/350 [00:07<00:18, 13.33it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.94it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.40it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.51it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.19it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.91it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.45it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.15it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.41it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.36it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.11it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.16it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.72it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.90it/s][A
 38%|███▊      | 133/350 [00:09<00:13, 16.62it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.39it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.92it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.48it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.39it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.36it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.40it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.45it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.45it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.35it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.64it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.07it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.96it/s][A
 46%|████▌     | 160/350 [00:11<00:16, 11.25it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.40it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.76it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.18it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.34it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.53it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.18it/s][A
 50%|█████     | 175/350 [00:12<00:11, 14.61it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.40it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.61it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.35it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.42it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.86it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.39it/s][A
 54%|█████▍    | 190/350 [00:13<00:09, 16.02it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.81it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.83it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.05it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.32it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.25it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.59it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.40it/s][A
 61%|██████    | 213/350 [00:14<00:08, 17.11it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.79it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.46it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.01it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.38it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.53it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.78it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.63it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.34it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.00it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.58it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.84it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.22it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.67it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.57it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:17<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.99it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.91it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.11it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.07it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.54it/s][A
 74%|███████▍  | 260/350 [00:18<00:07, 12.86it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.26it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.90it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.89it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.08it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.77it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.95it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 17.97it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.22it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.20it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.90it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.90it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.53it/s][A
 83%|████████▎ | 289/350 [00:20<00:04, 15.21it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.00it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.96it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.80it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.74it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.67it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.39it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.62it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.45it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.33it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.48it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.41it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.37it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.39it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:22<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.84it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.78it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.08it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.26it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.34it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.11it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.59it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.85it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.27it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.31it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.28it/s][A                                                   
                                                 [A 51%|█████     | 1000/1965 [37:48<30:56,  1.92s/it]
100%|██████████| 350/350 [00:24<00:00, 13.28it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 05:57:45,488 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1000
[INFO|configuration_utils.py:673] 2024-11-05 05:57:45,508 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 05:57:45,509 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 05:57:45,602 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 05:57:45,603 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1000/special_tokens_map.json
 51%|█████     | 1001/1965 [37:51<2:29:55,  9.33s/it] 51%|█████     | 1002/1965 [37:53<1:55:37,  7.20s/it] 51%|█████     | 1003/1965 [37:55<1:30:13,  5.63s/it] 51%|█████     | 1004/1965 [37:57<1:12:07,  4.50s/it] 51%|█████     | 1005/1965 [37:59<59:56,  3.75s/it]   51%|█████     | 1006/1965 [38:01<52:30,  3.29s/it] 51%|█████     | 1007/1965 [38:03<45:58,  2.88s/it] 51%|█████▏    | 1008/1965 [38:05<42:41,  2.68s/it] 51%|█████▏    | 1009/1965 [38:07<39:17,  2.47s/it] 51%|█████▏    | 1010/1965 [38:09<36:32,  2.30s/it]                                                    51%|█████▏    | 1010/1965 [38:09<36:32,  2.30s/it] 51%|█████▏    | 1011/1965 [38:11<34:23,  2.16s/it] 52%|█████▏    | 1012/1965 [38:13<32:10,  2.03s/it] 52%|█████▏    | 1013/1965 [38:15<32:41,  2.06s/it] 52%|█████▏    | 1014/1965 [38:17<31:25,  1.98s/it] 52%|█████▏    | 1015/1965 [38:19<33:14,  2.10s/it] 52%|█████▏    | 1016/1965 [38:21<33:08,  2.09s/it] 52%|█████▏    | 1017/1965 [38:23<32:22,  2.05s/it] 52%|█████▏    | 1018/1965 [38:25<32:51,  2.08s/it] 52%|█████▏    | 1019/1965 [38:27<33:15,  2.11s/it] 52%|█████▏    | 1020/1965 [38:29<32:35,  2.07s/it]                                                    52%|█████▏    | 1020/1965 [38:29<32:35,  2.07s/it] 52%|█████▏    | 1021/1965 [38:31<31:53,  2.03s/it] 52%|█████▏    | 1022/1965 [38:33<30:53,  1.97s/it] 52%|█████▏    | 1023/1965 [38:35<32:02,  2.04s/it] 52%|█████▏    | 1024/1965 [38:37<31:48,  2.03s/it] 52%|█████▏    | 1025/1965 [38:39<30:56,  1.98s/it] 52%|█████▏    | 1026/1965 [38:41<31:32,  2.02s/it] 52%|█████▏    | 1027/1965 [38:44<32:24,  2.07s/it] 52%|█████▏    | 1028/1965 [38:46<33:52,  2.17s/it] 52%|█████▏    | 1029/1965 [38:48<33:04,  2.12s/it] 52%|█████▏    | 1030/1965 [38:50<33:29,  2.15s/it]                                                    52%|█████▏    | 1030/1965 [38:50<33:29,  2.15s/it] 52%|█████▏    | 1031/1965 [38:52<33:05,  2.13s/it] 53%|█████▎    | 1032/1965 [38:54<31:58,  2.06s/it] 53%|█████▎    | 1033/1965 [38:56<31:30,  2.03s/it] 53%|█████▎    | 1034/1965 [38:58<31:53,  2.06s/it] 53%|█████▎    | 1035/1965 [39:00<32:02,  2.07s/it] 53%|█████▎    | 1036/1965 [39:02<31:53,  2.06s/it] 53%|█████▎    | 1037/1965 [39:05<33:01,  2.14s/it] 53%|█████▎    | 1038/1965 [39:07<32:23,  2.10s/it] 53%|█████▎    | 1039/1965 [39:08<30:54,  2.00s/it] 53%|█████▎    | 1040/1965 [39:10<29:41,  1.93s/it]                                                    53%|█████▎    | 1040/1965 [39:10<29:41,  1.93s/it] 53%|█████▎    | 1041/1965 [39:12<31:02,  2.02s/it] 53%|█████▎    | 1042/1965 [39:14<30:50,  2.01s/it] 53%|█████▎    | 1043/1965 [39:17<32:24,  2.11s/it] 53%|█████▎    | 1044/1965 [39:19<31:07,  2.03s/it] 53%|█████▎    | 1045/1965 [39:21<30:39,  2.00s/it] 53%|█████▎    | 1046/1965 [39:23<30:57,  2.02s/it] 53%|█████▎    | 1047/1965 [39:24<30:16,  1.98s/it] 53%|█████▎    | 1048/1965 [39:27<32:57,  2.16s/it] 53%|█████▎    | 1049/1965 [39:29<31:36,  2.07s/it] 53%|█████▎    | 1050/1965 [39:31<31:16,  2.05s/it]                                                    53%|█████▎    | 1050/1965 [39:31<31:16,  2.05s/it] 53%|█████▎    | 1051/1965 [39:33<31:52,  2.09s/it] 54%|█████▎    | 1052/1965 [39:35<31:15,  2.05s/it] 54%|█████▎    | 1053/1965 [39:37<30:57,  2.04s/it] 54%|█████▎    | 1054/1965 [39:39<30:08,  1.98s/it] 54%|█████▎    | 1055/1965 [39:41<29:27,  1.94s/it] 54%|█████▎    | 1056/1965 [39:43<30:38,  2.02s/it] 54%|█████▍    | 1057/1965 [39:45<32:11,  2.13s/it] 54%|█████▍    | 1058/1965 [39:47<31:54,  2.11s/it] 54%|█████▍    | 1059/1965 [39:49<30:46,  2.04s/it] 54%|█████▍    | 1060/1965 [39:51<30:44,  2.04s/it]                                                    54%|█████▍    | 1060/1965 [39:51<30:44,  2.04s/it] 54%|█████▍    | 1061/1965 [39:53<30:08,  2.00s/it] 54%|█████▍    | 1062/1965 [39:56<31:30,  2.09s/it] 54%|█████▍    | 1063/1965 [39:58<33:16,  2.21s/it] 54%|█████▍    | 1064/1965 [40:00<31:46,  2.12s/it] 54%|█████▍    | 1065/1965 [40:02<32:47,  2.19s/it] 54%|█████▍    | 1066/1965 [40:04<31:27,  2.10s/it] 54%|█████▍    | 1067/1965 [40:06<30:22,  2.03s/it] 54%|█████▍    | 1068/1965 [40:08<30:12,  2.02s/it] 54%|█████▍    | 1069/1965 [40:10<29:17,  1.96s/it] 54%|█████▍    | 1070/1965 [40:12<30:14,  2.03s/it]                                                    54%|█████▍    | 1070/1965 [40:12<30:14,  2.03s/it] 55%|█████▍    | 1071/1965 [40:14<31:10,  2.09s/it] 55%|█████▍    | 1072/1965 [40:16<31:13,  2.10s/it] 55%|█████▍    | 1073/1965 [40:19<31:40,  2.13s/it] 55%|█████▍    | 1074/1965 [40:21<30:58,  2.09s/it] 55%|█████▍    | 1075/1965 [40:23<30:34,  2.06s/it] 55%|█████▍    | 1076/1965 [40:24<29:26,  1.99s/it] 55%|█████▍    | 1077/1965 [40:26<28:29,  1.93s/it] 55%|█████▍    | 1078/1965 [40:28<29:32,  2.00s/it] 55%|█████▍    | 1079/1965 [40:30<29:39,  2.01s/it] 55%|█████▍    | 1080/1965 [40:32<29:22,  1.99s/it]                                                    55%|█████▍    | 1080/1965 [40:32<29:22,  1.99s/it] 55%|█████▌    | 1081/1965 [40:34<29:46,  2.02s/it] 55%|█████▌    | 1082/1965 [40:36<28:35,  1.94s/it] 55%|█████▌    | 1083/1965 [40:38<28:57,  1.97s/it] 55%|█████▌    | 1084/1965 [40:40<29:33,  2.01s/it] 55%|█████▌    | 1085/1965 [40:43<30:48,  2.10s/it] 55%|█████▌    | 1086/1965 [40:45<30:39,  2.09s/it] 55%|█████▌    | 1087/1965 [40:47<30:36,  2.09s/it] 55%|█████▌    | 1088/1965 [40:49<30:38,  2.10s/it] 55%|█████▌    | 1089/1965 [40:51<29:52,  2.05s/it] 55%|█████▌    | 1090/1965 [40:53<28:44,  1.97s/it]                                                    55%|█████▌    | 1090/1965 [40:53<28:44,  1.97s/it] 56%|█████▌    | 1091/1965 [40:54<27:59,  1.92s/it] 56%|█████▌    | 1092/1965 [40:56<27:33,  1.89s/it] 56%|█████▌    | 1093/1965 [40:58<26:53,  1.85s/it] 56%|█████▌    | 1094/1965 [41:00<27:58,  1.93s/it] 56%|█████▌    | 1095/1965 [41:02<28:03,  1.93s/it] 56%|█████▌    | 1096/1965 [41:04<27:35,  1.90s/it] 56%|█████▌    | 1097/1965 [41:06<28:15,  1.95s/it] 56%|█████▌    | 1098/1965 [41:08<28:35,  1.98s/it] 56%|█████▌    | 1099/1965 [41:10<28:27,  1.97s/it] 56%|█████▌    | 1100/1965 [41:12<28:58,  2.01s/it]                                                    56%|█████▌    | 1100/1965 [41:12<28:58,  2.01s/it][INFO|trainer.py:4021] 2024-11-05 06:01:09,182 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:01:09,182 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:01:09,182 >>   Batch size = 2
{'eval_loss': 0.3561781644821167, 'eval_runtime': 24.0703, 'eval_samples_per_second': 29.081, 'eval_steps_per_second': 14.541, 'epoch': 2.54}
{'loss': 0.3322, 'grad_norm': 4.685499668121338, 'learning_rate': 3.096023788272558e-05, 'epoch': 2.57}
{'loss': 0.3714, 'grad_norm': 1.6872227191925049, 'learning_rate': 3.0474948132801413e-05, 'epoch': 2.59}
{'loss': 0.3418, 'grad_norm': 0.8041073083877563, 'learning_rate': 2.9988719085315044e-05, 'epoch': 2.62}
{'loss': 0.3248, 'grad_norm': 2.4036924839019775, 'learning_rate': 2.9501704260172885e-05, 'epoch': 2.64}
{'loss': 0.3249, 'grad_norm': 1.7958379983901978, 'learning_rate': 2.9014057425379502e-05, 'epoch': 2.67}
{'loss': 0.3429, 'grad_norm': 1.1626794338226318, 'learning_rate': 2.8525932548487493e-05, 'epoch': 2.69}
{'loss': 0.3734, 'grad_norm': 1.1373364925384521, 'learning_rate': 2.803748374798445e-05, 'epoch': 2.72}
{'loss': 0.3178, 'grad_norm': 1.9540618658065796, 'learning_rate': 2.7548865244632267e-05, 'epoch': 2.74}
{'loss': 0.3229, 'grad_norm': 1.3033863306045532, 'learning_rate': 2.7060231312774065e-05, 'epoch': 2.77}
{'loss': 0.3315, 'grad_norm': 2.374699115753174, 'learning_rate': 2.6571736231624317e-05, 'epoch': 2.79}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.49it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.44it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.50it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.95it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.27it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.09it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.96it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.53it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.30it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.47it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.40it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.29it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.51it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.15it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.88it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.32it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.33it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.56it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.18it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.80it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.24it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.12it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.90it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.43it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.34it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.96it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.44it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.20it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.76it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.93it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.94it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.41it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.37it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.43it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.22it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.20it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.64it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.06it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.33it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.27it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.62it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.44it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.15it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.42it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.57it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.82it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.67it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.37it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.55it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.81it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.20it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.66it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.55it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.12it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.13it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.01it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.02it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.25it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.22it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.56it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.25it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.70it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.41it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.84it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.79it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.35it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.13it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                   
                                                 [A 56%|█████▌    | 1100/1965 [41:36<28:58,  2.01s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:01:33,210 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1100
[INFO|configuration_utils.py:673] 2024-11-05 06:01:33,230 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:01:33,231 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:01:33,326 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:01:33,326 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1100/special_tokens_map.json
 56%|█████▌    | 1101/1965 [41:38<2:13:34,  9.28s/it] 56%|█████▌    | 1102/1965 [41:40<1:42:08,  7.10s/it] 56%|█████▌    | 1103/1965 [41:42<1:20:14,  5.58s/it] 56%|█████▌    | 1104/1965 [41:45<1:05:30,  4.57s/it] 56%|█████▌    | 1105/1965 [41:47<54:09,  3.78s/it]   56%|█████▋    | 1106/1965 [41:49<47:41,  3.33s/it] 56%|█████▋    | 1107/1965 [41:51<41:31,  2.90s/it] 56%|█████▋    | 1108/1965 [41:53<36:48,  2.58s/it] 56%|█████▋    | 1109/1965 [41:54<33:42,  2.36s/it] 56%|█████▋    | 1110/1965 [41:56<31:42,  2.22s/it]                                                    56%|█████▋    | 1110/1965 [41:56<31:42,  2.22s/it] 57%|█████▋    | 1111/1965 [41:59<31:51,  2.24s/it] 57%|█████▋    | 1112/1965 [42:00<29:55,  2.11s/it] 57%|█████▋    | 1113/1965 [42:02<29:12,  2.06s/it] 57%|█████▋    | 1114/1965 [42:04<28:24,  2.00s/it] 57%|█████▋    | 1115/1965 [42:06<28:27,  2.01s/it] 57%|█████▋    | 1116/1965 [42:08<28:17,  2.00s/it] 57%|█████▋    | 1117/1965 [42:10<27:49,  1.97s/it] 57%|█████▋    | 1118/1965 [42:12<29:15,  2.07s/it] 57%|█████▋    | 1119/1965 [42:14<28:46,  2.04s/it] 57%|█████▋    | 1120/1965 [42:16<28:03,  1.99s/it]                                                    57%|█████▋    | 1120/1965 [42:16<28:03,  1.99s/it] 57%|█████▋    | 1121/1965 [42:19<29:37,  2.11s/it] 57%|█████▋    | 1122/1965 [42:20<28:00,  1.99s/it] 57%|█████▋    | 1123/1965 [42:23<31:09,  2.22s/it] 57%|█████▋    | 1124/1965 [42:25<30:26,  2.17s/it] 57%|█████▋    | 1125/1965 [42:27<29:28,  2.11s/it] 57%|█████▋    | 1126/1965 [42:29<29:32,  2.11s/it] 57%|█████▋    | 1127/1965 [42:32<30:37,  2.19s/it] 57%|█████▋    | 1128/1965 [42:34<31:41,  2.27s/it] 57%|█████▋    | 1129/1965 [42:36<30:24,  2.18s/it] 58%|█████▊    | 1130/1965 [42:38<28:22,  2.04s/it]                                                    58%|█████▊    | 1130/1965 [42:38<28:22,  2.04s/it] 58%|█████▊    | 1131/1965 [42:40<28:54,  2.08s/it] 58%|█████▊    | 1132/1965 [42:42<28:23,  2.04s/it] 58%|█████▊    | 1133/1965 [42:44<27:17,  1.97s/it] 58%|█████▊    | 1134/1965 [42:46<27:20,  1.97s/it] 58%|█████▊    | 1135/1965 [42:48<28:05,  2.03s/it] 58%|█████▊    | 1136/1965 [42:50<26:59,  1.95s/it] 58%|█████▊    | 1137/1965 [42:52<27:15,  1.98s/it] 58%|█████▊    | 1138/1965 [42:54<29:03,  2.11s/it] 58%|█████▊    | 1139/1965 [42:56<29:25,  2.14s/it] 58%|█████▊    | 1140/1965 [42:58<29:49,  2.17s/it]                                                    58%|█████▊    | 1140/1965 [42:58<29:49,  2.17s/it] 58%|█████▊    | 1141/1965 [43:00<28:04,  2.04s/it] 58%|█████▊    | 1142/1965 [43:02<28:50,  2.10s/it] 58%|█████▊    | 1143/1965 [43:04<28:24,  2.07s/it] 58%|█████▊    | 1144/1965 [43:06<27:20,  2.00s/it] 58%|█████▊    | 1145/1965 [43:08<26:13,  1.92s/it] 58%|█████▊    | 1146/1965 [43:10<27:57,  2.05s/it] 58%|█████▊    | 1147/1965 [43:12<27:42,  2.03s/it] 58%|█████▊    | 1148/1965 [43:14<26:53,  1.97s/it] 58%|█████▊    | 1149/1965 [43:16<27:06,  1.99s/it] 59%|█████▊    | 1150/1965 [43:19<28:15,  2.08s/it]                                                    59%|█████▊    | 1150/1965 [43:19<28:15,  2.08s/it] 59%|█████▊    | 1151/1965 [43:20<27:32,  2.03s/it] 59%|█████▊    | 1152/1965 [43:23<28:06,  2.07s/it] 59%|█████▊    | 1153/1965 [43:24<27:05,  2.00s/it] 59%|█████▊    | 1154/1965 [43:27<29:00,  2.15s/it] 59%|█████▉    | 1155/1965 [43:29<28:50,  2.14s/it] 59%|█████▉    | 1156/1965 [43:31<27:36,  2.05s/it] 59%|█████▉    | 1157/1965 [43:33<26:29,  1.97s/it] 59%|█████▉    | 1158/1965 [43:35<26:53,  2.00s/it] 59%|█████▉    | 1159/1965 [43:37<28:50,  2.15s/it] 59%|█████▉    | 1160/1965 [43:39<27:51,  2.08s/it]                                                    59%|█████▉    | 1160/1965 [43:39<27:51,  2.08s/it] 59%|█████▉    | 1161/1965 [43:41<27:00,  2.02s/it] 59%|█████▉    | 1162/1965 [43:43<28:26,  2.12s/it] 59%|█████▉    | 1163/1965 [43:45<27:07,  2.03s/it] 59%|█████▉    | 1164/1965 [43:47<27:00,  2.02s/it] 59%|█████▉    | 1165/1965 [43:50<28:20,  2.13s/it] 59%|█████▉    | 1166/1965 [43:52<29:09,  2.19s/it] 59%|█████▉    | 1167/1965 [43:54<28:13,  2.12s/it] 59%|█████▉    | 1168/1965 [43:56<29:22,  2.21s/it] 59%|█████▉    | 1169/1965 [43:58<28:07,  2.12s/it] 60%|█████▉    | 1170/1965 [44:00<28:37,  2.16s/it]                                                    60%|█████▉    | 1170/1965 [44:00<28:37,  2.16s/it] 60%|█████▉    | 1171/1965 [44:02<27:53,  2.11s/it] 60%|█████▉    | 1172/1965 [44:05<28:38,  2.17s/it] 60%|█████▉    | 1173/1965 [44:07<27:45,  2.10s/it] 60%|█████▉    | 1174/1965 [44:09<27:06,  2.06s/it] 60%|█████▉    | 1175/1965 [44:11<27:39,  2.10s/it] 60%|█████▉    | 1176/1965 [44:13<27:07,  2.06s/it] 60%|█████▉    | 1177/1965 [44:15<25:54,  1.97s/it] 60%|█████▉    | 1178/1965 [44:17<27:42,  2.11s/it] 60%|██████    | 1179/1965 [44:19<26:31,  2.02s/it] 60%|██████    | 1180/1965 [44:21<27:26,  2.10s/it]                                                    60%|██████    | 1180/1965 [44:21<27:26,  2.10s/it] 60%|██████    | 1181/1965 [44:23<26:10,  2.00s/it] 60%|██████    | 1182/1965 [44:25<25:27,  1.95s/it] 60%|██████    | 1183/1965 [44:27<25:35,  1.96s/it] 60%|██████    | 1184/1965 [44:29<25:48,  1.98s/it] 60%|██████    | 1185/1965 [44:31<26:10,  2.01s/it] 60%|██████    | 1186/1965 [44:33<27:45,  2.14s/it] 60%|██████    | 1187/1965 [44:35<27:45,  2.14s/it] 60%|██████    | 1188/1965 [44:37<27:16,  2.11s/it] 61%|██████    | 1189/1965 [44:39<26:28,  2.05s/it] 61%|██████    | 1190/1965 [44:41<26:25,  2.05s/it]                                                    61%|██████    | 1190/1965 [44:41<26:25,  2.05s/it] 61%|██████    | 1191/1965 [44:43<25:34,  1.98s/it] 61%|██████    | 1192/1965 [44:45<24:48,  1.93s/it] 61%|██████    | 1193/1965 [44:47<25:00,  1.94s/it] 61%|██████    | 1194/1965 [44:49<25:23,  1.98s/it] 61%|██████    | 1195/1965 [44:51<25:01,  1.95s/it] 61%|██████    | 1196/1965 [44:53<24:50,  1.94s/it] 61%|██████    | 1197/1965 [44:55<25:38,  2.00s/it] 61%|██████    | 1198/1965 [44:57<25:05,  1.96s/it] 61%|██████    | 1199/1965 [44:59<25:22,  1.99s/it] 61%|██████    | 1200/1965 [45:01<24:26,  1.92s/it]                                                    61%|██████    | 1200/1965 [45:01<24:26,  1.92s/it][INFO|trainer.py:4021] 2024-11-05 06:04:57,794 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:04:57,794 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:04:57,794 >>   Batch size = 2
{'eval_loss': 0.3472316265106201, 'eval_runtime': 24.0278, 'eval_samples_per_second': 29.133, 'eval_steps_per_second': 14.566, 'epoch': 2.79}
{'loss': 0.3327, 'grad_norm': 0.7824888229370117, 'learning_rate': 2.6083534236557344e-05, 'epoch': 2.82}
{'loss': 0.3119, 'grad_norm': 1.1110938787460327, 'learning_rate': 2.5595779470409734e-05, 'epoch': 2.84}
{'loss': 0.3055, 'grad_norm': 1.7421728372573853, 'learning_rate': 2.5108625934811867e-05, 'epoch': 2.87}
{'loss': 0.3163, 'grad_norm': 1.5392725467681885, 'learning_rate': 2.4622227441564154e-05, 'epoch': 2.9}
{'loss': 0.2878, 'grad_norm': 0.9888824224472046, 'learning_rate': 2.413673756407311e-05, 'epoch': 2.92}
{'loss': 0.2895, 'grad_norm': 1.3242359161376953, 'learning_rate': 2.365230958886275e-05, 'epoch': 2.95}
{'loss': 0.3017, 'grad_norm': 0.8323771357536316, 'learning_rate': 2.316909646717654e-05, 'epoch': 2.97}
{'loss': 0.3282, 'grad_norm': 1.3798646926879883, 'learning_rate': 2.2687250766685254e-05, 'epoch': 3.0}
{'loss': 0.2655, 'grad_norm': 1.2077040672302246, 'learning_rate': 2.2206924623315837e-05, 'epoch': 3.02}
{'loss': 0.3044, 'grad_norm': 1.3190635442733765, 'learning_rate': 2.1728269693216696e-05, 'epoch': 3.05}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.42it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.37it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.44it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.92it/s][A
  3%|▎         | 12/350 [00:00<00:22, 15.36it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.22it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.06it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.80it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.18it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.82it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.92it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.96it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.39it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.47it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.50it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.58it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.28it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.95it/s][A
 12%|█▏        | 41/350 [00:02<00:23, 13.43it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.35it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.24it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.30it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.47it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.51it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.73it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.47it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.14it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.88it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.13it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.29it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.05it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.76it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.67it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.59it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.30it/s][A
 22%|██▏       | 76/350 [00:05<00:17, 15.63it/s][A
 22%|██▏       | 78/350 [00:05<00:19, 13.70it/s][A
 23%|██▎       | 80/350 [00:05<00:17, 15.01it/s][A
 23%|██▎       | 82/350 [00:05<00:17, 15.74it/s][A
 24%|██▍       | 84/350 [00:05<00:16, 16.06it/s][A
 25%|██▍       | 86/350 [00:05<00:17, 15.44it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.78it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.05it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.73it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.20it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.08it/s][A
 28%|██▊       | 98/350 [00:06<00:16, 15.71it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.86it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.40it/s][A
 30%|██▉       | 104/350 [00:07<00:18, 13.29it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.91it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.37it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.50it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.19it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.90it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.45it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.15it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.38it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.13it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.18it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.74it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.92it/s][A
 38%|███▊      | 133/350 [00:09<00:13, 16.65it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.41it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.93it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.49it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.39it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.36it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.41it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.46it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.45it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.31it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.21it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.36it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.55it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.20it/s][A
 50%|█████     | 175/350 [00:12<00:11, 14.63it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.36it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.42it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.86it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.39it/s][A
 54%|█████▍    | 190/350 [00:13<00:09, 16.03it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.82it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.08it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.55it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.06it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.32it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.25it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.60it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.42it/s][A
 61%|██████    | 213/350 [00:14<00:08, 17.12it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.79it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.48it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.03it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.40it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.53it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.79it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.63it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.34it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.01it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.59it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.84it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.22it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.66it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.56it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.12it/s][A
 70%|███████   | 245/350 [00:17<00:08, 12.13it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.97it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.90it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.11it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.05it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.53it/s][A
 74%|███████▍  | 260/350 [00:18<00:07, 12.84it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.24it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.89it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.89it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.08it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.77it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.96it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 17.98it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.22it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.21it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.92it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.92it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.54it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.23it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.00it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.96it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.81it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.74it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.68it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.38it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.62it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.46it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.34it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.48it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.42it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.38it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.39it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.98it/s][A
 92%|█████████▏| 321/350 [00:22<00:01, 16.04it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.82it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.02it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.77it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.07it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.25it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.32it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.09it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.58it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.85it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.27it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.31it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.28it/s][A                                                   
                                                 [A 61%|██████    | 1200/1965 [45:25<24:26,  1.92s/it]
100%|██████████| 350/350 [00:24<00:00, 13.28it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:05:21,857 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1200
[INFO|configuration_utils.py:673] 2024-11-05 06:05:21,877 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:05:21,878 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:05:21,969 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:05:21,969 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1200/special_tokens_map.json
 61%|██████    | 1201/1965 [45:27<1:57:45,  9.25s/it] 61%|██████    | 1202/1965 [45:29<1:28:57,  7.00s/it] 61%|██████    | 1203/1965 [45:31<1:10:32,  5.55s/it] 61%|██████▏   | 1204/1965 [45:33<56:46,  4.48s/it]   61%|██████▏   | 1205/1965 [45:35<47:18,  3.74s/it] 61%|██████▏   | 1206/1965 [45:37<41:19,  3.27s/it] 61%|██████▏   | 1207/1965 [45:39<37:42,  2.98s/it] 61%|██████▏   | 1208/1965 [45:42<34:14,  2.71s/it] 62%|██████▏   | 1209/1965 [45:44<33:10,  2.63s/it] 62%|██████▏   | 1210/1965 [45:46<30:07,  2.39s/it]                                                    62%|██████▏   | 1210/1965 [45:46<30:07,  2.39s/it] 62%|██████▏   | 1211/1965 [45:48<28:09,  2.24s/it] 62%|██████▏   | 1212/1965 [45:50<26:39,  2.12s/it] 62%|██████▏   | 1213/1965 [45:51<25:27,  2.03s/it] 62%|██████▏   | 1214/1965 [45:53<25:41,  2.05s/it] 62%|██████▏   | 1215/1965 [45:55<24:51,  1.99s/it] 62%|██████▏   | 1216/1965 [45:57<25:28,  2.04s/it] 62%|██████▏   | 1217/1965 [45:59<25:11,  2.02s/it] 62%|██████▏   | 1218/1965 [46:02<26:19,  2.11s/it] 62%|██████▏   | 1219/1965 [46:04<26:23,  2.12s/it] 62%|██████▏   | 1220/1965 [46:06<25:42,  2.07s/it]                                                    62%|██████▏   | 1220/1965 [46:06<25:42,  2.07s/it] 62%|██████▏   | 1221/1965 [46:08<26:19,  2.12s/it] 62%|██████▏   | 1222/1965 [46:10<26:09,  2.11s/it] 62%|██████▏   | 1223/1965 [46:12<25:16,  2.04s/it] 62%|██████▏   | 1224/1965 [46:14<26:19,  2.13s/it] 62%|██████▏   | 1225/1965 [46:17<26:09,  2.12s/it] 62%|██████▏   | 1226/1965 [46:18<24:42,  2.01s/it] 62%|██████▏   | 1227/1965 [46:20<23:47,  1.93s/it] 62%|██████▏   | 1228/1965 [46:22<23:24,  1.91s/it] 63%|██████▎   | 1229/1965 [46:24<23:33,  1.92s/it] 63%|██████▎   | 1230/1965 [46:26<23:21,  1.91s/it]                                                    63%|██████▎   | 1230/1965 [46:26<23:21,  1.91s/it] 63%|██████▎   | 1231/1965 [46:28<24:14,  1.98s/it] 63%|██████▎   | 1232/1965 [46:30<23:29,  1.92s/it] 63%|██████▎   | 1233/1965 [46:32<23:28,  1.92s/it] 63%|██████▎   | 1234/1965 [46:34<24:14,  1.99s/it] 63%|██████▎   | 1235/1965 [46:36<23:34,  1.94s/it] 63%|██████▎   | 1236/1965 [46:37<23:10,  1.91s/it] 63%|██████▎   | 1237/1965 [46:39<23:02,  1.90s/it] 63%|██████▎   | 1238/1965 [46:41<23:34,  1.95s/it] 63%|██████▎   | 1239/1965 [46:44<24:43,  2.04s/it] 63%|██████▎   | 1240/1965 [46:45<23:32,  1.95s/it]                                                    63%|██████▎   | 1240/1965 [46:45<23:32,  1.95s/it] 63%|██████▎   | 1241/1965 [46:47<23:20,  1.93s/it] 63%|██████▎   | 1242/1965 [46:49<24:08,  2.00s/it] 63%|██████▎   | 1243/1965 [46:52<24:45,  2.06s/it] 63%|██████▎   | 1244/1965 [46:54<25:15,  2.10s/it] 63%|██████▎   | 1245/1965 [46:56<26:23,  2.20s/it] 63%|██████▎   | 1246/1965 [46:58<25:56,  2.16s/it] 63%|██████▎   | 1247/1965 [47:00<25:04,  2.10s/it] 64%|██████▎   | 1248/1965 [47:02<23:43,  1.99s/it] 64%|██████▎   | 1249/1965 [47:04<23:42,  1.99s/it] 64%|██████▎   | 1250/1965 [47:06<24:03,  2.02s/it]                                                    64%|██████▎   | 1250/1965 [47:06<24:03,  2.02s/it] 64%|██████▎   | 1251/1965 [47:08<23:35,  1.98s/it] 64%|██████▎   | 1252/1965 [47:10<23:18,  1.96s/it] 64%|██████▍   | 1253/1965 [47:12<23:07,  1.95s/it] 64%|██████▍   | 1254/1965 [47:14<22:33,  1.90s/it] 64%|██████▍   | 1255/1965 [47:16<24:09,  2.04s/it] 64%|██████▍   | 1256/1965 [47:18<22:59,  1.95s/it] 64%|██████▍   | 1257/1965 [47:20<24:53,  2.11s/it] 64%|██████▍   | 1258/1965 [47:22<25:07,  2.13s/it] 64%|██████▍   | 1259/1965 [47:24<24:53,  2.11s/it] 64%|██████▍   | 1260/1965 [47:26<23:51,  2.03s/it]                                                    64%|██████▍   | 1260/1965 [47:26<23:51,  2.03s/it] 64%|██████▍   | 1261/1965 [47:28<22:53,  1.95s/it] 64%|██████▍   | 1262/1965 [47:30<24:39,  2.10s/it] 64%|██████▍   | 1263/1965 [47:32<23:58,  2.05s/it] 64%|██████▍   | 1264/1965 [47:35<24:32,  2.10s/it] 64%|██████▍   | 1265/1965 [47:36<23:36,  2.02s/it] 64%|██████▍   | 1266/1965 [47:38<22:52,  1.96s/it] 64%|██████▍   | 1267/1965 [47:40<22:57,  1.97s/it] 65%|██████▍   | 1268/1965 [47:42<22:43,  1.96s/it] 65%|██████▍   | 1269/1965 [47:44<23:42,  2.04s/it] 65%|██████▍   | 1270/1965 [47:46<23:18,  2.01s/it]                                                    65%|██████▍   | 1270/1965 [47:46<23:18,  2.01s/it] 65%|██████▍   | 1271/1965 [47:48<23:32,  2.04s/it] 65%|██████▍   | 1272/1965 [47:50<22:42,  1.97s/it] 65%|██████▍   | 1273/1965 [47:52<23:28,  2.04s/it] 65%|██████▍   | 1274/1965 [47:55<23:36,  2.05s/it] 65%|██████▍   | 1275/1965 [47:56<23:12,  2.02s/it] 65%|██████▍   | 1276/1965 [47:58<22:20,  1.95s/it] 65%|██████▍   | 1277/1965 [48:00<21:52,  1.91s/it] 65%|██████▌   | 1278/1965 [48:02<21:59,  1.92s/it] 65%|██████▌   | 1279/1965 [48:04<23:05,  2.02s/it] 65%|██████▌   | 1280/1965 [48:06<22:21,  1.96s/it]                                                    65%|██████▌   | 1280/1965 [48:06<22:21,  1.96s/it] 65%|██████▌   | 1281/1965 [48:08<22:31,  1.98s/it] 65%|██████▌   | 1282/1965 [48:10<22:57,  2.02s/it] 65%|██████▌   | 1283/1965 [48:12<22:26,  1.97s/it] 65%|██████▌   | 1284/1965 [48:14<22:09,  1.95s/it] 65%|██████▌   | 1285/1965 [48:16<23:14,  2.05s/it] 65%|██████▌   | 1286/1965 [48:18<23:12,  2.05s/it] 65%|██████▌   | 1287/1965 [48:21<23:47,  2.11s/it] 66%|██████▌   | 1288/1965 [48:23<24:31,  2.17s/it] 66%|██████▌   | 1289/1965 [48:25<24:31,  2.18s/it] 66%|██████▌   | 1290/1965 [48:27<23:55,  2.13s/it]                                                    66%|██████▌   | 1290/1965 [48:27<23:55,  2.13s/it] 66%|██████▌   | 1291/1965 [48:29<24:43,  2.20s/it] 66%|██████▌   | 1292/1965 [48:31<24:06,  2.15s/it] 66%|██████▌   | 1293/1965 [48:34<23:58,  2.14s/it] 66%|██████▌   | 1294/1965 [48:36<23:32,  2.11s/it] 66%|██████▌   | 1295/1965 [48:37<22:30,  2.02s/it] 66%|██████▌   | 1296/1965 [48:39<22:28,  2.02s/it] 66%|██████▌   | 1297/1965 [48:41<22:34,  2.03s/it] 66%|██████▌   | 1298/1965 [48:44<23:02,  2.07s/it] 66%|██████▌   | 1299/1965 [48:46<23:42,  2.14s/it] 66%|██████▌   | 1300/1965 [48:48<23:27,  2.12s/it]                                                    66%|██████▌   | 1300/1965 [48:48<23:27,  2.12s/it][INFO|trainer.py:4021] 2024-11-05 06:08:45,115 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:08:45,115 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:08:45,115 >>   Batch size = 2
{'eval_loss': 0.34374216198921204, 'eval_runtime': 24.0622, 'eval_samples_per_second': 29.091, 'eval_steps_per_second': 14.546, 'epoch': 3.05}
{'loss': 0.296, 'grad_norm': 1.2192225456237793, 'learning_rate': 2.1251437104874418e-05, 'epoch': 3.07}
{'loss': 0.2698, 'grad_norm': 1.1400742530822754, 'learning_rate': 2.0776577411397086e-05, 'epoch': 3.1}
{'loss': 0.3325, 'grad_norm': 1.450447678565979, 'learning_rate': 2.0303840542979327e-05, 'epoch': 3.12}
{'loss': 0.2916, 'grad_norm': 0.7234179973602295, 'learning_rate': 1.98333757595639e-05, 'epoch': 3.15}
{'loss': 0.2775, 'grad_norm': 1.0032044649124146, 'learning_rate': 1.9365331603715066e-05, 'epoch': 3.17}
{'loss': 0.2808, 'grad_norm': 1.395087480545044, 'learning_rate': 1.8899855853718347e-05, 'epoch': 3.2}
{'loss': 0.2718, 'grad_norm': 1.4999998807907104, 'learning_rate': 1.8437095476921653e-05, 'epoch': 3.23}
{'loss': 0.3109, 'grad_norm': 1.0861655473709106, 'learning_rate': 1.797719658333242e-05, 'epoch': 3.25}
{'loss': 0.296, 'grad_norm': 2.1230528354644775, 'learning_rate': 1.7520304379485465e-05, 'epoch': 3.28}
{'loss': 0.2861, 'grad_norm': 0.6132673621177673, 'learning_rate': 1.7066563122596082e-05, 'epoch': 3.3}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.36it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.38it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.46it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.93it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.38it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.21it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.84it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.95it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.49it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.53it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.30it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.56it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.70it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.31it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.47it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.18it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.79it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.24it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.12it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.76it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.89it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.43it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.35it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.44it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.13it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.18it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.74it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.92it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.64it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.41it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.94it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.41it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.38it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.43it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.48it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.46it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.10it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.99it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.43it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.21it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.36it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.55it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.65it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.88it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.41it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.04it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.83it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.33it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.26it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.61it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.41it/s][A
 61%|██████    | 213/350 [00:14<00:08, 17.11it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.80it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.48it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.04it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.40it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.54it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.80it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.64it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.35it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.01it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.85it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.69it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.92it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.12it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.56it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.28it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.92it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.90it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.09it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.78it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.97it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 17.99it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.24it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.22it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.94it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.55it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.24it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.82it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.75it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.50it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.38it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.53it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.00it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.08it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.85it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.05it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.11it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.18it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                   
                                                 [A 66%|██████▌   | 1300/1965 [49:12<23:27,  2.12s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:09:09,149 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1300
[INFO|configuration_utils.py:673] 2024-11-05 06:09:09,169 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:09:09,169 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:09:09,263 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:09:09,263 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1300/special_tokens_map.json
 66%|██████▌   | 1301/1965 [49:15<1:44:25,  9.44s/it] 66%|██████▋   | 1302/1965 [49:16<1:19:18,  7.18s/it] 66%|██████▋   | 1303/1965 [49:18<1:01:54,  5.61s/it] 66%|██████▋   | 1304/1965 [49:20<50:00,  4.54s/it]   66%|██████▋   | 1305/1965 [49:22<41:13,  3.75s/it] 66%|██████▋   | 1306/1965 [49:24<35:38,  3.25s/it] 67%|██████▋   | 1307/1965 [49:26<31:27,  2.87s/it] 67%|██████▋   | 1308/1965 [49:28<28:46,  2.63s/it] 67%|██████▋   | 1309/1965 [49:31<26:57,  2.47s/it] 67%|██████▋   | 1310/1965 [49:32<24:56,  2.28s/it]                                                    67%|██████▋   | 1310/1965 [49:32<24:56,  2.28s/it] 67%|██████▋   | 1311/1965 [49:35<25:37,  2.35s/it] 67%|██████▋   | 1312/1965 [49:37<24:07,  2.22s/it] 67%|██████▋   | 1313/1965 [49:39<24:11,  2.23s/it] 67%|██████▋   | 1314/1965 [49:41<23:08,  2.13s/it] 67%|██████▋   | 1315/1965 [49:43<23:23,  2.16s/it] 67%|██████▋   | 1316/1965 [49:45<22:13,  2.06s/it] 67%|██████▋   | 1317/1965 [49:47<21:26,  1.99s/it] 67%|██████▋   | 1318/1965 [49:49<22:02,  2.04s/it] 67%|██████▋   | 1319/1965 [49:51<21:02,  1.95s/it] 67%|██████▋   | 1320/1965 [49:53<22:18,  2.08s/it]                                                    67%|██████▋   | 1320/1965 [49:53<22:18,  2.08s/it] 67%|██████▋   | 1321/1965 [49:55<23:04,  2.15s/it] 67%|██████▋   | 1322/1965 [49:57<21:46,  2.03s/it] 67%|██████▋   | 1323/1965 [49:59<21:47,  2.04s/it] 67%|██████▋   | 1324/1965 [50:01<21:32,  2.02s/it] 67%|██████▋   | 1325/1965 [50:04<22:43,  2.13s/it] 67%|██████▋   | 1326/1965 [50:06<21:55,  2.06s/it] 68%|██████▊   | 1327/1965 [50:08<23:01,  2.17s/it] 68%|██████▊   | 1328/1965 [50:10<22:04,  2.08s/it] 68%|██████▊   | 1329/1965 [50:12<21:26,  2.02s/it] 68%|██████▊   | 1330/1965 [50:14<21:21,  2.02s/it]                                                    68%|██████▊   | 1330/1965 [50:14<21:21,  2.02s/it] 68%|██████▊   | 1331/1965 [50:16<21:36,  2.05s/it] 68%|██████▊   | 1332/1965 [50:18<21:13,  2.01s/it] 68%|██████▊   | 1333/1965 [50:20<21:11,  2.01s/it] 68%|██████▊   | 1334/1965 [50:22<20:18,  1.93s/it] 68%|██████▊   | 1335/1965 [50:23<20:10,  1.92s/it] 68%|██████▊   | 1336/1965 [50:25<20:39,  1.97s/it] 68%|██████▊   | 1337/1965 [50:28<20:51,  1.99s/it] 68%|██████▊   | 1338/1965 [50:29<20:23,  1.95s/it] 68%|██████▊   | 1339/1965 [50:31<19:47,  1.90s/it] 68%|██████▊   | 1340/1965 [50:33<19:29,  1.87s/it]                                                    68%|██████▊   | 1340/1965 [50:33<19:29,  1.87s/it] 68%|██████▊   | 1341/1965 [50:35<19:19,  1.86s/it] 68%|██████▊   | 1342/1965 [50:37<18:59,  1.83s/it] 68%|██████▊   | 1343/1965 [50:38<18:31,  1.79s/it] 68%|██████▊   | 1344/1965 [50:40<19:18,  1.87s/it] 68%|██████▊   | 1345/1965 [50:43<20:47,  2.01s/it] 68%|██████▊   | 1346/1965 [50:45<20:30,  1.99s/it] 69%|██████▊   | 1347/1965 [50:47<20:33,  2.00s/it] 69%|██████▊   | 1348/1965 [50:48<19:56,  1.94s/it] 69%|██████▊   | 1349/1965 [50:50<19:51,  1.93s/it] 69%|██████▊   | 1350/1965 [50:52<20:23,  1.99s/it]                                                    69%|██████▊   | 1350/1965 [50:52<20:23,  1.99s/it] 69%|██████▉   | 1351/1965 [50:54<19:40,  1.92s/it] 69%|██████▉   | 1352/1965 [50:56<20:04,  1.96s/it] 69%|██████▉   | 1353/1965 [50:58<19:49,  1.94s/it] 69%|██████▉   | 1354/1965 [51:00<19:34,  1.92s/it] 69%|██████▉   | 1355/1965 [51:02<19:43,  1.94s/it] 69%|██████▉   | 1356/1965 [51:04<20:04,  1.98s/it] 69%|██████▉   | 1357/1965 [51:06<19:23,  1.91s/it] 69%|██████▉   | 1358/1965 [51:08<20:02,  1.98s/it] 69%|██████▉   | 1359/1965 [51:10<19:42,  1.95s/it] 69%|██████▉   | 1360/1965 [51:12<18:53,  1.87s/it]                                                    69%|██████▉   | 1360/1965 [51:12<18:53,  1.87s/it] 69%|██████▉   | 1361/1965 [51:13<18:25,  1.83s/it] 69%|██████▉   | 1362/1965 [51:15<18:03,  1.80s/it] 69%|██████▉   | 1363/1965 [51:17<17:46,  1.77s/it] 69%|██████▉   | 1364/1965 [51:19<18:40,  1.86s/it] 69%|██████▉   | 1365/1965 [51:21<19:28,  1.95s/it] 70%|██████▉   | 1366/1965 [51:23<19:27,  1.95s/it] 70%|██████▉   | 1367/1965 [51:25<19:06,  1.92s/it] 70%|██████▉   | 1368/1965 [51:27<19:14,  1.93s/it] 70%|██████▉   | 1369/1965 [51:29<18:46,  1.89s/it] 70%|██████▉   | 1370/1965 [51:31<19:26,  1.96s/it]                                                    70%|██████▉   | 1370/1965 [51:31<19:26,  1.96s/it] 70%|██████▉   | 1371/1965 [51:33<20:55,  2.11s/it] 70%|██████▉   | 1372/1965 [51:35<20:49,  2.11s/it] 70%|██████▉   | 1373/1965 [51:37<19:55,  2.02s/it] 70%|██████▉   | 1374/1965 [51:39<19:40,  2.00s/it] 70%|██████▉   | 1375/1965 [51:42<21:23,  2.18s/it] 70%|███████   | 1376/1965 [51:44<20:44,  2.11s/it] 70%|███████   | 1377/1965 [51:46<21:53,  2.23s/it] 70%|███████   | 1378/1965 [51:48<21:19,  2.18s/it] 70%|███████   | 1379/1965 [51:50<20:46,  2.13s/it] 70%|███████   | 1380/1965 [51:52<19:39,  2.02s/it]                                                    70%|███████   | 1380/1965 [51:52<19:39,  2.02s/it] 70%|███████   | 1381/1965 [51:54<19:34,  2.01s/it] 70%|███████   | 1382/1965 [51:56<19:20,  1.99s/it] 70%|███████   | 1383/1965 [51:58<19:12,  1.98s/it] 70%|███████   | 1384/1965 [52:00<19:19,  2.00s/it] 70%|███████   | 1385/1965 [52:01<18:29,  1.91s/it] 71%|███████   | 1386/1965 [52:04<19:11,  1.99s/it] 71%|███████   | 1387/1965 [52:06<19:52,  2.06s/it] 71%|███████   | 1388/1965 [52:08<19:54,  2.07s/it] 71%|███████   | 1389/1965 [52:10<20:32,  2.14s/it] 71%|███████   | 1390/1965 [52:12<20:07,  2.10s/it]                                                    71%|███████   | 1390/1965 [52:12<20:07,  2.10s/it] 71%|███████   | 1391/1965 [52:14<19:14,  2.01s/it] 71%|███████   | 1392/1965 [52:16<20:06,  2.11s/it] 71%|███████   | 1393/1965 [52:18<18:57,  1.99s/it] 71%|███████   | 1394/1965 [52:20<18:35,  1.95s/it] 71%|███████   | 1395/1965 [52:22<18:40,  1.96s/it] 71%|███████   | 1396/1965 [52:24<18:03,  1.90s/it] 71%|███████   | 1397/1965 [52:26<17:45,  1.88s/it] 71%|███████   | 1398/1965 [52:28<18:24,  1.95s/it] 71%|███████   | 1399/1965 [52:30<18:10,  1.93s/it] 71%|███████   | 1400/1965 [52:32<18:34,  1.97s/it]                                                    71%|███████   | 1400/1965 [52:32<18:34,  1.97s/it][INFO|trainer.py:4021] 2024-11-05 06:12:28,730 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:12:28,730 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:12:28,730 >>   Batch size = 2
{'eval_loss': 0.34361302852630615, 'eval_runtime': 24.0333, 'eval_samples_per_second': 29.126, 'eval_steps_per_second': 14.563, 'epoch': 3.3}
{'loss': 0.3043, 'grad_norm': 1.1356382369995117, 'learning_rate': 1.661611607501286e-05, 'epoch': 3.33}
{'loss': 0.2948, 'grad_norm': 1.0477585792541504, 'learning_rate': 1.6169105458984668e-05, 'epoch': 3.35}
{'loss': 0.301, 'grad_norm': 1.578271508216858, 'learning_rate': 1.572567241175597e-05, 'epoch': 3.38}
{'loss': 0.3312, 'grad_norm': 1.3031718730926514, 'learning_rate': 1.528595694100479e-05, 'epoch': 3.4}
{'loss': 0.3274, 'grad_norm': 1.3802906274795532, 'learning_rate': 1.4850097880637245e-05, 'epoch': 3.43}
{'loss': 0.3218, 'grad_norm': 0.7612563967704773, 'learning_rate': 1.441823284695268e-05, 'epoch': 3.45}
{'loss': 0.3023, 'grad_norm': 1.6489988565444946, 'learning_rate': 1.399049819519338e-05, 'epoch': 3.48}
{'loss': 0.3038, 'grad_norm': 1.2232040166854858, 'learning_rate': 1.356702897649222e-05, 'epoch': 3.5}
{'loss': 0.3016, 'grad_norm': 0.707220733165741, 'learning_rate': 1.3147958895232304e-05, 'epoch': 3.53}
{'loss': 0.3021, 'grad_norm': 1.6154084205627441, 'learning_rate': 1.2733420266831635e-05, 'epoch': 3.56}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.47it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.40it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.45it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.92it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.37it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.24it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.95it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.42it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.51it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.53it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.30it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.47it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.40it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.53it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.17it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.91it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.79it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.70it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.62it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.33it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.32it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.47it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.18it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.78it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.23it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.11it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.76it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.90it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.36it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.48it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.45it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.40it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.15it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.21it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.76it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.95it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.52it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.42it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.38it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.43it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.48it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.66it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.99it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.31it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.82it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.38it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.57it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.22it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.66it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.43it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.64it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.39it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.45it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.88it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.05it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.09it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.05it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.32it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.26it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.61it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.43it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.15it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.43it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.81it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.67it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.37it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.04it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.23it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.66it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.57it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.13it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.98it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.91it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.56it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.28it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.93it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.93it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.01it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.03it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.26it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.26it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.04it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.99it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.85it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.77it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.71it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.43it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.67it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.51it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.53it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.46it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.01it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.09it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.88it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.34it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.86it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                   
                                                 [A 71%|███████   | 1400/1965 [52:56<18:34,  1.97s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:12:52,754 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1400
[INFO|configuration_utils.py:673] 2024-11-05 06:12:52,774 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:12:52,774 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:12:52,866 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:12:52,866 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1400/special_tokens_map.json
 71%|███████▏  | 1401/1965 [52:58<1:27:57,  9.36s/it] 71%|███████▏  | 1402/1965 [53:00<1:07:41,  7.21s/it] 71%|███████▏  | 1403/1965 [53:02<53:03,  5.66s/it]   71%|███████▏  | 1404/1965 [53:05<44:09,  4.72s/it] 72%|███████▏  | 1405/1965 [53:07<37:16,  3.99s/it] 72%|███████▏  | 1406/1965 [53:09<31:31,  3.38s/it] 72%|███████▏  | 1407/1965 [53:11<27:39,  2.97s/it] 72%|███████▏  | 1408/1965 [53:13<24:32,  2.64s/it] 72%|███████▏  | 1409/1965 [53:15<22:06,  2.39s/it] 72%|███████▏  | 1410/1965 [53:17<21:00,  2.27s/it]                                                    72%|███████▏  | 1410/1965 [53:17<21:00,  2.27s/it] 72%|███████▏  | 1411/1965 [53:19<20:35,  2.23s/it] 72%|███████▏  | 1412/1965 [53:21<20:06,  2.18s/it] 72%|███████▏  | 1413/1965 [53:23<18:56,  2.06s/it] 72%|███████▏  | 1414/1965 [53:25<18:43,  2.04s/it] 72%|███████▏  | 1415/1965 [53:27<19:23,  2.11s/it] 72%|███████▏  | 1416/1965 [53:29<18:48,  2.06s/it] 72%|███████▏  | 1417/1965 [53:31<18:54,  2.07s/it] 72%|███████▏  | 1418/1965 [53:33<19:13,  2.11s/it] 72%|███████▏  | 1419/1965 [53:35<18:15,  2.01s/it] 72%|███████▏  | 1420/1965 [53:37<18:40,  2.06s/it]                                                    72%|███████▏  | 1420/1965 [53:37<18:40,  2.06s/it] 72%|███████▏  | 1421/1965 [53:40<19:05,  2.11s/it] 72%|███████▏  | 1422/1965 [53:42<18:56,  2.09s/it] 72%|███████▏  | 1423/1965 [53:44<18:19,  2.03s/it] 72%|███████▏  | 1424/1965 [53:46<18:28,  2.05s/it] 73%|███████▎  | 1425/1965 [53:48<18:48,  2.09s/it] 73%|███████▎  | 1426/1965 [53:50<18:04,  2.01s/it] 73%|███████▎  | 1427/1965 [53:52<18:28,  2.06s/it] 73%|███████▎  | 1428/1965 [53:54<18:54,  2.11s/it] 73%|███████▎  | 1429/1965 [53:56<17:56,  2.01s/it] 73%|███████▎  | 1430/1965 [53:58<19:20,  2.17s/it]                                                    73%|███████▎  | 1430/1965 [53:58<19:20,  2.17s/it] 73%|███████▎  | 1431/1965 [54:00<18:17,  2.06s/it] 73%|███████▎  | 1432/1965 [54:02<18:37,  2.10s/it] 73%|███████▎  | 1433/1965 [54:04<18:40,  2.11s/it] 73%|███████▎  | 1434/1965 [54:07<18:33,  2.10s/it] 73%|███████▎  | 1435/1965 [54:09<18:26,  2.09s/it] 73%|███████▎  | 1436/1965 [54:11<18:34,  2.11s/it] 73%|███████▎  | 1437/1965 [54:13<17:53,  2.03s/it] 73%|███████▎  | 1438/1965 [54:14<17:15,  1.97s/it] 73%|███████▎  | 1439/1965 [54:17<17:32,  2.00s/it] 73%|███████▎  | 1440/1965 [54:19<17:57,  2.05s/it]                                                    73%|███████▎  | 1440/1965 [54:19<17:57,  2.05s/it] 73%|███████▎  | 1441/1965 [54:21<18:06,  2.07s/it] 73%|███████▎  | 1442/1965 [54:23<17:37,  2.02s/it] 73%|███████▎  | 1443/1965 [54:25<17:35,  2.02s/it] 73%|███████▎  | 1444/1965 [54:27<17:42,  2.04s/it] 74%|███████▎  | 1445/1965 [54:29<17:09,  1.98s/it] 74%|███████▎  | 1446/1965 [54:31<17:00,  1.97s/it] 74%|███████▎  | 1447/1965 [54:32<16:42,  1.94s/it] 74%|███████▎  | 1448/1965 [54:34<16:51,  1.96s/it] 74%|███████▎  | 1449/1965 [54:37<17:17,  2.01s/it] 74%|███████▍  | 1450/1965 [54:38<16:51,  1.96s/it]                                                    74%|███████▍  | 1450/1965 [54:38<16:51,  1.96s/it] 74%|███████▍  | 1451/1965 [54:40<16:15,  1.90s/it] 74%|███████▍  | 1452/1965 [54:42<15:45,  1.84s/it] 74%|███████▍  | 1453/1965 [54:44<15:39,  1.83s/it] 74%|███████▍  | 1454/1965 [54:46<16:06,  1.89s/it] 74%|███████▍  | 1455/1965 [54:48<16:56,  1.99s/it] 74%|███████▍  | 1456/1965 [54:50<17:02,  2.01s/it] 74%|███████▍  | 1457/1965 [54:52<16:24,  1.94s/it] 74%|███████▍  | 1458/1965 [54:54<16:40,  1.97s/it] 74%|███████▍  | 1459/1965 [54:56<16:25,  1.95s/it] 74%|███████▍  | 1460/1965 [54:58<16:39,  1.98s/it]                                                    74%|███████▍  | 1460/1965 [54:58<16:39,  1.98s/it] 74%|███████▍  | 1461/1965 [55:00<17:14,  2.05s/it] 74%|███████▍  | 1462/1965 [55:02<16:52,  2.01s/it] 74%|███████▍  | 1463/1965 [55:04<17:51,  2.14s/it] 75%|███████▍  | 1464/1965 [55:06<17:47,  2.13s/it] 75%|███████▍  | 1465/1965 [55:09<17:31,  2.10s/it] 75%|███████▍  | 1466/1965 [55:10<17:10,  2.06s/it] 75%|███████▍  | 1467/1965 [55:13<17:28,  2.10s/it] 75%|███████▍  | 1468/1965 [55:15<17:13,  2.08s/it] 75%|███████▍  | 1469/1965 [55:17<17:46,  2.15s/it] 75%|███████▍  | 1470/1965 [55:19<17:53,  2.17s/it]                                                    75%|███████▍  | 1470/1965 [55:19<17:53,  2.17s/it] 75%|███████▍  | 1471/1965 [55:21<17:58,  2.18s/it] 75%|███████▍  | 1472/1965 [55:23<17:05,  2.08s/it] 75%|███████▍  | 1473/1965 [55:25<16:37,  2.03s/it] 75%|███████▌  | 1474/1965 [55:27<16:21,  2.00s/it] 75%|███████▌  | 1475/1965 [55:29<15:38,  1.92s/it] 75%|███████▌  | 1476/1965 [55:31<16:19,  2.00s/it] 75%|███████▌  | 1477/1965 [55:33<15:34,  1.92s/it] 75%|███████▌  | 1478/1965 [55:35<15:45,  1.94s/it] 75%|███████▌  | 1479/1965 [55:37<15:53,  1.96s/it] 75%|███████▌  | 1480/1965 [55:39<15:46,  1.95s/it]                                                    75%|███████▌  | 1480/1965 [55:39<15:46,  1.95s/it] 75%|███████▌  | 1481/1965 [55:41<16:11,  2.01s/it] 75%|███████▌  | 1482/1965 [55:43<15:59,  1.99s/it] 75%|███████▌  | 1483/1965 [55:45<16:16,  2.03s/it] 76%|███████▌  | 1484/1965 [55:47<16:23,  2.05s/it] 76%|███████▌  | 1485/1965 [55:49<15:31,  1.94s/it] 76%|███████▌  | 1486/1965 [55:51<16:43,  2.09s/it] 76%|███████▌  | 1487/1965 [55:53<16:47,  2.11s/it] 76%|███████▌  | 1488/1965 [55:55<16:09,  2.03s/it] 76%|███████▌  | 1489/1965 [55:58<17:46,  2.24s/it] 76%|███████▌  | 1490/1965 [56:00<16:33,  2.09s/it]                                                    76%|███████▌  | 1490/1965 [56:00<16:33,  2.09s/it] 76%|███████▌  | 1491/1965 [56:01<15:39,  1.98s/it] 76%|███████▌  | 1492/1965 [56:03<15:36,  1.98s/it] 76%|███████▌  | 1493/1965 [56:06<16:43,  2.13s/it] 76%|███████▌  | 1494/1965 [56:08<16:27,  2.10s/it] 76%|███████▌  | 1495/1965 [56:10<16:46,  2.14s/it] 76%|███████▌  | 1496/1965 [56:12<17:17,  2.21s/it] 76%|███████▌  | 1497/1965 [56:14<16:40,  2.14s/it] 76%|███████▌  | 1498/1965 [56:17<17:11,  2.21s/it] 76%|███████▋  | 1499/1965 [56:19<16:14,  2.09s/it] 76%|███████▋  | 1500/1965 [56:21<15:54,  2.05s/it]                                                    76%|███████▋  | 1500/1965 [56:21<15:54,  2.05s/it][INFO|trainer.py:4021] 2024-11-05 06:16:17,643 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:16:17,643 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:16:17,643 >>   Batch size = 2
{'eval_loss': 0.33688321709632874, 'eval_runtime': 24.0229, 'eval_samples_per_second': 29.139, 'eval_steps_per_second': 14.569, 'epoch': 3.56}
{'loss': 0.2838, 'grad_norm': 1.5377593040466309, 'learning_rate': 1.2323543975966403e-05, 'epoch': 3.58}
{'loss': 0.2763, 'grad_norm': 1.2375332117080688, 'learning_rate': 1.1918459435246073e-05, 'epoch': 3.61}
{'loss': 0.2958, 'grad_norm': 1.7503581047058105, 'learning_rate': 1.1518294544353106e-05, 'epoch': 3.63}
{'loss': 0.2901, 'grad_norm': 1.0609354972839355, 'learning_rate': 1.1123175649660539e-05, 'epoch': 3.66}
{'loss': 0.2866, 'grad_norm': 1.612578272819519, 'learning_rate': 1.0733227504339827e-05, 'epoch': 3.68}
{'loss': 0.2937, 'grad_norm': 1.354040265083313, 'learning_rate': 1.0348573228971922e-05, 'epoch': 3.71}
{'loss': 0.3005, 'grad_norm': 2.267197847366333, 'learning_rate': 9.969334272673559e-06, 'epoch': 3.73}
{'loss': 0.2881, 'grad_norm': 2.011963129043579, 'learning_rate': 9.59563037475154e-06, 'epoch': 3.76}
{'loss': 0.2938, 'grad_norm': 3.1276164054870605, 'learning_rate': 9.22757952689667e-06, 'epoch': 3.78}
{'loss': 0.2721, 'grad_norm': 2.001142978668213, 'learning_rate': 8.865297935929636e-06, 'epoch': 3.81}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.48it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.45it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.48it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.93it/s][A
  3%|▎         | 12/350 [00:00<00:22, 15.36it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.23it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.07it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.94it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.98it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.45it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.38it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.27it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.50it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.49it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.29it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.05it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.77it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.33it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.56it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.79it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.24it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.78it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.90it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.43it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.35it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.45it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.16it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.44it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.19it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.75it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.93it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.65it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.95it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.52it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.43it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.39it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.46it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.64it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.08it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.96it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.44it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.81it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.54it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.19it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.62it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.41it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.45it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.43it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.34it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.28it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.64it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.45it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.16it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.43it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.57it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.82it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.61it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.25it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.69it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.59it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.14it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.10it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.89it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.82it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 17.99it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.01it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.24it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.22it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.94it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.54it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.22it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.01it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.80it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.73it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.67it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.40it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.63it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.47it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.34it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.46it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.40it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.37it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.39it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.98it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.86it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.05it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.34it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.61it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.33it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.30it/s][A                                                   
                                                 [A 76%|███████▋  | 1500/1965 [56:45<15:54,  2.05s/it]
100%|██████████| 350/350 [00:23<00:00, 13.30it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:16:41,673 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1500
[INFO|configuration_utils.py:673] 2024-11-05 06:16:41,693 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:16:41,694 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:16:41,803 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:16:41,803 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1500/special_tokens_map.json
 76%|███████▋  | 1501/1965 [56:47<1:12:57,  9.43s/it] 76%|███████▋  | 1502/1965 [56:49<54:52,  7.11s/it]   76%|███████▋  | 1503/1965 [56:51<43:02,  5.59s/it] 77%|███████▋  | 1504/1965 [56:53<35:23,  4.61s/it] 77%|███████▋  | 1505/1965 [56:55<29:45,  3.88s/it] 77%|███████▋  | 1506/1965 [56:57<25:02,  3.27s/it] 77%|███████▋  | 1507/1965 [56:59<21:49,  2.86s/it] 77%|███████▋  | 1508/1965 [57:01<19:56,  2.62s/it] 77%|███████▋  | 1509/1965 [57:03<18:53,  2.49s/it] 77%|███████▋  | 1510/1965 [57:05<17:09,  2.26s/it]                                                    77%|███████▋  | 1510/1965 [57:05<17:09,  2.26s/it] 77%|███████▋  | 1511/1965 [57:08<17:18,  2.29s/it] 77%|███████▋  | 1512/1965 [57:10<17:29,  2.32s/it] 77%|███████▋  | 1513/1965 [57:12<16:34,  2.20s/it] 77%|███████▋  | 1514/1965 [57:14<15:56,  2.12s/it] 77%|███████▋  | 1515/1965 [57:16<16:37,  2.22s/it] 77%|███████▋  | 1516/1965 [57:18<16:24,  2.19s/it] 77%|███████▋  | 1517/1965 [57:20<15:30,  2.08s/it] 77%|███████▋  | 1518/1965 [57:22<15:54,  2.14s/it] 77%|███████▋  | 1519/1965 [57:24<15:32,  2.09s/it] 77%|███████▋  | 1520/1965 [57:26<14:37,  1.97s/it]                                                    77%|███████▋  | 1520/1965 [57:26<14:37,  1.97s/it] 77%|███████▋  | 1521/1965 [57:28<14:31,  1.96s/it] 77%|███████▋  | 1522/1965 [57:30<14:25,  1.95s/it] 78%|███████▊  | 1523/1965 [57:32<13:48,  1.87s/it] 78%|███████▊  | 1524/1965 [57:34<14:59,  2.04s/it] 78%|███████▊  | 1525/1965 [57:36<15:19,  2.09s/it] 78%|███████▊  | 1526/1965 [57:38<15:25,  2.11s/it] 78%|███████▊  | 1527/1965 [57:41<15:27,  2.12s/it] 78%|███████▊  | 1528/1965 [57:43<15:23,  2.11s/it] 78%|███████▊  | 1529/1965 [57:45<15:14,  2.10s/it] 78%|███████▊  | 1530/1965 [57:47<15:03,  2.08s/it]                                                    78%|███████▊  | 1530/1965 [57:47<15:03,  2.08s/it] 78%|███████▊  | 1531/1965 [57:49<15:24,  2.13s/it] 78%|███████▊  | 1532/1965 [57:51<14:56,  2.07s/it] 78%|███████▊  | 1533/1965 [57:53<15:13,  2.11s/it] 78%|███████▊  | 1534/1965 [57:55<15:17,  2.13s/it] 78%|███████▊  | 1535/1965 [57:58<15:38,  2.18s/it] 78%|███████▊  | 1536/1965 [58:00<15:47,  2.21s/it] 78%|███████▊  | 1537/1965 [58:02<16:08,  2.26s/it] 78%|███████▊  | 1538/1965 [58:04<15:33,  2.19s/it] 78%|███████▊  | 1539/1965 [58:06<14:32,  2.05s/it] 78%|███████▊  | 1540/1965 [58:08<14:43,  2.08s/it]                                                    78%|███████▊  | 1540/1965 [58:08<14:43,  2.08s/it] 78%|███████▊  | 1541/1965 [58:10<14:02,  1.99s/it] 78%|███████▊  | 1542/1965 [58:12<14:10,  2.01s/it] 79%|███████▊  | 1543/1965 [58:14<13:33,  1.93s/it] 79%|███████▊  | 1544/1965 [58:16<13:18,  1.90s/it] 79%|███████▊  | 1545/1965 [58:18<13:59,  2.00s/it] 79%|███████▊  | 1546/1965 [58:20<14:55,  2.14s/it] 79%|███████▊  | 1547/1965 [58:22<14:38,  2.10s/it] 79%|███████▉  | 1548/1965 [58:24<13:44,  1.98s/it] 79%|███████▉  | 1549/1965 [58:26<13:59,  2.02s/it] 79%|███████▉  | 1550/1965 [58:28<13:39,  1.97s/it]                                                    79%|███████▉  | 1550/1965 [58:28<13:39,  1.97s/it] 79%|███████▉  | 1551/1965 [58:30<13:37,  1.98s/it] 79%|███████▉  | 1552/1965 [58:32<13:37,  1.98s/it] 79%|███████▉  | 1553/1965 [58:34<13:13,  1.93s/it] 79%|███████▉  | 1554/1965 [58:36<14:08,  2.06s/it] 79%|███████▉  | 1555/1965 [58:38<13:56,  2.04s/it] 79%|███████▉  | 1556/1965 [58:40<13:43,  2.01s/it] 79%|███████▉  | 1557/1965 [58:42<13:32,  1.99s/it] 79%|███████▉  | 1558/1965 [58:44<13:36,  2.01s/it] 79%|███████▉  | 1559/1965 [58:46<13:40,  2.02s/it] 79%|███████▉  | 1560/1965 [58:48<13:43,  2.03s/it]                                                    79%|███████▉  | 1560/1965 [58:48<13:43,  2.03s/it] 79%|███████▉  | 1561/1965 [58:50<13:55,  2.07s/it] 79%|███████▉  | 1562/1965 [58:52<13:37,  2.03s/it] 80%|███████▉  | 1563/1965 [58:54<13:35,  2.03s/it] 80%|███████▉  | 1564/1965 [58:56<13:21,  2.00s/it] 80%|███████▉  | 1565/1965 [58:58<13:02,  1.96s/it] 80%|███████▉  | 1566/1965 [59:01<14:44,  2.22s/it] 80%|███████▉  | 1567/1965 [59:03<14:14,  2.15s/it] 80%|███████▉  | 1568/1965 [59:05<13:45,  2.08s/it] 80%|███████▉  | 1569/1965 [59:07<13:49,  2.09s/it] 80%|███████▉  | 1570/1965 [59:09<13:50,  2.10s/it]                                                    80%|███████▉  | 1570/1965 [59:09<13:50,  2.10s/it] 80%|███████▉  | 1571/1965 [59:12<14:45,  2.25s/it] 80%|████████  | 1572/1965 [59:13<13:50,  2.11s/it] 80%|████████  | 1573/1965 [59:16<13:50,  2.12s/it] 80%|████████  | 1574/1965 [59:18<13:39,  2.10s/it] 80%|████████  | 1575/1965 [59:19<13:04,  2.01s/it] 80%|████████  | 1576/1965 [59:21<12:44,  1.96s/it] 80%|████████  | 1577/1965 [59:23<12:41,  1.96s/it] 80%|████████  | 1578/1965 [59:25<12:33,  1.95s/it] 80%|████████  | 1579/1965 [59:27<12:42,  1.97s/it] 80%|████████  | 1580/1965 [59:29<12:57,  2.02s/it]                                                    80%|████████  | 1580/1965 [59:29<12:57,  2.02s/it] 80%|████████  | 1581/1965 [59:32<13:44,  2.15s/it] 81%|████████  | 1582/1965 [59:34<14:13,  2.23s/it] 81%|████████  | 1583/1965 [59:36<13:50,  2.17s/it] 81%|████████  | 1584/1965 [59:38<13:43,  2.16s/it] 81%|████████  | 1585/1965 [59:40<12:55,  2.04s/it] 81%|████████  | 1586/1965 [59:42<12:44,  2.02s/it] 81%|████████  | 1587/1965 [59:44<13:14,  2.10s/it] 81%|████████  | 1588/1965 [59:46<12:42,  2.02s/it] 81%|████████  | 1589/1965 [59:48<12:08,  1.94s/it] 81%|████████  | 1590/1965 [59:50<12:20,  1.98s/it]                                                    81%|████████  | 1590/1965 [59:50<12:20,  1.98s/it] 81%|████████  | 1591/1965 [59:52<12:12,  1.96s/it] 81%|████████  | 1592/1965 [59:54<12:28,  2.01s/it] 81%|████████  | 1593/1965 [59:56<13:03,  2.11s/it] 81%|████████  | 1594/1965 [59:58<12:49,  2.08s/it] 81%|████████  | 1595/1965 [1:00:01<13:15,  2.15s/it] 81%|████████  | 1596/1965 [1:00:03<12:41,  2.06s/it] 81%|████████▏ | 1597/1965 [1:00:05<12:28,  2.03s/it] 81%|████████▏ | 1598/1965 [1:00:07<12:36,  2.06s/it] 81%|████████▏ | 1599/1965 [1:00:09<12:53,  2.11s/it] 81%|████████▏ | 1600/1965 [1:00:11<13:06,  2.16s/it]                                                      81%|████████▏ | 1600/1965 [1:00:11<13:06,  2.16s/it][INFO|trainer.py:4021] 2024-11-05 06:20:08,240 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:20:08,240 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:20:08,240 >>   Batch size = 2
{'eval_loss': 0.3304470181465149, 'eval_runtime': 24.0299, 'eval_samples_per_second': 29.13, 'eval_steps_per_second': 14.565, 'epoch': 3.81}
{'loss': 0.3133, 'grad_norm': 2.582183837890625, 'learning_rate': 8.508899987110282e-06, 'epoch': 3.83}
{'loss': 0.2934, 'grad_norm': 1.4488002061843872, 'learning_rate': 8.158498208022148e-06, 'epoch': 3.86}
{'loss': 0.2945, 'grad_norm': 1.2411638498306274, 'learning_rate': 7.814203233043433e-06, 'epoch': 3.89}
{'loss': 0.2784, 'grad_norm': 1.2230011224746704, 'learning_rate': 7.476123768415823e-06, 'epoch': 3.91}
{'loss': 0.299, 'grad_norm': 1.8132665157318115, 'learning_rate': 7.144366557921976e-06, 'epoch': 3.94}
{'loss': 0.2985, 'grad_norm': 1.5613402128219604, 'learning_rate': 6.819036349182749e-06, 'epoch': 3.96}
{'loss': 0.2689, 'grad_norm': 1.1652255058288574, 'learning_rate': 6.500235860584606e-06, 'epoch': 3.99}
{'loss': 0.2718, 'grad_norm': 1.4288612604141235, 'learning_rate': 6.188065748847712e-06, 'epoch': 4.01}
{'loss': 0.2889, 'grad_norm': 1.0612835884094238, 'learning_rate': 5.882624577245084e-06, 'epoch': 4.04}
{'loss': 0.2586, 'grad_norm': 1.3239930868148804, 'learning_rate': 5.584008784482542e-06, 'epoch': 4.06}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.43it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.42it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.49it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.39it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.20it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.94it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.99it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.50it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.53it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.30it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.45it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.38it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.27it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.54it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.17it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.90it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.29it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.04it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.77it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.32it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.47it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.74it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.19it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.81it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.13it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.78it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.34it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.95it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.92it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.44it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.40it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.14it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.17it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.71it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.90it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.64it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.41it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.92it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.49it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.39it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.36it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.40it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.45it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.45it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.99it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.31it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.45it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.81it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.22it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.65it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.43it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.45it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.34it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.28it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.63it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.45it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.16it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.83it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.51it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.06it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.44it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.58it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.82it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.67it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.37it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.04it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.62it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.87it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.69it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.14it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.15it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.22it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.01it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.94it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.10it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.95it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.13it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.01it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.02it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.25it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.26it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.04it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.99it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.84it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.77it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.70it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.42it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.50it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.53it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.42it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 15.01it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.09it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.88it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.81it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.28it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.36it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.13it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.62it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.88it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                     
                                                 [A 81%|████████▏ | 1600/1965 [1:00:35<13:06,  2.16s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:20:32,265 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1600
[INFO|configuration_utils.py:673] 2024-11-05 06:20:32,477 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:20:32,478 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:20:32,582 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:20:32,582 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1600/special_tokens_map.json
 81%|████████▏ | 1601/1965 [1:00:38<57:28,  9.47s/it] 82%|████████▏ | 1602/1965 [1:00:40<44:00,  7.27s/it] 82%|████████▏ | 1603/1965 [1:00:42<34:52,  5.78s/it] 82%|████████▏ | 1604/1965 [1:00:44<28:18,  4.71s/it] 82%|████████▏ | 1605/1965 [1:00:47<23:53,  3.98s/it] 82%|████████▏ | 1606/1965 [1:00:49<20:24,  3.41s/it] 82%|████████▏ | 1607/1965 [1:00:50<17:25,  2.92s/it] 82%|████████▏ | 1608/1965 [1:00:52<15:31,  2.61s/it] 82%|████████▏ | 1609/1965 [1:00:54<14:18,  2.41s/it] 82%|████████▏ | 1610/1965 [1:00:56<13:19,  2.25s/it]                                                      82%|████████▏ | 1610/1965 [1:00:56<13:19,  2.25s/it] 82%|████████▏ | 1611/1965 [1:00:59<13:25,  2.28s/it] 82%|████████▏ | 1612/1965 [1:01:01<13:06,  2.23s/it] 82%|████████▏ | 1613/1965 [1:01:02<12:07,  2.07s/it] 82%|████████▏ | 1614/1965 [1:01:04<11:55,  2.04s/it] 82%|████████▏ | 1615/1965 [1:01:06<11:52,  2.04s/it] 82%|████████▏ | 1616/1965 [1:01:08<11:38,  2.00s/it] 82%|████████▏ | 1617/1965 [1:01:10<11:54,  2.05s/it] 82%|████████▏ | 1618/1965 [1:01:13<11:58,  2.07s/it] 82%|████████▏ | 1619/1965 [1:01:14<11:32,  2.00s/it] 82%|████████▏ | 1620/1965 [1:01:16<11:08,  1.94s/it]                                                      82%|████████▏ | 1620/1965 [1:01:16<11:08,  1.94s/it] 82%|████████▏ | 1621/1965 [1:01:18<11:18,  1.97s/it] 83%|████████▎ | 1622/1965 [1:01:20<11:16,  1.97s/it] 83%|████████▎ | 1623/1965 [1:01:22<11:37,  2.04s/it] 83%|████████▎ | 1624/1965 [1:01:25<11:44,  2.07s/it] 83%|████████▎ | 1625/1965 [1:01:26<11:10,  1.97s/it] 83%|████████▎ | 1626/1965 [1:01:28<10:48,  1.91s/it] 83%|████████▎ | 1627/1965 [1:01:30<10:59,  1.95s/it] 83%|████████▎ | 1628/1965 [1:01:32<11:32,  2.06s/it] 83%|████████▎ | 1629/1965 [1:01:34<11:02,  1.97s/it] 83%|████████▎ | 1630/1965 [1:01:36<10:58,  1.97s/it]                                                      83%|████████▎ | 1630/1965 [1:01:36<10:58,  1.97s/it] 83%|████████▎ | 1631/1965 [1:01:38<11:10,  2.01s/it] 83%|████████▎ | 1632/1965 [1:01:40<11:27,  2.06s/it] 83%|████████▎ | 1633/1965 [1:01:43<11:31,  2.08s/it] 83%|████████▎ | 1634/1965 [1:01:44<10:56,  1.98s/it] 83%|████████▎ | 1635/1965 [1:01:46<11:11,  2.04s/it] 83%|████████▎ | 1636/1965 [1:01:49<11:14,  2.05s/it] 83%|████████▎ | 1637/1965 [1:01:51<11:55,  2.18s/it] 83%|████████▎ | 1638/1965 [1:01:53<11:56,  2.19s/it] 83%|████████▎ | 1639/1965 [1:01:55<11:40,  2.15s/it] 83%|████████▎ | 1640/1965 [1:01:57<11:24,  2.11s/it]                                                      83%|████████▎ | 1640/1965 [1:01:57<11:24,  2.11s/it] 84%|████████▎ | 1641/1965 [1:01:59<10:50,  2.01s/it] 84%|████████▎ | 1642/1965 [1:02:01<10:39,  1.98s/it] 84%|████████▎ | 1643/1965 [1:02:03<10:22,  1.93s/it] 84%|████████▎ | 1644/1965 [1:02:05<10:19,  1.93s/it] 84%|████████▎ | 1645/1965 [1:02:07<10:23,  1.95s/it] 84%|████████▍ | 1646/1965 [1:02:09<10:14,  1.93s/it] 84%|████████▍ | 1647/1965 [1:02:11<10:19,  1.95s/it] 84%|████████▍ | 1648/1965 [1:02:13<10:53,  2.06s/it] 84%|████████▍ | 1649/1965 [1:02:15<10:20,  1.96s/it] 84%|████████▍ | 1650/1965 [1:02:17<10:39,  2.03s/it]                                                      84%|████████▍ | 1650/1965 [1:02:17<10:39,  2.03s/it] 84%|████████▍ | 1651/1965 [1:02:19<10:37,  2.03s/it] 84%|████████▍ | 1652/1965 [1:02:21<10:16,  1.97s/it] 84%|████████▍ | 1653/1965 [1:02:23<10:00,  1.92s/it] 84%|████████▍ | 1654/1965 [1:02:24<10:03,  1.94s/it] 84%|████████▍ | 1655/1965 [1:02:27<10:33,  2.04s/it] 84%|████████▍ | 1656/1965 [1:02:29<10:33,  2.05s/it] 84%|████████▍ | 1657/1965 [1:02:31<10:21,  2.02s/it] 84%|████████▍ | 1658/1965 [1:02:33<09:59,  1.95s/it] 84%|████████▍ | 1659/1965 [1:02:35<10:14,  2.01s/it] 84%|████████▍ | 1660/1965 [1:02:37<10:13,  2.01s/it]                                                      84%|████████▍ | 1660/1965 [1:02:37<10:13,  2.01s/it] 85%|████████▍ | 1661/1965 [1:02:39<10:39,  2.10s/it] 85%|████████▍ | 1662/1965 [1:02:41<10:09,  2.01s/it] 85%|████████▍ | 1663/1965 [1:02:43<10:18,  2.05s/it] 85%|████████▍ | 1664/1965 [1:02:45<10:07,  2.02s/it] 85%|████████▍ | 1665/1965 [1:02:47<10:34,  2.12s/it] 85%|████████▍ | 1666/1965 [1:02:50<11:24,  2.29s/it] 85%|████████▍ | 1667/1965 [1:02:52<11:10,  2.25s/it] 85%|████████▍ | 1668/1965 [1:02:54<10:56,  2.21s/it] 85%|████████▍ | 1669/1965 [1:02:56<10:48,  2.19s/it] 85%|████████▍ | 1670/1965 [1:02:59<10:42,  2.18s/it]                                                      85%|████████▍ | 1670/1965 [1:02:59<10:42,  2.18s/it] 85%|████████▌ | 1671/1965 [1:03:01<10:30,  2.14s/it] 85%|████████▌ | 1672/1965 [1:03:02<10:04,  2.06s/it] 85%|████████▌ | 1673/1965 [1:03:05<10:28,  2.15s/it] 85%|████████▌ | 1674/1965 [1:03:07<10:04,  2.08s/it] 85%|████████▌ | 1675/1965 [1:03:09<10:10,  2.10s/it] 85%|████████▌ | 1676/1965 [1:03:11<09:59,  2.07s/it] 85%|████████▌ | 1677/1965 [1:03:13<09:23,  1.96s/it] 85%|████████▌ | 1678/1965 [1:03:14<09:07,  1.91s/it] 85%|████████▌ | 1679/1965 [1:03:17<09:53,  2.08s/it] 85%|████████▌ | 1680/1965 [1:03:19<10:07,  2.13s/it]                                                      85%|████████▌ | 1680/1965 [1:03:19<10:07,  2.13s/it] 86%|████████▌ | 1681/1965 [1:03:21<10:05,  2.13s/it] 86%|████████▌ | 1682/1965 [1:03:23<09:55,  2.10s/it] 86%|████████▌ | 1683/1965 [1:03:25<09:24,  2.00s/it] 86%|████████▌ | 1684/1965 [1:03:27<09:12,  1.97s/it] 86%|████████▌ | 1685/1965 [1:03:29<09:10,  1.97s/it] 86%|████████▌ | 1686/1965 [1:03:31<08:57,  1.93s/it] 86%|████████▌ | 1687/1965 [1:03:32<08:39,  1.87s/it] 86%|████████▌ | 1688/1965 [1:03:34<08:34,  1.86s/it] 86%|████████▌ | 1689/1965 [1:03:36<08:30,  1.85s/it] 86%|████████▌ | 1690/1965 [1:03:38<08:37,  1.88s/it]                                                      86%|████████▌ | 1690/1965 [1:03:38<08:37,  1.88s/it] 86%|████████▌ | 1691/1965 [1:03:40<09:05,  1.99s/it] 86%|████████▌ | 1692/1965 [1:03:42<09:07,  2.00s/it] 86%|████████▌ | 1693/1965 [1:03:44<08:46,  1.93s/it] 86%|████████▌ | 1694/1965 [1:03:46<08:49,  1.95s/it] 86%|████████▋ | 1695/1965 [1:03:48<08:34,  1.91s/it] 86%|████████▋ | 1696/1965 [1:03:50<08:59,  2.00s/it] 86%|████████▋ | 1697/1965 [1:03:52<09:03,  2.03s/it] 86%|████████▋ | 1698/1965 [1:03:55<09:32,  2.14s/it] 86%|████████▋ | 1699/1965 [1:03:56<09:03,  2.04s/it] 87%|████████▋ | 1700/1965 [1:03:59<09:11,  2.08s/it]                                                      87%|████████▋ | 1700/1965 [1:03:59<09:11,  2.08s/it][INFO|trainer.py:4021] 2024-11-05 06:23:55,743 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:23:55,743 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:23:55,743 >>   Batch size = 2
{'eval_loss': 0.3307119309902191, 'eval_runtime': 24.0242, 'eval_samples_per_second': 29.137, 'eval_steps_per_second': 14.569, 'epoch': 4.06}
{'loss': 0.3068, 'grad_norm': 1.0891169309616089, 'learning_rate': 5.292312654249648e-06, 'epoch': 4.09}
{'loss': 0.3045, 'grad_norm': 0.627011239528656, 'learning_rate': 5.007628285450927e-06, 'epoch': 4.11}
{'loss': 0.2765, 'grad_norm': 1.2825590372085571, 'learning_rate': 4.730045563126947e-06, 'epoch': 4.14}
{'loss': 0.264, 'grad_norm': 1.591213583946228, 'learning_rate': 4.459652130074399e-06, 'epoch': 4.17}
{'loss': 0.2773, 'grad_norm': 0.7131186127662659, 'learning_rate': 4.1965333591741525e-06, 'epoch': 4.19}
{'loss': 0.2981, 'grad_norm': 1.074458122253418, 'learning_rate': 3.940772326435942e-06, 'epoch': 4.22}
{'loss': 0.2542, 'grad_norm': 0.368410587310791, 'learning_rate': 3.6924497847683438e-06, 'epoch': 4.24}
{'loss': 0.2757, 'grad_norm': 1.3626383543014526, 'learning_rate': 3.451644138482161e-06, 'epoch': 4.27}
{'loss': 0.3005, 'grad_norm': 1.5485562086105347, 'learning_rate': 3.2184314185353924e-06, 'epoch': 4.29}
{'loss': 0.2876, 'grad_norm': 1.0344023704528809, 'learning_rate': 2.9928852585275227e-06, 'epoch': 4.32}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.48it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.44it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.50it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.38it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.24it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.19it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.83it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.94it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.98it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.41it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.49it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.60it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.39it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.28it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.33it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.55it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.76it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s][A
 18%|█▊        | 64/350 [00:04<00:20, 14.27it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.04it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.76it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.67it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.59it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.32it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.56it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.49it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.67it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.79it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.24it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.12it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.36it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.43it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.94it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.48it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.18it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.45it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.41it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.16it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.21it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.76it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.42it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.94it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.42it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.38it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.43it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.48it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.47it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.44it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.82it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.64it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.63it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.37it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.85it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.34it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.29it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.63it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.45it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.15it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.81it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.49it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.04it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.42it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.81it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.35it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.02it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.61it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.24it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.56it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.12it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.56it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.93it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.14it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.82it/s][A
 79%|███████▊  | 275/350 [00:18<00:04, 18.01it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 18.03it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.26it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.23it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.95it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.94it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.57it/s][A
 83%|████████▎ | 289/350 [00:19<00:03, 15.26it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.04it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 15.00it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.85it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.78it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.71it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.43it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.66it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.36it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.51it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.44it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.41it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.83it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.79it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.08it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.10it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.58it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.86it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.31it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.28it/s][A                                                     
                                                 [A 87%|████████▋ | 1700/1965 [1:04:23<09:11,  2.08s/it]
100%|██████████| 350/350 [00:23<00:00, 13.28it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:24:19,771 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1700
[INFO|configuration_utils.py:673] 2024-11-05 06:24:19,791 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:24:19,792 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:24:19,897 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:24:19,897 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1700/special_tokens_map.json
 87%|████████▋ | 1701/1965 [1:04:25<41:12,  9.37s/it] 87%|████████▋ | 1702/1965 [1:04:27<31:17,  7.14s/it] 87%|████████▋ | 1703/1965 [1:04:29<24:27,  5.60s/it] 87%|████████▋ | 1704/1965 [1:04:31<19:41,  4.53s/it] 87%|████████▋ | 1705/1965 [1:04:33<16:26,  3.79s/it] 87%|████████▋ | 1706/1965 [1:04:35<14:00,  3.25s/it] 87%|████████▋ | 1707/1965 [1:04:37<12:36,  2.93s/it] 87%|████████▋ | 1708/1965 [1:04:40<11:57,  2.79s/it] 87%|████████▋ | 1709/1965 [1:04:42<10:41,  2.50s/it] 87%|████████▋ | 1710/1965 [1:04:43<09:55,  2.34s/it]                                                      87%|████████▋ | 1710/1965 [1:04:43<09:55,  2.34s/it] 87%|████████▋ | 1711/1965 [1:04:45<09:15,  2.19s/it] 87%|████████▋ | 1712/1965 [1:04:47<08:54,  2.11s/it] 87%|████████▋ | 1713/1965 [1:04:50<09:11,  2.19s/it] 87%|████████▋ | 1714/1965 [1:04:51<08:42,  2.08s/it] 87%|████████▋ | 1715/1965 [1:04:53<08:34,  2.06s/it] 87%|████████▋ | 1716/1965 [1:04:56<08:37,  2.08s/it] 87%|████████▋ | 1717/1965 [1:04:58<09:10,  2.22s/it] 87%|████████▋ | 1718/1965 [1:05:00<08:48,  2.14s/it] 87%|████████▋ | 1719/1965 [1:05:02<08:52,  2.16s/it] 88%|████████▊ | 1720/1965 [1:05:04<08:31,  2.09s/it]                                                      88%|████████▊ | 1720/1965 [1:05:04<08:31,  2.09s/it] 88%|████████▊ | 1721/1965 [1:05:06<08:40,  2.13s/it] 88%|████████▊ | 1722/1965 [1:05:08<08:11,  2.02s/it] 88%|████████▊ | 1723/1965 [1:05:10<08:13,  2.04s/it] 88%|████████▊ | 1724/1965 [1:05:12<08:14,  2.05s/it] 88%|████████▊ | 1725/1965 [1:05:14<08:02,  2.01s/it] 88%|████████▊ | 1726/1965 [1:05:16<07:59,  2.01s/it] 88%|████████▊ | 1727/1965 [1:05:18<07:54,  1.99s/it] 88%|████████▊ | 1728/1965 [1:05:20<07:39,  1.94s/it] 88%|████████▊ | 1729/1965 [1:05:22<08:07,  2.07s/it] 88%|████████▊ | 1730/1965 [1:05:24<07:52,  2.01s/it]                                                      88%|████████▊ | 1730/1965 [1:05:24<07:52,  2.01s/it] 88%|████████▊ | 1731/1965 [1:05:26<07:43,  1.98s/it] 88%|████████▊ | 1732/1965 [1:05:28<07:32,  1.94s/it] 88%|████████▊ | 1733/1965 [1:05:30<07:26,  1.92s/it] 88%|████████▊ | 1734/1965 [1:05:32<07:39,  1.99s/it] 88%|████████▊ | 1735/1965 [1:05:34<07:43,  2.02s/it] 88%|████████▊ | 1736/1965 [1:05:36<07:47,  2.04s/it] 88%|████████▊ | 1737/1965 [1:05:38<07:38,  2.01s/it] 88%|████████▊ | 1738/1965 [1:05:40<07:38,  2.02s/it] 88%|████████▊ | 1739/1965 [1:05:42<07:18,  1.94s/it] 89%|████████▊ | 1740/1965 [1:05:44<07:39,  2.04s/it]                                                      89%|████████▊ | 1740/1965 [1:05:44<07:39,  2.04s/it] 89%|████████▊ | 1741/1965 [1:05:47<07:56,  2.13s/it] 89%|████████▊ | 1742/1965 [1:05:49<08:00,  2.15s/it] 89%|████████▊ | 1743/1965 [1:05:51<07:48,  2.11s/it] 89%|████████▉ | 1744/1965 [1:05:53<07:37,  2.07s/it] 89%|████████▉ | 1745/1965 [1:05:55<07:55,  2.16s/it] 89%|████████▉ | 1746/1965 [1:05:57<07:41,  2.11s/it] 89%|████████▉ | 1747/1965 [1:06:00<07:55,  2.18s/it] 89%|████████▉ | 1748/1965 [1:06:01<07:36,  2.11s/it] 89%|████████▉ | 1749/1965 [1:06:03<07:30,  2.09s/it] 89%|████████▉ | 1750/1965 [1:06:06<08:03,  2.25s/it]                                                      89%|████████▉ | 1750/1965 [1:06:06<08:03,  2.25s/it] 89%|████████▉ | 1751/1965 [1:06:08<07:55,  2.22s/it] 89%|████████▉ | 1752/1965 [1:06:10<07:44,  2.18s/it] 89%|████████▉ | 1753/1965 [1:06:12<07:30,  2.13s/it] 89%|████████▉ | 1754/1965 [1:06:14<07:23,  2.10s/it] 89%|████████▉ | 1755/1965 [1:06:16<07:06,  2.03s/it] 89%|████████▉ | 1756/1965 [1:06:18<06:48,  1.96s/it] 89%|████████▉ | 1757/1965 [1:06:20<06:34,  1.90s/it] 89%|████████▉ | 1758/1965 [1:06:22<06:33,  1.90s/it] 90%|████████▉ | 1759/1965 [1:06:24<06:41,  1.95s/it] 90%|████████▉ | 1760/1965 [1:06:26<06:37,  1.94s/it]                                                      90%|████████▉ | 1760/1965 [1:06:26<06:37,  1.94s/it] 90%|████████▉ | 1761/1965 [1:06:27<06:21,  1.87s/it] 90%|████████▉ | 1762/1965 [1:06:29<06:16,  1.86s/it] 90%|████████▉ | 1763/1965 [1:06:31<06:24,  1.90s/it] 90%|████████▉ | 1764/1965 [1:06:34<06:48,  2.03s/it] 90%|████████▉ | 1765/1965 [1:06:35<06:34,  1.97s/it] 90%|████████▉ | 1766/1965 [1:06:38<06:56,  2.09s/it] 90%|████████▉ | 1767/1965 [1:06:40<06:37,  2.01s/it] 90%|████████▉ | 1768/1965 [1:06:41<06:16,  1.91s/it] 90%|█████████ | 1769/1965 [1:06:44<06:33,  2.01s/it] 90%|█████████ | 1770/1965 [1:06:46<06:48,  2.09s/it]                                                      90%|█████████ | 1770/1965 [1:06:46<06:48,  2.09s/it] 90%|█████████ | 1771/1965 [1:06:48<07:08,  2.21s/it] 90%|█████████ | 1772/1965 [1:06:50<06:44,  2.10s/it] 90%|█████████ | 1773/1965 [1:06:52<06:26,  2.01s/it] 90%|█████████ | 1774/1965 [1:06:54<06:07,  1.93s/it] 90%|█████████ | 1775/1965 [1:06:56<06:03,  1.91s/it] 90%|█████████ | 1776/1965 [1:06:58<06:06,  1.94s/it] 90%|█████████ | 1777/1965 [1:07:00<06:05,  1.94s/it] 90%|█████████ | 1778/1965 [1:07:02<06:25,  2.06s/it] 91%|█████████ | 1779/1965 [1:07:04<06:18,  2.03s/it] 91%|█████████ | 1780/1965 [1:07:06<06:06,  1.98s/it]                                                      91%|█████████ | 1780/1965 [1:07:06<06:06,  1.98s/it] 91%|█████████ | 1781/1965 [1:07:07<05:50,  1.90s/it] 91%|█████████ | 1782/1965 [1:07:09<05:36,  1.84s/it] 91%|█████████ | 1783/1965 [1:07:11<05:42,  1.88s/it] 91%|█████████ | 1784/1965 [1:07:13<05:50,  1.94s/it] 91%|█████████ | 1785/1965 [1:07:15<05:38,  1.88s/it] 91%|█████████ | 1786/1965 [1:07:17<05:48,  1.95s/it] 91%|█████████ | 1787/1965 [1:07:19<05:47,  1.95s/it] 91%|█████████ | 1788/1965 [1:07:21<05:48,  1.97s/it] 91%|█████████ | 1789/1965 [1:07:23<05:35,  1.91s/it] 91%|█████████ | 1790/1965 [1:07:25<05:34,  1.91s/it]                                                      91%|█████████ | 1790/1965 [1:07:25<05:34,  1.91s/it] 91%|█████████ | 1791/1965 [1:07:26<05:28,  1.89s/it] 91%|█████████ | 1792/1965 [1:07:28<05:20,  1.85s/it] 91%|█████████ | 1793/1965 [1:07:30<05:23,  1.88s/it] 91%|█████████▏| 1794/1965 [1:07:32<05:31,  1.94s/it] 91%|█████████▏| 1795/1965 [1:07:34<05:38,  1.99s/it] 91%|█████████▏| 1796/1965 [1:07:36<05:32,  1.97s/it] 91%|█████████▏| 1797/1965 [1:07:38<05:18,  1.90s/it] 92%|█████████▏| 1798/1965 [1:07:40<05:12,  1.87s/it] 92%|█████████▏| 1799/1965 [1:07:42<05:12,  1.88s/it] 92%|█████████▏| 1800/1965 [1:07:44<05:13,  1.90s/it]                                                      92%|█████████▏| 1800/1965 [1:07:44<05:13,  1.90s/it][INFO|trainer.py:4021] 2024-11-05 06:27:40,756 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:27:40,756 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:27:40,756 >>   Batch size = 2
{'eval_loss': 0.3306325376033783, 'eval_runtime': 24.027, 'eval_samples_per_second': 29.134, 'eval_steps_per_second': 14.567, 'epoch': 4.32}
{'loss': 0.2572, 'grad_norm': 0.3199309706687927, 'learning_rate': 2.775076871450789e-06, 'epoch': 4.34}
{'loss': 0.2877, 'grad_norm': 1.089165210723877, 'learning_rate': 2.5650750272056566e-06, 'epoch': 4.37}
{'loss': 0.3005, 'grad_norm': 0.8073526620864868, 'learning_rate': 2.3629460308877348e-06, 'epoch': 4.39}
{'loss': 0.2415, 'grad_norm': 1.2638280391693115, 'learning_rate': 2.1687537018528677e-06, 'epoch': 4.42}
{'loss': 0.2791, 'grad_norm': 0.8802748918533325, 'learning_rate': 1.9825593535670705e-06, 'epoch': 4.44}
{'loss': 0.2973, 'grad_norm': 1.3808128833770752, 'learning_rate': 1.804421774247701e-06, 'epoch': 4.47}
{'loss': 0.276, 'grad_norm': 3.763278007507324, 'learning_rate': 1.6343972083018904e-06, 'epoch': 4.5}
{'loss': 0.3079, 'grad_norm': 1.1779481172561646, 'learning_rate': 1.472539338568194e-06, 'epoch': 4.52}
{'loss': 0.29, 'grad_norm': 0.9526929259300232, 'learning_rate': 1.318899269366984e-06, 'epoch': 4.55}
{'loss': 0.2868, 'grad_norm': 1.4867334365844727, 'learning_rate': 1.1735255103649878e-06, 'epoch': 4.57}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.45it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.42it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.48it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.94it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.38it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.07it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.82it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.19it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.82it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.93it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.96it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.37it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.47it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.51it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.95it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.44it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.37it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.26it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.31it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.54it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.89it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.07it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.78it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.31it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.47it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.18it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.81it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.91it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.45it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.36it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.97it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.42it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.20it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.92it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.16it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.37it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.12it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.17it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.73it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.92it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.63it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.40it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.93it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.49it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.39it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.37it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.41it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.47it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.46it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.36it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.09it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.42it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.22it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.64it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.60it/s][A
 52%|█████▏    | 181/350 [00:12<00:11, 15.36it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.43it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.87it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.41it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.06it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.84it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.76it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.10it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.57it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.86it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.07it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.34it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.28it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.63it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.44it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.16it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.82it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.49it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.04it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.42it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.81it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.35it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.00it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.85it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.23it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.14it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.20it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 11.99it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.92it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.12it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.57it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.93it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.93it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.11it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.79it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.97it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 17.99it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.23it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.21it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.94it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.56it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.24it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.41it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.39it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.41it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.08it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.86it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.06it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.80it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.08it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.10it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.18it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.29it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                     
                                                 [A 92%|█████████▏| 1800/1965 [1:08:08<05:13,  1.90s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:28:04,793 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1800
[INFO|configuration_utils.py:673] 2024-11-05 06:28:04,813 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:28:04,814 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:28:04,917 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:28:04,917 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1800/special_tokens_map.json
 92%|█████████▏| 1801/1965 [1:08:10<25:33,  9.35s/it] 92%|█████████▏| 1802/1965 [1:08:12<19:27,  7.16s/it] 92%|█████████▏| 1803/1965 [1:08:14<14:59,  5.55s/it] 92%|█████████▏| 1804/1965 [1:08:16<12:00,  4.48s/it] 92%|█████████▏| 1805/1965 [1:08:18<09:56,  3.73s/it] 92%|█████████▏| 1806/1965 [1:08:20<08:28,  3.20s/it] 92%|█████████▏| 1807/1965 [1:08:22<07:22,  2.80s/it] 92%|█████████▏| 1808/1965 [1:08:24<06:58,  2.66s/it] 92%|█████████▏| 1809/1965 [1:08:27<06:34,  2.53s/it] 92%|█████████▏| 1810/1965 [1:08:29<06:04,  2.35s/it]                                                      92%|█████████▏| 1810/1965 [1:08:29<06:04,  2.35s/it] 92%|█████████▏| 1811/1965 [1:08:31<06:00,  2.34s/it] 92%|█████████▏| 1812/1965 [1:08:33<05:49,  2.28s/it] 92%|█████████▏| 1813/1965 [1:08:35<05:24,  2.13s/it] 92%|█████████▏| 1814/1965 [1:08:37<05:08,  2.04s/it] 92%|█████████▏| 1815/1965 [1:08:39<05:09,  2.07s/it] 92%|█████████▏| 1816/1965 [1:08:41<05:12,  2.10s/it] 92%|█████████▏| 1817/1965 [1:08:43<05:04,  2.06s/it] 93%|█████████▎| 1818/1965 [1:08:45<05:00,  2.05s/it] 93%|█████████▎| 1819/1965 [1:08:47<04:52,  2.00s/it] 93%|█████████▎| 1820/1965 [1:08:49<04:48,  1.99s/it]                                                      93%|█████████▎| 1820/1965 [1:08:49<04:48,  1.99s/it] 93%|█████████▎| 1821/1965 [1:08:51<04:39,  1.94s/it] 93%|█████████▎| 1822/1965 [1:08:53<04:48,  2.02s/it] 93%|█████████▎| 1823/1965 [1:08:55<04:56,  2.09s/it] 93%|█████████▎| 1824/1965 [1:08:57<04:59,  2.12s/it] 93%|█████████▎| 1825/1965 [1:08:59<04:56,  2.12s/it] 93%|█████████▎| 1826/1965 [1:09:01<04:45,  2.06s/it] 93%|█████████▎| 1827/1965 [1:09:03<04:40,  2.03s/it] 93%|█████████▎| 1828/1965 [1:09:05<04:48,  2.10s/it] 93%|█████████▎| 1829/1965 [1:09:08<04:47,  2.12s/it] 93%|█████████▎| 1830/1965 [1:09:10<04:37,  2.06s/it]                                                      93%|█████████▎| 1830/1965 [1:09:10<04:37,  2.06s/it] 93%|█████████▎| 1831/1965 [1:09:12<04:32,  2.03s/it] 93%|█████████▎| 1832/1965 [1:09:14<04:31,  2.04s/it] 93%|█████████▎| 1833/1965 [1:09:16<04:24,  2.00s/it] 93%|█████████▎| 1834/1965 [1:09:17<04:19,  1.98s/it] 93%|█████████▎| 1835/1965 [1:09:19<04:14,  1.96s/it] 93%|█████████▎| 1836/1965 [1:09:22<04:21,  2.03s/it] 93%|█████████▎| 1837/1965 [1:09:24<04:17,  2.01s/it] 94%|█████████▎| 1838/1965 [1:09:25<04:06,  1.94s/it] 94%|█████████▎| 1839/1965 [1:09:27<04:14,  2.02s/it] 94%|█████████▎| 1840/1965 [1:09:29<04:10,  2.00s/it]                                                      94%|█████████▎| 1840/1965 [1:09:29<04:10,  2.00s/it] 94%|█████████▎| 1841/1965 [1:09:31<04:07,  2.00s/it] 94%|█████████▎| 1842/1965 [1:09:34<04:20,  2.12s/it] 94%|█████████▍| 1843/1965 [1:09:36<04:17,  2.11s/it] 94%|█████████▍| 1844/1965 [1:09:38<04:12,  2.08s/it] 94%|█████████▍| 1845/1965 [1:09:40<04:21,  2.18s/it] 94%|█████████▍| 1846/1965 [1:09:42<04:13,  2.13s/it] 94%|█████████▍| 1847/1965 [1:09:44<04:07,  2.09s/it] 94%|█████████▍| 1848/1965 [1:09:47<04:18,  2.21s/it] 94%|█████████▍| 1849/1965 [1:09:49<04:08,  2.14s/it] 94%|█████████▍| 1850/1965 [1:09:51<03:57,  2.07s/it]                                                      94%|█████████▍| 1850/1965 [1:09:51<03:57,  2.07s/it] 94%|█████████▍| 1851/1965 [1:09:53<04:04,  2.14s/it] 94%|█████████▍| 1852/1965 [1:09:55<04:03,  2.16s/it] 94%|█████████▍| 1853/1965 [1:09:57<03:58,  2.13s/it] 94%|█████████▍| 1854/1965 [1:09:59<03:46,  2.04s/it] 94%|█████████▍| 1855/1965 [1:10:01<03:43,  2.04s/it] 94%|█████████▍| 1856/1965 [1:10:03<03:33,  1.96s/it] 95%|█████████▍| 1857/1965 [1:10:05<03:30,  1.95s/it] 95%|█████████▍| 1858/1965 [1:10:07<03:22,  1.90s/it] 95%|█████████▍| 1859/1965 [1:10:08<03:18,  1.87s/it] 95%|█████████▍| 1860/1965 [1:10:11<03:23,  1.94s/it]                                                      95%|█████████▍| 1860/1965 [1:10:11<03:23,  1.94s/it] 95%|█████████▍| 1861/1965 [1:10:12<03:19,  1.92s/it] 95%|█████████▍| 1862/1965 [1:10:15<03:25,  1.99s/it] 95%|█████████▍| 1863/1965 [1:10:17<03:30,  2.06s/it] 95%|█████████▍| 1864/1965 [1:10:19<03:35,  2.13s/it] 95%|█████████▍| 1865/1965 [1:10:21<03:28,  2.08s/it] 95%|█████████▍| 1866/1965 [1:10:23<03:25,  2.07s/it] 95%|█████████▌| 1867/1965 [1:10:25<03:19,  2.03s/it] 95%|█████████▌| 1868/1965 [1:10:27<03:18,  2.05s/it] 95%|█████████▌| 1869/1965 [1:10:29<03:12,  2.00s/it] 95%|█████████▌| 1870/1965 [1:10:31<03:03,  1.93s/it]                                                      95%|█████████▌| 1870/1965 [1:10:31<03:03,  1.93s/it] 95%|█████████▌| 1871/1965 [1:10:33<03:02,  1.94s/it] 95%|█████████▌| 1872/1965 [1:10:35<02:58,  1.92s/it] 95%|█████████▌| 1873/1965 [1:10:37<02:57,  1.92s/it] 95%|█████████▌| 1874/1965 [1:10:39<02:58,  1.96s/it] 95%|█████████▌| 1875/1965 [1:10:40<02:50,  1.90s/it] 95%|█████████▌| 1876/1965 [1:10:42<02:51,  1.93s/it] 96%|█████████▌| 1877/1965 [1:10:45<02:56,  2.01s/it] 96%|█████████▌| 1878/1965 [1:10:47<02:52,  1.99s/it] 96%|█████████▌| 1879/1965 [1:10:49<02:51,  2.00s/it] 96%|█████████▌| 1880/1965 [1:10:51<02:59,  2.11s/it]                                                      96%|█████████▌| 1880/1965 [1:10:51<02:59,  2.11s/it] 96%|█████████▌| 1881/1965 [1:10:53<02:53,  2.07s/it] 96%|█████████▌| 1882/1965 [1:10:55<02:56,  2.13s/it] 96%|█████████▌| 1883/1965 [1:10:57<02:45,  2.01s/it] 96%|█████████▌| 1884/1965 [1:10:59<02:38,  1.96s/it] 96%|█████████▌| 1885/1965 [1:11:01<02:35,  1.95s/it] 96%|█████████▌| 1886/1965 [1:11:02<02:31,  1.92s/it] 96%|█████████▌| 1887/1965 [1:11:05<02:45,  2.12s/it] 96%|█████████▌| 1888/1965 [1:11:07<02:44,  2.14s/it] 96%|█████████▌| 1889/1965 [1:11:09<02:33,  2.03s/it] 96%|█████████▌| 1890/1965 [1:11:11<02:37,  2.10s/it]                                                      96%|█████████▌| 1890/1965 [1:11:11<02:37,  2.10s/it] 96%|█████████▌| 1891/1965 [1:11:13<02:29,  2.02s/it] 96%|█████████▋| 1892/1965 [1:11:15<02:33,  2.10s/it] 96%|█████████▋| 1893/1965 [1:11:18<02:33,  2.13s/it] 96%|█████████▋| 1894/1965 [1:11:20<02:30,  2.13s/it] 96%|█████████▋| 1895/1965 [1:11:22<02:24,  2.07s/it] 96%|█████████▋| 1896/1965 [1:11:23<02:14,  1.96s/it] 97%|█████████▋| 1897/1965 [1:11:26<02:16,  2.01s/it] 97%|█████████▋| 1898/1965 [1:11:28<02:16,  2.04s/it] 97%|█████████▋| 1899/1965 [1:11:30<02:16,  2.07s/it] 97%|█████████▋| 1900/1965 [1:11:32<02:12,  2.03s/it]                                                      97%|█████████▋| 1900/1965 [1:11:32<02:12,  2.03s/it][INFO|trainer.py:4021] 2024-11-05 06:31:28,786 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:31:28,786 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:31:28,786 >>   Batch size = 2
{'eval_loss': 0.33040574193000793, 'eval_runtime': 24.036, 'eval_samples_per_second': 29.123, 'eval_steps_per_second': 14.561, 'epoch': 4.57}
{'loss': 0.2782, 'grad_norm': 1.1814886331558228, 'learning_rate': 1.036463961259051e-06, 'epoch': 4.6}
{'loss': 0.2698, 'grad_norm': 1.2887221574783325, 'learning_rate': 9.07757897283977e-07, 'epoch': 4.62}
{'loss': 0.2681, 'grad_norm': 0.8152891993522644, 'learning_rate': 7.874479555489533e-07, 'epoch': 4.65}
{'loss': 0.2703, 'grad_norm': 0.7888217568397522, 'learning_rate': 6.755721222070075e-07, 'epoch': 4.67}
{'loss': 0.2829, 'grad_norm': 0.8536162972450256, 'learning_rate': 5.721657204613673e-07, 'epoch': 4.7}
{'loss': 0.2983, 'grad_norm': 1.0239269733428955, 'learning_rate': 4.772613994127162e-07, 'epoch': 4.72}
{'loss': 0.2667, 'grad_norm': 1.0973210334777832, 'learning_rate': 3.908891237506548e-07, 'epoch': 4.75}
{'loss': 0.284, 'grad_norm': 0.9746098518371582, 'learning_rate': 3.130761642928115e-07, 'epoch': 4.77}
{'loss': 0.2794, 'grad_norm': 0.8769186735153198, 'learning_rate': 2.438470893744488e-07, 'epoch': 4.8}
{'loss': 0.2605, 'grad_norm': 1.3340106010437012, 'learning_rate': 1.8322375709137584e-07, 'epoch': 4.83}

  0%|          | 0/350 [00:00<?, ?it/s][A
  1%|          | 3/350 [00:00<00:17, 19.48it/s][A
  1%|▏         | 5/350 [00:00<00:17, 19.42it/s][A
  2%|▏         | 7/350 [00:00<00:18, 18.48it/s][A
  3%|▎         | 9/350 [00:00<00:24, 13.93it/s][A
  3%|▎         | 12/350 [00:00<00:21, 15.38it/s][A
  4%|▍         | 14/350 [00:00<00:20, 16.25it/s][A
  5%|▍         | 16/350 [00:00<00:20, 16.08it/s][A
  5%|▌         | 18/350 [00:01<00:19, 16.83it/s][A
  6%|▌         | 20/350 [00:01<00:21, 15.19it/s][A
  6%|▋         | 22/350 [00:01<00:20, 15.82it/s][A
  7%|▋         | 24/350 [00:01<00:20, 15.93it/s][A
  7%|▋         | 26/350 [00:01<00:21, 14.97it/s][A
  8%|▊         | 28/350 [00:01<00:20, 15.40it/s][A
  9%|▊         | 30/350 [00:01<00:20, 15.49it/s][A
  9%|▉         | 32/350 [00:02<00:21, 14.52it/s][A
 10%|▉         | 34/350 [00:02<00:25, 12.59it/s][A
 10%|█         | 36/350 [00:02<00:27, 11.29it/s][A
 11%|█         | 38/350 [00:02<00:28, 10.97it/s][A
 12%|█▏        | 41/350 [00:02<00:22, 13.46it/s][A
 13%|█▎        | 44/350 [00:02<00:19, 15.38it/s][A
 13%|█▎        | 46/350 [00:03<00:19, 15.27it/s][A
 14%|█▎        | 48/350 [00:03<00:22, 13.32it/s][A
 14%|█▍        | 50/350 [00:03<00:20, 14.49it/s][A
 15%|█▍        | 52/350 [00:03<00:19, 15.53it/s][A
 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s][A
 16%|█▌        | 56/350 [00:03<00:17, 16.50it/s][A
 17%|█▋        | 58/350 [00:03<00:18, 16.16it/s][A
 17%|█▋        | 60/350 [00:04<00:19, 14.90it/s][A
 18%|█▊        | 62/350 [00:04<00:21, 13.15it/s][A
 18%|█▊        | 64/350 [00:04<00:19, 14.31it/s][A
 19%|█▉        | 66/350 [00:04<00:18, 15.06it/s][A
 19%|█▉        | 68/350 [00:04<00:22, 12.77it/s][A
 20%|██        | 70/350 [00:04<00:20, 13.69it/s][A
 21%|██        | 72/350 [00:04<00:20, 13.61it/s][A
 21%|██        | 74/350 [00:05<00:19, 14.31it/s][A
 22%|██▏       | 77/350 [00:05<00:19, 14.31it/s][A
 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s][A
 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s][A
 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s][A
 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s][A
 25%|██▌       | 88/350 [00:05<00:16, 15.96it/s][A
 26%|██▌       | 90/350 [00:06<00:16, 16.17it/s][A
 26%|██▋       | 92/350 [00:06<00:15, 16.79it/s][A
 27%|██▋       | 94/350 [00:06<00:14, 17.23it/s][A
 27%|██▋       | 96/350 [00:06<00:14, 17.11it/s][A
 28%|██▊       | 98/350 [00:06<00:15, 15.75it/s][A
 29%|██▊       | 100/350 [00:06<00:15, 15.89it/s][A
 29%|██▉       | 102/350 [00:06<00:16, 15.43it/s][A
 30%|██▉       | 104/350 [00:06<00:18, 13.35it/s][A
 30%|███       | 106/350 [00:07<00:17, 13.96it/s][A
 31%|███       | 108/350 [00:07<00:16, 14.41it/s][A
 31%|███▏      | 110/350 [00:07<00:19, 12.52it/s][A
 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s][A
 33%|███▎      | 115/350 [00:07<00:16, 13.92it/s][A
 33%|███▎      | 117/350 [00:07<00:16, 14.45it/s][A
 34%|███▍      | 119/350 [00:08<00:17, 13.15it/s][A
 35%|███▍      | 121/350 [00:08<00:18, 12.43it/s][A
 35%|███▌      | 123/350 [00:08<00:16, 13.39it/s][A
 36%|███▌      | 125/350 [00:08<00:15, 14.13it/s][A
 36%|███▋      | 127/350 [00:08<00:14, 15.19it/s][A
 37%|███▋      | 129/350 [00:08<00:14, 15.75it/s][A
 37%|███▋      | 131/350 [00:08<00:13, 15.93it/s][A
 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s][A
 39%|███▊      | 135/350 [00:09<00:12, 17.42it/s][A
 39%|███▉      | 137/350 [00:09<00:12, 16.93it/s][A
 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s][A
 41%|████      | 142/350 [00:09<00:11, 18.40it/s][A
 41%|████      | 144/350 [00:09<00:13, 15.37it/s][A
 42%|████▏     | 146/350 [00:09<00:14, 14.42it/s][A
 42%|████▏     | 148/350 [00:09<00:13, 15.46it/s][A
 43%|████▎     | 150/350 [00:10<00:12, 15.45it/s][A
 43%|████▎     | 152/350 [00:10<00:13, 14.35it/s][A
 44%|████▍     | 154/350 [00:10<00:15, 12.64it/s][A
 45%|████▍     | 156/350 [00:10<00:16, 12.08it/s][A
 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s][A
 46%|████▌     | 160/350 [00:10<00:16, 11.29it/s][A
 46%|████▋     | 162/350 [00:11<00:16, 11.43it/s][A
 47%|████▋     | 165/350 [00:11<00:13, 13.80it/s][A
 48%|████▊     | 167/350 [00:11<00:12, 14.21it/s][A
 48%|████▊     | 169/350 [00:11<00:13, 13.36it/s][A
 49%|████▉     | 171/350 [00:11<00:13, 13.55it/s][A
 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s][A
 50%|█████     | 175/350 [00:11<00:11, 14.64it/s][A
 51%|█████     | 177/350 [00:12<00:12, 13.42it/s][A
 51%|█████     | 179/350 [00:12<00:11, 14.62it/s][A
 52%|█████▏    | 181/350 [00:12<00:10, 15.38it/s][A
 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s][A
 53%|█████▎    | 185/350 [00:12<00:11, 14.88it/s][A
 53%|█████▎    | 187/350 [00:12<00:11, 14.42it/s][A
 54%|█████▍    | 190/350 [00:12<00:09, 16.05it/s][A
 55%|█████▍    | 192/350 [00:13<00:10, 14.83it/s][A
 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s][A
 56%|█████▌    | 196/350 [00:13<00:13, 11.08it/s][A
 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s][A
 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s][A
 58%|█████▊    | 202/350 [00:14<00:11, 13.05it/s][A
 58%|█████▊    | 204/350 [00:14<00:10, 13.32it/s][A
 59%|█████▉    | 207/350 [00:14<00:09, 15.26it/s][A
 60%|█████▉    | 209/350 [00:14<00:09, 15.63it/s][A
 60%|██████    | 211/350 [00:14<00:08, 16.44it/s][A
 61%|██████    | 213/350 [00:14<00:07, 17.14it/s][A
 61%|██████▏   | 215/350 [00:14<00:09, 14.81it/s][A
 62%|██████▏   | 217/350 [00:14<00:08, 15.50it/s][A
 63%|██████▎   | 219/350 [00:15<00:08, 15.05it/s][A
 63%|██████▎   | 221/350 [00:15<00:08, 15.42it/s][A
 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s][A
 64%|██████▍   | 225/350 [00:15<00:07, 15.80it/s][A
 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s][A
 65%|██████▌   | 229/350 [00:15<00:08, 14.36it/s][A
 66%|██████▌   | 231/350 [00:15<00:08, 14.03it/s][A
 67%|██████▋   | 233/350 [00:16<00:08, 14.61it/s][A
 67%|██████▋   | 235/350 [00:16<00:07, 15.87it/s][A
 68%|██████▊   | 237/350 [00:16<00:07, 15.23it/s][A
 68%|██████▊   | 239/350 [00:16<00:08, 12.68it/s][A
 69%|██████▉   | 241/350 [00:16<00:09, 11.58it/s][A
 69%|██████▉   | 243/350 [00:16<00:08, 13.14it/s][A
 70%|███████   | 245/350 [00:16<00:08, 12.14it/s][A
 71%|███████   | 248/350 [00:17<00:08, 12.21it/s][A
 71%|███████▏  | 250/350 [00:17<00:08, 12.00it/s][A
 72%|███████▏  | 252/350 [00:17<00:07, 12.92it/s][A
 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s][A
 73%|███████▎  | 256/350 [00:17<00:07, 12.09it/s][A
 74%|███████▎  | 258/350 [00:18<00:07, 12.58it/s][A
 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s][A
 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s][A
 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s][A
 76%|███████▋  | 267/350 [00:18<00:05, 15.92it/s][A
 77%|███████▋  | 270/350 [00:18<00:04, 17.08it/s][A
 78%|███████▊  | 272/350 [00:18<00:04, 16.77it/s][A
 79%|███████▊  | 275/350 [00:19<00:04, 17.96it/s][A
 79%|███████▉  | 277/350 [00:19<00:04, 17.99it/s][A
 80%|███████▉  | 279/350 [00:19<00:04, 17.22it/s][A
 80%|████████  | 281/350 [00:19<00:04, 14.20it/s][A
 81%|████████  | 283/350 [00:19<00:04, 14.92it/s][A
 81%|████████▏ | 285/350 [00:19<00:04, 13.92it/s][A
 82%|████████▏ | 287/350 [00:19<00:04, 14.55it/s][A
 83%|████████▎ | 289/350 [00:19<00:04, 15.24it/s][A
 83%|████████▎ | 292/350 [00:20<00:03, 16.03it/s][A
 84%|████████▍ | 294/350 [00:20<00:03, 14.98it/s][A
 85%|████████▍ | 297/350 [00:20<00:03, 15.83it/s][A
 85%|████████▌ | 299/350 [00:20<00:03, 15.76it/s][A
 86%|████████▌ | 301/350 [00:20<00:03, 15.69it/s][A
 87%|████████▋ | 303/350 [00:20<00:02, 16.41it/s][A
 87%|████████▋ | 305/350 [00:20<00:02, 16.65it/s][A
 88%|████████▊ | 307/350 [00:21<00:02, 16.50it/s][A
 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s][A
 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s][A
 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s][A
 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s][A
 91%|█████████ | 317/350 [00:21<00:02, 15.40it/s][A
 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s][A
 92%|█████████▏| 321/350 [00:21<00:01, 16.07it/s][A
 92%|█████████▏| 323/350 [00:22<00:01, 16.85it/s][A
 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s][A
 93%|█████████▎| 327/350 [00:22<00:01, 14.79it/s][A
 94%|█████████▍| 329/350 [00:22<00:01, 15.09it/s][A
 95%|█████████▍| 331/350 [00:22<00:01, 15.27it/s][A
 95%|█████████▌| 333/350 [00:22<00:01, 16.34it/s][A
 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s][A
 96%|█████████▋| 337/350 [00:23<00:00, 15.59it/s][A
 97%|█████████▋| 339/350 [00:23<00:00, 14.17it/s][A
 97%|█████████▋| 341/350 [00:23<00:00, 12.86it/s][A
 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s][A
 99%|█████████▉| 346/350 [00:23<00:00, 13.32it/s][A
 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s][A                                                     
                                                 [A 97%|█████████▋| 1900/1965 [1:11:56<02:12,  2.03s/it]
100%|██████████| 350/350 [00:23<00:00, 13.29it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-05 06:31:52,822 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1900
[INFO|configuration_utils.py:673] 2024-11-05 06:31:52,843 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:31:52,844 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:31:52,957 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:31:52,958 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1900/special_tokens_map.json
 97%|█████████▋| 1901/1965 [1:11:58<09:56,  9.32s/it] 97%|█████████▋| 1902/1965 [1:12:00<07:30,  7.15s/it] 97%|█████████▋| 1903/1965 [1:12:02<05:48,  5.62s/it] 97%|█████████▋| 1904/1965 [1:12:04<04:36,  4.54s/it] 97%|█████████▋| 1905/1965 [1:12:06<03:49,  3.82s/it] 97%|█████████▋| 1906/1965 [1:12:09<03:17,  3.35s/it] 97%|█████████▋| 1907/1965 [1:12:10<02:45,  2.86s/it] 97%|█████████▋| 1908/1965 [1:12:12<02:29,  2.62s/it] 97%|█████████▋| 1909/1965 [1:12:14<02:17,  2.45s/it] 97%|█████████▋| 1910/1965 [1:12:16<02:04,  2.26s/it]                                                      97%|█████████▋| 1910/1965 [1:12:16<02:04,  2.26s/it] 97%|█████████▋| 1911/1965 [1:12:18<01:53,  2.11s/it] 97%|█████████▋| 1912/1965 [1:12:20<01:51,  2.10s/it] 97%|█████████▋| 1913/1965 [1:12:22<01:48,  2.09s/it] 97%|█████████▋| 1914/1965 [1:12:24<01:44,  2.05s/it] 97%|█████████▋| 1915/1965 [1:12:26<01:38,  1.96s/it] 98%|█████████▊| 1916/1965 [1:12:28<01:36,  1.96s/it] 98%|█████████▊| 1917/1965 [1:12:30<01:37,  2.03s/it] 98%|█████████▊| 1918/1965 [1:12:32<01:35,  2.03s/it] 98%|█████████▊| 1919/1965 [1:12:34<01:33,  2.03s/it] 98%|█████████▊| 1920/1965 [1:12:36<01:27,  1.93s/it]                                                      98%|█████████▊| 1920/1965 [1:12:36<01:27,  1.93s/it] 98%|█████████▊| 1921/1965 [1:12:38<01:22,  1.88s/it] 98%|█████████▊| 1922/1965 [1:12:40<01:22,  1.92s/it] 98%|█████████▊| 1923/1965 [1:12:42<01:22,  1.97s/it] 98%|█████████▊| 1924/1965 [1:12:44<01:20,  1.95s/it] 98%|█████████▊| 1925/1965 [1:12:45<01:18,  1.95s/it] 98%|█████████▊| 1926/1965 [1:12:47<01:14,  1.91s/it] 98%|█████████▊| 1927/1965 [1:12:49<01:14,  1.96s/it] 98%|█████████▊| 1928/1965 [1:12:51<01:14,  2.01s/it] 98%|█████████▊| 1929/1965 [1:12:54<01:15,  2.11s/it] 98%|█████████▊| 1930/1965 [1:12:56<01:15,  2.16s/it]                                                      98%|█████████▊| 1930/1965 [1:12:56<01:15,  2.16s/it] 98%|█████████▊| 1931/1965 [1:12:58<01:09,  2.04s/it] 98%|█████████▊| 1932/1965 [1:13:00<01:07,  2.05s/it] 98%|█████████▊| 1933/1965 [1:13:02<01:04,  2.01s/it] 98%|█████████▊| 1934/1965 [1:13:04<01:02,  2.02s/it] 98%|█████████▊| 1935/1965 [1:13:06<01:03,  2.12s/it] 99%|█████████▊| 1936/1965 [1:13:08<00:58,  2.02s/it] 99%|█████████▊| 1937/1965 [1:13:10<00:55,  1.99s/it] 99%|█████████▊| 1938/1965 [1:13:12<00:56,  2.10s/it] 99%|█████████▊| 1939/1965 [1:13:14<00:53,  2.04s/it] 99%|█████████▊| 1940/1965 [1:13:16<00:52,  2.09s/it]                                                      99%|█████████▊| 1940/1965 [1:13:16<00:52,  2.09s/it] 99%|█████████▉| 1941/1965 [1:13:19<00:50,  2.11s/it] 99%|█████████▉| 1942/1965 [1:13:20<00:46,  2.02s/it] 99%|█████████▉| 1943/1965 [1:13:23<00:46,  2.10s/it] 99%|█████████▉| 1944/1965 [1:13:25<00:44,  2.10s/it] 99%|█████████▉| 1945/1965 [1:13:27<00:41,  2.09s/it] 99%|█████████▉| 1946/1965 [1:13:29<00:37,  1.99s/it] 99%|█████████▉| 1947/1965 [1:13:30<00:35,  1.95s/it] 99%|█████████▉| 1948/1965 [1:13:32<00:32,  1.88s/it] 99%|█████████▉| 1949/1965 [1:13:34<00:30,  1.91s/it] 99%|█████████▉| 1950/1965 [1:13:36<00:29,  1.98s/it]                                                      99%|█████████▉| 1950/1965 [1:13:36<00:29,  1.98s/it] 99%|█████████▉| 1951/1965 [1:13:38<00:28,  2.04s/it] 99%|█████████▉| 1952/1965 [1:13:41<00:26,  2.05s/it] 99%|█████████▉| 1953/1965 [1:13:42<00:23,  1.99s/it] 99%|█████████▉| 1954/1965 [1:13:44<00:22,  2.01s/it] 99%|█████████▉| 1955/1965 [1:13:46<00:19,  1.95s/it]100%|█████████▉| 1956/1965 [1:13:48<00:16,  1.88s/it]100%|█████████▉| 1957/1965 [1:13:50<00:14,  1.85s/it]100%|█████████▉| 1958/1965 [1:13:52<00:12,  1.82s/it]100%|█████████▉| 1959/1965 [1:13:53<00:11,  1.85s/it]100%|█████████▉| 1960/1965 [1:13:55<00:09,  1.89s/it]                                                     100%|█████████▉| 1960/1965 [1:13:55<00:09,  1.89s/it]100%|█████████▉| 1961/1965 [1:13:58<00:07,  1.95s/it]100%|█████████▉| 1962/1965 [1:13:59<00:05,  1.92s/it]100%|█████████▉| 1963/1965 [1:14:02<00:04,  2.06s/it]100%|█████████▉| 1964/1965 [1:14:04<00:02,  2.00s/it]100%|██████████| 1965/1965 [1:14:05<00:00,  1.94s/it][INFO|trainer.py:3705] 2024-11-05 06:34:02,479 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1965
[INFO|configuration_utils.py:673] 2024-11-05 06:34:02,499 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:34:02,499 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:34:02,605 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1965/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:34:02,605 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/checkpoint-1965/special_tokens_map.json
[INFO|trainer.py:2505] 2024-11-05 06:34:02,949 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                     100%|██████████| 1965/1965 [1:14:06<00:00,  1.94s/it]100%|██████████| 1965/1965 [1:14:06<00:00,  2.26s/it]
[INFO|trainer.py:3705] 2024-11-05 06:34:02,950 >> Saving model checkpoint to ../Models/llama3B/f32/C3_train_1_hop
[INFO|configuration_utils.py:673] 2024-11-05 06:34:02,969 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-05 06:34:02,970 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-05 06:34:03,061 >> tokenizer config file saved in ../Models/llama3B/f32/C3_train_1_hop/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-05 06:34:03,061 >> Special tokens file saved in ../Models/llama3B/f32/C3_train_1_hop/special_tokens_map.json
{'eval_loss': 0.32973456382751465, 'eval_runtime': 24.0359, 'eval_samples_per_second': 29.123, 'eval_steps_per_second': 14.562, 'epoch': 4.83}
{'loss': 0.2732, 'grad_norm': 1.1995054483413696, 'learning_rate': 1.3122530839855983e-07, 'epoch': 4.85}
{'loss': 0.2546, 'grad_norm': 1.5755423307418823, 'learning_rate': 8.786816106662543e-08, 'epoch': 4.88}
{'loss': 0.2693, 'grad_norm': 0.8170889019966125, 'learning_rate': 5.31660044982149e-08, 'epoch': 4.9}
{'loss': 0.2761, 'grad_norm': 0.8988003134727478, 'learning_rate': 2.712979540570787e-08, 'epoch': 4.93}
{'loss': 0.2638, 'grad_norm': 1.520663857460022, 'learning_rate': 9.767754351836244e-09, 'epoch': 4.95}
{'loss': 0.2391, 'grad_norm': 0.8774315714836121, 'learning_rate': 1.08536315413188e-09, 'epoch': 4.98}
{'train_runtime': 4446.3625, 'train_samples_per_second': 7.084, 'train_steps_per_second': 0.442, 'train_loss': 0.4157222838802192, 'epoch': 4.99}
***** train metrics *****
  epoch                    =      4.9905
  total_flos               = 199799927GF
  train_loss               =      0.4157
  train_runtime            =  1:14:06.36
  train_samples_per_second =       7.084
  train_steps_per_second   =       0.442
Figure saved at: ../Models/llama3B/f32/C3_train_1_hop/training_loss.png
Figure saved at: ../Models/llama3B/f32/C3_train_1_hop/training_eval_loss.png
11/05/2024 06:34:03 - WARNING - llamafactory.extras.ploting - No metric eval_accuracy to plot.
[INFO|trainer.py:4021] 2024-11-05 06:34:03,461 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-05 06:34:03,461 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-05 06:34:03,461 >>   Batch size = 2
  0%|          | 0/350 [00:00<?, ?it/s]  1%|          | 3/350 [00:00<00:17, 19.46it/s]  1%|▏         | 5/350 [00:00<00:17, 19.42it/s]  2%|▏         | 7/350 [00:00<00:18, 18.46it/s]  3%|▎         | 9/350 [00:00<00:24, 13.92it/s]  3%|▎         | 12/350 [00:00<00:22, 15.34it/s]  4%|▍         | 14/350 [00:00<00:20, 16.21it/s]  5%|▍         | 16/350 [00:00<00:20, 16.04it/s]  5%|▌         | 18/350 [00:01<00:19, 16.76it/s]  6%|▌         | 20/350 [00:01<00:21, 15.15it/s]  6%|▋         | 22/350 [00:01<00:20, 15.80it/s]  7%|▋         | 24/350 [00:01<00:20, 15.92it/s]  7%|▋         | 26/350 [00:01<00:21, 14.96it/s]  8%|▊         | 28/350 [00:01<00:20, 15.38it/s]  9%|▊         | 30/350 [00:01<00:20, 15.47it/s]  9%|▉         | 32/350 [00:02<00:21, 14.49it/s] 10%|▉         | 34/350 [00:02<00:25, 12.57it/s] 10%|█         | 36/350 [00:02<00:27, 11.25it/s] 11%|█         | 38/350 [00:02<00:28, 10.93it/s] 12%|█▏        | 41/350 [00:02<00:23, 13.43it/s] 13%|█▎        | 44/350 [00:02<00:19, 15.38it/s] 13%|█▎        | 46/350 [00:03<00:19, 15.26it/s] 14%|█▎        | 48/350 [00:03<00:22, 13.31it/s] 14%|█▍        | 50/350 [00:03<00:20, 14.48it/s] 15%|█▍        | 52/350 [00:03<00:19, 15.54it/s] 15%|█▌        | 54/350 [00:03<00:18, 15.75it/s] 16%|█▌        | 56/350 [00:03<00:17, 16.48it/s] 17%|█▋        | 58/350 [00:03<00:18, 16.15it/s] 17%|█▋        | 60/350 [00:04<00:19, 14.88it/s] 18%|█▊        | 62/350 [00:04<00:21, 13.14it/s] 18%|█▊        | 64/350 [00:04<00:20, 14.30it/s] 19%|█▉        | 66/350 [00:04<00:18, 15.05it/s] 19%|█▉        | 68/350 [00:04<00:22, 12.76it/s] 20%|██        | 70/350 [00:04<00:20, 13.67it/s] 21%|██        | 72/350 [00:04<00:20, 13.59it/s] 21%|██        | 74/350 [00:05<00:19, 14.31it/s] 22%|██▏       | 77/350 [00:05<00:19, 14.31it/s] 23%|██▎       | 79/350 [00:05<00:18, 14.55it/s] 23%|██▎       | 81/350 [00:05<00:17, 15.48it/s] 24%|██▎       | 83/350 [00:05<00:17, 15.66it/s] 25%|██▍       | 86/350 [00:05<00:16, 15.73it/s] 25%|██▌       | 88/350 [00:05<00:16, 15.97it/s] 26%|██▌       | 90/350 [00:06<00:16, 16.19it/s] 26%|██▋       | 92/350 [00:06<00:15, 16.81it/s] 27%|██▋       | 94/350 [00:06<00:14, 17.25it/s] 27%|██▋       | 96/350 [00:06<00:14, 17.14it/s] 28%|██▊       | 98/350 [00:06<00:15, 15.77it/s] 29%|██▊       | 100/350 [00:06<00:15, 15.90it/s] 29%|██▉       | 102/350 [00:06<00:16, 15.44it/s] 30%|██▉       | 104/350 [00:07<00:18, 13.36it/s] 30%|███       | 106/350 [00:07<00:17, 13.97it/s] 31%|███       | 108/350 [00:07<00:16, 14.43it/s] 31%|███▏      | 110/350 [00:07<00:19, 12.53it/s] 32%|███▏      | 112/350 [00:07<00:19, 12.21it/s] 33%|███▎      | 115/350 [00:07<00:16, 13.93it/s] 33%|███▎      | 117/350 [00:07<00:16, 14.47it/s] 34%|███▍      | 119/350 [00:08<00:17, 13.17it/s] 35%|███▍      | 121/350 [00:08<00:18, 12.45it/s] 35%|███▌      | 123/350 [00:08<00:16, 13.40it/s] 36%|███▌      | 125/350 [00:08<00:15, 14.15it/s] 36%|███▋      | 127/350 [00:08<00:14, 15.20it/s] 37%|███▋      | 129/350 [00:08<00:14, 15.77it/s] 37%|███▋      | 131/350 [00:08<00:13, 15.94it/s] 38%|███▊      | 133/350 [00:08<00:13, 16.66it/s] 39%|███▊      | 135/350 [00:09<00:12, 17.43it/s] 39%|███▉      | 137/350 [00:09<00:12, 16.95it/s] 40%|███▉      | 139/350 [00:09<00:12, 17.51it/s] 41%|████      | 142/350 [00:09<00:11, 18.42it/s] 41%|████      | 144/350 [00:09<00:13, 15.39it/s] 42%|████▏     | 146/350 [00:09<00:14, 14.43it/s] 42%|████▏     | 148/350 [00:09<00:13, 15.48it/s] 43%|████▎     | 150/350 [00:10<00:12, 15.48it/s] 43%|████▎     | 152/350 [00:10<00:13, 14.37it/s] 44%|████▍     | 154/350 [00:10<00:15, 12.65it/s] 45%|████▍     | 156/350 [00:10<00:16, 12.10it/s] 45%|████▌     | 158/350 [00:10<00:16, 11.98it/s] 46%|████▌     | 160/350 [00:10<00:16, 11.30it/s] 46%|████▋     | 162/350 [00:11<00:16, 11.44it/s] 47%|████▋     | 165/350 [00:11<00:13, 13.81it/s] 48%|████▊     | 167/350 [00:11<00:12, 14.23it/s] 48%|████▊     | 169/350 [00:11<00:13, 13.37it/s] 49%|████▉     | 171/350 [00:11<00:13, 13.56it/s] 49%|████▉     | 173/350 [00:11<00:12, 14.21it/s] 50%|█████     | 175/350 [00:11<00:11, 14.64it/s] 51%|█████     | 177/350 [00:12<00:12, 13.43it/s] 51%|█████     | 179/350 [00:12<00:11, 14.64it/s] 52%|█████▏    | 181/350 [00:12<00:10, 15.39it/s] 52%|█████▏    | 183/350 [00:12<00:12, 13.44it/s] 53%|█████▎    | 185/350 [00:12<00:11, 14.89it/s] 53%|█████▎    | 187/350 [00:12<00:11, 14.41it/s] 54%|█████▍    | 190/350 [00:12<00:09, 16.04it/s] 55%|█████▍    | 192/350 [00:13<00:10, 14.83it/s] 55%|█████▌    | 194/350 [00:13<00:12, 12.75it/s] 56%|█████▌    | 196/350 [00:13<00:13, 11.08it/s] 57%|█████▋    | 198/350 [00:13<00:12, 12.56it/s] 57%|█████▋    | 200/350 [00:13<00:12, 11.84it/s] 58%|█████▊    | 202/350 [00:14<00:11, 13.03it/s] 58%|█████▊    | 204/350 [00:14<00:10, 13.32it/s] 59%|█████▉    | 207/350 [00:14<00:09, 15.26it/s] 60%|█████▉    | 209/350 [00:14<00:09, 15.62it/s] 60%|██████    | 211/350 [00:14<00:08, 16.45it/s] 61%|██████    | 213/350 [00:14<00:07, 17.15it/s] 61%|██████▏   | 215/350 [00:14<00:09, 14.80it/s] 62%|██████▏   | 217/350 [00:14<00:08, 15.48it/s] 63%|██████▎   | 219/350 [00:15<00:08, 15.03it/s] 63%|██████▎   | 221/350 [00:15<00:08, 15.41it/s] 64%|██████▎   | 223/350 [00:15<00:08, 15.56it/s] 64%|██████▍   | 225/350 [00:15<00:07, 15.80it/s] 65%|██████▍   | 227/350 [00:15<00:07, 16.66it/s] 65%|██████▌   | 229/350 [00:15<00:08, 14.35it/s] 66%|██████▌   | 231/350 [00:15<00:08, 14.02it/s] 67%|██████▋   | 233/350 [00:16<00:08, 14.60it/s] 67%|██████▋   | 235/350 [00:16<00:07, 15.86it/s] 68%|██████▊   | 237/350 [00:16<00:07, 15.23it/s] 68%|██████▊   | 239/350 [00:16<00:08, 12.67it/s] 69%|██████▉   | 241/350 [00:16<00:09, 11.57it/s] 69%|██████▉   | 243/350 [00:16<00:08, 13.13it/s] 70%|███████   | 245/350 [00:16<00:08, 12.14it/s] 71%|███████   | 248/350 [00:17<00:08, 12.21it/s] 71%|███████▏  | 250/350 [00:17<00:08, 11.99it/s] 72%|███████▏  | 252/350 [00:17<00:07, 12.93it/s] 73%|███████▎  | 254/350 [00:17<00:08, 11.13it/s] 73%|███████▎  | 256/350 [00:17<00:07, 12.08it/s] 74%|███████▎  | 258/350 [00:18<00:07, 12.56it/s] 74%|███████▍  | 260/350 [00:18<00:06, 12.88it/s] 75%|███████▍  | 262/350 [00:18<00:06, 14.29it/s] 75%|███████▌  | 264/350 [00:18<00:05, 14.94it/s] 76%|███████▋  | 267/350 [00:18<00:05, 15.94it/s] 77%|███████▋  | 270/350 [00:18<00:04, 17.14it/s] 78%|███████▊  | 272/350 [00:18<00:04, 16.81it/s] 79%|███████▊  | 275/350 [00:19<00:04, 18.01it/s] 79%|███████▉  | 277/350 [00:19<00:04, 18.02it/s] 80%|███████▉  | 279/350 [00:19<00:04, 17.25it/s] 80%|████████  | 281/350 [00:19<00:04, 14.22it/s] 81%|████████  | 283/350 [00:19<00:04, 14.94it/s] 81%|████████▏ | 285/350 [00:19<00:04, 13.93it/s] 82%|████████▏ | 287/350 [00:19<00:04, 14.56it/s] 83%|████████▎ | 289/350 [00:19<00:04, 15.25it/s] 83%|████████▎ | 292/350 [00:20<00:03, 16.04it/s] 84%|████████▍ | 294/350 [00:20<00:03, 15.00it/s] 85%|████████▍ | 297/350 [00:20<00:03, 15.85it/s] 85%|████████▌ | 299/350 [00:20<00:03, 15.77it/s] 86%|████████▌ | 301/350 [00:20<00:03, 15.70it/s] 87%|████████▋ | 303/350 [00:20<00:02, 16.40it/s] 87%|████████▋ | 305/350 [00:20<00:02, 16.64it/s] 88%|████████▊ | 307/350 [00:21<00:02, 16.49it/s] 88%|████████▊ | 309/350 [00:21<00:02, 16.37it/s] 89%|████████▉ | 311/350 [00:21<00:02, 16.52it/s] 89%|████████▉ | 313/350 [00:21<00:02, 16.45it/s] 90%|█████████ | 315/350 [00:21<00:02, 14.40it/s] 91%|█████████ | 317/350 [00:21<00:02, 15.40it/s] 91%|█████████ | 319/350 [00:21<00:02, 14.99it/s] 92%|█████████▏| 321/350 [00:21<00:01, 16.08it/s] 92%|█████████▏| 323/350 [00:22<00:01, 16.84it/s] 93%|█████████▎| 325/350 [00:22<00:01, 14.04it/s] 93%|█████████▎| 327/350 [00:22<00:01, 14.78it/s] 94%|█████████▍| 329/350 [00:22<00:01, 15.08it/s] 95%|█████████▍| 331/350 [00:22<00:01, 15.26it/s] 95%|█████████▌| 333/350 [00:22<00:01, 16.33it/s] 96%|█████████▌| 335/350 [00:22<00:00, 17.12it/s] 96%|█████████▋| 337/350 [00:23<00:00, 15.60it/s] 97%|█████████▋| 339/350 [00:23<00:00, 14.19it/s] 97%|█████████▋| 341/350 [00:23<00:00, 12.87it/s] 98%|█████████▊| 344/350 [00:23<00:00, 14.28it/s] 99%|█████████▉| 346/350 [00:23<00:00, 13.31it/s] 99%|█████████▉| 348/350 [00:23<00:00, 13.29it/s]100%|██████████| 350/350 [00:23<00:00, 14.60it/s]
[INFO|modelcard.py:449] 2024-11-05 06:34:27,499 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     4.9905
  eval_loss               =     0.3298
  eval_runtime            = 0:00:24.03
  eval_samples_per_second =     29.123
  eval_steps_per_second   =     14.561
