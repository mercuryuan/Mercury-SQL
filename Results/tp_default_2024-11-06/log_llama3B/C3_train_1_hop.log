11/06/2024 04:47:03 - WARNING - llamafactory.hparams.parser - We recommend enable mixed precision training.
11/06/2024 04:47:03 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: None
[INFO|configuration_utils.py:673] 2024-11-06 04:47:03,258 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:47:03,260 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,261 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,261 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,261 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,261 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,261 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 04:47:03,658 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:673] 2024-11-06 04:47:03,659 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:47:03,659 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,660 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,660 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,660 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,660 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 04:47:03,660 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 04:47:04,026 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
11/06/2024 04:47:04 - WARNING - llamafactory.model.loader - Processor was not found: 'LlamaConfig' object has no attribute 'vision_config'.
11/06/2024 04:47:04 - INFO - llamafactory.data.template - Replace eos token: <|end_of_text|>
11/06/2024 04:47:04 - INFO - llamafactory.data.template - Add pad token: <|end_of_text|>
11/06/2024 04:47:04 - INFO - llamafactory.data.loader - Loading dataset ../../Training_Dataset/C3/train.json...
Converting format of dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  56%|█████▋    | 3941/7000 [00:00<00:00, 39087.96 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 7000/7000 [00:00<00:00, 35540.60 examples/s]
Running tokenizer on dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6%|▋         | 438/7000 [00:01<00:17, 371.32 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 876/7000 [00:01<00:07, 778.29 examples/s]Running tokenizer on dataset (num_proc=16):  19%|█▉        | 1314/7000 [00:01<00:04, 1184.77 examples/s]Running tokenizer on dataset (num_proc=16):  25%|██▌       | 1752/7000 [00:01<00:04, 1264.58 examples/s]Running tokenizer on dataset (num_proc=16):  38%|███▊      | 2628/7000 [00:02<00:02, 1858.02 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▍     | 3066/7000 [00:02<00:01, 2087.19 examples/s]Running tokenizer on dataset (num_proc=16):  50%|█████     | 3504/7000 [00:02<00:01, 2248.73 examples/s]Running tokenizer on dataset (num_proc=16):  56%|█████▋    | 3941/7000 [00:02<00:01, 2119.81 examples/s]Running tokenizer on dataset (num_proc=16):  69%|██████▉   | 4815/7000 [00:02<00:00, 2892.47 examples/s]Running tokenizer on dataset (num_proc=16):  75%|███████▌  | 5252/7000 [00:02<00:00, 2479.55 examples/s]Running tokenizer on dataset (num_proc=16):  88%|████████▊ | 6126/7000 [00:03<00:00, 2828.16 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 3206.63 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 1983.38 examples/s]
[INFO|configuration_utils.py:673] 2024-11-06 04:47:08,911 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:47:08,912 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|modeling_utils.py:3729] 2024-11-06 04:47:08,936 >> loading weights file /home/models/Llama-3.2-3B/model.safetensors.index.json
[INFO|modeling_utils.py:1622] 2024-11-06 04:47:08,936 >> Instantiating LlamaForCausalLM model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1099] 2024-11-06 04:47:08,937 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "eos_token_id": 128001
}

training example:
input_ids:
[128000, 128006, 9125, 128007, 271, 2675, 527, 264, 11190, 18328, 13, 128001, 128006, 882, 128007, 271, 14711, 32215, 459, 8029, 3319, 3196, 389, 279, 3984, 3488, 323, 4729, 11036, 627, 14711, 7998, 25, 4438, 1690, 14971, 315, 279, 26280, 527, 9191, 1109, 220, 3487, 23285, 17010, 2042, 1292, 25, 364, 28414, 46463, 518, 14711, 12494, 26443, 25, 5324, 29543, 1401, 794, 4482, 43573, 16427, 851, 405, 2025, 16427, 851, 498, 330, 43573, 67300, 851, 405, 28414, 67300, 851, 8073, 330, 6682, 1401, 794, 4482, 28414, 67300, 851, 498, 330, 2025, 16427, 851, 498, 330, 43573, 67300, 851, 8073, 330, 33210, 794, 4482, 28414, 13089, 37091, 887, 11, 836, 11, 9886, 11, 23862, 11, 8199, 304, 33151, 11, 1661, 8420, 11844, 330, 2025, 26408, 887, 11, 836, 11, 9405, 1614, 11, 4325, 11844, 330, 43573, 13089, 37091, 887, 11, 2010, 887, 11, 13643, 15718, 8, 93546, 128001, 128006, 78191, 128007, 271, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
inputs:
<|begin_of_text|><|start_header_id|>system<|end_header_id|>

You are a helpful assistant.<|end_of_text|><|start_header_id|>user<|end_header_id|>

###Generate an SQL query based on the provided question and database schema.
###question:How many heads of the departments are older than 56?, ###db_name: 'department_management',###database_schema: {"foreign key": ["management.head_id->head.head_id", "management.department_id->department.department_id"], "primary key": ["department.department_id", "head.head_id", "management.department_id"], "tables": ["department(department id, name, creation, ranking, budget in billions, num employees)", "head(head id, name, born state, age)", "management(department id, head id, temporary acting)"]}<|end_of_text|><|start_header_id|>assistant<|end_header_id|>

SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
labels:
SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.10it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.01s/it]
[INFO|modeling_utils.py:4574] 2024-11-06 04:47:11,020 >> All model checkpoint weights were used when initializing LlamaForCausalLM.

[INFO|modeling_utils.py:4582] 2024-11-06 04:47:11,020 >> All the weights of LlamaForCausalLM were initialized from the model checkpoint at /home/models/Llama-3.2-3B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1052] 2024-11-06 04:47:11,023 >> loading configuration file /home/models/Llama-3.2-3B/generation_config.json
[INFO|configuration_utils.py:1099] 2024-11-06 04:47:11,023 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "do_sample": true,
  "eos_token_id": 128001,
  "temperature": 0.6,
  "top_p": 0.9
}

11/06/2024 04:47:11 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
11/06/2024 04:47:11 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
11/06/2024 04:47:11 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
11/06/2024 04:47:11 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
11/06/2024 04:47:11 - INFO - llamafactory.model.model_utils.misc - Found linear modules: o_proj,up_proj,v_proj,q_proj,gate_proj,k_proj,down_proj
11/06/2024 04:47:11 - INFO - llamafactory.model.loader - trainable params: 12,156,928 || all params: 3,224,906,752 || trainable%: 0.3770
[INFO|trainer.py:2243] 2024-11-06 04:47:11,697 >> ***** Running training *****
[INFO|trainer.py:2244] 2024-11-06 04:47:11,697 >>   Num examples = 6,300
[INFO|trainer.py:2245] 2024-11-06 04:47:11,697 >>   Num Epochs = 5
[INFO|trainer.py:2246] 2024-11-06 04:47:11,697 >>   Instantaneous batch size per device = 4
[INFO|trainer.py:2249] 2024-11-06 04:47:11,697 >>   Total train batch size (w. parallel, distributed & accumulation) = 32
[INFO|trainer.py:2250] 2024-11-06 04:47:11,698 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2251] 2024-11-06 04:47:11,698 >>   Total optimization steps = 980
[INFO|trainer.py:2252] 2024-11-06 04:47:11,701 >>   Number of trainable parameters = 12,156,928
  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 1/980 [00:04<1:13:48,  4.52s/it]  0%|          | 2/980 [00:08<1:10:39,  4.34s/it]  0%|          | 3/980 [00:13<1:12:42,  4.47s/it]  0%|          | 4/980 [00:17<1:09:45,  4.29s/it]  1%|          | 5/980 [00:21<1:07:53,  4.18s/it]  1%|          | 6/980 [00:26<1:12:12,  4.45s/it]  1%|          | 7/980 [00:30<1:13:03,  4.50s/it]  1%|          | 8/980 [00:35<1:12:05,  4.45s/it]  1%|          | 9/980 [00:39<1:11:13,  4.40s/it]  1%|          | 10/980 [00:44<1:14:02,  4.58s/it]                                                    1%|          | 10/980 [00:44<1:14:02,  4.58s/it]  1%|          | 11/980 [00:48<1:12:26,  4.49s/it]  1%|          | 12/980 [00:52<1:10:46,  4.39s/it]  1%|▏         | 13/980 [00:57<1:09:38,  4.32s/it]  1%|▏         | 14/980 [01:01<1:08:33,  4.26s/it]  2%|▏         | 15/980 [01:05<1:08:00,  4.23s/it]  2%|▏         | 16/980 [01:09<1:08:47,  4.28s/it]  2%|▏         | 17/980 [01:13<1:08:10,  4.25s/it]  2%|▏         | 18/980 [01:18<1:07:35,  4.22s/it]  2%|▏         | 19/980 [01:22<1:08:23,  4.27s/it]  2%|▏         | 20/980 [01:26<1:07:54,  4.24s/it]                                                    2%|▏         | 20/980 [01:26<1:07:54,  4.24s/it]  2%|▏         | 21/980 [01:31<1:08:44,  4.30s/it]  2%|▏         | 22/980 [01:34<1:04:34,  4.04s/it]  2%|▏         | 23/980 [01:38<1:03:19,  3.97s/it]  2%|▏         | 24/980 [01:42<1:03:20,  3.98s/it]  3%|▎         | 25/980 [01:46<1:03:00,  3.96s/it]  3%|▎         | 26/980 [01:49<59:57,  3.77s/it]    3%|▎         | 27/980 [01:54<1:03:19,  3.99s/it]  3%|▎         | 28/980 [01:58<1:03:29,  4.00s/it]  3%|▎         | 29/980 [02:02<1:04:47,  4.09s/it]  3%|▎         | 30/980 [02:07<1:07:24,  4.26s/it]                                                    3%|▎         | 30/980 [02:07<1:07:24,  4.26s/it]  3%|▎         | 31/980 [02:11<1:06:28,  4.20s/it]  3%|▎         | 32/980 [02:15<1:05:08,  4.12s/it]  3%|▎         | 33/980 [02:19<1:06:59,  4.24s/it]  3%|▎         | 34/980 [02:23<1:06:49,  4.24s/it]  4%|▎         | 35/980 [02:27<1:03:35,  4.04s/it]  4%|▎         | 36/980 [02:30<1:01:10,  3.89s/it]  4%|▍         | 37/980 [02:35<1:01:56,  3.94s/it]  4%|▍         | 38/980 [02:40<1:06:51,  4.26s/it]  4%|▍         | 39/980 [02:43<1:04:19,  4.10s/it]  4%|▍         | 40/980 [02:47<1:04:06,  4.09s/it]                                                    4%|▍         | 40/980 [02:47<1:04:06,  4.09s/it]  4%|▍         | 41/980 [02:51<1:03:52,  4.08s/it]  4%|▍         | 42/980 [02:56<1:06:17,  4.24s/it]  4%|▍         | 43/980 [03:01<1:09:14,  4.43s/it]  4%|▍         | 44/980 [03:04<1:04:14,  4.12s/it]  5%|▍         | 45/980 [03:08<1:01:40,  3.96s/it]  5%|▍         | 46/980 [03:12<1:02:20,  4.00s/it]  5%|▍         | 47/980 [03:16<1:00:54,  3.92s/it]  5%|▍         | 48/980 [03:20<1:03:18,  4.08s/it]  5%|▌         | 49/980 [03:24<1:02:41,  4.04s/it]  5%|▌         | 50/980 [03:28<1:00:10,  3.88s/it]                                                    5%|▌         | 50/980 [03:28<1:00:10,  3.88s/it]  5%|▌         | 51/980 [03:32<1:04:27,  4.16s/it]  5%|▌         | 52/980 [03:36<1:02:34,  4.05s/it]  5%|▌         | 53/980 [03:40<1:03:37,  4.12s/it]  6%|▌         | 54/980 [03:45<1:05:55,  4.27s/it]  6%|▌         | 55/980 [03:50<1:07:52,  4.40s/it]  6%|▌         | 56/980 [03:53<1:03:35,  4.13s/it]  6%|▌         | 57/980 [03:58<1:07:17,  4.37s/it]  6%|▌         | 58/980 [04:02<1:05:37,  4.27s/it]  6%|▌         | 59/980 [04:06<1:01:47,  4.03s/it]  6%|▌         | 60/980 [04:10<1:02:28,  4.07s/it]                                                    6%|▌         | 60/980 [04:10<1:02:28,  4.07s/it]  6%|▌         | 61/980 [04:14<1:02:27,  4.08s/it]  6%|▋         | 62/980 [04:17<58:11,  3.80s/it]    6%|▋         | 63/980 [04:21<59:48,  3.91s/it]  7%|▋         | 64/980 [04:25<1:00:17,  3.95s/it]  7%|▋         | 65/980 [04:31<1:05:51,  4.32s/it]  7%|▋         | 66/980 [04:35<1:04:30,  4.23s/it]  7%|▋         | 67/980 [04:38<1:01:15,  4.03s/it]  7%|▋         | 68/980 [04:42<1:00:41,  3.99s/it]  7%|▋         | 69/980 [04:47<1:06:13,  4.36s/it]  7%|▋         | 70/980 [04:51<1:02:20,  4.11s/it]                                                    7%|▋         | 70/980 [04:51<1:02:20,  4.11s/it]  7%|▋         | 71/980 [04:54<58:39,  3.87s/it]    7%|▋         | 72/980 [04:58<59:44,  3.95s/it]  7%|▋         | 73/980 [05:03<1:02:37,  4.14s/it]  8%|▊         | 74/980 [05:08<1:05:54,  4.36s/it]  8%|▊         | 75/980 [05:12<1:04:50,  4.30s/it]  8%|▊         | 76/980 [05:16<1:02:10,  4.13s/it]  8%|▊         | 77/980 [05:19<1:01:00,  4.05s/it]  8%|▊         | 78/980 [05:24<1:04:58,  4.32s/it]  8%|▊         | 79/980 [05:29<1:05:41,  4.37s/it]  8%|▊         | 80/980 [05:34<1:07:42,  4.51s/it]                                                    8%|▊         | 80/980 [05:34<1:07:42,  4.51s/it]  8%|▊         | 81/980 [05:37<1:01:37,  4.11s/it]  8%|▊         | 82/980 [05:41<1:01:56,  4.14s/it]  8%|▊         | 83/980 [05:45<1:01:06,  4.09s/it]  9%|▊         | 84/980 [05:49<1:00:00,  4.02s/it]  9%|▊         | 85/980 [05:52<56:36,  3.80s/it]    9%|▉         | 86/980 [05:56<58:09,  3.90s/it]  9%|▉         | 87/980 [06:01<1:02:24,  4.19s/it]  9%|▉         | 88/980 [06:05<1:02:02,  4.17s/it]  9%|▉         | 89/980 [06:09<59:07,  3.98s/it]    9%|▉         | 90/980 [06:14<1:02:54,  4.24s/it]                                                    9%|▉         | 90/980 [06:14<1:02:54,  4.24s/it]  9%|▉         | 91/980 [06:18<1:01:57,  4.18s/it]  9%|▉         | 92/980 [06:22<1:03:47,  4.31s/it]  9%|▉         | 93/980 [06:27<1:03:00,  4.26s/it] 10%|▉         | 94/980 [06:31<1:01:52,  4.19s/it] 10%|▉         | 95/980 [06:35<1:00:39,  4.11s/it] 10%|▉         | 96/980 [06:38<57:46,  3.92s/it]   10%|▉         | 97/980 [06:42<55:52,  3.80s/it] 10%|█         | 98/980 [06:45<55:07,  3.75s/it] 10%|█         | 99/980 [06:50<1:01:26,  4.18s/it] 10%|█         | 100/980 [06:54<58:25,  3.98s/it]                                                   10%|█         | 100/980 [06:54<58:25,  3.98s/it][INFO|trainer.py:4021] 2024-11-06 04:54:06,060 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:54:06,061 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:54:06,061 >>   Batch size = 4
{'loss': 1.26, 'grad_norm': 0.9625352025032043, 'learning_rate': 4.99871554050172e-05, 'epoch': 0.05}
{'loss': 0.7158, 'grad_norm': 0.9614026546478271, 'learning_rate': 4.994863481875841e-05, 'epoch': 0.1}
{'loss': 0.4966, 'grad_norm': 0.9061269760131836, 'learning_rate': 4.9884477823729956e-05, 'epoch': 0.15}
{'loss': 0.4144, 'grad_norm': 0.773888885974884, 'learning_rate': 4.979475034558115e-05, 'epoch': 0.2}
{'loss': 0.3501, 'grad_norm': 0.6158084869384766, 'learning_rate': 4.967954458536126e-05, 'epoch': 0.25}
{'loss': 0.3447, 'grad_norm': 0.7663087844848633, 'learning_rate': 4.9538978924776634e-05, 'epoch': 0.3}
{'loss': 0.3338, 'grad_norm': 0.7575082778930664, 'learning_rate': 4.937319780454559e-05, 'epoch': 0.36}
{'loss': 0.2977, 'grad_norm': 0.6914912462234497, 'learning_rate': 4.9182371575975736e-05, 'epoch': 0.41}
{'loss': 0.2663, 'grad_norm': 0.6228150129318237, 'learning_rate': 4.8966696325916515e-05, 'epoch': 0.46}
{'loss': 0.2789, 'grad_norm': 0.706648051738739, 'learning_rate': 4.8726393675266716e-05, 'epoch': 0.51}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.32it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.42it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.34it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.65it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.26it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.38it/s][A
  6%|▌         | 10/175 [00:01<00:22,  7.19it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.52it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.48it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.24it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.53it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.58it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.60it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.10it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.04it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.49it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.63it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.36it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.69it/s][A
 14%|█▍        | 25/175 [00:03<00:20,  7.16it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.68it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.61it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  8.01it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.80it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.74it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.34it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.13it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.80it/s][A
 19%|█▉        | 34/175 [00:04<00:22,  6.15it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.51it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.52it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.69it/s][A
 22%|██▏       | 39/175 [00:05<00:20,  6.80it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.72it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.71it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.18it/s][A
 25%|██▌       | 44/175 [00:06<00:18,  7.28it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.40it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.80it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.25it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.11it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.06it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.07it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.22it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.04it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.17it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.59it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  6.99it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  7.01it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.76it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.12it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.34it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.03it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.91it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.59it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.44it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.66it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.07it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.50it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.43it/s][A
 43%|████▎     | 76/175 [00:10<00:14,  6.61it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.38it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.22it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.37it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.68it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.86it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.80it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.71it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.26it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.13it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.24it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.64it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.99it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.64it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.44it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.60it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.19it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.48it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.97it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.16it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.89it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.08it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.49it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.54it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.02it/s][A
 61%|██████    | 107/175 [00:15<00:09,  6.98it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.88it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.30it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.12it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.27it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.80it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.77it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.45it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.66it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.08it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.47it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.85it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.44it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.26it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.10it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.51it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.73it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.34it/s][A
 73%|███████▎  | 127/175 [00:19<00:09,  4.81it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.24it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.38it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.83it/s][A
 75%|███████▍  | 131/175 [00:19<00:06,  6.63it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.90it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.95it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.35it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.15it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.43it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.28it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.48it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.68it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.87it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.04it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.39it/s][A
 83%|████████▎ | 146/175 [00:21<00:03,  7.35it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.57it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.66it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.60it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.89it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.58it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.21it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.09it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.52it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.49it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.66it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.03it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.05it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.69it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.87it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.37it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.84it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.47it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.51it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.34it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.59it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.17it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.94it/s][A                                                 
                                                 [A 10%|█         | 100/980 [07:20<58:25,  3.98s/it]
100%|██████████| 175/175 [00:26<00:00,  5.94it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:54:32,181 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-100
[INFO|configuration_utils.py:673] 2024-11-06 04:54:32,203 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:54:32,203 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:54:32,303 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:54:32,303 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-100/special_tokens_map.json
 10%|█         | 101/980 [07:25<2:56:02, 12.02s/it] 10%|█         | 102/980 [07:29<2:22:34,  9.74s/it] 11%|█         | 103/980 [07:33<1:56:53,  8.00s/it] 11%|█         | 104/980 [07:38<1:42:27,  7.02s/it] 11%|█         | 105/980 [07:41<1:27:23,  5.99s/it] 11%|█         | 106/980 [07:45<1:16:55,  5.28s/it] 11%|█         | 107/980 [07:49<1:13:38,  5.06s/it] 11%|█         | 108/980 [07:53<1:09:00,  4.75s/it] 11%|█         | 109/980 [07:57<1:04:50,  4.47s/it] 11%|█         | 110/980 [08:01<1:01:40,  4.25s/it]                                                    11%|█         | 110/980 [08:01<1:01:40,  4.25s/it] 11%|█▏        | 111/980 [08:05<59:11,  4.09s/it]   11%|█▏        | 112/980 [08:08<57:20,  3.96s/it] 12%|█▏        | 113/980 [08:13<57:47,  4.00s/it] 12%|█▏        | 114/980 [08:16<55:45,  3.86s/it] 12%|█▏        | 115/980 [08:19<51:58,  3.61s/it] 12%|█▏        | 116/980 [08:23<55:08,  3.83s/it] 12%|█▏        | 117/980 [08:28<57:15,  3.98s/it] 12%|█▏        | 118/980 [08:32<56:24,  3.93s/it] 12%|█▏        | 119/980 [08:35<55:45,  3.89s/it] 12%|█▏        | 120/980 [08:39<53:55,  3.76s/it]                                                  12%|█▏        | 120/980 [08:39<53:55,  3.76s/it] 12%|█▏        | 121/980 [08:43<54:52,  3.83s/it] 12%|█▏        | 122/980 [08:47<55:41,  3.89s/it] 13%|█▎        | 123/980 [08:51<56:38,  3.97s/it] 13%|█▎        | 124/980 [08:55<56:19,  3.95s/it] 13%|█▎        | 125/980 [08:58<54:38,  3.83s/it] 13%|█▎        | 126/980 [09:02<52:48,  3.71s/it] 13%|█▎        | 127/980 [09:05<52:19,  3.68s/it] 13%|█▎        | 128/980 [09:10<53:58,  3.80s/it] 13%|█▎        | 129/980 [09:14<55:38,  3.92s/it] 13%|█▎        | 130/980 [09:18<57:29,  4.06s/it]                                                  13%|█▎        | 130/980 [09:18<57:29,  4.06s/it] 13%|█▎        | 131/980 [09:22<56:51,  4.02s/it] 13%|█▎        | 132/980 [09:26<57:23,  4.06s/it] 14%|█▎        | 133/980 [09:30<57:28,  4.07s/it] 14%|█▎        | 134/980 [09:34<57:18,  4.06s/it] 14%|█▍        | 135/980 [09:38<55:13,  3.92s/it] 14%|█▍        | 136/980 [09:41<52:43,  3.75s/it] 14%|█▍        | 137/980 [09:45<50:42,  3.61s/it] 14%|█▍        | 138/980 [09:49<52:45,  3.76s/it] 14%|█▍        | 139/980 [09:52<51:00,  3.64s/it] 14%|█▍        | 140/980 [09:56<52:23,  3.74s/it]                                                  14%|█▍        | 140/980 [09:56<52:23,  3.74s/it] 14%|█▍        | 141/980 [10:00<53:17,  3.81s/it] 14%|█▍        | 142/980 [10:04<53:47,  3.85s/it] 15%|█▍        | 143/980 [10:07<50:52,  3.65s/it] 15%|█▍        | 144/980 [10:11<53:14,  3.82s/it] 15%|█▍        | 145/980 [10:15<51:15,  3.68s/it] 15%|█▍        | 146/980 [10:19<52:04,  3.75s/it] 15%|█▌        | 147/980 [10:23<53:56,  3.88s/it] 15%|█▌        | 148/980 [10:27<55:40,  4.01s/it] 15%|█▌        | 149/980 [10:31<55:06,  3.98s/it] 15%|█▌        | 150/980 [10:36<58:02,  4.20s/it]                                                  15%|█▌        | 150/980 [10:36<58:02,  4.20s/it] 15%|█▌        | 151/980 [10:40<57:13,  4.14s/it] 16%|█▌        | 152/980 [10:44<58:33,  4.24s/it] 16%|█▌        | 153/980 [10:48<58:20,  4.23s/it] 16%|█▌        | 154/980 [10:53<58:23,  4.24s/it] 16%|█▌        | 155/980 [10:57<59:02,  4.29s/it] 16%|█▌        | 156/980 [11:02<59:44,  4.35s/it] 16%|█▌        | 157/980 [11:06<1:00:52,  4.44s/it] 16%|█▌        | 158/980 [11:10<59:52,  4.37s/it]   16%|█▌        | 159/980 [11:15<1:00:27,  4.42s/it] 16%|█▋        | 160/980 [11:19<1:00:04,  4.40s/it]                                                    16%|█▋        | 160/980 [11:19<1:00:04,  4.40s/it] 16%|█▋        | 161/980 [11:23<55:36,  4.07s/it]   17%|█▋        | 162/980 [11:26<53:36,  3.93s/it] 17%|█▋        | 163/980 [11:31<56:14,  4.13s/it] 17%|█▋        | 164/980 [11:35<54:23,  4.00s/it] 17%|█▋        | 165/980 [11:39<56:34,  4.16s/it] 17%|█▋        | 166/980 [11:42<52:51,  3.90s/it] 17%|█▋        | 167/980 [11:46<52:05,  3.84s/it] 17%|█▋        | 168/980 [11:50<52:32,  3.88s/it] 17%|█▋        | 169/980 [11:53<49:52,  3.69s/it] 17%|█▋        | 170/980 [11:57<49:20,  3.66s/it]                                                  17%|█▋        | 170/980 [11:57<49:20,  3.66s/it] 17%|█▋        | 171/980 [12:02<53:18,  3.95s/it] 18%|█▊        | 172/980 [12:05<50:02,  3.72s/it] 18%|█▊        | 173/980 [12:09<50:32,  3.76s/it] 18%|█▊        | 174/980 [12:14<56:54,  4.24s/it] 18%|█▊        | 175/980 [12:17<53:30,  3.99s/it] 18%|█▊        | 176/980 [12:21<52:16,  3.90s/it] 18%|█▊        | 177/980 [12:24<49:32,  3.70s/it] 18%|█▊        | 178/980 [12:28<49:22,  3.69s/it] 18%|█▊        | 179/980 [12:32<49:54,  3.74s/it] 18%|█▊        | 180/980 [12:36<51:36,  3.87s/it]                                                  18%|█▊        | 180/980 [12:36<51:36,  3.87s/it] 18%|█▊        | 181/980 [12:40<51:05,  3.84s/it] 19%|█▊        | 182/980 [12:43<50:13,  3.78s/it] 19%|█▊        | 183/980 [12:47<49:05,  3.70s/it] 19%|█▉        | 184/980 [12:51<52:21,  3.95s/it] 19%|█▉        | 185/980 [12:55<52:52,  3.99s/it] 19%|█▉        | 186/980 [12:59<52:26,  3.96s/it] 19%|█▉        | 187/980 [13:03<51:02,  3.86s/it] 19%|█▉        | 188/980 [13:06<49:31,  3.75s/it] 19%|█▉        | 189/980 [13:11<50:57,  3.87s/it] 19%|█▉        | 190/980 [13:14<49:27,  3.76s/it]                                                  19%|█▉        | 190/980 [13:14<49:27,  3.76s/it] 19%|█▉        | 191/980 [13:19<52:18,  3.98s/it] 20%|█▉        | 192/980 [13:22<50:12,  3.82s/it] 20%|█▉        | 193/980 [13:25<46:57,  3.58s/it] 20%|█▉        | 194/980 [13:28<45:53,  3.50s/it] 20%|█▉        | 195/980 [13:34<53:14,  4.07s/it] 20%|██        | 196/980 [13:39<55:41,  4.26s/it] 20%|██        | 197/980 [13:42<54:01,  4.14s/it] 20%|██        | 198/980 [13:48<57:54,  4.44s/it] 20%|██        | 199/980 [13:51<54:32,  4.19s/it] 20%|██        | 200/980 [13:55<53:02,  4.08s/it]                                                  20%|██        | 200/980 [13:55<53:02,  4.08s/it][INFO|trainer.py:4021] 2024-11-06 05:01:07,151 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:01:07,151 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:01:07,151 >>   Batch size = 4
{'eval_loss': 0.2715044915676117, 'eval_runtime': 26.1204, 'eval_samples_per_second': 26.799, 'eval_steps_per_second': 6.7, 'epoch': 0.51}
{'loss': 0.2506, 'grad_norm': 0.7797937989234924, 'learning_rate': 4.846171055124401e-05, 'epoch': 0.56}
{'loss': 0.2688, 'grad_norm': 0.9357553720474243, 'learning_rate': 4.817291893365055e-05, 'epoch': 0.61}
{'loss': 0.2583, 'grad_norm': 1.2523703575134277, 'learning_rate': 4.7860315575395316e-05, 'epoch': 0.66}
{'loss': 0.2342, 'grad_norm': 0.9787672162055969, 'learning_rate': 4.752422169756048e-05, 'epoch': 0.71}
{'loss': 0.2304, 'grad_norm': 0.8919821977615356, 'learning_rate': 4.716498265932501e-05, 'epoch': 0.76}
{'loss': 0.2251, 'grad_norm': 0.855346143245697, 'learning_rate': 4.678296760308474e-05, 'epoch': 0.81}
{'loss': 0.2149, 'grad_norm': 1.1371644735336304, 'learning_rate': 4.637856907513366e-05, 'epoch': 0.86}
{'loss': 0.2197, 'grad_norm': 0.954900324344635, 'learning_rate': 4.595220262229601e-05, 'epoch': 0.91}
{'loss': 0.2116, 'grad_norm': 1.2802053689956665, 'learning_rate': 4.55043063649239e-05, 'epoch': 0.97}
{'loss': 0.2004, 'grad_norm': 1.1507114171981812, 'learning_rate': 4.503534054669892e-05, 'epoch': 1.02}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.34it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.41it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.34it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.65it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.24it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.36it/s][A
  6%|▌         | 10/175 [00:01<00:23,  7.16it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.49it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.44it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.20it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.48it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.54it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.58it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.09it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.02it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.47it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.59it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.33it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.65it/s][A
 14%|█▍        | 25/175 [00:03<00:21,  7.14it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.65it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.60it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  7.98it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.79it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.73it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.34it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.13it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.79it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.15it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.50it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.51it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.70it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.81it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.74it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.71it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.18it/s][A
 25%|██▌       | 44/175 [00:06<00:18,  7.27it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.39it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.80it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.27it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.12it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.06it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.05it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.19it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.68it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.03it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.15it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.56it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  6.96it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  6.97it/s][A
 34%|███▍      | 60/175 [00:08<00:20,  5.74it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.13it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.36it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.04it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.90it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.58it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.40it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.63it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.05it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.48it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.40it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.59it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.37it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.21it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.67it/s][A
 46%|████▋     | 81/175 [00:12<00:19,  4.85it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.77it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.68it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.24it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.11it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.22it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.58it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.95it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.61it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.43it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.58it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.16it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.46it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.95it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.14it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.86it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.06it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.76it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.75it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.44it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.50it/s][A
 61%|██████    | 106/175 [00:15<00:08,  7.98it/s][A
 61%|██████    | 107/175 [00:15<00:09,  6.98it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.89it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.31it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.12it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.27it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.80it/s][A
 65%|██████▌   | 114/175 [00:17<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.76it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.44it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.63it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.03it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.45it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.84it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.43it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.25it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.50it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.72it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.34it/s][A
 73%|███████▎  | 127/175 [00:19<00:10,  4.80it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.23it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.37it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.82it/s][A
 75%|███████▍  | 131/175 [00:20<00:06,  6.61it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.87it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.95it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.34it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.13it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.39it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.25it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.46it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.66it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.85it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.00it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.35it/s][A
 83%|████████▎ | 146/175 [00:22<00:03,  7.32it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.55it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.63it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.58it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.86it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.55it/s][A
 88%|████████▊ | 154/175 [00:23<00:02,  8.18it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.07it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.51it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.49it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.67it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.03it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.04it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.69it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.87it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.36it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.82it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.46it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.49it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.32it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.57it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.16it/s][A
 99%|█████████▉| 174/175 [00:26<00:00,  5.92it/s][A                                                 
                                                 [A 20%|██        | 200/980 [14:21<53:02,  4.08s/it]
100%|██████████| 175/175 [00:26<00:00,  5.92it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:01:33,335 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-200
[INFO|configuration_utils.py:673] 2024-11-06 05:01:33,356 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:01:33,357 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:01:33,461 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:01:33,461 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-200/special_tokens_map.json
 21%|██        | 201/980 [14:26<2:39:36, 12.29s/it] 21%|██        | 202/980 [14:30<2:06:54,  9.79s/it] 21%|██        | 203/980 [14:34<1:42:11,  7.89s/it] 21%|██        | 204/980 [14:38<1:28:12,  6.82s/it] 21%|██        | 205/980 [14:42<1:16:47,  5.94s/it] 21%|██        | 206/980 [14:45<1:06:57,  5.19s/it] 21%|██        | 207/980 [14:50<1:05:04,  5.05s/it] 21%|██        | 208/980 [14:55<1:02:14,  4.84s/it] 21%|██▏       | 209/980 [14:58<58:10,  4.53s/it]   21%|██▏       | 210/980 [15:03<58:01,  4.52s/it]                                                  21%|██▏       | 210/980 [15:03<58:01,  4.52s/it] 22%|██▏       | 211/980 [15:07<57:27,  4.48s/it] 22%|██▏       | 212/980 [15:12<57:06,  4.46s/it] 22%|██▏       | 213/980 [15:15<54:12,  4.24s/it] 22%|██▏       | 214/980 [15:19<53:06,  4.16s/it] 22%|██▏       | 215/980 [15:23<52:05,  4.09s/it] 22%|██▏       | 216/980 [15:27<49:59,  3.93s/it] 22%|██▏       | 217/980 [15:31<49:35,  3.90s/it] 22%|██▏       | 218/980 [15:35<52:51,  4.16s/it] 22%|██▏       | 219/980 [15:39<49:53,  3.93s/it] 22%|██▏       | 220/980 [15:43<49:39,  3.92s/it]                                                  22%|██▏       | 220/980 [15:43<49:39,  3.92s/it] 23%|██▎       | 221/980 [15:47<49:31,  3.91s/it] 23%|██▎       | 222/980 [15:51<51:07,  4.05s/it] 23%|██▎       | 223/980 [15:55<51:01,  4.04s/it] 23%|██▎       | 224/980 [15:59<50:33,  4.01s/it] 23%|██▎       | 225/980 [16:03<52:05,  4.14s/it] 23%|██▎       | 226/980 [16:07<50:26,  4.01s/it] 23%|██▎       | 227/980 [16:11<50:00,  3.98s/it] 23%|██▎       | 228/980 [16:15<51:27,  4.11s/it] 23%|██▎       | 229/980 [16:20<52:21,  4.18s/it] 23%|██▎       | 230/980 [16:23<48:51,  3.91s/it]                                                  23%|██▎       | 230/980 [16:23<48:51,  3.91s/it] 24%|██▎       | 231/980 [16:28<51:28,  4.12s/it] 24%|██▎       | 232/980 [16:31<47:56,  3.85s/it] 24%|██▍       | 233/980 [16:35<47:50,  3.84s/it] 24%|██▍       | 234/980 [16:39<48:17,  3.88s/it] 24%|██▍       | 235/980 [16:42<46:01,  3.71s/it] 24%|██▍       | 236/980 [16:46<47:28,  3.83s/it] 24%|██▍       | 237/980 [16:50<48:23,  3.91s/it] 24%|██▍       | 238/980 [16:53<46:06,  3.73s/it] 24%|██▍       | 239/980 [16:58<47:50,  3.87s/it] 24%|██▍       | 240/980 [17:02<48:39,  3.95s/it]                                                  24%|██▍       | 240/980 [17:02<48:39,  3.95s/it] 25%|██▍       | 241/980 [17:06<50:11,  4.07s/it] 25%|██▍       | 242/980 [17:10<50:21,  4.09s/it] 25%|██▍       | 243/980 [17:15<51:49,  4.22s/it] 25%|██▍       | 244/980 [17:19<49:45,  4.06s/it] 25%|██▌       | 245/980 [17:23<49:43,  4.06s/it] 25%|██▌       | 246/980 [17:26<48:36,  3.97s/it] 25%|██▌       | 247/980 [17:30<48:02,  3.93s/it] 25%|██▌       | 248/980 [17:34<46:12,  3.79s/it] 25%|██▌       | 249/980 [17:38<49:04,  4.03s/it] 26%|██▌       | 250/980 [17:43<51:15,  4.21s/it]                                                  26%|██▌       | 250/980 [17:43<51:15,  4.21s/it] 26%|██▌       | 251/980 [17:46<46:22,  3.82s/it] 26%|██▌       | 252/980 [17:50<48:06,  3.96s/it] 26%|██▌       | 253/980 [17:54<49:03,  4.05s/it] 26%|██▌       | 254/980 [17:58<48:23,  4.00s/it] 26%|██▌       | 255/980 [18:03<52:07,  4.31s/it] 26%|██▌       | 256/980 [18:08<53:10,  4.41s/it] 26%|██▌       | 257/980 [18:13<55:24,  4.60s/it] 26%|██▋       | 258/980 [18:17<51:48,  4.31s/it] 26%|██▋       | 259/980 [18:20<49:17,  4.10s/it] 27%|██▋       | 260/980 [18:24<49:46,  4.15s/it]                                                  27%|██▋       | 260/980 [18:24<49:46,  4.15s/it] 27%|██▋       | 261/980 [18:28<47:11,  3.94s/it] 27%|██▋       | 262/980 [18:31<45:02,  3.76s/it] 27%|██▋       | 263/980 [18:36<47:25,  3.97s/it] 27%|██▋       | 264/980 [18:39<44:59,  3.77s/it] 27%|██▋       | 265/980 [18:42<43:11,  3.62s/it] 27%|██▋       | 266/980 [18:46<44:28,  3.74s/it] 27%|██▋       | 267/980 [18:50<42:48,  3.60s/it] 27%|██▋       | 268/980 [18:54<44:50,  3.78s/it] 27%|██▋       | 269/980 [18:58<46:31,  3.93s/it] 28%|██▊       | 270/980 [19:02<45:27,  3.84s/it]                                                  28%|██▊       | 270/980 [19:02<45:27,  3.84s/it] 28%|██▊       | 271/980 [19:06<46:02,  3.90s/it] 28%|██▊       | 272/980 [19:09<44:36,  3.78s/it] 28%|██▊       | 273/980 [19:12<42:39,  3.62s/it] 28%|██▊       | 274/980 [19:17<45:15,  3.85s/it] 28%|██▊       | 275/980 [19:21<44:56,  3.83s/it] 28%|██▊       | 276/980 [19:24<43:24,  3.70s/it] 28%|██▊       | 277/980 [19:28<44:26,  3.79s/it] 28%|██▊       | 278/980 [19:33<48:04,  4.11s/it] 28%|██▊       | 279/980 [19:36<46:07,  3.95s/it] 29%|██▊       | 280/980 [19:39<42:15,  3.62s/it]                                                  29%|██▊       | 280/980 [19:39<42:15,  3.62s/it] 29%|██▊       | 281/980 [19:43<41:45,  3.59s/it] 29%|██▉       | 282/980 [19:46<40:45,  3.50s/it] 29%|██▉       | 283/980 [19:51<44:31,  3.83s/it] 29%|██▉       | 284/980 [19:55<47:46,  4.12s/it] 29%|██▉       | 285/980 [20:00<47:52,  4.13s/it] 29%|██▉       | 286/980 [20:04<47:53,  4.14s/it] 29%|██▉       | 287/980 [20:08<47:00,  4.07s/it] 29%|██▉       | 288/980 [20:11<45:32,  3.95s/it] 29%|██▉       | 289/980 [20:17<49:32,  4.30s/it] 30%|██▉       | 290/980 [20:20<46:04,  4.01s/it]                                                  30%|██▉       | 290/980 [20:20<46:04,  4.01s/it] 30%|██▉       | 291/980 [20:24<47:10,  4.11s/it] 30%|██▉       | 292/980 [20:28<46:10,  4.03s/it] 30%|██▉       | 293/980 [20:32<44:54,  3.92s/it] 30%|███       | 294/980 [20:36<45:20,  3.97s/it] 30%|███       | 295/980 [20:39<43:16,  3.79s/it] 30%|███       | 296/980 [20:44<46:30,  4.08s/it] 30%|███       | 297/980 [20:48<47:37,  4.18s/it] 30%|███       | 298/980 [20:52<45:53,  4.04s/it] 31%|███       | 299/980 [20:56<44:22,  3.91s/it] 31%|███       | 300/980 [20:59<42:49,  3.78s/it]                                                  31%|███       | 300/980 [20:59<42:49,  3.78s/it][INFO|trainer.py:4021] 2024-11-06 05:08:11,302 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:08:11,302 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:08:11,302 >>   Batch size = 4
{'eval_loss': 0.20008784532546997, 'eval_runtime': 26.1841, 'eval_samples_per_second': 26.734, 'eval_steps_per_second': 6.683, 'epoch': 1.02}
{'loss': 0.1841, 'grad_norm': 1.2000396251678467, 'learning_rate': 4.454578706170075e-05, 'epoch': 1.07}
{'loss': 0.1697, 'grad_norm': 0.9722445607185364, 'learning_rate': 4.4036148959228365e-05, 'epoch': 1.12}
{'loss': 0.1718, 'grad_norm': 1.2047351598739624, 'learning_rate': 4.350694992688289e-05, 'epoch': 1.17}
{'loss': 0.1646, 'grad_norm': 1.0722894668579102, 'learning_rate': 4.2958733752443195e-05, 'epoch': 1.22}
{'loss': 0.1809, 'grad_norm': 0.7705670595169067, 'learning_rate': 4.239206376508717e-05, 'epoch': 1.27}
{'loss': 0.1635, 'grad_norm': 1.4110196828842163, 'learning_rate': 4.180752225653292e-05, 'epoch': 1.32}
{'loss': 0.1515, 'grad_norm': 1.1934772729873657, 'learning_rate': 4.120570988269472e-05, 'epoch': 1.37}
{'loss': 0.1549, 'grad_norm': 0.9490672945976257, 'learning_rate': 4.058724504646834e-05, 'epoch': 1.42}
{'loss': 0.1707, 'grad_norm': 1.388243556022644, 'learning_rate': 3.9952763262280405e-05, 'epoch': 1.47}
{'loss': 0.1436, 'grad_norm': 1.4902511835098267, 'learning_rate': 3.9302916503054246e-05, 'epoch': 1.52}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.33it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.41it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.34it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.65it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.25it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.38it/s][A
  6%|▌         | 10/175 [00:01<00:23,  7.17it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.48it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.44it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.21it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.50it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.54it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.57it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.08it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.01it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.47it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.59it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.33it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.65it/s][A
 14%|█▍        | 25/175 [00:03<00:21,  7.13it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.65it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.59it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  7.97it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.78it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.74it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.34it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.14it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.80it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.16it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.51it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.53it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.71it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.83it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.77it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.73it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.20it/s][A
 25%|██▌       | 44/175 [00:06<00:17,  7.29it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.41it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.83it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.30it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.15it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.08it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.09it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.24it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.04it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.17it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.85it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  7.00it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  7.02it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.77it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.16it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.40it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.06it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.93it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.60it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.45it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.66it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.07it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.50it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.42it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.59it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.36it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.21it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.67it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.86it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.79it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.69it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.25it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.12it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.24it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.63it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.99it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.64it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.44it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.61it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.20it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.49it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.97it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.14it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.87it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.07it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.48it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.54it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.02it/s][A
 61%|██████    | 107/175 [00:15<00:09,  7.00it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.92it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.33it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.16it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.29it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.81it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.76it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.43it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.64it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.05it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.45it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.83it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.42it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.24it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.51it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.73it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.34it/s][A
 73%|███████▎  | 127/175 [00:19<00:10,  4.80it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.23it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.37it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.82it/s][A
 75%|███████▍  | 131/175 [00:20<00:06,  6.61it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.88it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.95it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.35it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.13it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.39it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.25it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.46it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.67it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.87it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.04it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.37it/s][A
 83%|████████▎ | 146/175 [00:21<00:03,  7.33it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.56it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.64it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.59it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.87it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.56it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.19it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.07it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.51it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.50it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.66it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.01it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.04it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.69it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.88it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.37it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.83it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.46it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.50it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.33it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.58it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.17it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.93it/s][A                                                 
                                                 [A 31%|███       | 300/980 [21:25<42:49,  3.78s/it]
100%|██████████| 175/175 [00:26<00:00,  5.93it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:08:37,441 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-300
[INFO|configuration_utils.py:673] 2024-11-06 05:08:37,462 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:08:37,463 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:08:37,570 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:08:37,570 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-300/special_tokens_map.json
 31%|███       | 301/980 [21:30<2:13:27, 11.79s/it] 31%|███       | 302/980 [21:34<1:49:25,  9.68s/it] 31%|███       | 303/980 [21:38<1:30:08,  7.99s/it] 31%|███       | 304/980 [21:42<1:15:19,  6.69s/it] 31%|███       | 305/980 [21:47<1:07:49,  6.03s/it] 31%|███       | 306/980 [21:51<1:01:58,  5.52s/it] 31%|███▏      | 307/980 [21:55<55:47,  4.97s/it]   31%|███▏      | 308/980 [21:59<54:39,  4.88s/it] 32%|███▏      | 309/980 [22:03<49:36,  4.44s/it] 32%|███▏      | 310/980 [22:07<48:22,  4.33s/it]                                                  32%|███▏      | 310/980 [22:07<48:22,  4.33s/it] 32%|███▏      | 311/980 [22:10<45:08,  4.05s/it] 32%|███▏      | 312/980 [22:13<42:13,  3.79s/it] 32%|███▏      | 313/980 [22:17<41:09,  3.70s/it] 32%|███▏      | 314/980 [22:20<38:48,  3.50s/it] 32%|███▏      | 315/980 [22:24<41:42,  3.76s/it] 32%|███▏      | 316/980 [22:28<41:49,  3.78s/it] 32%|███▏      | 317/980 [22:32<41:53,  3.79s/it] 32%|███▏      | 318/980 [22:36<43:59,  3.99s/it] 33%|███▎      | 319/980 [22:40<43:22,  3.94s/it] 33%|███▎      | 320/980 [22:44<43:35,  3.96s/it]                                                  33%|███▎      | 320/980 [22:44<43:35,  3.96s/it] 33%|███▎      | 321/980 [22:48<44:38,  4.06s/it] 33%|███▎      | 322/980 [22:53<46:02,  4.20s/it] 33%|███▎      | 323/980 [22:57<46:19,  4.23s/it] 33%|███▎      | 324/980 [23:01<43:53,  4.01s/it] 33%|███▎      | 325/980 [23:05<45:36,  4.18s/it] 33%|███▎      | 326/980 [23:09<43:18,  3.97s/it] 33%|███▎      | 327/980 [23:13<43:56,  4.04s/it] 33%|███▎      | 328/980 [23:17<43:58,  4.05s/it] 34%|███▎      | 329/980 [23:20<41:38,  3.84s/it] 34%|███▎      | 330/980 [23:25<43:32,  4.02s/it]                                                  34%|███▎      | 330/980 [23:25<43:32,  4.02s/it] 34%|███▍      | 331/980 [23:29<43:39,  4.04s/it] 34%|███▍      | 332/980 [23:32<40:47,  3.78s/it] 34%|███▍      | 333/980 [23:36<41:30,  3.85s/it] 34%|███▍      | 334/980 [23:40<41:10,  3.82s/it] 34%|███▍      | 335/980 [23:44<41:00,  3.81s/it] 34%|███▍      | 336/980 [23:47<39:56,  3.72s/it] 34%|███▍      | 337/980 [23:51<40:46,  3.81s/it] 34%|███▍      | 338/980 [23:55<40:56,  3.83s/it] 35%|███▍      | 339/980 [23:58<39:37,  3.71s/it] 35%|███▍      | 340/980 [24:03<41:42,  3.91s/it]                                                  35%|███▍      | 340/980 [24:03<41:42,  3.91s/it] 35%|███▍      | 341/980 [24:08<44:33,  4.18s/it] 35%|███▍      | 342/980 [24:11<41:32,  3.91s/it] 35%|███▌      | 343/980 [24:15<40:25,  3.81s/it] 35%|███▌      | 344/980 [24:19<41:08,  3.88s/it] 35%|███▌      | 345/980 [24:22<39:42,  3.75s/it] 35%|███▌      | 346/980 [24:26<41:10,  3.90s/it] 35%|███▌      | 347/980 [24:30<40:18,  3.82s/it] 36%|███▌      | 348/980 [24:33<38:33,  3.66s/it] 36%|███▌      | 349/980 [24:38<42:34,  4.05s/it] 36%|███▌      | 350/980 [24:42<42:18,  4.03s/it]                                                  36%|███▌      | 350/980 [24:42<42:18,  4.03s/it] 36%|███▌      | 351/980 [24:46<43:00,  4.10s/it] 36%|███▌      | 352/980 [24:51<43:41,  4.17s/it] 36%|███▌      | 353/980 [24:55<45:08,  4.32s/it] 36%|███▌      | 354/980 [25:00<45:38,  4.37s/it] 36%|███▌      | 355/980 [25:04<45:07,  4.33s/it] 36%|███▋      | 356/980 [25:08<43:26,  4.18s/it] 36%|███▋      | 357/980 [25:12<44:05,  4.25s/it] 37%|███▋      | 358/980 [25:16<43:13,  4.17s/it] 37%|███▋      | 359/980 [25:20<40:48,  3.94s/it] 37%|███▋      | 360/980 [25:24<42:23,  4.10s/it]                                                  37%|███▋      | 360/980 [25:24<42:23,  4.10s/it] 37%|███▋      | 361/980 [25:28<41:48,  4.05s/it] 37%|███▋      | 362/980 [25:33<42:45,  4.15s/it] 37%|███▋      | 363/980 [25:37<43:07,  4.19s/it] 37%|███▋      | 364/980 [25:41<41:56,  4.09s/it] 37%|███▋      | 365/980 [25:45<43:28,  4.24s/it] 37%|███▋      | 366/980 [25:50<44:23,  4.34s/it] 37%|███▋      | 367/980 [25:54<42:48,  4.19s/it] 38%|███▊      | 368/980 [25:57<41:14,  4.04s/it] 38%|███▊      | 369/980 [26:01<41:05,  4.03s/it] 38%|███▊      | 370/980 [26:05<40:28,  3.98s/it]                                                  38%|███▊      | 370/980 [26:05<40:28,  3.98s/it] 38%|███▊      | 371/980 [26:10<41:22,  4.08s/it] 38%|███▊      | 372/980 [26:14<42:43,  4.22s/it] 38%|███▊      | 373/980 [26:18<41:32,  4.11s/it] 38%|███▊      | 374/980 [26:22<41:27,  4.11s/it] 38%|███▊      | 375/980 [26:27<42:35,  4.22s/it] 38%|███▊      | 376/980 [26:31<41:41,  4.14s/it] 38%|███▊      | 377/980 [26:35<42:43,  4.25s/it] 39%|███▊      | 378/980 [26:39<41:08,  4.10s/it] 39%|███▊      | 379/980 [26:43<41:08,  4.11s/it] 39%|███▉      | 380/980 [26:46<39:32,  3.95s/it]                                                  39%|███▉      | 380/980 [26:46<39:32,  3.95s/it] 39%|███▉      | 381/980 [26:51<41:33,  4.16s/it] 39%|███▉      | 382/980 [26:55<40:24,  4.05s/it] 39%|███▉      | 383/980 [26:58<38:32,  3.87s/it] 39%|███▉      | 384/980 [27:03<39:55,  4.02s/it] 39%|███▉      | 385/980 [27:07<39:56,  4.03s/it] 39%|███▉      | 386/980 [27:11<40:35,  4.10s/it] 39%|███▉      | 387/980 [27:15<41:10,  4.17s/it] 40%|███▉      | 388/980 [27:19<38:36,  3.91s/it] 40%|███▉      | 389/980 [27:23<39:06,  3.97s/it] 40%|███▉      | 390/980 [27:27<38:53,  3.96s/it]                                                  40%|███▉      | 390/980 [27:27<38:53,  3.96s/it] 40%|███▉      | 391/980 [27:30<36:50,  3.75s/it] 40%|████      | 392/980 [27:34<38:49,  3.96s/it] 40%|████      | 393/980 [27:38<37:38,  3.85s/it] 40%|████      | 394/980 [27:41<34:35,  3.54s/it] 40%|████      | 395/980 [27:45<35:05,  3.60s/it] 40%|████      | 396/980 [27:49<36:05,  3.71s/it] 41%|████      | 397/980 [27:53<39:19,  4.05s/it] 41%|████      | 398/980 [27:58<40:05,  4.13s/it] 41%|████      | 399/980 [28:02<39:15,  4.05s/it] 41%|████      | 400/980 [28:05<38:01,  3.93s/it]                                                  41%|████      | 400/980 [28:05<38:01,  3.93s/it][INFO|trainer.py:4021] 2024-11-06 05:15:17,464 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:15:17,464 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:15:17,464 >>   Batch size = 4
{'eval_loss': 0.17092542350292206, 'eval_runtime': 26.1386, 'eval_samples_per_second': 26.78, 'eval_steps_per_second': 6.695, 'epoch': 1.52}
{'loss': 0.1425, 'grad_norm': 1.445993423461914, 'learning_rate': 3.8638372530263715e-05, 'epoch': 1.57}
{'loss': 0.149, 'grad_norm': 1.0472463369369507, 'learning_rate': 3.7959814207763135e-05, 'epoch': 1.63}
{'loss': 0.1425, 'grad_norm': 1.091273307800293, 'learning_rate': 3.726793880009845e-05, 'epoch': 1.68}
{'loss': 0.1424, 'grad_norm': 0.9205888509750366, 'learning_rate': 3.656345725602089e-05, 'epoch': 1.73}
{'loss': 0.1477, 'grad_norm': 1.056847095489502, 'learning_rate': 3.5847093477938956e-05, 'epoch': 1.78}
{'loss': 0.1332, 'grad_norm': 1.0303212404251099, 'learning_rate': 3.5119583578059846e-05, 'epoch': 1.83}
{'loss': 0.1434, 'grad_norm': 1.272528052330017, 'learning_rate': 3.438167512198436e-05, 'epoch': 1.88}
{'loss': 0.1433, 'grad_norm': 0.8155139684677124, 'learning_rate': 3.363412636053269e-05, 'epoch': 1.93}
{'loss': 0.1399, 'grad_norm': 1.1258138418197632, 'learning_rate': 3.2877705450590526e-05, 'epoch': 1.98}
{'loss': 0.1073, 'grad_norm': 1.4469319581985474, 'learning_rate': 3.211318966577581e-05, 'epoch': 2.03}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.32it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.45it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.36it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.68it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.28it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.39it/s][A
  6%|▌         | 10/175 [00:01<00:22,  7.20it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.54it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.49it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.23it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.53it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.58it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.60it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.11it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.03it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.49it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.62it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.34it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.67it/s][A
 14%|█▍        | 25/175 [00:03<00:20,  7.15it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.66it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.61it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  7.99it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.79it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.72it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.34it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.15it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.81it/s][A
 19%|█▉        | 34/175 [00:04<00:22,  6.16it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.49it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.50it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.68it/s][A
 22%|██▏       | 39/175 [00:05<00:20,  6.80it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.74it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.70it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.18it/s][A
 25%|██▌       | 44/175 [00:06<00:18,  7.27it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.39it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.81it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.28it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.13it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.07it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.07it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.22it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.04it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.17it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.85it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  7.00it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  7.01it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.77it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.16it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.39it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.06it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.94it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.61it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.46it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.66it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.09it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.51it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.43it/s][A
 43%|████▎     | 76/175 [00:10<00:14,  6.61it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.38it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.22it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.36it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.68it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.87it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.78it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.69it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.26it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.14it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.26it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.64it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.99it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.64it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.45it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.61it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.20it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.50it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.97it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.14it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.88it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.08it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.48it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.53it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.00it/s][A
 61%|██████    | 107/175 [00:15<00:09,  7.00it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.92it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.29it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.13it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.27it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.79it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.76it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.44it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.65it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.06it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.47it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.83it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.40it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.23it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.51it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.73it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.33it/s][A
 73%|███████▎  | 127/175 [00:19<00:10,  4.80it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.23it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.36it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.80it/s][A
 75%|███████▍  | 131/175 [00:19<00:06,  6.60it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.87it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.95it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.35it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.13it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.36it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.22it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.45it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.67it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.86it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.01it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.34it/s][A
 83%|████████▎ | 146/175 [00:21<00:03,  7.32it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.55it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.63it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.57it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.84it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.53it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.16it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.05it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.48it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.46it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.66it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.01it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.04it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.69it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.85it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.35it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.81it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.46it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.50it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.33it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.55it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.15it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.93it/s][A                                                 
                                                 [A 41%|████      | 400/980 [28:31<38:01,  3.93s/it]
100%|██████████| 175/175 [00:26<00:00,  5.93it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:15:43,609 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-400
[INFO|configuration_utils.py:673] 2024-11-06 05:15:43,631 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:15:43,632 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:15:43,726 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:15:43,726 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-400/special_tokens_map.json
 41%|████      | 401/980 [28:36<1:55:09, 11.93s/it] 41%|████      | 402/980 [28:39<1:30:29,  9.39s/it] 41%|████      | 403/980 [28:43<1:14:50,  7.78s/it] 41%|████      | 404/980 [28:47<1:03:23,  6.60s/it] 41%|████▏     | 405/980 [28:53<1:00:31,  6.32s/it] 41%|████▏     | 406/980 [28:56<52:21,  5.47s/it]   42%|████▏     | 407/980 [29:00<46:17,  4.85s/it] 42%|████▏     | 408/980 [29:04<43:55,  4.61s/it] 42%|████▏     | 409/980 [29:07<40:18,  4.24s/it] 42%|████▏     | 410/980 [29:11<39:20,  4.14s/it]                                                  42%|████▏     | 410/980 [29:11<39:20,  4.14s/it] 42%|████▏     | 411/980 [29:15<38:48,  4.09s/it] 42%|████▏     | 412/980 [29:20<40:01,  4.23s/it] 42%|████▏     | 413/980 [29:23<38:41,  4.09s/it] 42%|████▏     | 414/980 [29:28<38:46,  4.11s/it] 42%|████▏     | 415/980 [29:31<36:52,  3.92s/it] 42%|████▏     | 416/980 [29:35<37:29,  3.99s/it] 43%|████▎     | 417/980 [29:39<37:20,  3.98s/it] 43%|████▎     | 418/980 [29:44<38:31,  4.11s/it] 43%|████▎     | 419/980 [29:46<34:46,  3.72s/it] 43%|████▎     | 420/980 [29:51<37:38,  4.03s/it]                                                  43%|████▎     | 420/980 [29:51<37:38,  4.03s/it] 43%|████▎     | 421/980 [29:55<38:28,  4.13s/it] 43%|████▎     | 422/980 [29:59<36:16,  3.90s/it] 43%|████▎     | 423/980 [30:03<35:55,  3.87s/it] 43%|████▎     | 424/980 [30:06<35:41,  3.85s/it] 43%|████▎     | 425/980 [30:10<34:31,  3.73s/it] 43%|████▎     | 426/980 [30:14<35:39,  3.86s/it] 44%|████▎     | 427/980 [30:18<35:50,  3.89s/it] 44%|████▎     | 428/980 [30:22<35:09,  3.82s/it] 44%|████▍     | 429/980 [30:26<37:14,  4.06s/it] 44%|████▍     | 430/980 [30:30<37:29,  4.09s/it]                                                  44%|████▍     | 430/980 [30:30<37:29,  4.09s/it] 44%|████▍     | 431/980 [30:34<36:21,  3.97s/it] 44%|████▍     | 432/980 [30:39<38:48,  4.25s/it] 44%|████▍     | 433/980 [30:43<39:12,  4.30s/it] 44%|████▍     | 434/980 [30:47<37:53,  4.16s/it] 44%|████▍     | 435/980 [30:51<35:56,  3.96s/it] 44%|████▍     | 436/980 [30:54<35:01,  3.86s/it] 45%|████▍     | 437/980 [30:58<34:06,  3.77s/it] 45%|████▍     | 438/980 [31:01<32:21,  3.58s/it] 45%|████▍     | 439/980 [31:05<32:31,  3.61s/it] 45%|████▍     | 440/980 [31:09<33:15,  3.70s/it]                                                  45%|████▍     | 440/980 [31:09<33:15,  3.70s/it] 45%|████▌     | 441/980 [31:13<35:27,  3.95s/it] 45%|████▌     | 442/980 [31:17<33:57,  3.79s/it] 45%|████▌     | 443/980 [31:20<33:49,  3.78s/it] 45%|████▌     | 444/980 [31:24<33:52,  3.79s/it] 45%|████▌     | 445/980 [31:29<36:23,  4.08s/it] 46%|████▌     | 446/980 [31:33<36:33,  4.11s/it] 46%|████▌     | 447/980 [31:37<36:31,  4.11s/it] 46%|████▌     | 448/980 [31:41<35:50,  4.04s/it] 46%|████▌     | 449/980 [31:47<40:09,  4.54s/it] 46%|████▌     | 450/980 [31:51<39:00,  4.42s/it]                                                  46%|████▌     | 450/980 [31:51<39:00,  4.42s/it] 46%|████▌     | 451/980 [31:55<39:11,  4.45s/it] 46%|████▌     | 452/980 [32:00<40:19,  4.58s/it] 46%|████▌     | 453/980 [32:04<37:38,  4.29s/it] 46%|████▋     | 454/980 [32:08<35:53,  4.09s/it] 46%|████▋     | 455/980 [32:11<33:49,  3.86s/it] 47%|████▋     | 456/980 [32:14<31:41,  3.63s/it] 47%|████▋     | 457/980 [32:18<33:09,  3.80s/it] 47%|████▋     | 458/980 [32:22<33:08,  3.81s/it] 47%|████▋     | 459/980 [32:26<32:40,  3.76s/it] 47%|████▋     | 460/980 [32:30<34:17,  3.96s/it]                                                  47%|████▋     | 460/980 [32:30<34:17,  3.96s/it] 47%|████▋     | 461/980 [32:34<33:26,  3.87s/it] 47%|████▋     | 462/980 [32:38<33:42,  3.91s/it] 47%|████▋     | 463/980 [32:41<32:49,  3.81s/it] 47%|████▋     | 464/980 [32:45<33:16,  3.87s/it] 47%|████▋     | 465/980 [32:49<33:38,  3.92s/it] 48%|████▊     | 466/980 [32:54<35:09,  4.10s/it] 48%|████▊     | 467/980 [32:59<36:45,  4.30s/it] 48%|████▊     | 468/980 [33:04<39:43,  4.66s/it] 48%|████▊     | 469/980 [33:09<40:11,  4.72s/it] 48%|████▊     | 470/980 [33:13<37:26,  4.40s/it]                                                  48%|████▊     | 470/980 [33:13<37:26,  4.40s/it] 48%|████▊     | 471/980 [33:16<35:19,  4.16s/it] 48%|████▊     | 472/980 [33:20<33:22,  3.94s/it] 48%|████▊     | 473/980 [33:23<30:42,  3.63s/it] 48%|████▊     | 474/980 [33:27<32:30,  3.86s/it] 48%|████▊     | 475/980 [33:30<31:16,  3.71s/it] 49%|████▊     | 476/980 [33:34<30:37,  3.65s/it] 49%|████▊     | 477/980 [33:38<31:46,  3.79s/it] 49%|████▉     | 478/980 [33:42<33:07,  3.96s/it] 49%|████▉     | 479/980 [33:46<33:25,  4.00s/it] 49%|████▉     | 480/980 [33:50<32:50,  3.94s/it]                                                  49%|████▉     | 480/980 [33:50<32:50,  3.94s/it] 49%|████▉     | 481/980 [33:55<35:34,  4.28s/it] 49%|████▉     | 482/980 [33:59<34:06,  4.11s/it] 49%|████▉     | 483/980 [34:03<34:46,  4.20s/it] 49%|████▉     | 484/980 [34:08<34:47,  4.21s/it] 49%|████▉     | 485/980 [34:12<34:52,  4.23s/it] 50%|████▉     | 486/980 [34:17<36:25,  4.42s/it] 50%|████▉     | 487/980 [34:20<33:53,  4.13s/it] 50%|████▉     | 488/980 [34:24<31:39,  3.86s/it] 50%|████▉     | 489/980 [34:27<31:39,  3.87s/it] 50%|█████     | 490/980 [34:31<31:03,  3.80s/it]                                                  50%|█████     | 490/980 [34:31<31:03,  3.80s/it] 50%|█████     | 491/980 [34:35<30:25,  3.73s/it] 50%|█████     | 492/980 [34:39<32:10,  3.96s/it] 50%|█████     | 493/980 [34:44<33:36,  4.14s/it] 50%|█████     | 494/980 [34:47<32:36,  4.03s/it] 51%|█████     | 495/980 [34:51<31:08,  3.85s/it] 51%|█████     | 496/980 [34:55<31:09,  3.86s/it] 51%|█████     | 497/980 [34:59<31:57,  3.97s/it] 51%|█████     | 498/980 [35:04<34:22,  4.28s/it] 51%|█████     | 499/980 [35:07<32:22,  4.04s/it] 51%|█████     | 500/980 [35:11<30:21,  3.80s/it]                                                  51%|█████     | 500/980 [35:11<30:21,  3.80s/it][INFO|trainer.py:4021] 2024-11-06 05:22:22,902 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:22:22,902 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:22:22,902 >>   Batch size = 4
{'eval_loss': 0.14928022027015686, 'eval_runtime': 26.1443, 'eval_samples_per_second': 26.774, 'eval_steps_per_second': 6.694, 'epoch': 2.03}
{'loss': 0.1127, 'grad_norm': 1.1919610500335693, 'learning_rate': 3.1341364597737686e-05, 'epoch': 2.08}
{'loss': 0.1042, 'grad_norm': 0.8325329422950745, 'learning_rate': 3.056302334890786e-05, 'epoch': 2.13}
{'loss': 0.1104, 'grad_norm': 1.0042898654937744, 'learning_rate': 2.9778965717534313e-05, 'epoch': 2.18}
{'loss': 0.0979, 'grad_norm': 1.1531733274459839, 'learning_rate': 2.8989997375834482e-05, 'epoch': 2.23}
{'loss': 0.1096, 'grad_norm': 1.331968903541565, 'learning_rate': 2.8196929042112652e-05, 'epoch': 2.29}
{'loss': 0.1214, 'grad_norm': 0.8861129879951477, 'learning_rate': 2.7400575647692046e-05, 'epoch': 2.34}
{'loss': 0.1144, 'grad_norm': 1.753576397895813, 'learning_rate': 2.6601755499517826e-05, 'epoch': 2.39}
{'loss': 0.0978, 'grad_norm': 1.2032444477081299, 'learning_rate': 2.5801289439291388e-05, 'epoch': 2.44}
{'loss': 0.0912, 'grad_norm': 1.4401791095733643, 'learning_rate': 2.5e-05, 'epoch': 2.49}
{'loss': 0.1108, 'grad_norm': 1.1733392477035522, 'learning_rate': 2.419871056070862e-05, 'epoch': 2.54}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.33it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.39it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.33it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.62it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.21it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.31it/s][A
  6%|▌         | 10/175 [00:01<00:23,  7.14it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.48it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.44it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.21it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.48it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.51it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.56it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.09it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.02it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.47it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.59it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.32it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.66it/s][A
 14%|█▍        | 25/175 [00:03<00:21,  7.13it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.63it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.58it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  7.96it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.76it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.73it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.34it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.13it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.80it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.16it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.52it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.53it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.70it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.81it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.75it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.71it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.16it/s][A
 25%|██▌       | 44/175 [00:06<00:18,  7.24it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.37it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.80it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.28it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.13it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.06it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.08it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.24it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.06it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.18it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.56it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  6.96it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  6.98it/s][A
 34%|███▍      | 60/175 [00:08<00:20,  5.75it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.12it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.36it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.05it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.93it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.60it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.43it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.65it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.06it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.48it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.39it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.59it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.37it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.21it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.68it/s][A
 46%|████▋     | 81/175 [00:12<00:19,  4.86it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.80it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.70it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.25it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.13it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.24it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.64it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.99it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.64it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.44it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.59it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.18it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.47it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.97it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.15it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.89it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.09it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.49it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.54it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.02it/s][A
 61%|██████    | 107/175 [00:15<00:09,  7.01it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.92it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.33it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.15it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.30it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.81it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.77it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.45it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.65it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.05it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.46it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.85it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.45it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.27it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.11it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.51it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.72it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.35it/s][A
 73%|███████▎  | 127/175 [00:19<00:09,  4.80it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.25it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.39it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.82it/s][A
 75%|███████▍  | 131/175 [00:20<00:06,  6.62it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.89it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.93it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.33it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.13it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.40it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.24it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.45it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.67it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.87it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.04it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.39it/s][A
 83%|████████▎ | 146/175 [00:22<00:03,  7.33it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.55it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.65it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.59it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.88it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.57it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.20it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.09it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.51it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.49it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.66it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.03it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.06it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.70it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.88it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.39it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.85it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.48it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.51it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.35it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.59it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.17it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.94it/s][A                                                 
                                                 [A 51%|█████     | 500/980 [35:37<30:21,  3.80s/it]
100%|██████████| 175/175 [00:26<00:00,  5.94it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:22:49,053 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-500
[INFO|configuration_utils.py:673] 2024-11-06 05:22:49,073 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:22:49,074 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:22:49,182 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:22:49,182 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-500/special_tokens_map.json
 51%|█████     | 501/980 [35:42<1:35:27, 11.96s/it] 51%|█████     | 502/980 [35:45<1:15:16,  9.45s/it] 51%|█████▏    | 503/980 [35:50<1:02:56,  7.92s/it] 51%|█████▏    | 504/980 [35:54<53:12,  6.71s/it]   52%|█████▏    | 505/980 [35:57<45:41,  5.77s/it] 52%|█████▏    | 506/980 [36:00<38:39,  4.89s/it] 52%|█████▏    | 507/980 [36:04<35:47,  4.54s/it] 52%|█████▏    | 508/980 [36:08<36:08,  4.59s/it] 52%|█████▏    | 509/980 [36:13<35:16,  4.49s/it] 52%|█████▏    | 510/980 [36:17<34:19,  4.38s/it]                                                  52%|█████▏    | 510/980 [36:17<34:19,  4.38s/it] 52%|█████▏    | 511/980 [36:20<32:03,  4.10s/it] 52%|█████▏    | 512/980 [36:25<32:31,  4.17s/it] 52%|█████▏    | 513/980 [36:29<32:00,  4.11s/it] 52%|█████▏    | 514/980 [36:34<34:07,  4.39s/it] 53%|█████▎    | 515/980 [36:38<33:56,  4.38s/it] 53%|█████▎    | 516/980 [36:41<31:38,  4.09s/it] 53%|█████▎    | 517/980 [36:45<31:38,  4.10s/it] 53%|█████▎    | 518/980 [36:50<32:01,  4.16s/it] 53%|█████▎    | 519/980 [36:54<33:02,  4.30s/it] 53%|█████▎    | 520/980 [36:57<30:01,  3.92s/it]                                                  53%|█████▎    | 520/980 [36:57<30:01,  3.92s/it] 53%|█████▎    | 521/980 [37:02<30:37,  4.00s/it] 53%|█████▎    | 522/980 [37:06<31:14,  4.09s/it] 53%|█████▎    | 523/980 [37:10<30:43,  4.03s/it] 53%|█████▎    | 524/980 [37:15<32:18,  4.25s/it] 54%|█████▎    | 525/980 [37:18<30:52,  4.07s/it] 54%|█████▎    | 526/980 [37:22<31:15,  4.13s/it] 54%|█████▍    | 527/980 [37:26<30:02,  3.98s/it] 54%|█████▍    | 528/980 [37:30<30:11,  4.01s/it] 54%|█████▍    | 529/980 [37:35<31:18,  4.17s/it] 54%|█████▍    | 530/980 [37:39<30:26,  4.06s/it]                                                  54%|█████▍    | 530/980 [37:39<30:26,  4.06s/it] 54%|█████▍    | 531/980 [37:43<31:16,  4.18s/it] 54%|█████▍    | 532/980 [37:47<31:21,  4.20s/it] 54%|█████▍    | 533/980 [37:51<30:25,  4.08s/it] 54%|█████▍    | 534/980 [37:55<29:21,  3.95s/it] 55%|█████▍    | 535/980 [37:58<28:48,  3.88s/it] 55%|█████▍    | 536/980 [38:03<30:26,  4.11s/it] 55%|█████▍    | 537/980 [38:07<30:40,  4.16s/it] 55%|█████▍    | 538/980 [38:10<28:23,  3.85s/it] 55%|█████▌    | 539/980 [38:14<28:14,  3.84s/it] 55%|█████▌    | 540/980 [38:18<28:09,  3.84s/it]                                                  55%|█████▌    | 540/980 [38:18<28:09,  3.84s/it] 55%|█████▌    | 541/980 [38:22<27:10,  3.71s/it] 55%|█████▌    | 542/980 [38:26<28:06,  3.85s/it] 55%|█████▌    | 543/980 [38:30<29:59,  4.12s/it] 56%|█████▌    | 544/980 [38:34<29:46,  4.10s/it] 56%|█████▌    | 545/980 [38:38<28:16,  3.90s/it] 56%|█████▌    | 546/980 [38:41<26:55,  3.72s/it] 56%|█████▌    | 547/980 [38:45<26:14,  3.64s/it] 56%|█████▌    | 548/980 [38:48<25:43,  3.57s/it] 56%|█████▌    | 549/980 [38:52<26:39,  3.71s/it] 56%|█████▌    | 550/980 [38:56<27:26,  3.83s/it]                                                  56%|█████▌    | 550/980 [38:56<27:26,  3.83s/it] 56%|█████▌    | 551/980 [39:00<26:11,  3.66s/it] 56%|█████▋    | 552/980 [39:04<27:41,  3.88s/it] 56%|█████▋    | 553/980 [39:08<28:56,  4.07s/it] 57%|█████▋    | 554/980 [39:12<27:57,  3.94s/it] 57%|█████▋    | 555/980 [39:16<27:02,  3.82s/it] 57%|█████▋    | 556/980 [39:19<27:10,  3.85s/it] 57%|█████▋    | 557/980 [39:23<26:56,  3.82s/it] 57%|█████▋    | 558/980 [39:27<26:49,  3.81s/it] 57%|█████▋    | 559/980 [39:31<27:13,  3.88s/it] 57%|█████▋    | 560/980 [39:35<26:21,  3.77s/it]                                                  57%|█████▋    | 560/980 [39:35<26:21,  3.77s/it] 57%|█████▋    | 561/980 [39:39<26:56,  3.86s/it] 57%|█████▋    | 562/980 [39:44<29:24,  4.22s/it] 57%|█████▋    | 563/980 [39:47<28:07,  4.05s/it] 58%|█████▊    | 564/980 [39:53<30:51,  4.45s/it] 58%|█████▊    | 565/980 [39:56<28:01,  4.05s/it] 58%|█████▊    | 566/980 [40:00<28:10,  4.08s/it] 58%|█████▊    | 567/980 [40:04<26:57,  3.92s/it] 58%|█████▊    | 568/980 [40:07<26:25,  3.85s/it] 58%|█████▊    | 569/980 [40:12<27:37,  4.03s/it] 58%|█████▊    | 570/980 [40:16<28:54,  4.23s/it]                                                  58%|█████▊    | 570/980 [40:16<28:54,  4.23s/it] 58%|█████▊    | 571/980 [40:20<28:06,  4.12s/it] 58%|█████▊    | 572/980 [40:24<27:03,  3.98s/it] 58%|█████▊    | 573/980 [40:28<27:05,  3.99s/it] 59%|█████▊    | 574/980 [40:32<26:27,  3.91s/it] 59%|█████▊    | 575/980 [40:36<27:15,  4.04s/it] 59%|█████▉    | 576/980 [40:40<27:06,  4.03s/it] 59%|█████▉    | 577/980 [40:44<27:25,  4.08s/it] 59%|█████▉    | 578/980 [40:48<27:13,  4.06s/it] 59%|█████▉    | 579/980 [40:52<26:23,  3.95s/it] 59%|█████▉    | 580/980 [40:56<26:50,  4.03s/it]                                                  59%|█████▉    | 580/980 [40:56<26:50,  4.03s/it] 59%|█████▉    | 581/980 [41:00<26:25,  3.97s/it] 59%|█████▉    | 582/980 [41:04<25:49,  3.89s/it] 59%|█████▉    | 583/980 [41:09<28:45,  4.35s/it] 60%|█████▉    | 584/980 [41:14<28:58,  4.39s/it] 60%|█████▉    | 585/980 [41:18<28:24,  4.31s/it] 60%|█████▉    | 586/980 [41:22<28:37,  4.36s/it] 60%|█████▉    | 587/980 [41:26<27:33,  4.21s/it] 60%|██████    | 588/980 [41:30<27:12,  4.17s/it] 60%|██████    | 589/980 [41:34<26:53,  4.13s/it] 60%|██████    | 590/980 [41:38<26:41,  4.11s/it]                                                  60%|██████    | 590/980 [41:38<26:41,  4.11s/it] 60%|██████    | 591/980 [41:41<24:52,  3.84s/it] 60%|██████    | 592/980 [41:45<25:16,  3.91s/it] 61%|██████    | 593/980 [41:50<27:05,  4.20s/it] 61%|██████    | 594/980 [41:55<26:56,  4.19s/it] 61%|██████    | 595/980 [41:58<26:06,  4.07s/it] 61%|██████    | 596/980 [42:02<24:33,  3.84s/it] 61%|██████    | 597/980 [42:06<24:46,  3.88s/it] 61%|██████    | 598/980 [42:09<24:03,  3.78s/it] 61%|██████    | 599/980 [42:13<23:57,  3.77s/it] 61%|██████    | 600/980 [42:16<23:31,  3.71s/it]                                                  61%|██████    | 600/980 [42:16<23:31,  3.71s/it][INFO|trainer.py:4021] 2024-11-06 05:29:28,675 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:29:28,675 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:29:28,675 >>   Batch size = 4
{'eval_loss': 0.13340482115745544, 'eval_runtime': 26.1504, 'eval_samples_per_second': 26.768, 'eval_steps_per_second': 6.692, 'epoch': 2.54}
{'loss': 0.1094, 'grad_norm': 1.2722678184509277, 'learning_rate': 2.339824450048218e-05, 'epoch': 2.59}
{'loss': 0.093, 'grad_norm': 1.3563270568847656, 'learning_rate': 2.2599424352307957e-05, 'epoch': 2.64}
{'loss': 0.0915, 'grad_norm': 1.6959896087646484, 'learning_rate': 2.1803070957887347e-05, 'epoch': 2.69}
{'loss': 0.0994, 'grad_norm': 1.8469306230545044, 'learning_rate': 2.1010002624165527e-05, 'epoch': 2.74}
{'loss': 0.1086, 'grad_norm': 1.1782095432281494, 'learning_rate': 2.02210342824657e-05, 'epoch': 2.79}
{'loss': 0.108, 'grad_norm': 1.023361086845398, 'learning_rate': 1.9436976651092144e-05, 'epoch': 2.84}
{'loss': 0.0935, 'grad_norm': 1.2615491151809692, 'learning_rate': 1.865863540226232e-05, 'epoch': 2.9}
{'loss': 0.0892, 'grad_norm': 0.9799651503562927, 'learning_rate': 1.7886810334224192e-05, 'epoch': 2.95}
{'loss': 0.087, 'grad_norm': 1.3665986061096191, 'learning_rate': 1.7122294549409484e-05, 'epoch': 3.0}
{'loss': 0.0754, 'grad_norm': 1.3938663005828857, 'learning_rate': 1.6365873639467315e-05, 'epoch': 3.05}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.35it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.45it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.36it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.67it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.28it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.39it/s][A
  6%|▌         | 10/175 [00:01<00:22,  7.20it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.54it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.50it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.24it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.55it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.59it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.61it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.12it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.04it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.49it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.62it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.36it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.67it/s][A
 14%|█▍        | 25/175 [00:03<00:20,  7.16it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.68it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.62it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  8.01it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.80it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.75it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.36it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.16it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.81it/s][A
 19%|█▉        | 34/175 [00:04<00:22,  6.17it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.51it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.54it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.72it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.84it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.78it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.76it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.22it/s][A
 25%|██▌       | 44/175 [00:06<00:17,  7.30it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.41it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.84it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.29it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.14it/s][A
 28%|██▊       | 49/175 [00:06<00:17,  7.08it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.09it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.25it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.71it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.04it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.17it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.59it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  7.00it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  7.02it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.77it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.14it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.33it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.01it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.88it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.56it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.41it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.64it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.05it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.47it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.39it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.58it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.35it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.19it/s][A
 45%|████▌     | 79/175 [00:11<00:18,  5.33it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.66it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.84it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.77it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.69it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.25it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.11it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.23it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.62it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.97it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.62it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.41it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.57it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.15it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.45it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.94it/s][A
 56%|█████▌    | 98/175 [00:14<00:15,  5.13it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.85it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.06it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.77it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.76it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.46it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.52it/s][A
 61%|██████    | 106/175 [00:15<00:08,  7.97it/s][A
 61%|██████    | 107/175 [00:15<00:09,  6.96it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.88it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.28it/s][A
 63%|██████▎   | 111/175 [00:16<00:09,  7.11it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.24it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.77it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.06it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.76it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.44it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.64it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.04it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.45it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.83it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.42it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.24it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.50it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.71it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.32it/s][A
 73%|███████▎  | 127/175 [00:19<00:10,  4.78it/s][A
 73%|███████▎  | 128/175 [00:19<00:09,  5.21it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.35it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.78it/s][A
 75%|███████▍  | 131/175 [00:20<00:06,  6.56it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.83it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.89it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.28it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.07it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.31it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.19it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.43it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.64it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.84it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.00it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.33it/s][A
 83%|████████▎ | 146/175 [00:22<00:03,  7.29it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.53it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.63it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.58it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.87it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.54it/s][A
 88%|████████▊ | 154/175 [00:23<00:02,  8.16it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.04it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.49it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.46it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.63it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.00it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.03it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.68it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.85it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.35it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.79it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.43it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.48it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.31it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.56it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.14it/s][A
 99%|█████████▉| 174/175 [00:26<00:00,  5.91it/s][A                                                 
                                                 [A 61%|██████    | 600/980 [42:43<23:31,  3.71s/it]
100%|██████████| 175/175 [00:26<00:00,  5.91it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:29:54,858 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-600
[INFO|configuration_utils.py:673] 2024-11-06 05:29:54,879 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:29:54,880 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:29:54,983 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:29:54,983 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-600/special_tokens_map.json
 61%|██████▏   | 601/980 [42:46<1:12:54, 11.54s/it] 61%|██████▏   | 602/980 [42:50<58:20,  9.26s/it]   62%|██████▏   | 603/980 [42:54<48:29,  7.72s/it] 62%|██████▏   | 604/980 [42:59<42:15,  6.74s/it] 62%|██████▏   | 605/980 [43:03<37:49,  6.05s/it] 62%|██████▏   | 606/980 [43:07<32:42,  5.25s/it] 62%|██████▏   | 607/980 [43:10<29:58,  4.82s/it] 62%|██████▏   | 608/980 [43:14<28:29,  4.59s/it] 62%|██████▏   | 609/980 [43:18<27:18,  4.42s/it] 62%|██████▏   | 610/980 [43:23<26:59,  4.38s/it]                                                  62%|██████▏   | 610/980 [43:23<26:59,  4.38s/it] 62%|██████▏   | 611/980 [43:27<27:01,  4.40s/it] 62%|██████▏   | 612/980 [43:32<27:06,  4.42s/it] 63%|██████▎   | 613/980 [43:35<25:21,  4.14s/it] 63%|██████▎   | 614/980 [43:38<23:21,  3.83s/it] 63%|██████▎   | 615/980 [43:42<22:55,  3.77s/it] 63%|██████▎   | 616/980 [43:46<23:07,  3.81s/it] 63%|██████▎   | 617/980 [43:50<23:45,  3.93s/it] 63%|██████▎   | 618/980 [43:54<22:53,  3.79s/it] 63%|██████▎   | 619/980 [43:57<22:55,  3.81s/it] 63%|██████▎   | 620/980 [44:01<22:38,  3.77s/it]                                                  63%|██████▎   | 620/980 [44:01<22:38,  3.77s/it] 63%|██████▎   | 621/980 [44:05<23:00,  3.85s/it] 63%|██████▎   | 622/980 [44:10<24:14,  4.06s/it] 64%|██████▎   | 623/980 [44:14<25:32,  4.29s/it] 64%|██████▎   | 624/980 [44:18<23:37,  3.98s/it] 64%|██████▍   | 625/980 [44:22<23:37,  3.99s/it] 64%|██████▍   | 626/980 [44:25<23:00,  3.90s/it] 64%|██████▍   | 627/980 [44:29<22:13,  3.78s/it] 64%|██████▍   | 628/980 [44:33<22:38,  3.86s/it] 64%|██████▍   | 629/980 [44:38<25:09,  4.30s/it] 64%|██████▍   | 630/980 [44:42<24:24,  4.18s/it]                                                  64%|██████▍   | 630/980 [44:42<24:24,  4.18s/it] 64%|██████▍   | 631/980 [44:46<24:05,  4.14s/it] 64%|██████▍   | 632/980 [44:51<24:14,  4.18s/it] 65%|██████▍   | 633/980 [44:54<22:52,  3.96s/it] 65%|██████▍   | 634/980 [44:58<22:41,  3.93s/it] 65%|██████▍   | 635/980 [45:02<23:24,  4.07s/it] 65%|██████▍   | 636/980 [45:06<22:48,  3.98s/it] 65%|██████▌   | 637/980 [45:11<24:08,  4.22s/it] 65%|██████▌   | 638/980 [45:14<22:22,  3.93s/it] 65%|██████▌   | 639/980 [45:18<21:51,  3.85s/it] 65%|██████▌   | 640/980 [45:22<21:56,  3.87s/it]                                                  65%|██████▌   | 640/980 [45:22<21:56,  3.87s/it] 65%|██████▌   | 641/980 [45:26<22:26,  3.97s/it] 66%|██████▌   | 642/980 [45:29<21:26,  3.80s/it] 66%|██████▌   | 643/980 [45:33<21:52,  3.90s/it] 66%|██████▌   | 644/980 [45:38<22:49,  4.08s/it] 66%|██████▌   | 645/980 [45:42<23:17,  4.17s/it] 66%|██████▌   | 646/980 [45:47<23:51,  4.29s/it] 66%|██████▌   | 647/980 [45:51<23:43,  4.28s/it] 66%|██████▌   | 648/980 [45:55<22:28,  4.06s/it] 66%|██████▌   | 649/980 [45:59<23:01,  4.17s/it] 66%|██████▋   | 650/980 [46:04<23:45,  4.32s/it]                                                  66%|██████▋   | 650/980 [46:04<23:45,  4.32s/it] 66%|██████▋   | 651/980 [46:08<22:58,  4.19s/it] 67%|██████▋   | 652/980 [46:11<22:10,  4.06s/it] 67%|██████▋   | 653/980 [46:15<21:52,  4.01s/it] 67%|██████▋   | 654/980 [46:19<21:56,  4.04s/it] 67%|██████▋   | 655/980 [46:23<21:29,  3.97s/it] 67%|██████▋   | 656/980 [46:28<22:27,  4.16s/it] 67%|██████▋   | 657/980 [46:32<22:22,  4.16s/it] 67%|██████▋   | 658/980 [46:36<22:04,  4.11s/it] 67%|██████▋   | 659/980 [46:40<21:41,  4.06s/it] 67%|██████▋   | 660/980 [46:44<21:38,  4.06s/it]                                                  67%|██████▋   | 660/980 [46:44<21:38,  4.06s/it] 67%|██████▋   | 661/980 [46:48<20:57,  3.94s/it] 68%|██████▊   | 662/980 [46:52<21:06,  3.98s/it] 68%|██████▊   | 663/980 [46:56<21:26,  4.06s/it] 68%|██████▊   | 664/980 [47:00<21:49,  4.14s/it] 68%|██████▊   | 665/980 [47:04<21:07,  4.03s/it] 68%|██████▊   | 666/980 [47:08<20:40,  3.95s/it] 68%|██████▊   | 667/980 [47:11<19:46,  3.79s/it] 68%|██████▊   | 668/980 [47:15<19:45,  3.80s/it] 68%|██████▊   | 669/980 [47:19<19:43,  3.81s/it] 68%|██████▊   | 670/980 [47:22<18:24,  3.56s/it]                                                  68%|██████▊   | 670/980 [47:22<18:24,  3.56s/it] 68%|██████▊   | 671/980 [47:25<17:59,  3.49s/it] 69%|██████▊   | 672/980 [47:28<17:34,  3.42s/it] 69%|██████▊   | 673/980 [47:33<19:22,  3.79s/it] 69%|██████▉   | 674/980 [47:37<19:20,  3.79s/it] 69%|██████▉   | 675/980 [47:41<19:19,  3.80s/it] 69%|██████▉   | 676/980 [47:44<18:50,  3.72s/it] 69%|██████▉   | 677/980 [47:48<18:14,  3.61s/it] 69%|██████▉   | 678/980 [47:51<18:25,  3.66s/it] 69%|██████▉   | 679/980 [47:55<18:38,  3.72s/it] 69%|██████▉   | 680/980 [47:58<17:46,  3.56s/it]                                                  69%|██████▉   | 680/980 [47:58<17:46,  3.56s/it] 69%|██████▉   | 681/980 [48:01<16:54,  3.39s/it] 70%|██████▉   | 682/980 [48:05<17:06,  3.44s/it] 70%|██████▉   | 683/980 [48:09<18:14,  3.69s/it] 70%|██████▉   | 684/980 [48:13<18:18,  3.71s/it] 70%|██████▉   | 685/980 [48:17<18:14,  3.71s/it] 70%|███████   | 686/980 [48:22<20:04,  4.10s/it] 70%|███████   | 687/980 [48:25<19:21,  3.97s/it] 70%|███████   | 688/980 [48:30<20:32,  4.22s/it] 70%|███████   | 689/980 [48:35<21:28,  4.43s/it] 70%|███████   | 690/980 [48:39<20:05,  4.16s/it]                                                  70%|███████   | 690/980 [48:39<20:05,  4.16s/it] 71%|███████   | 691/980 [48:42<19:29,  4.05s/it] 71%|███████   | 692/980 [48:46<19:11,  4.00s/it] 71%|███████   | 693/980 [48:50<18:08,  3.79s/it] 71%|███████   | 694/980 [48:54<19:10,  4.02s/it] 71%|███████   | 695/980 [48:59<19:51,  4.18s/it] 71%|███████   | 696/980 [49:03<19:23,  4.10s/it] 71%|███████   | 697/980 [49:06<17:58,  3.81s/it] 71%|███████   | 698/980 [49:09<17:29,  3.72s/it] 71%|███████▏  | 699/980 [49:13<17:41,  3.78s/it] 71%|███████▏  | 700/980 [49:17<17:55,  3.84s/it]                                                  71%|███████▏  | 700/980 [49:17<17:55,  3.84s/it][INFO|trainer.py:4021] 2024-11-06 05:36:29,321 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:36:29,321 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:36:29,321 >>   Batch size = 4
{'eval_loss': 0.11899930983781815, 'eval_runtime': 26.1826, 'eval_samples_per_second': 26.735, 'eval_steps_per_second': 6.684, 'epoch': 3.05}
{'loss': 0.0722, 'grad_norm': 0.9431683421134949, 'learning_rate': 1.561832487801565e-05, 'epoch': 3.1}
{'loss': 0.0792, 'grad_norm': 1.2068281173706055, 'learning_rate': 1.4880416421940155e-05, 'epoch': 3.15}
{'loss': 0.0718, 'grad_norm': 1.146267294883728, 'learning_rate': 1.4152906522061048e-05, 'epoch': 3.2}
{'loss': 0.0661, 'grad_norm': 1.3579281568527222, 'learning_rate': 1.3436542743979125e-05, 'epoch': 3.25}
{'loss': 0.0711, 'grad_norm': 1.504146933555603, 'learning_rate': 1.2732061199901562e-05, 'epoch': 3.3}
{'loss': 0.0615, 'grad_norm': 1.08335280418396, 'learning_rate': 1.2040185792236874e-05, 'epoch': 3.35}
{'loss': 0.0694, 'grad_norm': 1.421995997428894, 'learning_rate': 1.1361627469736285e-05, 'epoch': 3.4}
{'loss': 0.0912, 'grad_norm': 1.1391630172729492, 'learning_rate': 1.0697083496945765e-05, 'epoch': 3.45}
{'loss': 0.0652, 'grad_norm': 0.7425748705863953, 'learning_rate': 1.0047236737719601e-05, 'epoch': 3.5}
{'loss': 0.0631, 'grad_norm': 1.2166213989257812, 'learning_rate': 9.412754953531663e-06, 'epoch': 3.56}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.33it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.46it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.36it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.67it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.27it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.39it/s][A
  6%|▌         | 10/175 [00:01<00:22,  7.18it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.51it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.46it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.22it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.48it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.53it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.57it/s][A
 10%|▉         | 17/175 [00:02<00:26,  6.06it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.00it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.47it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.57it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.30it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.65it/s][A
 14%|█▍        | 25/175 [00:03<00:21,  7.11it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.63it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.57it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  7.96it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.77it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.74it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.35it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.13it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.79it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.14it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.49it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.52it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.68it/s][A
 22%|██▏       | 39/175 [00:05<00:20,  6.79it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.71it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.70it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.17it/s][A
 25%|██▌       | 44/175 [00:06<00:18,  7.27it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.38it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.81it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.28it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.13it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.07it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.10it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.25it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.03it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.16it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  6.97it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  6.99it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.75it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.13it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.35it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.02it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.90it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.59it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.43it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.64it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.05it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.49it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.41it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.60it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.38it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.22it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.68it/s][A
 46%|████▋     | 81/175 [00:12<00:19,  4.85it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.78it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.69it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.25it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.13it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.23it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.63it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.98it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.62it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.42it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.58it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.17it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.47it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.96it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.13it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.86it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.07it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.46it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.52it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.01it/s][A
 61%|██████    | 107/175 [00:15<00:09,  6.99it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.91it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.31it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.14it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.29it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.82it/s][A
 65%|██████▌   | 114/175 [00:17<00:10,  6.08it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.78it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.46it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.66it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.07it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.47it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.84it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.43it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.24it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.51it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.72it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.33it/s][A
 73%|███████▎  | 127/175 [00:19<00:10,  4.79it/s][A
 73%|███████▎  | 128/175 [00:19<00:09,  5.22it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.35it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.80it/s][A
 75%|███████▍  | 131/175 [00:20<00:06,  6.60it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.87it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.94it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.35it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.13it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.39it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.25it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.45it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.66it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.86it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.02it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.34it/s][A
 83%|████████▎ | 146/175 [00:22<00:03,  7.30it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.54it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.65it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.59it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.88it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.56it/s][A
 88%|████████▊ | 154/175 [00:23<00:02,  8.19it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.05it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.50it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.47it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.65it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.00it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.03it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.68it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.87it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.38it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.84it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.46it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.49it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.33it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.55it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.14it/s][A
 99%|█████████▉| 174/175 [00:26<00:00,  5.91it/s][A                                                 
                                                 [A 71%|███████▏  | 700/980 [49:43<17:55,  3.84s/it]
100%|██████████| 175/175 [00:26<00:00,  5.91it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:36:55,495 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-700
[INFO|configuration_utils.py:673] 2024-11-06 05:36:55,516 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:36:55,516 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:36:55,621 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:36:55,622 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-700/special_tokens_map.json
 72%|███████▏  | 701/980 [49:48<55:55, 12.03s/it] 72%|███████▏  | 702/980 [49:53<46:13,  9.98s/it] 72%|███████▏  | 703/980 [49:58<38:08,  8.26s/it] 72%|███████▏  | 704/980 [50:02<31:51,  6.93s/it] 72%|███████▏  | 705/980 [50:05<27:01,  5.90s/it] 72%|███████▏  | 706/980 [50:09<24:51,  5.44s/it] 72%|███████▏  | 707/980 [50:13<22:12,  4.88s/it] 72%|███████▏  | 708/980 [50:17<21:21,  4.71s/it] 72%|███████▏  | 709/980 [50:22<20:51,  4.62s/it] 72%|███████▏  | 710/980 [50:26<19:43,  4.38s/it]                                                  72%|███████▏  | 710/980 [50:26<19:43,  4.38s/it] 73%|███████▎  | 711/980 [50:30<19:40,  4.39s/it] 73%|███████▎  | 712/980 [50:34<19:01,  4.26s/it] 73%|███████▎  | 713/980 [50:37<18:05,  4.06s/it] 73%|███████▎  | 714/980 [50:42<18:44,  4.23s/it] 73%|███████▎  | 715/980 [50:47<19:07,  4.33s/it] 73%|███████▎  | 716/980 [50:50<18:04,  4.11s/it] 73%|███████▎  | 717/980 [50:54<17:54,  4.09s/it] 73%|███████▎  | 718/980 [50:58<17:54,  4.10s/it] 73%|███████▎  | 719/980 [51:02<16:32,  3.80s/it] 73%|███████▎  | 720/980 [51:06<16:56,  3.91s/it]                                                  73%|███████▎  | 720/980 [51:06<16:56,  3.91s/it] 74%|███████▎  | 721/980 [51:10<16:57,  3.93s/it] 74%|███████▎  | 722/980 [51:14<17:06,  3.98s/it] 74%|███████▍  | 723/980 [51:17<16:35,  3.88s/it] 74%|███████▍  | 724/980 [51:21<16:22,  3.84s/it] 74%|███████▍  | 725/980 [51:25<16:41,  3.93s/it] 74%|███████▍  | 726/980 [51:28<15:15,  3.61s/it] 74%|███████▍  | 727/980 [51:32<15:03,  3.57s/it] 74%|███████▍  | 728/980 [51:36<16:01,  3.82s/it] 74%|███████▍  | 729/980 [51:40<15:43,  3.76s/it] 74%|███████▍  | 730/980 [51:43<15:22,  3.69s/it]                                                  74%|███████▍  | 730/980 [51:43<15:22,  3.69s/it] 75%|███████▍  | 731/980 [51:48<16:11,  3.90s/it] 75%|███████▍  | 732/980 [51:53<17:45,  4.30s/it] 75%|███████▍  | 733/980 [51:57<17:07,  4.16s/it] 75%|███████▍  | 734/980 [52:01<17:38,  4.30s/it] 75%|███████▌  | 735/980 [52:06<18:37,  4.56s/it] 75%|███████▌  | 736/980 [52:10<17:19,  4.26s/it] 75%|███████▌  | 737/980 [52:14<16:37,  4.11s/it] 75%|███████▌  | 738/980 [52:17<15:51,  3.93s/it] 75%|███████▌  | 739/980 [52:21<15:13,  3.79s/it] 76%|███████▌  | 740/980 [52:24<14:59,  3.75s/it]                                                  76%|███████▌  | 740/980 [52:24<14:59,  3.75s/it] 76%|███████▌  | 741/980 [52:29<15:33,  3.91s/it] 76%|███████▌  | 742/980 [52:33<15:52,  4.00s/it] 76%|███████▌  | 743/980 [52:37<15:51,  4.01s/it] 76%|███████▌  | 744/980 [52:41<15:44,  4.00s/it] 76%|███████▌  | 745/980 [52:45<16:18,  4.16s/it] 76%|███████▌  | 746/980 [52:49<15:04,  3.87s/it] 76%|███████▌  | 747/980 [52:53<16:13,  4.18s/it] 76%|███████▋  | 748/980 [52:59<17:10,  4.44s/it] 76%|███████▋  | 749/980 [53:03<17:25,  4.52s/it] 77%|███████▋  | 750/980 [53:07<16:15,  4.24s/it]                                                  77%|███████▋  | 750/980 [53:07<16:15,  4.24s/it] 77%|███████▋  | 751/980 [53:11<15:35,  4.09s/it] 77%|███████▋  | 752/980 [53:15<15:46,  4.15s/it] 77%|███████▋  | 753/980 [53:19<15:33,  4.11s/it] 77%|███████▋  | 754/980 [53:23<15:14,  4.05s/it] 77%|███████▋  | 755/980 [53:27<14:50,  3.96s/it] 77%|███████▋  | 756/980 [53:32<16:33,  4.44s/it] 77%|███████▋  | 757/980 [53:36<15:44,  4.24s/it] 77%|███████▋  | 758/980 [53:41<16:12,  4.38s/it] 77%|███████▋  | 759/980 [53:45<15:45,  4.28s/it] 78%|███████▊  | 760/980 [53:48<14:31,  3.96s/it]                                                  78%|███████▊  | 760/980 [53:48<14:31,  3.96s/it] 78%|███████▊  | 761/980 [53:51<14:00,  3.84s/it] 78%|███████▊  | 762/980 [53:55<13:48,  3.80s/it] 78%|███████▊  | 763/980 [54:00<14:35,  4.03s/it] 78%|███████▊  | 764/980 [54:04<15:00,  4.17s/it] 78%|███████▊  | 765/980 [54:08<14:58,  4.18s/it] 78%|███████▊  | 766/980 [54:13<15:11,  4.26s/it] 78%|███████▊  | 767/980 [54:18<15:37,  4.40s/it] 78%|███████▊  | 768/980 [54:22<16:04,  4.55s/it] 78%|███████▊  | 769/980 [54:27<16:15,  4.63s/it] 79%|███████▊  | 770/980 [54:31<15:07,  4.32s/it]                                                  79%|███████▊  | 770/980 [54:31<15:07,  4.32s/it] 79%|███████▊  | 771/980 [54:34<14:13,  4.08s/it] 79%|███████▉  | 772/980 [54:37<12:58,  3.74s/it] 79%|███████▉  | 773/980 [54:43<14:33,  4.22s/it] 79%|███████▉  | 774/980 [54:46<13:35,  3.96s/it] 79%|███████▉  | 775/980 [54:50<13:33,  3.97s/it] 79%|███████▉  | 776/980 [54:54<13:36,  4.00s/it] 79%|███████▉  | 777/980 [54:58<13:53,  4.10s/it] 79%|███████▉  | 778/980 [55:02<13:43,  4.08s/it] 79%|███████▉  | 779/980 [55:06<13:12,  3.94s/it] 80%|███████▉  | 780/980 [55:10<13:19,  4.00s/it]                                                  80%|███████▉  | 780/980 [55:10<13:19,  4.00s/it] 80%|███████▉  | 781/980 [55:14<13:18,  4.01s/it] 80%|███████▉  | 782/980 [55:18<13:06,  3.97s/it] 80%|███████▉  | 783/980 [55:23<13:36,  4.14s/it] 80%|████████  | 784/980 [55:26<12:57,  3.97s/it] 80%|████████  | 785/980 [55:31<13:20,  4.11s/it] 80%|████████  | 786/980 [55:35<13:44,  4.25s/it] 80%|████████  | 787/980 [55:39<13:20,  4.15s/it] 80%|████████  | 788/980 [55:42<12:15,  3.83s/it] 81%|████████  | 789/980 [55:46<11:55,  3.75s/it] 81%|████████  | 790/980 [55:50<12:28,  3.94s/it]                                                  81%|████████  | 790/980 [55:50<12:28,  3.94s/it] 81%|████████  | 791/980 [55:55<13:31,  4.29s/it] 81%|████████  | 792/980 [56:00<13:24,  4.28s/it] 81%|████████  | 793/980 [56:03<12:33,  4.03s/it] 81%|████████  | 794/980 [56:07<12:29,  4.03s/it] 81%|████████  | 795/980 [56:11<12:07,  3.93s/it] 81%|████████  | 796/980 [56:15<11:56,  3.89s/it] 81%|████████▏ | 797/980 [56:19<12:05,  3.96s/it] 81%|████████▏ | 798/980 [56:23<12:31,  4.13s/it] 82%|████████▏ | 799/980 [56:27<12:28,  4.14s/it] 82%|████████▏ | 800/980 [56:32<12:49,  4.28s/it]                                                  82%|████████▏ | 800/980 [56:32<12:49,  4.28s/it][INFO|trainer.py:4021] 2024-11-06 05:43:44,130 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:43:44,131 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:43:44,131 >>   Batch size = 4
{'eval_loss': 0.11707548052072525, 'eval_runtime': 26.1735, 'eval_samples_per_second': 26.745, 'eval_steps_per_second': 6.686, 'epoch': 3.56}
{'loss': 0.0694, 'grad_norm': 1.368181586265564, 'learning_rate': 8.794290117305296e-06, 'epoch': 3.61}
{'loss': 0.067, 'grad_norm': 1.043707251548767, 'learning_rate': 8.192477743467078e-06, 'epoch': 3.66}
{'loss': 0.0708, 'grad_norm': 1.3566410541534424, 'learning_rate': 7.607936234912841e-06, 'epoch': 3.71}
{'loss': 0.0808, 'grad_norm': 1.3374149799346924, 'learning_rate': 7.041266247556813e-06, 'epoch': 3.76}
{'loss': 0.0683, 'grad_norm': 1.3147488832473755, 'learning_rate': 6.493050073117116e-06, 'epoch': 3.81}
{'loss': 0.0661, 'grad_norm': 1.060612440109253, 'learning_rate': 5.9638510407716394e-06, 'epoch': 3.86}
{'loss': 0.0685, 'grad_norm': 1.5400638580322266, 'learning_rate': 5.454212938299255e-06, 'epoch': 3.91}
{'loss': 0.0732, 'grad_norm': 1.2258412837982178, 'learning_rate': 4.9646594533010875e-06, 'epoch': 3.96}
{'loss': 0.0605, 'grad_norm': 1.1550198793411255, 'learning_rate': 4.495693635076101e-06, 'epoch': 4.01}
{'loss': 0.0556, 'grad_norm': 1.202544093132019, 'learning_rate': 4.047797377703985e-06, 'epoch': 4.06}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.34it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.46it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.36it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.68it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.28it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.40it/s][A
  6%|▌         | 10/175 [00:01<00:22,  7.20it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.53it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.48it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.23it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.52it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.56it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.58it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.09it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.02it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.47it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.59it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.32it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.66it/s][A
 14%|█▍        | 25/175 [00:03<00:21,  7.13it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.66it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.60it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  8.00it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.80it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.75it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.35it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.14it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.79it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.15it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.50it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.54it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.72it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.83it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.77it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.74it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.21it/s][A
 25%|██▌       | 44/175 [00:06<00:17,  7.29it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.40it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.82it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.28it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.14it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.08it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.08it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.22it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.05it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.18it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.85it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  7.00it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  7.01it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.77it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.17it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.40it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.07it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.94it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.61it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.46it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.66it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.08it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.51it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.42it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.60it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.36it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.20it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.67it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.86it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.79it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.70it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.26it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.13it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.24it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.62it/s][A
 51%|█████     | 89/175 [00:13<00:14,  5.97it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.62it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.43it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.60it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.20it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.49it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.98it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.15it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.88it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.08it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.81it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.79it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.48it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.53it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.01it/s][A
 61%|██████    | 107/175 [00:15<00:09,  7.00it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.93it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.33it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.16it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.29it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.82it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.08it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.78it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.46it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.67it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.08it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.47it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.84it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.43it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.25it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.10it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.52it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.74it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.35it/s][A
 73%|███████▎  | 127/175 [00:19<00:09,  4.81it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.24it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.37it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.82it/s][A
 75%|███████▍  | 131/175 [00:19<00:06,  6.63it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.89it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.95it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.35it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.14it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.39it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.26it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.47it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.68it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.87it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.04it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.37it/s][A
 83%|████████▎ | 146/175 [00:21<00:03,  7.33it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.56it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.64it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.59it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.87it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.55it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.18it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.06it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.50it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.49it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.67it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.03it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.05it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.70it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.89it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.37it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.83it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.47it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.50it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.33it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.57it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.16it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.93it/s][A                                                 
                                                 [A 82%|████████▏ | 800/980 [56:58<12:49,  4.28s/it]
100%|██████████| 175/175 [00:26<00:00,  5.93it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:44:10,253 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-800
[INFO|configuration_utils.py:673] 2024-11-06 05:44:10,273 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:44:10,274 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:44:10,373 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:44:10,373 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-800/special_tokens_map.json
 82%|████████▏ | 801/980 [57:02<36:13, 12.14s/it] 82%|████████▏ | 802/980 [57:07<29:25,  9.92s/it] 82%|████████▏ | 803/980 [57:12<24:42,  8.38s/it] 82%|████████▏ | 804/980 [57:15<20:12,  6.89s/it] 82%|████████▏ | 805/980 [57:19<17:16,  5.92s/it] 82%|████████▏ | 806/980 [57:24<16:14,  5.60s/it] 82%|████████▏ | 807/980 [57:27<14:12,  4.93s/it] 82%|████████▏ | 808/980 [57:31<13:10,  4.60s/it] 83%|████████▎ | 809/980 [57:36<13:05,  4.59s/it] 83%|████████▎ | 810/980 [57:39<11:52,  4.19s/it]                                                  83%|████████▎ | 810/980 [57:39<11:52,  4.19s/it] 83%|████████▎ | 811/980 [57:43<11:32,  4.10s/it] 83%|████████▎ | 812/980 [57:48<12:01,  4.29s/it] 83%|████████▎ | 813/980 [57:50<10:43,  3.86s/it] 83%|████████▎ | 814/980 [57:55<11:24,  4.13s/it] 83%|████████▎ | 815/980 [57:58<10:27,  3.81s/it] 83%|████████▎ | 816/980 [58:03<11:00,  4.03s/it] 83%|████████▎ | 817/980 [58:06<10:44,  3.96s/it] 83%|████████▎ | 818/980 [58:11<11:13,  4.16s/it] 84%|████████▎ | 819/980 [58:16<12:04,  4.50s/it] 84%|████████▎ | 820/980 [58:20<11:36,  4.35s/it]                                                  84%|████████▎ | 820/980 [58:20<11:36,  4.35s/it] 84%|████████▍ | 821/980 [58:24<10:38,  4.02s/it] 84%|████████▍ | 822/980 [58:27<10:08,  3.85s/it] 84%|████████▍ | 823/980 [58:31<10:03,  3.85s/it] 84%|████████▍ | 824/980 [58:35<10:21,  3.98s/it] 84%|████████▍ | 825/980 [58:39<10:04,  3.90s/it] 84%|████████▍ | 826/980 [58:43<09:52,  3.84s/it] 84%|████████▍ | 827/980 [58:46<09:40,  3.79s/it] 84%|████████▍ | 828/980 [58:51<10:23,  4.10s/it] 85%|████████▍ | 829/980 [58:55<09:59,  3.97s/it] 85%|████████▍ | 830/980 [58:59<10:15,  4.10s/it]                                                  85%|████████▍ | 830/980 [58:59<10:15,  4.10s/it] 85%|████████▍ | 831/980 [59:03<10:03,  4.05s/it] 85%|████████▍ | 832/980 [59:07<10:02,  4.07s/it] 85%|████████▌ | 833/980 [59:13<11:04,  4.52s/it] 85%|████████▌ | 834/980 [59:17<10:54,  4.48s/it] 85%|████████▌ | 835/980 [59:22<10:59,  4.55s/it] 85%|████████▌ | 836/980 [59:25<10:05,  4.20s/it] 85%|████████▌ | 837/980 [59:29<09:50,  4.13s/it] 86%|████████▌ | 838/980 [59:34<09:51,  4.17s/it] 86%|████████▌ | 839/980 [59:36<08:53,  3.78s/it] 86%|████████▌ | 840/980 [59:42<09:51,  4.22s/it]                                                  86%|████████▌ | 840/980 [59:42<09:51,  4.22s/it] 86%|████████▌ | 841/980 [59:46<09:37,  4.16s/it] 86%|████████▌ | 842/980 [59:49<08:52,  3.86s/it] 86%|████████▌ | 843/980 [59:52<08:37,  3.78s/it] 86%|████████▌ | 844/980 [59:56<08:08,  3.59s/it] 86%|████████▌ | 845/980 [59:59<07:53,  3.50s/it] 86%|████████▋ | 846/980 [1:00:04<08:33,  3.83s/it] 86%|████████▋ | 847/980 [1:00:07<08:15,  3.72s/it] 87%|████████▋ | 848/980 [1:00:11<08:27,  3.84s/it] 87%|████████▋ | 849/980 [1:00:16<09:03,  4.15s/it] 87%|████████▋ | 850/980 [1:00:20<08:49,  4.07s/it]                                                    87%|████████▋ | 850/980 [1:00:20<08:49,  4.07s/it] 87%|████████▋ | 851/980 [1:00:24<08:29,  3.95s/it] 87%|████████▋ | 852/980 [1:00:27<08:21,  3.92s/it] 87%|████████▋ | 853/980 [1:00:31<08:22,  3.96s/it] 87%|████████▋ | 854/980 [1:00:36<09:00,  4.29s/it] 87%|████████▋ | 855/980 [1:00:40<08:32,  4.10s/it] 87%|████████▋ | 856/980 [1:00:44<08:08,  3.94s/it] 87%|████████▋ | 857/980 [1:00:48<08:09,  3.98s/it] 88%|████████▊ | 858/980 [1:00:51<07:55,  3.90s/it] 88%|████████▊ | 859/980 [1:00:56<08:23,  4.16s/it] 88%|████████▊ | 860/980 [1:01:00<08:10,  4.09s/it]                                                    88%|████████▊ | 860/980 [1:01:00<08:10,  4.09s/it] 88%|████████▊ | 861/980 [1:01:04<08:03,  4.06s/it] 88%|████████▊ | 862/980 [1:01:08<08:05,  4.12s/it] 88%|████████▊ | 863/980 [1:01:12<07:48,  4.00s/it] 88%|████████▊ | 864/980 [1:01:16<07:24,  3.83s/it] 88%|████████▊ | 865/980 [1:01:20<07:36,  3.97s/it] 88%|████████▊ | 866/980 [1:01:23<07:12,  3.80s/it] 88%|████████▊ | 867/980 [1:01:27<07:16,  3.86s/it] 89%|████████▊ | 868/980 [1:01:31<07:22,  3.95s/it] 89%|████████▊ | 869/980 [1:01:36<07:23,  4.00s/it] 89%|████████▉ | 870/980 [1:01:40<07:23,  4.03s/it]                                                    89%|████████▉ | 870/980 [1:01:40<07:23,  4.03s/it] 89%|████████▉ | 871/980 [1:01:45<07:51,  4.32s/it] 89%|████████▉ | 872/980 [1:01:49<07:41,  4.27s/it] 89%|████████▉ | 873/980 [1:01:53<07:46,  4.36s/it] 89%|████████▉ | 874/980 [1:01:58<07:45,  4.39s/it] 89%|████████▉ | 875/980 [1:02:03<08:07,  4.64s/it] 89%|████████▉ | 876/980 [1:02:08<08:00,  4.62s/it] 89%|████████▉ | 877/980 [1:02:12<07:40,  4.47s/it] 90%|████████▉ | 878/980 [1:02:15<06:57,  4.09s/it] 90%|████████▉ | 879/980 [1:02:18<06:32,  3.88s/it] 90%|████████▉ | 880/980 [1:02:22<06:28,  3.89s/it]                                                    90%|████████▉ | 880/980 [1:02:22<06:28,  3.89s/it] 90%|████████▉ | 881/980 [1:02:25<06:00,  3.64s/it] 90%|█████████ | 882/980 [1:02:30<06:19,  3.88s/it] 90%|█████████ | 883/980 [1:02:34<06:26,  3.98s/it] 90%|█████████ | 884/980 [1:02:37<05:51,  3.66s/it] 90%|█████████ | 885/980 [1:02:42<06:15,  3.96s/it] 90%|█████████ | 886/980 [1:02:46<06:23,  4.08s/it] 91%|█████████ | 887/980 [1:02:49<05:52,  3.79s/it] 91%|█████████ | 888/980 [1:02:53<05:44,  3.75s/it] 91%|█████████ | 889/980 [1:02:57<05:51,  3.86s/it] 91%|█████████ | 890/980 [1:03:01<05:44,  3.83s/it]                                                    91%|█████████ | 890/980 [1:03:01<05:44,  3.83s/it] 91%|█████████ | 891/980 [1:03:03<05:07,  3.46s/it] 91%|█████████ | 892/980 [1:03:07<05:22,  3.67s/it] 91%|█████████ | 893/980 [1:03:11<05:11,  3.58s/it] 91%|█████████ | 894/980 [1:03:15<05:20,  3.73s/it] 91%|█████████▏| 895/980 [1:03:18<05:06,  3.61s/it] 91%|█████████▏| 896/980 [1:03:21<04:51,  3.48s/it] 92%|█████████▏| 897/980 [1:03:25<05:03,  3.66s/it] 92%|█████████▏| 898/980 [1:03:29<05:10,  3.79s/it] 92%|█████████▏| 899/980 [1:03:33<04:51,  3.60s/it] 92%|█████████▏| 900/980 [1:03:36<04:39,  3.49s/it]                                                    92%|█████████▏| 900/980 [1:03:36<04:39,  3.49s/it][INFO|trainer.py:4021] 2024-11-06 05:50:48,009 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:50:48,010 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:50:48,010 >>   Batch size = 4
{'eval_loss': 0.1131654903292656, 'eval_runtime': 26.1217, 'eval_samples_per_second': 26.798, 'eval_steps_per_second': 6.699, 'epoch': 4.06}
{'loss': 0.0589, 'grad_norm': 0.8349817395210266, 'learning_rate': 3.621430924866348e-06, 'epoch': 4.11}
{'loss': 0.0599, 'grad_norm': 1.438464641571045, 'learning_rate': 3.217032396915265e-06, 'epoch': 4.17}
{'loss': 0.0581, 'grad_norm': 1.3168480396270752, 'learning_rate': 2.8350173406749973e-06, 'epoch': 4.22}
{'loss': 0.0486, 'grad_norm': 0.8702763319015503, 'learning_rate': 2.475778302439524e-06, 'epoch': 4.27}
{'loss': 0.0555, 'grad_norm': 1.3166958093643188, 'learning_rate': 2.1396844246046903e-06, 'epoch': 4.32}
{'loss': 0.0568, 'grad_norm': 1.173749327659607, 'learning_rate': 1.827081066349459e-06, 'epoch': 4.37}
{'loss': 0.0622, 'grad_norm': 1.2063233852386475, 'learning_rate': 1.538289448755989e-06, 'epoch': 4.42}
{'loss': 0.0595, 'grad_norm': 1.2760685682296753, 'learning_rate': 1.273606324733284e-06, 'epoch': 4.47}
{'loss': 0.067, 'grad_norm': 1.5342379808425903, 'learning_rate': 1.0333036740834856e-06, 'epoch': 4.52}
{'loss': 0.0615, 'grad_norm': 1.3252460956573486, 'learning_rate': 8.176284240242638e-07, 'epoch': 4.57}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:16, 10.32it/s][A
  2%|▏         | 4/175 [00:00<00:18,  9.43it/s][A
  3%|▎         | 5/175 [00:00<00:26,  6.35it/s][A
  3%|▎         | 6/175 [00:00<00:25,  6.65it/s][A
  4%|▍         | 7/175 [00:00<00:23,  7.24it/s][A
  5%|▍         | 8/175 [00:01<00:22,  7.37it/s][A
  6%|▌         | 10/175 [00:01<00:23,  7.17it/s][A
  6%|▋         | 11/175 [00:01<00:21,  7.50it/s][A
  7%|▋         | 12/175 [00:01<00:21,  7.44it/s][A
  7%|▋         | 13/175 [00:01<00:22,  7.22it/s][A
  8%|▊         | 14/175 [00:01<00:21,  7.51it/s][A
  9%|▊         | 15/175 [00:02<00:21,  7.56it/s][A
  9%|▉         | 16/175 [00:02<00:24,  6.59it/s][A
 10%|▉         | 17/175 [00:02<00:25,  6.10it/s][A
 10%|█         | 18/175 [00:02<00:31,  5.03it/s][A
 11%|█         | 19/175 [00:02<00:34,  4.48it/s][A
 12%|█▏        | 21/175 [00:03<00:23,  6.62it/s][A
 13%|█▎        | 23/175 [00:03<00:20,  7.35it/s][A
 14%|█▎        | 24/175 [00:03<00:22,  6.68it/s][A
 14%|█▍        | 25/175 [00:03<00:20,  7.16it/s][A
 15%|█▍        | 26/175 [00:03<00:19,  7.68it/s][A
 15%|█▌        | 27/175 [00:03<00:19,  7.62it/s][A
 16%|█▌        | 28/175 [00:03<00:18,  8.02it/s][A
 17%|█▋        | 29/175 [00:04<00:18,  7.82it/s][A
 17%|█▋        | 30/175 [00:04<00:21,  6.75it/s][A
 18%|█▊        | 31/175 [00:04<00:26,  5.36it/s][A
 18%|█▊        | 32/175 [00:04<00:23,  6.16it/s][A
 19%|█▉        | 33/175 [00:04<00:20,  6.82it/s][A
 19%|█▉        | 34/175 [00:05<00:22,  6.17it/s][A
 20%|██        | 35/175 [00:05<00:21,  6.51it/s][A
 21%|██        | 36/175 [00:05<00:21,  6.54it/s][A
 21%|██        | 37/175 [00:05<00:20,  6.72it/s][A
 22%|██▏       | 39/175 [00:05<00:19,  6.83it/s][A
 23%|██▎       | 41/175 [00:05<00:17,  7.76it/s][A
 24%|██▍       | 42/175 [00:06<00:17,  7.73it/s][A
 25%|██▍       | 43/175 [00:06<00:18,  7.19it/s][A
 25%|██▌       | 44/175 [00:06<00:17,  7.28it/s][A
 26%|██▌       | 45/175 [00:06<00:17,  7.40it/s][A
 26%|██▋       | 46/175 [00:06<00:16,  7.82it/s][A
 27%|██▋       | 47/175 [00:06<00:15,  8.29it/s][A
 27%|██▋       | 48/175 [00:06<00:15,  8.14it/s][A
 28%|██▊       | 49/175 [00:07<00:17,  7.08it/s][A
 29%|██▊       | 50/175 [00:07<00:17,  7.11it/s][A
 29%|██▉       | 51/175 [00:07<00:17,  7.26it/s][A
 30%|██▉       | 52/175 [00:07<00:21,  5.71it/s][A
 30%|███       | 53/175 [00:07<00:20,  6.05it/s][A
 31%|███       | 54/175 [00:07<00:19,  6.17it/s][A
 31%|███▏      | 55/175 [00:08<00:20,  5.85it/s][A
 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s][A
 33%|███▎      | 58/175 [00:08<00:16,  6.98it/s][A
 34%|███▎      | 59/175 [00:08<00:16,  6.99it/s][A
 34%|███▍      | 60/175 [00:08<00:19,  5.75it/s][A
 35%|███▍      | 61/175 [00:08<00:18,  6.14it/s][A
 36%|███▌      | 63/175 [00:09<00:15,  7.38it/s][A
 37%|███▋      | 65/175 [00:09<00:13,  8.06it/s][A
 38%|███▊      | 67/175 [00:09<00:12,  8.91it/s][A
 39%|███▉      | 68/175 [00:09<00:12,  8.58it/s][A
 40%|████      | 70/175 [00:09<00:11,  9.43it/s][A
 41%|████      | 72/175 [00:10<00:13,  7.64it/s][A
 42%|████▏     | 73/175 [00:10<00:14,  7.04it/s][A
 42%|████▏     | 74/175 [00:10<00:13,  7.48it/s][A
 43%|████▎     | 75/175 [00:10<00:13,  7.41it/s][A
 43%|████▎     | 76/175 [00:10<00:15,  6.60it/s][A
 44%|████▍     | 77/175 [00:11<00:18,  5.37it/s][A
 45%|████▍     | 78/175 [00:11<00:18,  5.21it/s][A
 45%|████▌     | 79/175 [00:11<00:17,  5.35it/s][A
 46%|████▌     | 80/175 [00:11<00:20,  4.68it/s][A
 46%|████▋     | 81/175 [00:11<00:19,  4.86it/s][A
 47%|████▋     | 83/175 [00:12<00:13,  6.79it/s][A
 48%|████▊     | 84/175 [00:12<00:13,  6.70it/s][A
 49%|████▊     | 85/175 [00:12<00:14,  6.26it/s][A
 49%|████▉     | 86/175 [00:12<00:14,  6.13it/s][A
 50%|████▉     | 87/175 [00:12<00:14,  6.25it/s][A
 50%|█████     | 88/175 [00:12<00:13,  6.65it/s][A
 51%|█████     | 89/175 [00:13<00:14,  6.00it/s][A
 51%|█████▏    | 90/175 [00:13<00:12,  6.64it/s][A
 52%|█████▏    | 91/175 [00:13<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:13<00:12,  6.43it/s][A
 54%|█████▎    | 94/175 [00:13<00:12,  6.60it/s][A
 54%|█████▍    | 95/175 [00:14<00:11,  7.19it/s][A
 55%|█████▍    | 96/175 [00:14<00:12,  6.49it/s][A
 55%|█████▌    | 97/175 [00:14<00:13,  5.98it/s][A
 56%|█████▌    | 98/175 [00:14<00:14,  5.16it/s][A
 57%|█████▋    | 99/175 [00:14<00:12,  5.89it/s][A
 57%|█████▋    | 100/175 [00:15<00:14,  5.09it/s][A
 58%|█████▊    | 101/175 [00:15<00:12,  5.80it/s][A
 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s][A
 59%|█████▉    | 104/175 [00:15<00:09,  7.48it/s][A
 60%|██████    | 105/175 [00:15<00:09,  7.53it/s][A
 61%|██████    | 106/175 [00:15<00:08,  8.02it/s][A
 61%|██████    | 107/175 [00:15<00:09,  7.00it/s][A
 62%|██████▏   | 108/175 [00:16<00:09,  6.91it/s][A
 63%|██████▎   | 110/175 [00:16<00:08,  7.32it/s][A
 63%|██████▎   | 111/175 [00:16<00:08,  7.14it/s][A
 64%|██████▍   | 112/175 [00:16<00:08,  7.28it/s][A
 65%|██████▍   | 113/175 [00:16<00:07,  7.80it/s][A
 65%|██████▌   | 114/175 [00:16<00:10,  6.07it/s][A
 66%|██████▌   | 115/175 [00:17<00:08,  6.75it/s][A
 66%|██████▋   | 116/175 [00:17<00:09,  6.45it/s][A
 67%|██████▋   | 117/175 [00:17<00:08,  6.66it/s][A
 67%|██████▋   | 118/175 [00:17<00:08,  7.07it/s][A
 68%|██████▊   | 119/175 [00:17<00:10,  5.47it/s][A
 69%|██████▊   | 120/175 [00:18<00:11,  4.85it/s][A
 69%|██████▉   | 121/175 [00:18<00:09,  5.44it/s][A
 70%|██████▉   | 122/175 [00:18<00:08,  6.25it/s][A
 70%|███████   | 123/175 [00:18<00:10,  5.09it/s][A
 71%|███████   | 124/175 [00:18<00:11,  4.50it/s][A
 71%|███████▏  | 125/175 [00:19<00:10,  4.71it/s][A
 72%|███████▏  | 126/175 [00:19<00:09,  5.34it/s][A
 73%|███████▎  | 127/175 [00:19<00:09,  4.80it/s][A
 73%|███████▎  | 128/175 [00:19<00:08,  5.25it/s][A
 74%|███████▎  | 129/175 [00:19<00:08,  5.38it/s][A
 74%|███████▍  | 130/175 [00:19<00:07,  5.82it/s][A
 75%|███████▍  | 131/175 [00:19<00:06,  6.63it/s][A
 75%|███████▌  | 132/175 [00:20<00:06,  6.90it/s][A
 77%|███████▋  | 134/175 [00:20<00:05,  7.97it/s][A
 77%|███████▋  | 135/175 [00:20<00:04,  8.36it/s][A
 78%|███████▊  | 136/175 [00:20<00:04,  8.15it/s][A
 79%|███████▉  | 138/175 [00:20<00:03,  9.42it/s][A
 79%|███████▉  | 139/175 [00:20<00:04,  8.27it/s][A
 80%|████████  | 140/175 [00:21<00:05,  6.47it/s][A
 81%|████████  | 141/175 [00:21<00:05,  6.69it/s][A
 81%|████████  | 142/175 [00:21<00:05,  5.88it/s][A
 82%|████████▏ | 144/175 [00:21<00:04,  7.06it/s][A
 83%|████████▎ | 145/175 [00:21<00:04,  7.39it/s][A
 83%|████████▎ | 146/175 [00:21<00:03,  7.34it/s][A
 84%|████████▍ | 147/175 [00:22<00:04,  6.57it/s][A
 85%|████████▌ | 149/175 [00:22<00:03,  7.67it/s][A
 86%|████████▌ | 150/175 [00:22<00:03,  7.61it/s][A
 86%|████████▋ | 151/175 [00:22<00:03,  7.90it/s][A
 87%|████████▋ | 153/175 [00:22<00:02,  8.58it/s][A
 88%|████████▊ | 154/175 [00:22<00:02,  8.20it/s][A
 89%|████████▊ | 155/175 [00:23<00:02,  8.07it/s][A
 90%|████████▉ | 157/175 [00:23<00:02,  7.51it/s][A
 90%|█████████ | 158/175 [00:23<00:02,  7.50it/s][A
 91%|█████████▏| 160/175 [00:23<00:01,  7.68it/s][A
 92%|█████████▏| 161/175 [00:23<00:01,  8.03it/s][A
 93%|█████████▎| 162/175 [00:24<00:01,  7.06it/s][A
 93%|█████████▎| 163/175 [00:24<00:01,  6.70it/s][A
 94%|█████████▎| 164/175 [00:24<00:01,  6.89it/s][A
 95%|█████████▍| 166/175 [00:24<00:01,  7.38it/s][A
 95%|█████████▌| 167/175 [00:24<00:01,  7.84it/s][A
 96%|█████████▌| 168/175 [00:24<00:00,  7.47it/s][A
 97%|█████████▋| 169/175 [00:25<00:00,  6.50it/s][A
 97%|█████████▋| 170/175 [00:25<00:00,  5.33it/s][A
 98%|█████████▊| 172/175 [00:25<00:00,  6.59it/s][A
 99%|█████████▉| 173/175 [00:25<00:00,  6.17it/s][A
 99%|█████████▉| 174/175 [00:25<00:00,  5.94it/s][A                                                   
                                                 [A 92%|█████████▏| 900/980 [1:04:02<04:39,  3.49s/it]
100%|██████████| 175/175 [00:26<00:00,  5.94it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 05:51:14,127 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-900
[INFO|configuration_utils.py:673] 2024-11-06 05:51:14,147 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:51:14,148 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:51:14,248 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:51:14,248 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-900/special_tokens_map.json
 92%|█████████▏| 901/980 [1:04:07<15:32, 11.81s/it] 92%|█████████▏| 902/980 [1:04:10<12:03,  9.28s/it] 92%|█████████▏| 903/980 [1:04:14<09:48,  7.64s/it] 92%|█████████▏| 904/980 [1:04:18<08:17,  6.54s/it] 92%|█████████▏| 905/980 [1:04:23<07:22,  5.91s/it] 92%|█████████▏| 906/980 [1:04:28<06:55,  5.62s/it] 93%|█████████▎| 907/980 [1:04:31<05:53,  4.84s/it] 93%|█████████▎| 908/980 [1:04:35<05:35,  4.66s/it] 93%|█████████▎| 909/980 [1:04:39<05:15,  4.44s/it] 93%|█████████▎| 910/980 [1:04:43<04:58,  4.27s/it]                                                    93%|█████████▎| 910/980 [1:04:43<04:58,  4.27s/it] 93%|█████████▎| 911/980 [1:04:47<04:52,  4.23s/it] 93%|█████████▎| 912/980 [1:04:51<04:52,  4.30s/it] 93%|█████████▎| 913/980 [1:04:55<04:42,  4.22s/it] 93%|█████████▎| 914/980 [1:05:00<04:40,  4.25s/it] 93%|█████████▎| 915/980 [1:05:04<04:37,  4.27s/it] 93%|█████████▎| 916/980 [1:05:08<04:31,  4.25s/it] 94%|█████████▎| 917/980 [1:05:11<04:11,  3.99s/it] 94%|█████████▎| 918/980 [1:05:16<04:09,  4.03s/it] 94%|█████████▍| 919/980 [1:05:19<03:51,  3.80s/it] 94%|█████████▍| 920/980 [1:05:23<03:56,  3.95s/it]                                                    94%|█████████▍| 920/980 [1:05:23<03:56,  3.95s/it] 94%|█████████▍| 921/980 [1:05:28<04:03,  4.12s/it] 94%|█████████▍| 922/980 [1:05:32<04:02,  4.17s/it] 94%|█████████▍| 923/980 [1:05:37<04:09,  4.38s/it] 94%|█████████▍| 924/980 [1:05:42<04:12,  4.50s/it] 94%|█████████▍| 925/980 [1:05:45<03:53,  4.24s/it] 94%|█████████▍| 926/980 [1:05:50<03:57,  4.40s/it] 95%|█████████▍| 927/980 [1:05:54<03:44,  4.23s/it] 95%|█████████▍| 928/980 [1:05:58<03:31,  4.06s/it] 95%|█████████▍| 929/980 [1:06:01<03:15,  3.83s/it] 95%|█████████▍| 930/980 [1:06:05<03:11,  3.84s/it]                                                    95%|█████████▍| 930/980 [1:06:05<03:11,  3.84s/it] 95%|█████████▌| 931/980 [1:06:09<03:11,  3.90s/it] 95%|█████████▌| 932/980 [1:06:13<03:19,  4.15s/it] 95%|█████████▌| 933/980 [1:06:18<03:14,  4.13s/it] 95%|█████████▌| 934/980 [1:06:22<03:08,  4.10s/it] 95%|█████████▌| 935/980 [1:06:25<02:57,  3.95s/it] 96%|█████████▌| 936/980 [1:06:29<02:51,  3.89s/it] 96%|█████████▌| 937/980 [1:06:33<02:46,  3.87s/it] 96%|█████████▌| 938/980 [1:06:36<02:34,  3.68s/it] 96%|█████████▌| 939/980 [1:06:40<02:33,  3.75s/it] 96%|█████████▌| 940/980 [1:06:45<02:41,  4.04s/it]                                                    96%|█████████▌| 940/980 [1:06:45<02:41,  4.04s/it] 96%|█████████▌| 941/980 [1:06:49<02:42,  4.17s/it] 96%|█████████▌| 942/980 [1:06:52<02:25,  3.84s/it] 96%|█████████▌| 943/980 [1:06:55<02:15,  3.67s/it] 96%|█████████▋| 944/980 [1:07:01<02:30,  4.17s/it] 96%|█████████▋| 945/980 [1:07:05<02:24,  4.12s/it] 97%|█████████▋| 946/980 [1:07:09<02:18,  4.07s/it] 97%|█████████▋| 947/980 [1:07:13<02:20,  4.26s/it] 97%|█████████▋| 948/980 [1:07:17<02:05,  3.91s/it] 97%|█████████▋| 949/980 [1:07:21<02:06,  4.09s/it] 97%|█████████▋| 950/980 [1:07:25<02:01,  4.03s/it]                                                    97%|█████████▋| 950/980 [1:07:25<02:01,  4.03s/it] 97%|█████████▋| 951/980 [1:07:29<01:53,  3.92s/it] 97%|█████████▋| 952/980 [1:07:33<01:52,  4.00s/it] 97%|█████████▋| 953/980 [1:07:38<01:54,  4.25s/it] 97%|█████████▋| 954/980 [1:07:41<01:44,  4.03s/it] 97%|█████████▋| 955/980 [1:07:45<01:40,  4.02s/it] 98%|█████████▊| 956/980 [1:07:49<01:33,  3.90s/it] 98%|█████████▊| 957/980 [1:07:53<01:30,  3.95s/it] 98%|█████████▊| 958/980 [1:07:56<01:24,  3.83s/it] 98%|█████████▊| 959/980 [1:08:01<01:23,  4.00s/it] 98%|█████████▊| 960/980 [1:08:04<01:15,  3.78s/it]                                                    98%|█████████▊| 960/980 [1:08:04<01:15,  3.78s/it] 98%|█████████▊| 961/980 [1:08:07<01:09,  3.66s/it] 98%|█████████▊| 962/980 [1:08:11<01:08,  3.79s/it] 98%|█████████▊| 963/980 [1:08:15<01:04,  3.77s/it] 98%|█████████▊| 964/980 [1:08:20<01:02,  3.93s/it] 98%|█████████▊| 965/980 [1:08:24<01:02,  4.14s/it] 99%|█████████▊| 966/980 [1:08:28<00:56,  4.01s/it] 99%|█████████▊| 967/980 [1:08:32<00:51,  3.99s/it] 99%|█████████▉| 968/980 [1:08:36<00:48,  4.04s/it] 99%|█████████▉| 969/980 [1:08:40<00:45,  4.12s/it] 99%|█████████▉| 970/980 [1:08:45<00:41,  4.18s/it]                                                    99%|█████████▉| 970/980 [1:08:45<00:41,  4.18s/it] 99%|█████████▉| 971/980 [1:08:49<00:37,  4.11s/it] 99%|█████████▉| 972/980 [1:08:53<00:34,  4.25s/it] 99%|█████████▉| 973/980 [1:08:57<00:28,  4.03s/it] 99%|█████████▉| 974/980 [1:09:00<00:22,  3.80s/it] 99%|█████████▉| 975/980 [1:09:04<00:19,  3.82s/it]100%|█████████▉| 976/980 [1:09:08<00:16,  4.01s/it]100%|█████████▉| 977/980 [1:09:12<00:12,  4.05s/it]100%|█████████▉| 978/980 [1:09:15<00:07,  3.68s/it]100%|█████████▉| 979/980 [1:09:18<00:03,  3.52s/it]100%|██████████| 980/980 [1:09:22<00:00,  3.63s/it]                                                   100%|██████████| 980/980 [1:09:22<00:00,  3.63s/it][INFO|trainer.py:3705] 2024-11-06 05:56:34,431 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-980
[INFO|configuration_utils.py:673] 2024-11-06 05:56:34,451 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:56:34,452 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:56:34,558 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-980/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:56:34,558 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/checkpoint-980/special_tokens_map.json
[INFO|trainer.py:2505] 2024-11-06 05:56:34,910 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 980/980 [1:09:23<00:00,  3.63s/it]100%|██████████| 980/980 [1:09:23<00:00,  4.25s/it]
[INFO|trainer.py:3705] 2024-11-06 05:56:34,912 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_train_1_hop
[INFO|configuration_utils.py:673] 2024-11-06 05:56:34,931 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 05:56:34,931 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 05:56:35,022 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 05:56:35,022 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_train_1_hop/special_tokens_map.json
{'eval_loss': 0.11382189393043518, 'eval_runtime': 26.1163, 'eval_samples_per_second': 26.803, 'eval_steps_per_second': 6.701, 'epoch': 4.57}
{'loss': 0.0583, 'grad_norm': 1.1168605089187622, 'learning_rate': 6.268021954544096e-07, 'epoch': 4.62}
{'loss': 0.0572, 'grad_norm': 1.0383858680725098, 'learning_rate': 4.6102107522336403e-07, 'epoch': 4.67}
{'loss': 0.0614, 'grad_norm': 1.0673326253890991, 'learning_rate': 3.204554146387456e-07, 'epoch': 4.72}
{'loss': 0.0536, 'grad_norm': 1.1330183744430542, 'learning_rate': 2.052496544188487e-07, 'epoch': 4.77}
{'loss': 0.0578, 'grad_norm': 0.948739230632782, 'learning_rate': 1.1552217627004425e-07, 'epoch': 4.83}
{'loss': 0.0526, 'grad_norm': 1.0695948600769043, 'learning_rate': 5.136518124159162e-08, 'epoch': 4.88}
{'loss': 0.0505, 'grad_norm': 1.0393099784851074, 'learning_rate': 1.284459498280266e-08, 'epoch': 4.93}
{'loss': 0.0547, 'grad_norm': 1.2220402956008911, 'learning_rate': 0.0, 'epoch': 4.98}
{'train_runtime': 4163.2097, 'train_samples_per_second': 7.566, 'train_steps_per_second': 0.235, 'train_loss': 0.1486647775282665, 'epoch': 4.98}
***** train metrics *****
  epoch                    =      4.9778
  total_flos               = 258097801GF
  train_loss               =      0.1487
  train_runtime            =  1:09:23.20
  train_samples_per_second =       7.566
  train_steps_per_second   =       0.235
Figure saved at: ../Models/llama3B/tp_llama3/C3_train_1_hop/training_loss.png
Figure saved at: ../Models/llama3B/tp_llama3/C3_train_1_hop/training_eval_loss.png
11/06/2024 05:56:35 - WARNING - llamafactory.extras.ploting - No metric eval_accuracy to plot.
[INFO|trainer.py:4021] 2024-11-06 05:56:35,405 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 05:56:35,405 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 05:56:35,405 >>   Batch size = 4
  0%|          | 0/175 [00:00<?, ?it/s]  1%|          | 2/175 [00:00<00:16, 10.34it/s]  2%|▏         | 4/175 [00:00<00:18,  9.44it/s]  3%|▎         | 5/175 [00:00<00:26,  6.35it/s]  3%|▎         | 6/175 [00:00<00:25,  6.68it/s]  4%|▍         | 7/175 [00:00<00:23,  7.28it/s]  5%|▍         | 8/175 [00:01<00:22,  7.38it/s]  6%|▌         | 10/175 [00:01<00:22,  7.19it/s]  6%|▋         | 11/175 [00:01<00:21,  7.53it/s]  7%|▋         | 12/175 [00:01<00:21,  7.50it/s]  7%|▋         | 13/175 [00:01<00:22,  7.24it/s]  8%|▊         | 14/175 [00:01<00:21,  7.54it/s]  9%|▊         | 15/175 [00:02<00:21,  7.58it/s]  9%|▉         | 16/175 [00:02<00:24,  6.61it/s] 10%|▉         | 17/175 [00:02<00:25,  6.12it/s] 10%|█         | 18/175 [00:02<00:31,  5.04it/s] 11%|█         | 19/175 [00:02<00:34,  4.49it/s] 12%|█▏        | 21/175 [00:03<00:23,  6.63it/s] 13%|█▎        | 23/175 [00:03<00:20,  7.36it/s] 14%|█▎        | 24/175 [00:03<00:22,  6.68it/s] 14%|█▍        | 25/175 [00:03<00:20,  7.17it/s] 15%|█▍        | 26/175 [00:03<00:19,  7.69it/s] 15%|█▌        | 27/175 [00:03<00:19,  7.63it/s] 16%|█▌        | 28/175 [00:03<00:18,  8.02it/s] 17%|█▋        | 29/175 [00:04<00:18,  7.82it/s] 17%|█▋        | 30/175 [00:04<00:21,  6.76it/s] 18%|█▊        | 31/175 [00:04<00:26,  5.37it/s] 18%|█▊        | 32/175 [00:04<00:23,  6.16it/s] 19%|█▉        | 33/175 [00:04<00:20,  6.82it/s] 19%|█▉        | 34/175 [00:04<00:22,  6.18it/s] 20%|██        | 35/175 [00:05<00:21,  6.52it/s] 21%|██        | 36/175 [00:05<00:21,  6.54it/s] 21%|██        | 37/175 [00:05<00:20,  6.71it/s] 22%|██▏       | 39/175 [00:05<00:19,  6.83it/s] 23%|██▎       | 41/175 [00:05<00:17,  7.77it/s] 24%|██▍       | 42/175 [00:06<00:17,  7.75it/s] 25%|██▍       | 43/175 [00:06<00:18,  7.21it/s] 25%|██▌       | 44/175 [00:06<00:17,  7.29it/s] 26%|██▌       | 45/175 [00:06<00:17,  7.41it/s] 26%|██▋       | 46/175 [00:06<00:16,  7.83it/s] 27%|██▋       | 47/175 [00:06<00:15,  8.30it/s] 27%|██▋       | 48/175 [00:06<00:15,  8.16it/s] 28%|██▊       | 49/175 [00:06<00:17,  7.08it/s] 29%|██▊       | 50/175 [00:07<00:17,  7.07it/s] 29%|██▉       | 51/175 [00:07<00:17,  7.22it/s] 30%|██▉       | 52/175 [00:07<00:21,  5.70it/s] 30%|███       | 53/175 [00:07<00:20,  6.05it/s] 31%|███       | 54/175 [00:07<00:19,  6.17it/s] 31%|███▏      | 55/175 [00:08<00:20,  5.84it/s] 32%|███▏      | 56/175 [00:08<00:21,  5.58it/s] 33%|███▎      | 58/175 [00:08<00:16,  6.96it/s] 34%|███▎      | 59/175 [00:08<00:16,  6.96it/s] 34%|███▍      | 60/175 [00:08<00:20,  5.74it/s] 35%|███▍      | 61/175 [00:08<00:18,  6.12it/s] 36%|███▌      | 63/175 [00:09<00:15,  7.34it/s] 37%|███▋      | 65/175 [00:09<00:13,  8.02it/s] 38%|███▊      | 67/175 [00:09<00:12,  8.91it/s] 39%|███▉      | 68/175 [00:09<00:12,  8.58it/s] 40%|████      | 70/175 [00:09<00:11,  9.40it/s] 41%|████      | 72/175 [00:10<00:13,  7.62it/s] 42%|████▏     | 73/175 [00:10<00:14,  7.03it/s] 42%|████▏     | 74/175 [00:10<00:13,  7.46it/s] 43%|████▎     | 75/175 [00:10<00:13,  7.38it/s] 43%|████▎     | 76/175 [00:10<00:15,  6.57it/s] 44%|████▍     | 77/175 [00:11<00:18,  5.36it/s] 45%|████▍     | 78/175 [00:11<00:18,  5.20it/s] 45%|████▌     | 79/175 [00:11<00:18,  5.33it/s] 46%|████▌     | 80/175 [00:11<00:20,  4.67it/s] 46%|████▋     | 81/175 [00:11<00:19,  4.85it/s] 47%|████▋     | 83/175 [00:12<00:13,  6.76it/s] 48%|████▊     | 84/175 [00:12<00:13,  6.68it/s] 49%|████▊     | 85/175 [00:12<00:14,  6.25it/s] 49%|████▉     | 86/175 [00:12<00:14,  6.12it/s] 50%|████▉     | 87/175 [00:12<00:14,  6.23it/s] 50%|█████     | 88/175 [00:12<00:13,  6.62it/s] 51%|█████     | 89/175 [00:13<00:14,  5.97it/s] 51%|█████▏    | 90/175 [00:13<00:12,  6.61it/s] 52%|█████▏    | 91/175 [00:13<00:15,  5.29it/s] 53%|█████▎    | 93/175 [00:13<00:12,  6.42it/s] 54%|█████▎    | 94/175 [00:13<00:12,  6.59it/s] 54%|█████▍    | 95/175 [00:14<00:11,  7.18it/s] 55%|█████▍    | 96/175 [00:14<00:12,  6.47it/s] 55%|█████▌    | 97/175 [00:14<00:13,  5.97it/s] 56%|█████▌    | 98/175 [00:14<00:14,  5.15it/s] 57%|█████▋    | 99/175 [00:14<00:12,  5.88it/s] 57%|█████▋    | 100/175 [00:15<00:14,  5.07it/s] 58%|█████▊    | 101/175 [00:15<00:12,  5.79it/s] 58%|█████▊    | 102/175 [00:15<00:12,  5.78it/s] 59%|█████▉    | 104/175 [00:15<00:09,  7.46it/s] 60%|██████    | 105/175 [00:15<00:09,  7.51it/s] 61%|██████    | 106/175 [00:15<00:08,  8.01it/s] 61%|██████    | 107/175 [00:15<00:09,  7.00it/s] 62%|██████▏   | 108/175 [00:16<00:09,  6.90it/s] 63%|██████▎   | 110/175 [00:16<00:08,  7.30it/s] 63%|██████▎   | 111/175 [00:16<00:08,  7.11it/s] 64%|██████▍   | 112/175 [00:16<00:08,  7.27it/s] 65%|██████▍   | 113/175 [00:16<00:07,  7.80it/s] 65%|██████▌   | 114/175 [00:16<00:10,  6.05it/s] 66%|██████▌   | 115/175 [00:17<00:08,  6.73it/s] 66%|██████▋   | 116/175 [00:17<00:09,  6.43it/s] 67%|██████▋   | 117/175 [00:17<00:08,  6.63it/s] 67%|██████▋   | 118/175 [00:17<00:08,  7.03it/s] 68%|██████▊   | 119/175 [00:17<00:10,  5.44it/s] 69%|██████▊   | 120/175 [00:18<00:11,  4.83it/s] 69%|██████▉   | 121/175 [00:18<00:09,  5.42it/s] 70%|██████▉   | 122/175 [00:18<00:08,  6.23it/s] 70%|███████   | 123/175 [00:18<00:10,  5.08it/s] 71%|███████   | 124/175 [00:18<00:11,  4.50it/s] 71%|███████▏  | 125/175 [00:19<00:10,  4.71it/s] 72%|███████▏  | 126/175 [00:19<00:09,  5.33it/s] 73%|███████▎  | 127/175 [00:19<00:10,  4.79it/s] 73%|███████▎  | 128/175 [00:19<00:09,  5.21it/s] 74%|███████▎  | 129/175 [00:19<00:08,  5.34it/s] 74%|███████▍  | 130/175 [00:19<00:07,  5.80it/s] 75%|███████▍  | 131/175 [00:20<00:06,  6.60it/s] 75%|███████▌  | 132/175 [00:20<00:06,  6.86it/s] 77%|███████▋  | 134/175 [00:20<00:05,  7.89it/s] 77%|███████▋  | 135/175 [00:20<00:04,  8.29it/s] 78%|███████▊  | 136/175 [00:20<00:04,  8.08it/s] 79%|███████▉  | 138/175 [00:20<00:03,  9.35it/s] 79%|███████▉  | 139/175 [00:20<00:04,  8.23it/s] 80%|████████  | 140/175 [00:21<00:05,  6.45it/s] 81%|████████  | 141/175 [00:21<00:05,  6.65it/s] 81%|████████  | 142/175 [00:21<00:05,  5.86it/s] 82%|████████▏ | 144/175 [00:21<00:04,  7.04it/s] 83%|████████▎ | 145/175 [00:21<00:04,  7.36it/s] 83%|████████▎ | 146/175 [00:22<00:03,  7.31it/s] 84%|████████▍ | 147/175 [00:22<00:04,  6.55it/s] 85%|████████▌ | 149/175 [00:22<00:03,  7.64it/s] 86%|████████▌ | 150/175 [00:22<00:03,  7.59it/s] 86%|████████▋ | 151/175 [00:22<00:03,  7.86it/s] 87%|████████▋ | 153/175 [00:22<00:02,  8.56it/s] 88%|████████▊ | 154/175 [00:23<00:02,  8.18it/s] 89%|████████▊ | 155/175 [00:23<00:02,  8.04it/s] 90%|████████▉ | 157/175 [00:23<00:02,  7.47it/s] 90%|█████████ | 158/175 [00:23<00:02,  7.46it/s] 91%|█████████▏| 160/175 [00:23<00:01,  7.63it/s] 92%|█████████▏| 161/175 [00:23<00:01,  7.96it/s] 93%|█████████▎| 162/175 [00:24<00:01,  6.99it/s] 93%|█████████▎| 163/175 [00:24<00:01,  6.65it/s] 94%|█████████▎| 164/175 [00:24<00:01,  6.85it/s] 95%|█████████▍| 166/175 [00:24<00:01,  7.36it/s] 95%|█████████▌| 167/175 [00:24<00:01,  7.81it/s] 96%|█████████▌| 168/175 [00:24<00:00,  7.44it/s] 97%|█████████▋| 169/175 [00:25<00:00,  6.50it/s] 97%|█████████▋| 170/175 [00:25<00:00,  5.34it/s] 98%|█████████▊| 172/175 [00:25<00:00,  6.57it/s] 99%|█████████▉| 173/175 [00:25<00:00,  6.15it/s] 99%|█████████▉| 174/175 [00:26<00:00,  5.93it/s]100%|██████████| 175/175 [00:26<00:00,  6.71it/s]
[INFO|modelcard.py:449] 2024-11-06 05:57:01,576 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     4.9778
  eval_loss               =     0.1134
  eval_runtime            = 0:00:26.16
  eval_samples_per_second =     26.749
  eval_steps_per_second   =      6.687
