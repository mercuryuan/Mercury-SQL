11/06/2024 03:18:54 - WARNING - llamafactory.hparams.parser - We recommend enable mixed precision training.
11/06/2024 03:18:54 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: None
[INFO|configuration_utils.py:673] 2024-11-06 03:18:54,640 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:18:54,641 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,642 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,642 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,642 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,642 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,642 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 03:18:55,055 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:673] 2024-11-06 03:18:55,056 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:18:55,057 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:55,058 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:55,058 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:55,058 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:55,058 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:55,058 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 03:18:55,433 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
11/06/2024 03:18:55 - WARNING - llamafactory.model.loader - Processor was not found: 'LlamaConfig' object has no attribute 'vision_config'.
11/06/2024 03:18:55 - INFO - llamafactory.data.template - Replace eos token: <|end_of_text|>
11/06/2024 03:18:55 - INFO - llamafactory.data.template - Add pad token: <|end_of_text|>
11/06/2024 03:18:55 - INFO - llamafactory.data.loader - Loading dataset ../../Training_Dataset/C3_orig/my_ft_dataset.json...
Converting format of dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  63%|██████▎   | 4378/7000 [00:00<00:00, 42192.16 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 7000/7000 [00:00<00:00, 34718.19 examples/s]
Running tokenizer on dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6%|▋         | 438/7000 [00:01<00:17, 381.00 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 876/7000 [00:01<00:09, 669.49 examples/s]Running tokenizer on dataset (num_proc=16):  25%|██▌       | 1752/7000 [00:01<00:04, 1294.10 examples/s]Running tokenizer on dataset (num_proc=16):  31%|███▏      | 2190/7000 [00:01<00:03, 1537.93 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▍     | 3066/7000 [00:02<00:02, 1950.20 examples/s]Running tokenizer on dataset (num_proc=16):  50%|█████     | 3504/7000 [00:02<00:01, 2127.63 examples/s]Running tokenizer on dataset (num_proc=16):  56%|█████▋    | 3941/7000 [00:02<00:01, 2044.80 examples/s]Running tokenizer on dataset (num_proc=16):  69%|██████▉   | 4815/7000 [00:02<00:00, 2699.30 examples/s]Running tokenizer on dataset (num_proc=16):  75%|███████▌  | 5252/7000 [00:02<00:00, 2710.90 examples/s]Running tokenizer on dataset (num_proc=16):  88%|████████▊ | 6126/7000 [00:03<00:00, 2790.14 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 3365.76 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 1991.22 examples/s]
[INFO|configuration_utils.py:673] 2024-11-06 03:19:00,446 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:19:00,447 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|modeling_utils.py:3729] 2024-11-06 03:19:00,472 >> loading weights file /home/models/Llama-3.2-3B/model.safetensors.index.json
[INFO|modeling_utils.py:1622] 2024-11-06 03:19:00,473 >> Instantiating LlamaForCausalLM model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1099] 2024-11-06 03:19:00,474 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "eos_token_id": 128001
}

training example:
input_ids:
[128000, 128006, 9125, 128007, 271, 2675, 527, 264, 11190, 18328, 13, 128001, 128006, 882, 128007, 271, 8144, 459, 8029, 3319, 311, 17622, 279, 2038, 3196, 389, 279, 2728, 4729, 11036, 11829, 1121, 1288, 387, 1193, 264, 5822, 3319, 627, 13922, 7998, 1232, 364, 4438, 1690, 14971, 315, 279, 26280, 527, 9191, 1109, 220, 3487, 59050, 364, 2042, 851, 1232, 364, 28414, 46463, 518, 364, 2042, 26443, 1232, 5473, 29543, 1401, 1232, 2570, 43573, 16427, 851, 405, 2025, 16427, 851, 518, 364, 43573, 67300, 851, 405, 28414, 67300, 851, 4181, 364, 6682, 1401, 1232, 2570, 28414, 67300, 851, 518, 364, 2025, 16427, 851, 518, 364, 43573, 67300, 851, 4181, 364, 33210, 1232, 62208, 2048, 1292, 1232, 364, 28414, 518, 364, 6361, 9366, 1232, 2570, 28414, 887, 518, 364, 609, 518, 364, 38475, 518, 364, 97646, 518, 364, 49506, 304, 33151, 518, 364, 2470, 8420, 663, 2186, 5473, 2048, 1292, 1232, 364, 2025, 518, 364, 6361, 9366, 1232, 2570, 2025, 887, 518, 364, 609, 518, 364, 16381, 1614, 518, 364, 425, 663, 2186, 5473, 2048, 1292, 1232, 364, 43573, 518, 364, 6361, 9366, 1232, 2570, 28414, 887, 518, 364, 2025, 887, 518, 364, 79190, 15718, 663, 26516, 3500, 128001, 128006, 78191, 128007, 271, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
inputs:
<|begin_of_text|><|start_header_id|>system<|end_header_id|>

You are a helpful assistant.<|end_of_text|><|start_header_id|>user<|end_header_id|>

Write an SQL query to retrieve the information based on the given database schema.The result should be only a sql query.
{'question': 'How many heads of the departments are older than 56?', 'db_id': 'department_management', 'db_schema': {'foreign key': ['management.head_id->head.head_id','management.department_id->department.department_id'], 'primary key': ['department.department_id', 'head.head_id','management.department_id'], 'tables': [{'table_name': 'department', 'column_names': ['department id', 'name', 'creation', 'ranking', 'budget in billions', 'num employees']}, {'table_name': 'head', 'column_names': ['head id', 'name', 'born state', 'age']}, {'table_name':'management', 'column_names': ['department id', 'head id', 'temporary acting']}]}}<|end_of_text|><|start_header_id|>assistant<|end_header_id|>

SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
labels:
SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.14it/s]
[INFO|modeling_utils.py:4574] 2024-11-06 03:19:02,297 >> All model checkpoint weights were used when initializing LlamaForCausalLM.

[INFO|modeling_utils.py:4582] 2024-11-06 03:19:02,297 >> All the weights of LlamaForCausalLM were initialized from the model checkpoint at /home/models/Llama-3.2-3B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1052] 2024-11-06 03:19:02,301 >> loading configuration file /home/models/Llama-3.2-3B/generation_config.json
[INFO|configuration_utils.py:1099] 2024-11-06 03:19:02,301 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "do_sample": true,
  "eos_token_id": 128001,
  "temperature": 0.6,
  "top_p": 0.9
}

11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
11/06/2024 03:19:02 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
11/06/2024 03:19:02 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.misc - Found linear modules: gate_proj,up_proj,k_proj,q_proj,down_proj,o_proj,v_proj
11/06/2024 03:19:03 - INFO - llamafactory.model.loader - trainable params: 12,156,928 || all params: 3,224,906,752 || trainable%: 0.3770
[INFO|trainer.py:2243] 2024-11-06 03:19:03,225 >> ***** Running training *****
[INFO|trainer.py:2244] 2024-11-06 03:19:03,225 >>   Num examples = 6,300
[INFO|trainer.py:2245] 2024-11-06 03:19:03,225 >>   Num Epochs = 5
[INFO|trainer.py:2246] 2024-11-06 03:19:03,225 >>   Instantaneous batch size per device = 4
[INFO|trainer.py:2249] 2024-11-06 03:19:03,225 >>   Total train batch size (w. parallel, distributed & accumulation) = 32
[INFO|trainer.py:2250] 2024-11-06 03:19:03,225 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2251] 2024-11-06 03:19:03,225 >>   Total optimization steps = 980
[INFO|trainer.py:2252] 2024-11-06 03:19:03,228 >>   Number of trainable parameters = 12,156,928
  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 1/980 [00:05<1:32:34,  5.67s/it]  0%|          | 2/980 [00:11<1:35:54,  5.88s/it]  0%|          | 3/980 [00:17<1:32:37,  5.69s/it]  0%|          | 4/980 [00:22<1:28:36,  5.45s/it]  1%|          | 5/980 [00:27<1:27:27,  5.38s/it]  1%|          | 6/980 [00:33<1:32:48,  5.72s/it]  1%|          | 7/980 [00:39<1:31:53,  5.67s/it]  1%|          | 8/980 [00:44<1:30:45,  5.60s/it]  1%|          | 9/980 [00:50<1:28:10,  5.45s/it]  1%|          | 10/980 [00:55<1:29:25,  5.53s/it]                                                    1%|          | 10/980 [00:55<1:29:25,  5.53s/it]  1%|          | 11/980 [01:01<1:29:11,  5.52s/it]  1%|          | 12/980 [01:06<1:26:37,  5.37s/it]  1%|▏         | 13/980 [01:11<1:27:11,  5.41s/it]  1%|▏         | 14/980 [01:16<1:25:50,  5.33s/it]  2%|▏         | 15/980 [01:22<1:26:23,  5.37s/it]  2%|▏         | 16/980 [01:27<1:26:56,  5.41s/it]  2%|▏         | 17/980 [01:33<1:26:18,  5.38s/it]  2%|▏         | 18/980 [01:38<1:25:33,  5.34s/it]  2%|▏         | 19/980 [01:43<1:25:53,  5.36s/it]  2%|▏         | 20/980 [01:48<1:24:31,  5.28s/it]                                                    2%|▏         | 20/980 [01:48<1:24:31,  5.28s/it]  2%|▏         | 21/980 [01:54<1:25:37,  5.36s/it]  2%|▏         | 22/980 [01:59<1:21:37,  5.11s/it]  2%|▏         | 23/980 [02:03<1:20:34,  5.05s/it]  2%|▏         | 24/980 [02:08<1:19:38,  5.00s/it]  3%|▎         | 25/980 [02:13<1:18:35,  4.94s/it]  3%|▎         | 26/980 [02:17<1:15:29,  4.75s/it]  3%|▎         | 27/980 [02:23<1:20:52,  5.09s/it]  3%|▎         | 28/980 [02:29<1:22:00,  5.17s/it]  3%|▎         | 29/980 [02:34<1:23:20,  5.26s/it]  3%|▎         | 30/980 [02:40<1:24:51,  5.36s/it]                                                    3%|▎         | 30/980 [02:40<1:24:51,  5.36s/it]  3%|▎         | 31/980 [02:45<1:25:01,  5.38s/it]  3%|▎         | 32/980 [02:50<1:23:56,  5.31s/it]  3%|▎         | 33/980 [02:56<1:26:08,  5.46s/it]  3%|▎         | 34/980 [03:01<1:25:16,  5.41s/it]  4%|▎         | 35/980 [03:06<1:21:36,  5.18s/it]  4%|▎         | 36/980 [03:11<1:18:47,  5.01s/it]  4%|▍         | 37/980 [03:16<1:19:56,  5.09s/it]  4%|▍         | 38/980 [03:22<1:24:22,  5.37s/it]  4%|▍         | 39/980 [03:26<1:20:27,  5.13s/it]  4%|▍         | 40/980 [03:31<1:18:52,  5.03s/it]                                                    4%|▍         | 40/980 [03:31<1:18:52,  5.03s/it]  4%|▍         | 41/980 [03:36<1:18:29,  5.02s/it]  4%|▍         | 42/980 [03:42<1:21:10,  5.19s/it]  4%|▍         | 43/980 [03:48<1:24:29,  5.41s/it]  4%|▍         | 44/980 [03:52<1:19:32,  5.10s/it]  5%|▍         | 45/980 [03:57<1:17:45,  4.99s/it]  5%|▍         | 46/980 [04:02<1:17:53,  5.00s/it]  5%|▍         | 47/980 [04:07<1:17:11,  4.96s/it]  5%|▍         | 48/980 [04:13<1:21:24,  5.24s/it]  5%|▌         | 49/980 [04:18<1:20:59,  5.22s/it]  5%|▌         | 50/980 [04:22<1:17:31,  5.00s/it]                                                    5%|▌         | 50/980 [04:22<1:17:31,  5.00s/it]  5%|▌         | 51/980 [04:28<1:21:03,  5.24s/it]  5%|▌         | 52/980 [04:33<1:20:11,  5.18s/it]  5%|▌         | 53/980 [04:39<1:20:50,  5.23s/it]  6%|▌         | 54/980 [04:44<1:23:43,  5.43s/it]  6%|▌         | 55/980 [04:50<1:26:15,  5.60s/it]  6%|▌         | 56/980 [04:55<1:21:03,  5.26s/it]  6%|▌         | 57/980 [05:01<1:24:28,  5.49s/it]  6%|▌         | 58/980 [05:06<1:23:45,  5.45s/it]  6%|▌         | 59/980 [05:11<1:19:53,  5.20s/it]  6%|▌         | 60/980 [05:16<1:21:25,  5.31s/it]                                                    6%|▌         | 60/980 [05:16<1:21:25,  5.31s/it]  6%|▌         | 61/980 [05:22<1:20:42,  5.27s/it]  6%|▋         | 62/980 [05:26<1:15:25,  4.93s/it]  6%|▋         | 63/980 [05:31<1:14:57,  4.91s/it]  7%|▋         | 64/980 [05:36<1:16:57,  5.04s/it]  7%|▋         | 65/980 [05:42<1:21:39,  5.35s/it]  7%|▋         | 66/980 [05:47<1:19:26,  5.21s/it]  7%|▋         | 67/980 [05:52<1:16:50,  5.05s/it]  7%|▋         | 68/980 [05:56<1:15:39,  4.98s/it]  7%|▋         | 69/980 [06:02<1:20:15,  5.29s/it]  7%|▋         | 70/980 [06:07<1:17:04,  5.08s/it]                                                    7%|▋         | 70/980 [06:07<1:17:04,  5.08s/it]  7%|▋         | 71/980 [06:11<1:13:42,  4.87s/it]  7%|▋         | 72/980 [06:17<1:16:15,  5.04s/it]  7%|▋         | 73/980 [06:23<1:19:35,  5.26s/it]  8%|▊         | 74/980 [06:29<1:23:55,  5.56s/it]  8%|▊         | 75/980 [06:34<1:21:49,  5.42s/it]  8%|▊         | 76/980 [06:39<1:19:29,  5.28s/it]  8%|▊         | 77/980 [06:44<1:18:25,  5.21s/it]  8%|▊         | 78/980 [06:50<1:21:41,  5.43s/it]  8%|▊         | 79/980 [06:56<1:22:35,  5.50s/it]  8%|▊         | 80/980 [07:01<1:24:06,  5.61s/it]                                                    8%|▊         | 80/980 [07:01<1:24:06,  5.61s/it]  8%|▊         | 81/980 [07:06<1:17:00,  5.14s/it]  8%|▊         | 82/980 [07:11<1:18:54,  5.27s/it]  8%|▊         | 83/980 [07:16<1:17:16,  5.17s/it]  9%|▊         | 84/980 [07:21<1:16:12,  5.10s/it]  9%|▊         | 85/980 [07:25<1:12:31,  4.86s/it]  9%|▉         | 86/980 [07:30<1:13:44,  4.95s/it]  9%|▉         | 87/980 [07:36<1:18:02,  5.24s/it]  9%|▉         | 88/980 [07:41<1:17:16,  5.20s/it]  9%|▉         | 89/980 [07:46<1:14:19,  5.00s/it]  9%|▉         | 90/980 [07:52<1:20:22,  5.42s/it]                                                    9%|▉         | 90/980 [07:52<1:20:22,  5.42s/it]  9%|▉         | 91/980 [07:57<1:18:21,  5.29s/it]  9%|▉         | 92/980 [08:03<1:20:36,  5.45s/it]  9%|▉         | 93/980 [08:08<1:18:50,  5.33s/it] 10%|▉         | 94/980 [08:13<1:17:16,  5.23s/it] 10%|▉         | 95/980 [08:18<1:16:29,  5.19s/it] 10%|▉         | 96/980 [08:23<1:13:32,  4.99s/it] 10%|▉         | 97/980 [08:27<1:11:25,  4.85s/it] 10%|█         | 98/980 [08:32<1:10:43,  4.81s/it] 10%|█         | 99/980 [08:38<1:15:38,  5.15s/it] 10%|█         | 100/980 [08:43<1:12:51,  4.97s/it]                                                    10%|█         | 100/980 [08:43<1:12:51,  4.97s/it][INFO|trainer.py:4021] 2024-11-06 03:27:46,325 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:27:46,325 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:27:46,325 >>   Batch size = 4
{'loss': 1.225, 'grad_norm': 1.0191056728363037, 'learning_rate': 4.99871554050172e-05, 'epoch': 0.05}
{'loss': 0.6867, 'grad_norm': 0.9654883742332458, 'learning_rate': 4.994863481875841e-05, 'epoch': 0.1}
{'loss': 0.4855, 'grad_norm': 0.8520717620849609, 'learning_rate': 4.9884477823729956e-05, 'epoch': 0.15}
{'loss': 0.4191, 'grad_norm': 0.7957696318626404, 'learning_rate': 4.979475034558115e-05, 'epoch': 0.2}
{'loss': 0.3526, 'grad_norm': 0.6676112413406372, 'learning_rate': 4.967954458536126e-05, 'epoch': 0.25}
{'loss': 0.3512, 'grad_norm': 0.7221593856811523, 'learning_rate': 4.9538978924776634e-05, 'epoch': 0.3}
{'loss': 0.3547, 'grad_norm': 0.8104822635650635, 'learning_rate': 4.937319780454559e-05, 'epoch': 0.36}
{'loss': 0.2989, 'grad_norm': 0.6637939214706421, 'learning_rate': 4.9182371575975736e-05, 'epoch': 0.41}
{'loss': 0.2712, 'grad_norm': 0.7388603687286377, 'learning_rate': 4.8966696325916515e-05, 'epoch': 0.46}
{'loss': 0.2692, 'grad_norm': 0.7946398258209229, 'learning_rate': 4.8726393675266716e-05, 'epoch': 0.51}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.69it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.43it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.34it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.37it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.98it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.71it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.96it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.07it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.62it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.62it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.06it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.16it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.55it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.16it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.96it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.70it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.60it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.32it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.57it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.76it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.05it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.28it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.14it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.78it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.90it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.91it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.30it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.05it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.03it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.82it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.64it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.87it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.23it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.27it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.47it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.18it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.61it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.79it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.25it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.62it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.34it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.45it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.49it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.59it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.39it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.72it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.58it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.87it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.73it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.05it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.88it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.24it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.22it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.13it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.41it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 10%|█         | 100/980 [09:15<1:12:51,  4.97s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:28:18,717 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-100
[INFO|configuration_utils.py:673] 2024-11-06 03:28:18,738 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:28:18,738 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:28:18,847 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:28:18,847 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-100/special_tokens_map.json
 10%|█         | 101/980 [09:21<3:38:24, 14.91s/it] 10%|█         | 102/980 [09:26<2:56:58, 12.09s/it] 11%|█         | 103/980 [09:31<2:26:14, 10.01s/it] 11%|█         | 104/980 [09:37<2:06:33,  8.67s/it] 11%|█         | 105/980 [09:42<1:49:42,  7.52s/it] 11%|█         | 106/980 [09:46<1:36:19,  6.61s/it] 11%|█         | 107/980 [09:52<1:30:42,  6.23s/it] 11%|█         | 108/980 [09:57<1:26:51,  5.98s/it] 11%|█         | 109/980 [10:02<1:22:30,  5.68s/it] 11%|█         | 110/980 [10:07<1:18:50,  5.44s/it]                                                    11%|█         | 110/980 [10:07<1:18:50,  5.44s/it] 11%|█▏        | 111/980 [10:12<1:15:59,  5.25s/it] 11%|█▏        | 112/980 [10:16<1:13:51,  5.11s/it] 12%|█▏        | 113/980 [10:22<1:15:17,  5.21s/it] 12%|█▏        | 114/980 [10:27<1:13:19,  5.08s/it] 12%|█▏        | 115/980 [10:30<1:07:47,  4.70s/it] 12%|█▏        | 116/980 [10:36<1:09:29,  4.83s/it] 12%|█▏        | 117/980 [10:41<1:12:22,  5.03s/it] 12%|█▏        | 118/980 [10:46<1:11:02,  4.95s/it] 12%|█▏        | 119/980 [10:51<1:10:10,  4.89s/it] 12%|█▏        | 120/980 [10:55<1:08:24,  4.77s/it]                                                    12%|█▏        | 120/980 [10:55<1:08:24,  4.77s/it] 12%|█▏        | 121/980 [11:00<1:10:35,  4.93s/it] 12%|█▏        | 122/980 [11:05<1:10:28,  4.93s/it] 13%|█▎        | 123/980 [11:11<1:11:56,  5.04s/it] 13%|█▎        | 124/980 [11:16<1:12:40,  5.09s/it] 13%|█▎        | 125/980 [11:21<1:10:49,  4.97s/it] 13%|█▎        | 126/980 [11:25<1:08:23,  4.81s/it] 13%|█▎        | 127/980 [11:30<1:07:29,  4.75s/it] 13%|█▎        | 128/980 [11:35<1:09:57,  4.93s/it] 13%|█▎        | 129/980 [11:40<1:10:32,  4.97s/it] 13%|█▎        | 130/980 [11:45<1:11:32,  5.05s/it]                                                    13%|█▎        | 130/980 [11:45<1:11:32,  5.05s/it] 13%|█▎        | 131/980 [11:50<1:11:46,  5.07s/it] 13%|█▎        | 132/980 [11:55<1:10:42,  5.00s/it] 14%|█▎        | 133/980 [12:01<1:12:17,  5.12s/it] 14%|█▎        | 134/980 [12:05<1:11:13,  5.05s/it] 14%|█▍        | 135/980 [12:10<1:09:44,  4.95s/it] 14%|█▍        | 136/980 [12:14<1:06:46,  4.75s/it] 14%|█▍        | 137/980 [12:19<1:04:37,  4.60s/it] 14%|█▍        | 138/980 [12:24<1:06:51,  4.76s/it] 14%|█▍        | 139/980 [12:28<1:04:59,  4.64s/it] 14%|█▍        | 140/980 [12:33<1:06:51,  4.78s/it]                                                    14%|█▍        | 140/980 [12:33<1:06:51,  4.78s/it] 14%|█▍        | 141/980 [12:38<1:08:02,  4.87s/it] 14%|█▍        | 142/980 [12:43<1:08:53,  4.93s/it] 15%|█▍        | 143/980 [12:48<1:05:21,  4.69s/it] 15%|█▍        | 144/980 [12:53<1:07:53,  4.87s/it] 15%|█▍        | 145/980 [12:57<1:05:59,  4.74s/it] 15%|█▍        | 146/980 [13:03<1:08:06,  4.90s/it] 15%|█▌        | 147/980 [13:08<1:10:40,  5.09s/it] 15%|█▌        | 148/980 [13:13<1:11:22,  5.15s/it] 15%|█▌        | 149/980 [13:18<1:09:48,  5.04s/it] 15%|█▌        | 150/980 [13:24<1:12:00,  5.21s/it]                                                    15%|█▌        | 150/980 [13:24<1:12:00,  5.21s/it] 15%|█▌        | 151/980 [13:29<1:11:33,  5.18s/it] 16%|█▌        | 152/980 [13:34<1:12:37,  5.26s/it] 16%|█▌        | 153/980 [13:40<1:13:29,  5.33s/it] 16%|█▌        | 154/980 [13:45<1:13:20,  5.33s/it] 16%|█▌        | 155/980 [13:51<1:13:39,  5.36s/it] 16%|█▌        | 156/980 [13:56<1:15:14,  5.48s/it] 16%|█▌        | 157/980 [14:02<1:16:22,  5.57s/it] 16%|█▌        | 158/980 [14:07<1:15:26,  5.51s/it] 16%|█▌        | 159/980 [14:13<1:16:12,  5.57s/it] 16%|█▋        | 160/980 [14:19<1:15:32,  5.53s/it]                                                    16%|█▋        | 160/980 [14:19<1:15:32,  5.53s/it] 16%|█▋        | 161/980 [14:23<1:10:27,  5.16s/it] 17%|█▋        | 162/980 [14:28<1:08:35,  5.03s/it] 17%|█▋        | 163/980 [14:33<1:10:30,  5.18s/it] 17%|█▋        | 164/980 [14:38<1:09:23,  5.10s/it] 17%|█▋        | 165/980 [14:44<1:12:57,  5.37s/it] 17%|█▋        | 166/980 [14:48<1:08:32,  5.05s/it] 17%|█▋        | 167/980 [14:53<1:06:11,  4.88s/it] 17%|█▋        | 168/980 [14:58<1:06:05,  4.88s/it] 17%|█▋        | 169/980 [15:02<1:03:38,  4.71s/it] 17%|█▋        | 170/980 [15:06<1:02:08,  4.60s/it]                                                    17%|█▋        | 170/980 [15:06<1:02:08,  4.60s/it] 17%|█▋        | 171/980 [15:12<1:05:43,  4.87s/it] 18%|█▊        | 172/980 [15:16<1:02:30,  4.64s/it] 18%|█▊        | 173/980 [15:21<1:02:45,  4.67s/it] 18%|█▊        | 174/980 [15:27<1:08:51,  5.13s/it] 18%|█▊        | 175/980 [15:31<1:06:10,  4.93s/it] 18%|█▊        | 176/980 [15:36<1:04:20,  4.80s/it] 18%|█▊        | 177/980 [15:40<1:01:29,  4.59s/it] 18%|█▊        | 178/980 [15:45<1:02:14,  4.66s/it] 18%|█▊        | 179/980 [15:50<1:02:14,  4.66s/it] 18%|█▊        | 180/980 [15:54<1:03:04,  4.73s/it]                                                    18%|█▊        | 180/980 [15:54<1:03:04,  4.73s/it] 18%|█▊        | 181/980 [15:59<1:03:44,  4.79s/it] 19%|█▊        | 182/980 [16:04<1:04:13,  4.83s/it] 19%|█▊        | 183/980 [16:09<1:02:38,  4.72s/it] 19%|█▉        | 184/980 [16:14<1:06:15,  4.99s/it] 19%|█▉        | 185/980 [16:19<1:06:00,  4.98s/it] 19%|█▉        | 186/980 [16:24<1:05:30,  4.95s/it] 19%|█▉        | 187/980 [16:29<1:04:30,  4.88s/it] 19%|█▉        | 188/980 [16:33<1:01:41,  4.67s/it] 19%|█▉        | 189/980 [16:38<1:03:07,  4.79s/it] 19%|█▉        | 190/980 [16:42<1:01:06,  4.64s/it]                                                    19%|█▉        | 190/980 [16:42<1:01:06,  4.64s/it] 19%|█▉        | 191/980 [16:48<1:03:56,  4.86s/it] 20%|█▉        | 192/980 [16:52<1:02:35,  4.77s/it] 20%|█▉        | 193/980 [16:56<59:14,  4.52s/it]   20%|█▉        | 194/980 [17:01<58:03,  4.43s/it] 20%|█▉        | 195/980 [17:07<1:06:02,  5.05s/it] 20%|██        | 196/980 [17:13<1:09:33,  5.32s/it] 20%|██        | 197/980 [17:18<1:06:23,  5.09s/it] 20%|██        | 198/980 [17:24<1:10:41,  5.42s/it] 20%|██        | 199/980 [17:28<1:07:40,  5.20s/it] 20%|██        | 200/980 [17:33<1:05:59,  5.08s/it]                                                    20%|██        | 200/980 [17:33<1:05:59,  5.08s/it][INFO|trainer.py:4021] 2024-11-06 03:36:36,954 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:36:36,954 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:36:36,954 >>   Batch size = 4
{'eval_loss': 0.27519363164901733, 'eval_runtime': 32.3911, 'eval_samples_per_second': 21.611, 'eval_steps_per_second': 5.403, 'epoch': 0.51}
{'loss': 0.258, 'grad_norm': 0.7324967980384827, 'learning_rate': 4.846171055124401e-05, 'epoch': 0.56}
{'loss': 0.2741, 'grad_norm': 1.1370856761932373, 'learning_rate': 4.817291893365055e-05, 'epoch': 0.61}
{'loss': 0.2655, 'grad_norm': 1.4511381387710571, 'learning_rate': 4.7860315575395316e-05, 'epoch': 0.66}
{'loss': 0.2376, 'grad_norm': 1.071557641029358, 'learning_rate': 4.752422169756048e-05, 'epoch': 0.71}
{'loss': 0.2298, 'grad_norm': 1.04619562625885, 'learning_rate': 4.716498265932501e-05, 'epoch': 0.76}
{'loss': 0.2248, 'grad_norm': 0.842060923576355, 'learning_rate': 4.678296760308474e-05, 'epoch': 0.81}
{'loss': 0.219, 'grad_norm': 1.2725625038146973, 'learning_rate': 4.637856907513366e-05, 'epoch': 0.86}
{'loss': 0.2176, 'grad_norm': 1.1059691905975342, 'learning_rate': 4.595220262229601e-05, 'epoch': 0.91}
{'loss': 0.2162, 'grad_norm': 1.227347493171692, 'learning_rate': 4.55043063649239e-05, 'epoch': 0.97}
{'loss': 0.2026, 'grad_norm': 1.476076364517212, 'learning_rate': 4.503534054669892e-05, 'epoch': 1.02}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.70it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.42it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.36it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.50it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.71it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.56it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.95it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.62it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.24it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.01it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.81it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.44it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.07it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.63it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.07it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.95it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.16it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.56it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.16it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.66it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.17it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.04it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.71it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.61it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.24it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.59it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.29it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.35it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.34it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.60it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.78it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.49it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.45it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.79it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.60it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.30it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.94it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.15it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.56it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.79it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.91it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.21it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.91it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.89it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.28it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.64it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.16it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.32it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.35it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.37it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.88it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.07it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.60it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.23it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.84it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.62it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.24it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.29it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.67it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.48it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.42it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.18it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.61it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.10it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.04it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.58it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.30it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:21<00:11,  4.79it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.35it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.52it/s][A
 77%|███████▋  | 134/175 [00:24<00:06,  6.33it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:25<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.76it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.78it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.98it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.65it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.19it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:29<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.88it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 20%|██        | 200/980 [18:06<1:05:59,  5.08s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:37:09,308 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-200
[INFO|configuration_utils.py:673] 2024-11-06 03:37:09,328 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:37:09,329 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:37:09,420 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:37:09,421 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-200/special_tokens_map.json
 21%|██        | 201/980 [18:11<3:15:06, 15.03s/it] 21%|██        | 202/980 [18:17<2:36:37, 12.08s/it] 21%|██        | 203/980 [18:21<2:06:40,  9.78s/it] 21%|██        | 204/980 [18:27<1:49:58,  8.50s/it] 21%|██        | 205/980 [18:32<1:36:18,  7.46s/it] 21%|██        | 206/980 [18:36<1:24:20,  6.54s/it] 21%|██        | 207/980 [18:42<1:21:05,  6.29s/it] 21%|██        | 208/980 [18:47<1:18:00,  6.06s/it] 21%|██▏       | 209/980 [18:52<1:12:25,  5.64s/it] 21%|██▏       | 210/980 [18:57<1:11:12,  5.55s/it]                                                    21%|██▏       | 210/980 [18:57<1:11:12,  5.55s/it] 22%|██▏       | 211/980 [19:03<1:10:50,  5.53s/it] 22%|██▏       | 212/980 [19:08<1:09:17,  5.41s/it] 22%|██▏       | 213/980 [19:13<1:07:02,  5.24s/it] 22%|██▏       | 214/980 [19:18<1:05:35,  5.14s/it] 22%|██▏       | 215/980 [19:23<1:05:34,  5.14s/it] 22%|██▏       | 216/980 [19:27<1:03:39,  5.00s/it] 22%|██▏       | 217/980 [19:32<1:03:43,  5.01s/it] 22%|██▏       | 218/980 [19:38<1:06:49,  5.26s/it] 22%|██▏       | 219/980 [19:43<1:03:19,  4.99s/it] 22%|██▏       | 220/980 [19:48<1:03:47,  5.04s/it]                                                    22%|██▏       | 220/980 [19:48<1:03:47,  5.04s/it] 23%|██▎       | 221/980 [19:53<1:04:04,  5.06s/it] 23%|██▎       | 222/980 [19:59<1:06:55,  5.30s/it] 23%|██▎       | 223/980 [20:04<1:06:57,  5.31s/it] 23%|██▎       | 224/980 [20:09<1:05:29,  5.20s/it] 23%|██▎       | 225/980 [20:15<1:06:39,  5.30s/it] 23%|██▎       | 226/980 [20:19<1:03:41,  5.07s/it] 23%|██▎       | 227/980 [20:24<1:03:54,  5.09s/it] 23%|██▎       | 228/980 [20:30<1:04:53,  5.18s/it] 23%|██▎       | 229/980 [20:35<1:05:50,  5.26s/it] 23%|██▎       | 230/980 [20:39<1:01:46,  4.94s/it]                                                    23%|██▎       | 230/980 [20:39<1:01:46,  4.94s/it] 24%|██▎       | 231/980 [20:45<1:04:16,  5.15s/it] 24%|██▎       | 232/980 [20:49<1:00:22,  4.84s/it] 24%|██▍       | 233/980 [20:54<1:01:07,  4.91s/it] 24%|██▍       | 234/980 [20:59<1:01:27,  4.94s/it] 24%|██▍       | 235/980 [21:03<58:34,  4.72s/it]   24%|██▍       | 236/980 [21:09<1:00:56,  4.91s/it] 24%|██▍       | 237/980 [21:14<1:01:35,  4.97s/it] 24%|██▍       | 238/980 [21:18<59:02,  4.77s/it]   24%|██▍       | 239/980 [21:23<1:01:01,  4.94s/it] 24%|██▍       | 240/980 [21:29<1:02:22,  5.06s/it]                                                    24%|██▍       | 240/980 [21:29<1:02:22,  5.06s/it] 25%|██▍       | 241/980 [21:34<1:03:03,  5.12s/it] 25%|██▍       | 242/980 [21:39<1:03:55,  5.20s/it] 25%|██▍       | 243/980 [21:45<1:05:06,  5.30s/it] 25%|██▍       | 244/980 [21:50<1:03:42,  5.19s/it] 25%|██▌       | 245/980 [21:55<1:03:17,  5.17s/it] 25%|██▌       | 246/980 [22:00<1:02:39,  5.12s/it] 25%|██▌       | 247/980 [22:05<1:02:02,  5.08s/it] 25%|██▌       | 248/980 [22:10<59:58,  4.92s/it]   25%|██▌       | 249/980 [22:15<1:01:51,  5.08s/it] 26%|██▌       | 250/980 [22:21<1:04:18,  5.28s/it]                                                    26%|██▌       | 250/980 [22:21<1:04:18,  5.28s/it] 26%|██▌       | 251/980 [22:25<58:45,  4.84s/it]   26%|██▌       | 252/980 [22:30<1:01:22,  5.06s/it] 26%|██▌       | 253/980 [22:35<1:01:02,  5.04s/it] 26%|██▌       | 254/980 [22:40<1:00:22,  4.99s/it] 26%|██▌       | 255/980 [22:46<1:04:26,  5.33s/it] 26%|██▌       | 256/980 [22:52<1:05:35,  5.44s/it] 26%|██▌       | 257/980 [22:58<1:08:10,  5.66s/it] 26%|██▋       | 258/980 [23:03<1:04:15,  5.34s/it] 26%|██▋       | 259/980 [23:07<1:01:50,  5.15s/it] 27%|██▋       | 260/980 [23:13<1:02:16,  5.19s/it]                                                    27%|██▋       | 260/980 [23:13<1:02:16,  5.19s/it] 27%|██▋       | 261/980 [23:17<59:37,  4.98s/it]   27%|██▋       | 262/980 [23:21<57:14,  4.78s/it] 27%|██▋       | 263/980 [23:27<59:04,  4.94s/it] 27%|██▋       | 264/980 [23:31<56:11,  4.71s/it] 27%|██▋       | 265/980 [23:35<54:27,  4.57s/it] 27%|██▋       | 266/980 [23:40<55:38,  4.68s/it] 27%|██▋       | 267/980 [23:44<54:23,  4.58s/it] 27%|██▋       | 268/980 [23:49<55:34,  4.68s/it] 27%|██▋       | 269/980 [23:55<58:47,  4.96s/it] 28%|██▊       | 270/980 [24:00<58:12,  4.92s/it]                                                  28%|██▊       | 270/980 [24:00<58:12,  4.92s/it] 28%|██▊       | 271/980 [24:05<59:14,  5.01s/it] 28%|██▊       | 272/980 [24:09<56:40,  4.80s/it] 28%|██▊       | 273/980 [24:13<54:26,  4.62s/it] 28%|██▊       | 274/980 [24:19<58:34,  4.98s/it] 28%|██▊       | 275/980 [24:24<57:21,  4.88s/it] 28%|██▊       | 276/980 [24:28<55:32,  4.73s/it] 28%|██▊       | 277/980 [24:33<55:25,  4.73s/it] 28%|██▊       | 278/980 [24:39<59:21,  5.07s/it] 28%|██▊       | 279/980 [24:44<57:33,  4.93s/it] 29%|██▊       | 280/980 [24:47<53:16,  4.57s/it]                                                  29%|██▊       | 280/980 [24:47<53:16,  4.57s/it] 29%|██▊       | 281/980 [24:52<53:25,  4.59s/it] 29%|██▉       | 282/980 [24:56<52:12,  4.49s/it] 29%|██▉       | 283/980 [25:02<56:23,  4.85s/it] 29%|██▉       | 284/980 [25:08<1:00:26,  5.21s/it] 29%|██▉       | 285/980 [25:13<1:00:42,  5.24s/it] 29%|██▉       | 286/980 [25:19<1:01:11,  5.29s/it] 29%|██▉       | 287/980 [25:23<59:25,  5.15s/it]   29%|██▉       | 288/980 [25:28<56:46,  4.92s/it] 29%|██▉       | 289/980 [25:34<59:47,  5.19s/it] 30%|██▉       | 290/980 [25:38<56:39,  4.93s/it]                                                  30%|██▉       | 290/980 [25:38<56:39,  4.93s/it] 30%|██▉       | 291/980 [25:43<58:24,  5.09s/it] 30%|██▉       | 292/980 [25:48<56:57,  4.97s/it] 30%|██▉       | 293/980 [25:53<55:53,  4.88s/it] 30%|███       | 294/980 [25:58<57:01,  4.99s/it] 30%|███       | 295/980 [26:02<54:54,  4.81s/it] 30%|███       | 296/980 [26:08<57:52,  5.08s/it] 30%|███       | 297/980 [26:14<59:34,  5.23s/it] 30%|███       | 298/980 [26:18<56:39,  4.98s/it] 31%|███       | 299/980 [26:23<54:58,  4.84s/it] 31%|███       | 300/980 [26:27<54:06,  4.77s/it]                                                  31%|███       | 300/980 [26:27<54:06,  4.77s/it][INFO|trainer.py:4021] 2024-11-06 03:45:30,977 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:45:30,977 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:45:30,977 >>   Batch size = 4
{'eval_loss': 0.20201446115970612, 'eval_runtime': 32.3535, 'eval_samples_per_second': 21.636, 'eval_steps_per_second': 5.409, 'epoch': 1.02}
{'loss': 0.1884, 'grad_norm': 1.2760798931121826, 'learning_rate': 4.454578706170075e-05, 'epoch': 1.07}
{'loss': 0.1738, 'grad_norm': 1.0688468217849731, 'learning_rate': 4.4036148959228365e-05, 'epoch': 1.12}
{'loss': 0.1742, 'grad_norm': 1.3657989501953125, 'learning_rate': 4.350694992688289e-05, 'epoch': 1.17}
{'loss': 0.1695, 'grad_norm': 1.0645039081573486, 'learning_rate': 4.2958733752443195e-05, 'epoch': 1.22}
{'loss': 0.1815, 'grad_norm': 0.8085832595825195, 'learning_rate': 4.239206376508717e-05, 'epoch': 1.27}
{'loss': 0.1677, 'grad_norm': 1.4982285499572754, 'learning_rate': 4.180752225653292e-05, 'epoch': 1.32}
{'loss': 0.1556, 'grad_norm': 1.3534070253372192, 'learning_rate': 4.120570988269472e-05, 'epoch': 1.37}
{'loss': 0.161, 'grad_norm': 1.2130829095840454, 'learning_rate': 4.058724504646834e-05, 'epoch': 1.42}
{'loss': 0.1747, 'grad_norm': 1.6561528444290161, 'learning_rate': 3.9952763262280405e-05, 'epoch': 1.47}
{'loss': 0.1456, 'grad_norm': 1.4149686098098755, 'learning_rate': 3.9302916503054246e-05, 'epoch': 1.52}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.69it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.40it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.37it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:27,  6.01it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.12it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.54it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.40it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.73it/s][A
  7%|▋         | 12/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.56it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.95it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.07it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.63it/s][A
 10%|█         | 18/175 [00:03<00:36,  4.25it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.02it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.07it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.15it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.62it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.07it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.95it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.53it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.17it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.98it/s][A
 22%|██▏       | 39/175 [00:07<00:26,  5.04it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.72it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.19it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.71it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.92it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.24it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.58it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.29it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.91it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.54it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.43it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.29it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.12it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.51it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.59it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.92it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.30it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.04it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.03it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.63it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.82it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.25it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.58it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.19it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.23it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.61it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.45it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.39it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.79it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.53it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.09it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.14it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.74it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.41it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 31%|███       | 300/980 [27:00<54:06,  4.77s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:46:03,350 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-300
[INFO|configuration_utils.py:673] 2024-11-06 03:46:03,370 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:46:03,371 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:46:03,458 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:46:03,458 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-300/special_tokens_map.json
 31%|███       | 301/980 [27:05<2:45:59, 14.67s/it] 31%|███       | 302/980 [27:11<2:15:34, 12.00s/it] 31%|███       | 303/980 [27:16<1:51:22,  9.87s/it] 31%|███       | 304/980 [27:20<1:33:52,  8.33s/it] 31%|███       | 305/980 [27:26<1:24:11,  7.48s/it] 31%|███       | 306/980 [27:31<1:16:48,  6.84s/it] 31%|███▏      | 307/980 [27:36<1:08:57,  6.15s/it] 31%|███▏      | 308/980 [27:42<1:07:53,  6.06s/it] 32%|███▏      | 309/980 [27:46<1:02:04,  5.55s/it] 32%|███▏      | 310/980 [27:51<1:01:35,  5.52s/it]                                                    32%|███▏      | 310/980 [27:51<1:01:35,  5.52s/it] 32%|███▏      | 311/980 [27:56<58:06,  5.21s/it]   32%|███▏      | 312/980 [28:00<54:28,  4.89s/it] 32%|███▏      | 313/980 [28:05<53:15,  4.79s/it] 32%|███▏      | 314/980 [28:08<49:55,  4.50s/it] 32%|███▏      | 315/980 [28:14<53:13,  4.80s/it] 32%|███▏      | 316/980 [28:19<54:13,  4.90s/it] 32%|███▏      | 317/980 [28:24<53:46,  4.87s/it] 32%|███▏      | 318/980 [28:29<55:01,  4.99s/it] 33%|███▎      | 319/980 [28:34<53:50,  4.89s/it] 33%|███▎      | 320/980 [28:39<54:05,  4.92s/it]                                                  33%|███▎      | 320/980 [28:39<54:05,  4.92s/it] 33%|███▎      | 321/980 [28:44<54:08,  4.93s/it] 33%|███▎      | 322/980 [28:49<55:28,  5.06s/it] 33%|███▎      | 323/980 [28:54<56:22,  5.15s/it] 33%|███▎      | 324/980 [28:59<53:03,  4.85s/it] 33%|███▎      | 325/980 [29:04<54:52,  5.03s/it] 33%|███▎      | 326/980 [29:09<53:31,  4.91s/it] 33%|███▎      | 327/980 [29:14<54:37,  5.02s/it] 33%|███▎      | 328/980 [29:19<54:54,  5.05s/it] 34%|███▎      | 329/980 [29:23<52:33,  4.84s/it] 34%|███▎      | 330/980 [29:29<53:34,  4.95s/it]                                                  34%|███▎      | 330/980 [29:29<53:34,  4.95s/it] 34%|███▍      | 331/980 [29:34<53:52,  4.98s/it] 34%|███▍      | 332/980 [29:38<51:10,  4.74s/it] 34%|███▍      | 333/980 [29:43<52:55,  4.91s/it] 34%|███▍      | 334/980 [29:48<52:00,  4.83s/it] 34%|███▍      | 335/980 [29:53<52:27,  4.88s/it] 34%|███▍      | 336/980 [29:58<51:43,  4.82s/it] 34%|███▍      | 337/980 [30:03<52:52,  4.93s/it] 34%|███▍      | 338/980 [30:08<53:18,  4.98s/it] 35%|███▍      | 339/980 [30:12<51:20,  4.81s/it] 35%|███▍      | 340/980 [30:18<53:21,  5.00s/it]                                                  35%|███▍      | 340/980 [30:18<53:21,  5.00s/it] 35%|███▍      | 341/980 [30:23<55:35,  5.22s/it] 35%|███▍      | 342/980 [30:28<52:30,  4.94s/it] 35%|███▌      | 343/980 [30:32<50:42,  4.78s/it] 35%|███▌      | 344/980 [30:37<51:20,  4.84s/it] 35%|███▌      | 345/980 [30:42<50:22,  4.76s/it] 35%|███▌      | 346/980 [30:47<52:07,  4.93s/it] 35%|███▌      | 347/980 [30:52<51:24,  4.87s/it] 36%|███▌      | 348/980 [30:56<49:04,  4.66s/it] 36%|███▌      | 349/980 [31:02<53:55,  5.13s/it] 36%|███▌      | 350/980 [31:07<54:23,  5.18s/it]                                                  36%|███▌      | 350/980 [31:07<54:23,  5.18s/it] 36%|███▌      | 351/980 [31:13<54:37,  5.21s/it] 36%|███▌      | 352/980 [31:18<56:12,  5.37s/it] 36%|███▌      | 353/980 [31:24<56:41,  5.43s/it] 36%|███▌      | 354/980 [31:30<57:09,  5.48s/it] 36%|███▌      | 355/980 [31:35<56:13,  5.40s/it] 36%|███▋      | 356/980 [31:40<54:45,  5.27s/it] 36%|███▋      | 357/980 [31:45<55:19,  5.33s/it] 37%|███▋      | 358/980 [31:50<54:07,  5.22s/it] 37%|███▋      | 359/980 [31:55<51:52,  5.01s/it] 37%|███▋      | 360/980 [32:00<53:29,  5.18s/it]                                                  37%|███▋      | 360/980 [32:00<53:29,  5.18s/it] 37%|███▋      | 361/980 [32:05<53:18,  5.17s/it] 37%|███▋      | 362/980 [32:11<54:08,  5.26s/it] 37%|███▋      | 363/980 [32:16<53:55,  5.24s/it] 37%|███▋      | 364/980 [32:21<53:12,  5.18s/it] 37%|███▋      | 365/980 [32:27<54:40,  5.33s/it] 37%|███▋      | 366/980 [32:32<54:12,  5.30s/it] 37%|███▋      | 367/980 [32:37<52:54,  5.18s/it] 38%|███▊      | 368/980 [32:42<51:39,  5.07s/it] 38%|███▊      | 369/980 [32:47<51:21,  5.04s/it] 38%|███▊      | 370/980 [32:52<51:03,  5.02s/it]                                                  38%|███▊      | 370/980 [32:52<51:03,  5.02s/it] 38%|███▊      | 371/980 [32:57<51:09,  5.04s/it] 38%|███▊      | 372/980 [33:03<53:12,  5.25s/it] 38%|███▊      | 373/980 [33:08<52:36,  5.20s/it] 38%|███▊      | 374/980 [33:13<52:39,  5.21s/it] 38%|███▊      | 375/980 [33:19<54:03,  5.36s/it] 38%|███▊      | 376/980 [33:24<53:25,  5.31s/it] 38%|███▊      | 377/980 [33:30<54:56,  5.47s/it] 39%|███▊      | 378/980 [33:34<51:48,  5.16s/it] 39%|███▊      | 379/980 [33:40<52:44,  5.26s/it] 39%|███▉      | 380/980 [33:44<50:38,  5.06s/it]                                                  39%|███▉      | 380/980 [33:44<50:38,  5.06s/it] 39%|███▉      | 381/980 [33:50<52:06,  5.22s/it] 39%|███▉      | 382/980 [33:54<50:20,  5.05s/it] 39%|███▉      | 383/980 [33:59<48:33,  4.88s/it] 39%|███▉      | 384/980 [34:04<50:07,  5.05s/it] 39%|███▉      | 385/980 [34:09<49:42,  5.01s/it] 39%|███▉      | 386/980 [34:15<50:50,  5.14s/it] 39%|███▉      | 387/980 [34:20<51:38,  5.23s/it] 40%|███▉      | 388/980 [34:24<48:55,  4.96s/it] 40%|███▉      | 389/980 [34:30<49:42,  5.05s/it] 40%|███▉      | 390/980 [34:35<48:58,  4.98s/it]                                                  40%|███▉      | 390/980 [34:35<48:58,  4.98s/it] 40%|███▉      | 391/980 [34:39<46:25,  4.73s/it] 40%|████      | 392/980 [34:44<49:00,  5.00s/it] 40%|████      | 393/980 [34:49<47:55,  4.90s/it] 40%|████      | 394/980 [34:53<44:12,  4.53s/it] 40%|████      | 395/980 [34:57<45:00,  4.62s/it] 40%|████      | 396/980 [35:02<46:02,  4.73s/it] 41%|████      | 397/980 [35:08<49:02,  5.05s/it] 41%|████      | 398/980 [35:14<49:56,  5.15s/it] 41%|████      | 399/980 [35:18<48:43,  5.03s/it] 41%|████      | 400/980 [35:23<47:49,  4.95s/it]                                                  41%|████      | 400/980 [35:23<47:49,  4.95s/it][INFO|trainer.py:4021] 2024-11-06 03:54:26,835 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:54:26,835 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:54:26,835 >>   Batch size = 4
{'eval_loss': 0.17671045660972595, 'eval_runtime': 32.3728, 'eval_samples_per_second': 21.623, 'eval_steps_per_second': 5.406, 'epoch': 1.52}
{'loss': 0.1502, 'grad_norm': 1.3356090784072876, 'learning_rate': 3.8638372530263715e-05, 'epoch': 1.57}
{'loss': 0.1531, 'grad_norm': 1.2519950866699219, 'learning_rate': 3.7959814207763135e-05, 'epoch': 1.63}
{'loss': 0.1467, 'grad_norm': 1.0121928453445435, 'learning_rate': 3.726793880009845e-05, 'epoch': 1.68}
{'loss': 0.1473, 'grad_norm': 0.9090415835380554, 'learning_rate': 3.656345725602089e-05, 'epoch': 1.73}
{'loss': 0.1503, 'grad_norm': 1.4178476333618164, 'learning_rate': 3.5847093477938956e-05, 'epoch': 1.78}
{'loss': 0.139, 'grad_norm': 1.134209394454956, 'learning_rate': 3.5119583578059846e-05, 'epoch': 1.83}
{'loss': 0.1487, 'grad_norm': 1.5325080156326294, 'learning_rate': 3.438167512198436e-05, 'epoch': 1.88}
{'loss': 0.148, 'grad_norm': 0.9620266556739807, 'learning_rate': 3.363412636053269e-05, 'epoch': 1.93}
{'loss': 0.1409, 'grad_norm': 1.1046562194824219, 'learning_rate': 3.2877705450590526e-05, 'epoch': 1.98}
{'loss': 0.1097, 'grad_norm': 1.70424485206604, 'learning_rate': 3.211318966577581e-05, 'epoch': 2.03}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.70it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.42it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.36it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:27,  6.01it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.12it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.53it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.70it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.96it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.08it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.63it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:39,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.62it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.06it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.95it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.16it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.66it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.94it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.17it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.23it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.72it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.19it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.92it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.24it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.58it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.28it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.34it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.91it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.54it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.14it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.60it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.29it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.78it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.90it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.21it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.59it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.91it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.05it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.03it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.63it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.34it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.83it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.03it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.57it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.21it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.35it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.47it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.79it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.62it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.76it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.98it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.09it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.69it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.68it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.22it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.25it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.73it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.08it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.18it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.13it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.74it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.91it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.61it/s][A                                                 
                                                 [A 41%|████      | 400/980 [35:55<47:49,  4.95s/it]
100%|██████████| 175/175 [00:32<00:00,  4.61it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:54:59,214 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-400
[INFO|configuration_utils.py:673] 2024-11-06 03:54:59,235 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:54:59,235 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:54:59,327 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:54:59,327 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-400/special_tokens_map.json
 41%|████      | 401/980 [36:01<2:23:45, 14.90s/it] 41%|████      | 402/980 [36:06<1:53:18, 11.76s/it] 41%|████      | 403/980 [36:11<1:34:12,  9.80s/it] 41%|████      | 404/980 [36:16<1:20:15,  8.36s/it] 41%|████▏     | 405/980 [36:22<1:15:01,  7.83s/it] 41%|████▏     | 406/980 [36:27<1:04:53,  6.78s/it] 42%|████▏     | 407/980 [36:31<57:57,  6.07s/it]   42%|████▏     | 408/980 [36:37<55:45,  5.85s/it] 42%|████▏     | 409/980 [36:41<51:24,  5.40s/it] 42%|████▏     | 410/980 [36:46<50:17,  5.29s/it]                                                  42%|████▏     | 410/980 [36:46<50:17,  5.29s/it] 42%|████▏     | 411/980 [36:51<49:06,  5.18s/it] 42%|████▏     | 412/980 [36:56<49:31,  5.23s/it] 42%|████▏     | 413/980 [37:01<47:47,  5.06s/it] 42%|████▏     | 414/980 [37:06<47:15,  5.01s/it] 42%|████▏     | 415/980 [37:10<45:27,  4.83s/it] 42%|████▏     | 416/980 [37:16<46:52,  4.99s/it] 43%|████▎     | 417/980 [37:21<47:22,  5.05s/it] 43%|████▎     | 418/980 [37:26<49:12,  5.25s/it] 43%|████▎     | 419/980 [37:30<44:19,  4.74s/it] 43%|████▎     | 420/980 [37:36<46:50,  5.02s/it]                                                  43%|████▎     | 420/980 [37:36<46:50,  5.02s/it] 43%|████▎     | 421/980 [37:41<47:10,  5.06s/it] 43%|████▎     | 422/980 [37:45<45:17,  4.87s/it] 43%|████▎     | 423/980 [37:50<45:29,  4.90s/it] 43%|████▎     | 424/980 [37:55<44:05,  4.76s/it] 43%|████▎     | 425/980 [37:59<43:07,  4.66s/it] 43%|████▎     | 426/980 [38:04<43:46,  4.74s/it] 44%|████▎     | 427/980 [38:09<44:45,  4.86s/it] 44%|████▎     | 428/980 [38:14<44:41,  4.86s/it] 44%|████▍     | 429/980 [38:20<47:18,  5.15s/it] 44%|████▍     | 430/980 [38:25<48:01,  5.24s/it]                                                  44%|████▍     | 430/980 [38:25<48:01,  5.24s/it] 44%|████▍     | 431/980 [38:30<46:52,  5.12s/it] 44%|████▍     | 432/980 [38:36<48:48,  5.34s/it] 44%|████▍     | 433/980 [38:41<49:07,  5.39s/it] 44%|████▍     | 434/980 [38:46<48:01,  5.28s/it] 44%|████▍     | 435/980 [38:51<45:49,  5.04s/it] 44%|████▍     | 436/980 [38:56<45:05,  4.97s/it] 45%|████▍     | 437/980 [39:00<44:05,  4.87s/it] 45%|████▍     | 438/980 [39:04<41:40,  4.61s/it] 45%|████▍     | 439/980 [39:09<41:40,  4.62s/it] 45%|████▍     | 440/980 [39:14<41:56,  4.66s/it]                                                  45%|████▍     | 440/980 [39:14<41:56,  4.66s/it] 45%|████▌     | 441/980 [39:20<44:47,  4.99s/it] 45%|████▌     | 442/980 [39:24<43:00,  4.80s/it] 45%|████▌     | 443/980 [39:29<43:22,  4.85s/it] 45%|████▌     | 444/980 [39:34<43:34,  4.88s/it] 45%|████▌     | 445/980 [39:40<45:32,  5.11s/it] 46%|████▌     | 446/980 [39:45<46:15,  5.20s/it] 46%|████▌     | 447/980 [39:50<46:43,  5.26s/it] 46%|████▌     | 448/980 [39:55<45:05,  5.09s/it] 46%|████▌     | 449/980 [40:02<48:50,  5.52s/it] 46%|████▌     | 450/980 [40:07<47:59,  5.43s/it]                                                  46%|████▌     | 450/980 [40:07<47:59,  5.43s/it] 46%|████▌     | 451/980 [40:12<48:19,  5.48s/it] 46%|████▌     | 452/980 [40:19<50:01,  5.68s/it] 46%|████▌     | 453/980 [40:23<47:21,  5.39s/it] 46%|████▋     | 454/980 [40:28<45:31,  5.19s/it] 46%|████▋     | 455/980 [40:32<43:12,  4.94s/it] 47%|████▋     | 456/980 [40:36<40:40,  4.66s/it] 47%|████▋     | 457/980 [40:42<42:51,  4.92s/it] 47%|████▋     | 458/980 [40:47<42:38,  4.90s/it] 47%|████▋     | 459/980 [40:51<42:02,  4.84s/it] 47%|████▋     | 460/980 [40:57<44:21,  5.12s/it]                                                  47%|████▋     | 460/980 [40:57<44:21,  5.12s/it] 47%|████▋     | 461/980 [41:02<43:23,  5.02s/it] 47%|████▋     | 462/980 [41:07<42:59,  4.98s/it] 47%|████▋     | 463/980 [41:12<42:08,  4.89s/it] 47%|████▋     | 464/980 [41:17<42:54,  4.99s/it] 47%|████▋     | 465/980 [41:22<43:46,  5.10s/it] 48%|████▊     | 466/980 [41:28<45:04,  5.26s/it] 48%|████▊     | 467/980 [41:34<46:24,  5.43s/it] 48%|████▊     | 468/980 [41:40<48:44,  5.71s/it] 48%|████▊     | 469/980 [41:46<49:17,  5.79s/it] 48%|████▊     | 470/980 [41:51<46:44,  5.50s/it]                                                  48%|████▊     | 470/980 [41:51<46:44,  5.50s/it] 48%|████▊     | 471/980 [41:55<44:40,  5.27s/it] 48%|████▊     | 472/980 [42:00<42:39,  5.04s/it] 48%|████▊     | 473/980 [42:04<39:11,  4.64s/it] 48%|████▊     | 474/980 [42:09<41:24,  4.91s/it] 48%|████▊     | 475/980 [42:14<39:54,  4.74s/it] 49%|████▊     | 476/980 [42:18<39:30,  4.70s/it] 49%|████▊     | 477/980 [42:24<41:18,  4.93s/it] 49%|████▉     | 478/980 [42:29<42:13,  5.05s/it] 49%|████▉     | 479/980 [42:34<42:58,  5.15s/it] 49%|████▉     | 480/980 [42:39<42:35,  5.11s/it]                                                  49%|████▉     | 480/980 [42:39<42:35,  5.11s/it] 49%|████▉     | 481/980 [42:45<44:20,  5.33s/it] 49%|████▉     | 482/980 [42:50<42:18,  5.10s/it] 49%|████▉     | 483/980 [42:56<43:56,  5.30s/it] 49%|████▉     | 484/980 [43:01<43:29,  5.26s/it] 49%|████▉     | 485/980 [43:06<43:46,  5.31s/it] 50%|████▉     | 486/980 [43:12<45:26,  5.52s/it] 50%|████▉     | 487/980 [43:17<42:45,  5.20s/it] 50%|████▉     | 488/980 [43:21<40:21,  4.92s/it] 50%|████▉     | 489/980 [43:26<40:08,  4.91s/it] 50%|█████     | 490/980 [43:30<39:39,  4.86s/it]                                                  50%|█████     | 490/980 [43:30<39:39,  4.86s/it] 50%|█████     | 491/980 [43:35<39:00,  4.79s/it] 50%|█████     | 492/980 [43:40<40:21,  4.96s/it] 50%|█████     | 493/980 [43:46<41:35,  5.12s/it] 50%|█████     | 494/980 [43:51<40:56,  5.06s/it] 51%|█████     | 495/980 [43:55<39:30,  4.89s/it] 51%|█████     | 496/980 [44:00<39:54,  4.95s/it] 51%|█████     | 497/980 [44:06<40:47,  5.07s/it] 51%|█████     | 498/980 [44:11<42:10,  5.25s/it] 51%|█████     | 499/980 [44:16<40:31,  5.06s/it] 51%|█████     | 500/980 [44:20<38:14,  4.78s/it]                                                  51%|█████     | 500/980 [44:20<38:14,  4.78s/it][INFO|trainer.py:4021] 2024-11-06 04:03:23,907 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:03:23,908 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:03:23,908 >>   Batch size = 4
{'eval_loss': 0.1539609283208847, 'eval_runtime': 32.3786, 'eval_samples_per_second': 21.619, 'eval_steps_per_second': 5.405, 'epoch': 2.03}
{'loss': 0.1141, 'grad_norm': 1.116982340812683, 'learning_rate': 3.1341364597737686e-05, 'epoch': 2.08}
{'loss': 0.1075, 'grad_norm': 0.9284565448760986, 'learning_rate': 3.056302334890786e-05, 'epoch': 2.13}
{'loss': 0.1166, 'grad_norm': 1.3953242301940918, 'learning_rate': 2.9778965717534313e-05, 'epoch': 2.18}
{'loss': 0.1036, 'grad_norm': 1.183762788772583, 'learning_rate': 2.8989997375834482e-05, 'epoch': 2.23}
{'loss': 0.1112, 'grad_norm': 1.7175638675689697, 'learning_rate': 2.8196929042112652e-05, 'epoch': 2.29}
{'loss': 0.122, 'grad_norm': 0.7461743354797363, 'learning_rate': 2.7400575647692046e-05, 'epoch': 2.34}
{'loss': 0.1174, 'grad_norm': 1.8951953649520874, 'learning_rate': 2.6601755499517826e-05, 'epoch': 2.39}
{'loss': 0.1009, 'grad_norm': 1.366808533668518, 'learning_rate': 2.5801289439291388e-05, 'epoch': 2.44}
{'loss': 0.0987, 'grad_norm': 1.497194528579712, 'learning_rate': 2.5e-05, 'epoch': 2.49}
{'loss': 0.1141, 'grad_norm': 1.554703712463379, 'learning_rate': 2.419871056070862e-05, 'epoch': 2.54}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.35it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.30it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.48it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.97it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.69it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.52it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.77it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.05it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.60it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.21it/s][A
 11%|█         | 19/175 [00:03<00:39,  3.99it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.76it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.39it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.03it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.11it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.57it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.00it/s][A
 15%|█▌        | 27/175 [00:04<00:25,  5.89it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.19it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.01it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.12it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.53it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.12it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.62it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.91it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.69it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.15it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.59it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.90it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.58it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.28it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.10it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.56it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.23it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.88it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.08it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.50it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.75it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:13<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.56it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.89it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.39it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.17it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.26it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.01it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.00it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.59it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.44it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.89it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.79it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.86it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.25it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.62it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.13it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.32it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.34it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.58it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.21it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.81it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.35it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.84it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.74it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.21it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.44it/s][A
 62%|██████▏   | 108/175 [00:20<00:12,  5.37it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.15it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.58it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.56it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.98it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.09it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.71it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.68it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.22it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.24it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.39it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.48it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.20it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:32<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 51%|█████     | 500/980 [44:53<38:14,  4.78s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:03:56,355 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-500
[INFO|configuration_utils.py:673] 2024-11-06 04:03:56,375 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:03:56,376 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:03:56,468 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:03:56,468 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-500/special_tokens_map.json
 51%|█████     | 501/980 [44:59<1:58:51, 14.89s/it] 51%|█████     | 502/980 [45:03<1:34:09, 11.82s/it] 51%|█████▏    | 503/980 [45:09<1:18:47,  9.91s/it] 51%|█████▏    | 504/980 [45:14<1:07:05,  8.46s/it] 52%|█████▏    | 505/980 [45:18<57:56,  7.32s/it]   52%|█████▏    | 506/980 [45:22<48:49,  6.18s/it] 52%|█████▏    | 507/980 [45:27<44:45,  5.68s/it] 52%|█████▏    | 508/980 [45:32<45:15,  5.75s/it] 52%|█████▏    | 509/980 [45:38<44:56,  5.72s/it] 52%|█████▏    | 510/980 [45:43<43:32,  5.56s/it]                                                  52%|█████▏    | 510/980 [45:43<43:32,  5.56s/it] 52%|█████▏    | 511/980 [45:48<40:53,  5.23s/it] 52%|█████▏    | 512/980 [45:53<40:16,  5.16s/it] 52%|█████▏    | 513/980 [45:58<39:24,  5.06s/it] 52%|█████▏    | 514/980 [46:04<42:11,  5.43s/it] 53%|█████▎    | 515/980 [46:09<42:21,  5.47s/it] 53%|█████▎    | 516/980 [46:14<39:06,  5.06s/it] 53%|█████▎    | 517/980 [46:19<39:54,  5.17s/it] 53%|█████▎    | 518/980 [46:25<41:19,  5.37s/it] 53%|█████▎    | 519/980 [46:31<42:18,  5.51s/it] 53%|█████▎    | 520/980 [46:34<38:26,  5.01s/it]                                                  53%|█████▎    | 520/980 [46:34<38:26,  5.01s/it] 53%|█████▎    | 521/980 [46:40<39:46,  5.20s/it] 53%|█████▎    | 522/980 [46:45<39:36,  5.19s/it] 53%|█████▎    | 523/980 [46:50<39:15,  5.16s/it] 53%|█████▎    | 524/980 [46:56<40:34,  5.34s/it] 54%|█████▎    | 525/980 [47:01<39:09,  5.16s/it] 54%|█████▎    | 526/980 [47:06<39:25,  5.21s/it] 54%|█████▍    | 527/980 [47:11<38:19,  5.08s/it] 54%|█████▍    | 528/980 [47:16<38:14,  5.08s/it] 54%|█████▍    | 529/980 [47:21<38:46,  5.16s/it] 54%|█████▍    | 530/980 [47:26<37:25,  4.99s/it]                                                  54%|█████▍    | 530/980 [47:26<37:25,  4.99s/it] 54%|█████▍    | 531/980 [47:32<38:39,  5.17s/it] 54%|█████▍    | 532/980 [47:37<38:53,  5.21s/it] 54%|█████▍    | 533/980 [47:42<37:50,  5.08s/it] 54%|█████▍    | 534/980 [47:46<37:03,  4.99s/it] 55%|█████▍    | 535/980 [47:51<36:32,  4.93s/it] 55%|█████▍    | 536/980 [47:57<37:16,  5.04s/it] 55%|█████▍    | 537/980 [48:02<37:33,  5.09s/it] 55%|█████▍    | 538/980 [48:06<34:51,  4.73s/it] 55%|█████▌    | 539/980 [48:10<34:43,  4.73s/it] 55%|█████▌    | 540/980 [48:15<35:17,  4.81s/it]                                                  55%|█████▌    | 540/980 [48:15<35:17,  4.81s/it] 55%|█████▌    | 541/980 [48:20<34:14,  4.68s/it] 55%|█████▌    | 542/980 [48:25<35:47,  4.90s/it] 55%|█████▌    | 543/980 [48:31<38:08,  5.24s/it] 56%|█████▌    | 544/980 [48:36<37:54,  5.22s/it] 56%|█████▌    | 545/980 [48:41<36:13,  5.00s/it] 56%|█████▌    | 546/980 [48:45<34:44,  4.80s/it] 56%|█████▌    | 547/980 [48:50<34:06,  4.73s/it] 56%|█████▌    | 548/980 [48:54<33:21,  4.63s/it] 56%|█████▌    | 549/980 [48:59<34:13,  4.76s/it] 56%|█████▌    | 550/980 [49:05<35:35,  4.97s/it]                                                  56%|█████▌    | 550/980 [49:05<35:35,  4.97s/it] 56%|█████▌    | 551/980 [49:09<34:07,  4.77s/it] 56%|█████▋    | 552/980 [49:14<35:40,  5.00s/it] 56%|█████▋    | 553/980 [49:20<36:46,  5.17s/it] 57%|█████▋    | 554/980 [49:25<35:38,  5.02s/it] 57%|█████▋    | 555/980 [49:29<34:36,  4.89s/it] 57%|█████▋    | 556/980 [49:34<34:14,  4.85s/it] 57%|█████▋    | 557/980 [49:39<34:25,  4.88s/it] 57%|█████▋    | 558/980 [49:44<33:47,  4.80s/it] 57%|█████▋    | 559/980 [49:49<33:54,  4.83s/it] 57%|█████▋    | 560/980 [49:53<33:09,  4.74s/it]                                                  57%|█████▋    | 560/980 [49:53<33:09,  4.74s/it] 57%|█████▋    | 561/980 [49:58<33:43,  4.83s/it] 57%|█████▋    | 562/980 [50:04<36:16,  5.21s/it] 57%|█████▋    | 563/980 [50:09<34:46,  5.00s/it] 58%|█████▊    | 564/980 [50:15<37:43,  5.44s/it] 58%|█████▊    | 565/980 [50:19<34:39,  5.01s/it] 58%|█████▊    | 566/980 [50:24<34:12,  4.96s/it] 58%|█████▊    | 567/980 [50:28<32:47,  4.76s/it] 58%|█████▊    | 568/980 [50:33<31:54,  4.65s/it] 58%|█████▊    | 569/980 [50:38<33:41,  4.92s/it] 58%|█████▊    | 570/980 [50:44<35:26,  5.19s/it]                                                  58%|█████▊    | 570/980 [50:44<35:26,  5.19s/it] 58%|█████▊    | 571/980 [50:49<34:29,  5.06s/it] 58%|█████▊    | 572/980 [50:54<33:40,  4.95s/it] 58%|█████▊    | 573/980 [50:58<33:05,  4.88s/it] 59%|█████▊    | 574/980 [51:03<32:46,  4.84s/it] 59%|█████▊    | 575/980 [51:08<33:08,  4.91s/it] 59%|█████▉    | 576/980 [51:13<33:09,  4.92s/it] 59%|█████▉    | 577/980 [51:18<33:47,  5.03s/it] 59%|█████▉    | 578/980 [51:23<33:41,  5.03s/it] 59%|█████▉    | 579/980 [51:28<33:06,  4.95s/it] 59%|█████▉    | 580/980 [51:33<32:49,  4.92s/it]                                                  59%|█████▉    | 580/980 [51:33<32:49,  4.92s/it] 59%|█████▉    | 581/980 [51:38<32:26,  4.88s/it] 59%|█████▉    | 582/980 [51:43<32:24,  4.89s/it] 59%|█████▉    | 583/980 [51:49<35:08,  5.31s/it] 60%|█████▉    | 584/980 [51:55<35:42,  5.41s/it] 60%|█████▉    | 585/980 [52:00<35:47,  5.44s/it] 60%|█████▉    | 586/980 [52:06<36:40,  5.58s/it] 60%|█████▉    | 587/980 [52:11<35:32,  5.43s/it] 60%|██████    | 588/980 [52:16<35:25,  5.42s/it] 60%|██████    | 589/980 [52:22<35:15,  5.41s/it] 60%|██████    | 590/980 [52:27<34:11,  5.26s/it]                                                  60%|██████    | 590/980 [52:27<34:11,  5.26s/it] 60%|██████    | 591/980 [52:31<31:32,  4.87s/it] 60%|██████    | 592/980 [52:36<32:32,  5.03s/it] 61%|██████    | 593/980 [52:42<34:55,  5.42s/it] 61%|██████    | 594/980 [52:48<34:17,  5.33s/it] 61%|██████    | 595/980 [52:52<33:22,  5.20s/it] 61%|██████    | 596/980 [52:57<31:20,  4.90s/it] 61%|██████    | 597/980 [53:02<31:26,  4.92s/it] 61%|██████    | 598/980 [53:06<30:42,  4.82s/it] 61%|██████    | 599/980 [53:11<30:08,  4.75s/it] 61%|██████    | 600/980 [53:15<29:16,  4.62s/it]                                                  61%|██████    | 600/980 [53:15<29:16,  4.62s/it][INFO|trainer.py:4021] 2024-11-06 04:12:18,847 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:12:18,847 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:12:18,847 >>   Batch size = 4
{'eval_loss': 0.1354784220457077, 'eval_runtime': 32.4469, 'eval_samples_per_second': 21.574, 'eval_steps_per_second': 5.393, 'epoch': 2.54}
{'loss': 0.115, 'grad_norm': 1.474134922027588, 'learning_rate': 2.339824450048218e-05, 'epoch': 2.59}
{'loss': 0.0971, 'grad_norm': 1.4485106468200684, 'learning_rate': 2.2599424352307957e-05, 'epoch': 2.64}
{'loss': 0.0948, 'grad_norm': 1.6140292882919312, 'learning_rate': 2.1803070957887347e-05, 'epoch': 2.69}
{'loss': 0.1005, 'grad_norm': 2.009873390197754, 'learning_rate': 2.1010002624165527e-05, 'epoch': 2.74}
{'loss': 0.1083, 'grad_norm': 1.2273447513580322, 'learning_rate': 2.02210342824657e-05, 'epoch': 2.79}
{'loss': 0.1107, 'grad_norm': 1.118269443511963, 'learning_rate': 1.9436976651092144e-05, 'epoch': 2.84}
{'loss': 0.0938, 'grad_norm': 1.193086862564087, 'learning_rate': 1.865863540226232e-05, 'epoch': 2.9}
{'loss': 0.0955, 'grad_norm': 1.107651948928833, 'learning_rate': 1.7886810334224192e-05, 'epoch': 2.95}
{'loss': 0.0896, 'grad_norm': 1.382055401802063, 'learning_rate': 1.7122294549409484e-05, 'epoch': 3.0}
{'loss': 0.0781, 'grad_norm': 1.8059526681900024, 'learning_rate': 1.6365873639467315e-05, 'epoch': 3.05}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.69it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.40it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.37it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:27,  6.01it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.12it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.53it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.40it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.94it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.07it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.63it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.24it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.02it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.40it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.04it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.64it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.96it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.71it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.11it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.17it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.61it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.92it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.25it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.59it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.28it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.35it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.78it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.50it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.45it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.60it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.30it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.93it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.27it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.64it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.23it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.84it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.47it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.49it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.10it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:11,  5.27it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.61it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.77it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.25it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.62it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.48it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.34it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.33it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.74it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.47it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.98it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.91it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.09it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.70it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.67it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.21it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.25it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.73it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.18it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.65it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.13it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.74it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.91it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 61%|██████    | 600/980 [53:47<29:16,  4.62s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:12:51,223 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-600
[INFO|configuration_utils.py:673] 2024-11-06 04:12:51,244 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:12:51,245 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:12:51,346 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:12:51,346 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-600/special_tokens_map.json
 61%|██████▏   | 601/980 [53:52<1:30:12, 14.28s/it] 61%|██████▏   | 602/980 [53:57<1:12:41, 11.54s/it] 62%|██████▏   | 603/980 [54:02<1:00:26,  9.62s/it] 62%|██████▏   | 604/980 [54:08<52:08,  8.32s/it]   62%|██████▏   | 605/980 [54:13<46:50,  7.49s/it] 62%|██████▏   | 606/980 [54:17<40:44,  6.54s/it] 62%|██████▏   | 607/980 [54:22<37:51,  6.09s/it] 62%|██████▏   | 608/980 [54:28<36:16,  5.85s/it] 62%|██████▏   | 609/980 [54:33<34:27,  5.57s/it] 62%|██████▏   | 610/980 [54:38<34:44,  5.63s/it]                                                  62%|██████▏   | 610/980 [54:38<34:44,  5.63s/it] 62%|██████▏   | 611/980 [54:44<34:28,  5.60s/it] 62%|██████▏   | 612/980 [54:50<34:26,  5.61s/it] 63%|██████▎   | 613/980 [54:54<32:18,  5.28s/it] 63%|██████▎   | 614/980 [54:58<29:38,  4.86s/it] 63%|██████▎   | 615/980 [55:02<28:55,  4.76s/it] 63%|██████▎   | 616/980 [55:07<29:03,  4.79s/it] 63%|██████▎   | 617/980 [55:13<29:45,  4.92s/it] 63%|██████▎   | 618/980 [55:17<28:39,  4.75s/it] 63%|██████▎   | 619/980 [55:22<29:07,  4.84s/it] 63%|██████▎   | 620/980 [55:26<27:53,  4.65s/it]                                                  63%|██████▎   | 620/980 [55:26<27:53,  4.65s/it] 63%|██████▎   | 621/980 [55:32<29:03,  4.86s/it] 63%|██████▎   | 622/980 [55:38<31:08,  5.22s/it] 64%|██████▎   | 623/980 [55:44<32:23,  5.44s/it] 64%|██████▎   | 624/980 [55:48<30:08,  5.08s/it] 64%|██████▍   | 625/980 [55:53<30:31,  5.16s/it] 64%|██████▍   | 626/980 [55:58<29:50,  5.06s/it] 64%|██████▍   | 627/980 [56:02<28:47,  4.89s/it] 64%|██████▍   | 628/980 [56:07<28:54,  4.93s/it] 64%|██████▍   | 629/980 [56:14<31:27,  5.38s/it] 64%|██████▍   | 630/980 [56:19<30:18,  5.20s/it]                                                  64%|██████▍   | 630/980 [56:19<30:18,  5.20s/it] 64%|██████▍   | 631/980 [56:24<29:41,  5.10s/it] 64%|██████▍   | 632/980 [56:29<30:04,  5.18s/it] 65%|██████▍   | 633/980 [56:33<28:40,  4.96s/it] 65%|██████▍   | 634/980 [56:38<28:48,  4.99s/it] 65%|██████▍   | 635/980 [56:44<29:32,  5.14s/it] 65%|██████▍   | 636/980 [56:49<28:36,  4.99s/it] 65%|██████▌   | 637/980 [56:54<29:44,  5.20s/it] 65%|██████▌   | 638/980 [56:58<27:53,  4.89s/it] 65%|██████▌   | 639/980 [57:03<27:37,  4.86s/it] 65%|██████▌   | 640/980 [57:08<27:39,  4.88s/it]                                                  65%|██████▌   | 640/980 [57:08<27:39,  4.88s/it] 65%|██████▌   | 641/980 [57:13<27:42,  4.90s/it] 66%|██████▌   | 642/980 [57:18<26:54,  4.78s/it] 66%|██████▌   | 643/980 [57:23<27:36,  4.92s/it] 66%|██████▌   | 644/980 [57:28<28:20,  5.06s/it] 66%|██████▌   | 645/980 [57:34<29:02,  5.20s/it] 66%|██████▌   | 646/980 [57:39<29:53,  5.37s/it] 66%|██████▌   | 647/980 [57:44<29:09,  5.25s/it] 66%|██████▌   | 648/980 [57:49<28:01,  5.07s/it] 66%|██████▌   | 649/980 [57:55<28:46,  5.21s/it] 66%|██████▋   | 650/980 [58:01<29:45,  5.41s/it]                                                  66%|██████▋   | 650/980 [58:01<29:45,  5.41s/it] 66%|██████▋   | 651/980 [58:06<29:02,  5.30s/it] 67%|██████▋   | 652/980 [58:10<28:18,  5.18s/it] 67%|██████▋   | 653/980 [58:16<28:10,  5.17s/it] 67%|██████▋   | 654/980 [58:21<28:02,  5.16s/it] 67%|██████▋   | 655/980 [58:26<27:30,  5.08s/it] 67%|██████▋   | 656/980 [58:31<28:32,  5.29s/it] 67%|██████▋   | 657/980 [58:37<28:15,  5.25s/it] 67%|██████▋   | 658/980 [58:41<27:38,  5.15s/it] 67%|██████▋   | 659/980 [58:46<27:08,  5.07s/it] 67%|██████▋   | 660/980 [58:52<27:07,  5.09s/it]                                                  67%|██████▋   | 660/980 [58:52<27:07,  5.09s/it] 67%|██████▋   | 661/980 [58:56<26:09,  4.92s/it] 68%|██████▊   | 662/980 [59:01<26:52,  5.07s/it] 68%|██████▊   | 663/980 [59:07<27:00,  5.11s/it] 68%|██████▊   | 664/980 [59:12<27:28,  5.22s/it] 68%|██████▊   | 665/980 [59:17<26:56,  5.13s/it] 68%|██████▊   | 666/980 [59:22<26:33,  5.08s/it] 68%|██████▊   | 667/980 [59:26<25:25,  4.87s/it] 68%|██████▊   | 668/980 [59:31<25:39,  4.93s/it] 68%|██████▊   | 669/980 [59:36<25:34,  4.93s/it] 68%|██████▊   | 670/980 [59:40<23:43,  4.59s/it]                                                  68%|██████▊   | 670/980 [59:40<23:43,  4.59s/it] 68%|██████▊   | 671/980 [59:45<23:20,  4.53s/it] 69%|██████▊   | 672/980 [59:48<22:14,  4.33s/it] 69%|██████▊   | 673/980 [59:54<24:26,  4.78s/it] 69%|██████▉   | 674/980 [59:59<24:37,  4.83s/it] 69%|██████▉   | 675/980 [1:00:04<24:16,  4.77s/it] 69%|██████▉   | 676/980 [1:00:08<23:37,  4.66s/it] 69%|██████▉   | 677/980 [1:00:13<23:11,  4.59s/it] 69%|██████▉   | 678/980 [1:00:17<22:37,  4.49s/it] 69%|██████▉   | 679/980 [1:00:22<23:27,  4.67s/it] 69%|██████▉   | 680/980 [1:00:26<22:28,  4.50s/it]                                                    69%|██████▉   | 680/980 [1:00:26<22:28,  4.50s/it] 69%|██████▉   | 681/980 [1:00:30<21:22,  4.29s/it] 70%|██████▉   | 682/980 [1:00:34<21:27,  4.32s/it] 70%|██████▉   | 683/980 [1:00:40<22:49,  4.61s/it] 70%|██████▉   | 684/980 [1:00:45<23:18,  4.73s/it] 70%|██████▉   | 685/980 [1:00:49<23:21,  4.75s/it] 70%|███████   | 686/980 [1:00:55<24:44,  5.05s/it] 70%|███████   | 687/980 [1:01:00<24:16,  4.97s/it] 70%|███████   | 688/980 [1:01:06<25:17,  5.20s/it] 70%|███████   | 689/980 [1:01:12<26:07,  5.39s/it] 70%|███████   | 690/980 [1:01:16<24:26,  5.06s/it]                                                    70%|███████   | 690/980 [1:01:16<24:26,  5.06s/it] 71%|███████   | 691/980 [1:01:20<23:40,  4.92s/it] 71%|███████   | 692/980 [1:01:25<23:44,  4.95s/it] 71%|███████   | 693/980 [1:01:30<22:26,  4.69s/it] 71%|███████   | 694/980 [1:01:35<23:55,  5.02s/it] 71%|███████   | 695/980 [1:01:41<25:09,  5.30s/it] 71%|███████   | 696/980 [1:01:46<24:27,  5.17s/it] 71%|███████   | 697/980 [1:01:50<22:49,  4.84s/it] 71%|███████   | 698/980 [1:01:55<22:21,  4.76s/it] 71%|███████▏  | 699/980 [1:02:00<22:28,  4.80s/it] 71%|███████▏  | 700/980 [1:02:05<23:00,  4.93s/it]                                                    71%|███████▏  | 700/980 [1:02:05<23:00,  4.93s/it][INFO|trainer.py:4021] 2024-11-06 04:21:08,626 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:21:08,626 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:21:08,626 >>   Batch size = 4
{'eval_loss': 0.12255304306745529, 'eval_runtime': 32.3759, 'eval_samples_per_second': 21.621, 'eval_steps_per_second': 5.405, 'epoch': 3.05}
{'loss': 0.0739, 'grad_norm': 1.3309026956558228, 'learning_rate': 1.561832487801565e-05, 'epoch': 3.1}
{'loss': 0.0788, 'grad_norm': 1.392250895500183, 'learning_rate': 1.4880416421940155e-05, 'epoch': 3.15}
{'loss': 0.0751, 'grad_norm': 1.2724119424819946, 'learning_rate': 1.4152906522061048e-05, 'epoch': 3.2}
{'loss': 0.0712, 'grad_norm': 1.1021978855133057, 'learning_rate': 1.3436542743979125e-05, 'epoch': 3.25}
{'loss': 0.0728, 'grad_norm': 1.2586781978607178, 'learning_rate': 1.2732061199901562e-05, 'epoch': 3.3}
{'loss': 0.066, 'grad_norm': 1.224714756011963, 'learning_rate': 1.2040185792236874e-05, 'epoch': 3.35}
{'loss': 0.0755, 'grad_norm': 1.3674218654632568, 'learning_rate': 1.1361627469736285e-05, 'epoch': 3.4}
{'loss': 0.097, 'grad_norm': 1.3282668590545654, 'learning_rate': 1.0697083496945765e-05, 'epoch': 3.45}
{'loss': 0.067, 'grad_norm': 1.1922457218170166, 'learning_rate': 1.0047236737719601e-05, 'epoch': 3.5}
{'loss': 0.0685, 'grad_norm': 1.6162793636322021, 'learning_rate': 9.412754953531663e-06, 'epoch': 3.56}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.69it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.41it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.32it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.50it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.53it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.72it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.94it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.60it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.21it/s][A
 11%|█         | 19/175 [00:03<00:39,  3.99it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.76it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.39it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.02it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.11it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.59it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.02it/s][A
 15%|█▌        | 27/175 [00:04<00:25,  5.90it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.21it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.02it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.12it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.52it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.12it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.62it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.91it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.16it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.15it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.93it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.01it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.68it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.09it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.14it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.58it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.68it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.89it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.22it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.56it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.32it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.32it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.57it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.75it/s][A
 30%|███       | 53/175 [00:09<00:25,  4.87it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.89it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.51it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.28it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.42it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.01it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.10it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.57it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.77it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:13<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:18,  5.55it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.87it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.38it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.18it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.44it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.27it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.32it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.84it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.03it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.23it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.84it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.25it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:20<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.32it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.69it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.32it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.72it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.45it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.60it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.41it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.75it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.86it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.05it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.67it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.18it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.05it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.16it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.85it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.62it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.10it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.72it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.39it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:32<00:00,  4.88it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 71%|███████▏  | 700/980 [1:02:37<23:00,  4.93s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:21:41,077 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-700
[INFO|configuration_utils.py:673] 2024-11-06 04:21:41,099 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:21:41,100 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:21:41,203 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:21:41,203 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-700/special_tokens_map.json
 72%|███████▏  | 701/980 [1:02:44<1:09:54, 15.04s/it] 72%|███████▏  | 702/980 [1:02:50<57:51, 12.49s/it]   72%|███████▏  | 703/980 [1:02:55<47:35, 10.31s/it] 72%|███████▏  | 704/980 [1:03:00<40:08,  8.73s/it] 72%|███████▏  | 705/980 [1:03:05<34:13,  7.47s/it] 72%|███████▏  | 706/980 [1:03:10<31:24,  6.88s/it] 72%|███████▏  | 707/980 [1:03:15<28:14,  6.21s/it] 72%|███████▏  | 708/980 [1:03:21<27:13,  6.00s/it] 72%|███████▏  | 709/980 [1:03:26<26:21,  5.83s/it] 72%|███████▏  | 710/980 [1:03:31<24:48,  5.51s/it]                                                    72%|███████▏  | 710/980 [1:03:31<24:48,  5.51s/it] 73%|███████▎  | 711/980 [1:03:36<24:16,  5.41s/it] 73%|███████▎  | 712/980 [1:03:41<23:55,  5.36s/it] 73%|███████▎  | 713/980 [1:03:46<23:08,  5.20s/it] 73%|███████▎  | 714/980 [1:03:52<23:53,  5.39s/it] 73%|███████▎  | 715/980 [1:03:57<23:57,  5.43s/it] 73%|███████▎  | 716/980 [1:04:02<22:58,  5.22s/it] 73%|███████▎  | 717/980 [1:04:07<22:58,  5.24s/it] 73%|███████▎  | 718/980 [1:04:12<22:42,  5.20s/it] 73%|███████▎  | 719/980 [1:04:16<21:05,  4.85s/it] 73%|███████▎  | 720/980 [1:04:22<21:28,  4.95s/it]                                                    73%|███████▎  | 720/980 [1:04:22<21:28,  4.95s/it] 74%|███████▎  | 721/980 [1:04:27<21:19,  4.94s/it] 74%|███████▎  | 722/980 [1:04:32<21:55,  5.10s/it] 74%|███████▍  | 723/980 [1:04:37<21:19,  4.98s/it] 74%|███████▍  | 724/980 [1:04:42<21:07,  4.95s/it] 74%|███████▍  | 725/980 [1:04:47<21:20,  5.02s/it] 74%|███████▍  | 726/980 [1:04:50<19:29,  4.61s/it] 74%|███████▍  | 727/980 [1:04:55<18:57,  4.50s/it] 74%|███████▍  | 728/980 [1:05:00<19:45,  4.70s/it] 74%|███████▍  | 729/980 [1:05:05<19:39,  4.70s/it] 74%|███████▍  | 730/980 [1:05:09<19:26,  4.67s/it]                                                    74%|███████▍  | 730/980 [1:05:09<19:26,  4.67s/it] 75%|███████▍  | 731/980 [1:05:15<20:23,  4.91s/it] 75%|███████▍  | 732/980 [1:05:21<21:39,  5.24s/it] 75%|███████▍  | 733/980 [1:05:26<21:16,  5.17s/it] 75%|███████▍  | 734/980 [1:05:31<22:00,  5.37s/it] 75%|███████▌  | 735/980 [1:05:38<23:02,  5.64s/it] 75%|███████▌  | 736/980 [1:05:42<21:22,  5.26s/it] 75%|███████▌  | 737/980 [1:05:47<20:56,  5.17s/it] 75%|███████▌  | 738/980 [1:05:52<20:10,  5.00s/it] 75%|███████▌  | 739/980 [1:05:56<19:32,  4.86s/it] 76%|███████▌  | 740/980 [1:06:01<19:20,  4.84s/it]                                                    76%|███████▌  | 740/980 [1:06:01<19:20,  4.84s/it] 76%|███████▌  | 741/980 [1:06:06<19:46,  4.96s/it] 76%|███████▌  | 742/980 [1:06:12<20:02,  5.05s/it] 76%|███████▌  | 743/980 [1:06:16<19:33,  4.95s/it] 76%|███████▌  | 744/980 [1:06:21<19:43,  5.02s/it] 76%|███████▌  | 745/980 [1:06:27<20:09,  5.15s/it] 76%|███████▌  | 746/980 [1:06:31<18:39,  4.79s/it] 76%|███████▌  | 747/980 [1:06:37<19:46,  5.09s/it] 76%|███████▋  | 748/980 [1:06:43<21:14,  5.49s/it] 76%|███████▋  | 749/980 [1:06:49<21:28,  5.58s/it] 77%|███████▋  | 750/980 [1:06:53<20:07,  5.25s/it]                                                    77%|███████▋  | 750/980 [1:06:53<20:07,  5.25s/it] 77%|███████▋  | 751/980 [1:06:58<19:35,  5.13s/it] 77%|███████▋  | 752/980 [1:07:03<19:44,  5.20s/it] 77%|███████▋  | 753/980 [1:07:08<19:25,  5.13s/it] 77%|███████▋  | 754/980 [1:07:14<19:13,  5.11s/it] 77%|███████▋  | 755/980 [1:07:18<18:36,  4.96s/it] 77%|███████▋  | 756/980 [1:07:24<19:49,  5.31s/it] 77%|███████▋  | 757/980 [1:07:29<19:15,  5.18s/it] 77%|███████▋  | 758/980 [1:07:35<20:20,  5.50s/it] 77%|███████▋  | 759/980 [1:07:40<19:42,  5.35s/it] 78%|███████▊  | 760/980 [1:07:44<18:13,  4.97s/it]                                                    78%|███████▊  | 760/980 [1:07:44<18:13,  4.97s/it] 78%|███████▊  | 761/980 [1:07:49<17:50,  4.89s/it] 78%|███████▊  | 762/980 [1:07:54<17:48,  4.90s/it] 78%|███████▊  | 763/980 [1:08:00<18:41,  5.17s/it] 78%|███████▊  | 764/980 [1:08:05<18:53,  5.25s/it] 78%|███████▊  | 765/980 [1:08:11<18:46,  5.24s/it] 78%|███████▊  | 766/980 [1:08:16<18:54,  5.30s/it] 78%|███████▊  | 767/980 [1:08:22<19:13,  5.42s/it] 78%|███████▊  | 768/980 [1:08:28<19:50,  5.62s/it] 78%|███████▊  | 769/980 [1:08:34<19:53,  5.65s/it] 79%|███████▊  | 770/980 [1:08:38<18:46,  5.36s/it]                                                    79%|███████▊  | 770/980 [1:08:38<18:46,  5.36s/it] 79%|███████▊  | 771/980 [1:08:43<17:47,  5.11s/it] 79%|███████▉  | 772/980 [1:08:47<16:27,  4.75s/it] 79%|███████▉  | 773/980 [1:08:53<17:47,  5.16s/it] 79%|███████▉  | 774/980 [1:08:57<16:35,  4.83s/it] 79%|███████▉  | 775/980 [1:09:02<17:01,  4.98s/it] 79%|███████▉  | 776/980 [1:09:07<17:06,  5.03s/it] 79%|███████▉  | 777/980 [1:09:13<17:22,  5.14s/it] 79%|███████▉  | 778/980 [1:09:18<17:21,  5.16s/it] 79%|███████▉  | 779/980 [1:09:23<16:53,  5.04s/it] 80%|███████▉  | 780/980 [1:09:28<16:49,  5.05s/it]                                                    80%|███████▉  | 780/980 [1:09:28<16:49,  5.05s/it] 80%|███████▉  | 781/980 [1:09:33<16:45,  5.05s/it] 80%|███████▉  | 782/980 [1:09:38<16:37,  5.04s/it] 80%|███████▉  | 783/980 [1:09:43<17:09,  5.23s/it] 80%|████████  | 784/980 [1:09:48<16:09,  4.95s/it] 80%|████████  | 785/980 [1:09:53<16:44,  5.15s/it] 80%|████████  | 786/980 [1:09:59<17:20,  5.36s/it] 80%|████████  | 787/980 [1:10:04<17:05,  5.31s/it] 80%|████████  | 788/980 [1:10:08<15:48,  4.94s/it] 81%|████████  | 789/980 [1:10:13<15:28,  4.86s/it] 81%|████████  | 790/980 [1:10:19<15:50,  5.00s/it]                                                    81%|████████  | 790/980 [1:10:19<15:50,  5.00s/it] 81%|████████  | 791/980 [1:10:25<16:56,  5.38s/it] 81%|████████  | 792/980 [1:10:30<16:32,  5.28s/it] 81%|████████  | 793/980 [1:10:34<15:37,  5.01s/it] 81%|████████  | 794/980 [1:10:39<15:26,  4.98s/it] 81%|████████  | 795/980 [1:10:44<14:52,  4.83s/it] 81%|████████  | 796/980 [1:10:48<14:40,  4.79s/it] 81%|████████▏ | 797/980 [1:10:54<15:06,  4.95s/it] 81%|████████▏ | 798/980 [1:10:59<15:27,  5.10s/it] 82%|████████▏ | 799/980 [1:11:05<15:43,  5.21s/it] 82%|████████▏ | 800/980 [1:11:10<15:44,  5.25s/it]                                                    82%|████████▏ | 800/980 [1:11:10<15:44,  5.25s/it][INFO|trainer.py:4021] 2024-11-06 04:30:13,574 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:30:13,574 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:30:13,574 >>   Batch size = 4
{'eval_loss': 0.11896002292633057, 'eval_runtime': 32.4506, 'eval_samples_per_second': 21.571, 'eval_steps_per_second': 5.393, 'epoch': 3.56}
{'loss': 0.0715, 'grad_norm': 1.1861917972564697, 'learning_rate': 8.794290117305296e-06, 'epoch': 3.61}
{'loss': 0.0731, 'grad_norm': 0.9698352217674255, 'learning_rate': 8.192477743467078e-06, 'epoch': 3.66}
{'loss': 0.0688, 'grad_norm': 1.508344054222107, 'learning_rate': 7.607936234912841e-06, 'epoch': 3.71}
{'loss': 0.0865, 'grad_norm': 1.4600569009780884, 'learning_rate': 7.041266247556813e-06, 'epoch': 3.76}
{'loss': 0.0748, 'grad_norm': 1.7102383375167847, 'learning_rate': 6.493050073117116e-06, 'epoch': 3.81}
{'loss': 0.0747, 'grad_norm': 1.257096529006958, 'learning_rate': 5.9638510407716394e-06, 'epoch': 3.86}
{'loss': 0.0731, 'grad_norm': 1.2964640855789185, 'learning_rate': 5.454212938299255e-06, 'epoch': 3.91}
{'loss': 0.0742, 'grad_norm': 1.0951746702194214, 'learning_rate': 4.9646594533010875e-06, 'epoch': 3.96}
{'loss': 0.0604, 'grad_norm': 1.1442248821258545, 'learning_rate': 4.495693635076101e-06, 'epoch': 4.01}
{'loss': 0.0578, 'grad_norm': 1.1108237504959106, 'learning_rate': 4.047797377703985e-06, 'epoch': 4.06}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.70it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.41it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.30it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.11it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.54it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.40it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.73it/s][A
  7%|▋         | 12/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.94it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.07it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.63it/s][A
 10%|█         | 18/175 [00:03<00:36,  4.24it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.02it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.82it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.45it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.08it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.15it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.63it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.06it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.24it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.03it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.13it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.98it/s][A
 22%|██▏       | 39/175 [00:07<00:26,  5.04it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.74it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.15it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.20it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.63it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.92it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.35it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.34it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:25,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.30it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.50it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.03it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.30it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.93it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.78it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.90it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.59it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.04it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.82it/s][A
 50%|████▉     | 87/175 [00:15<00:17,  4.90it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.28it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.64it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.16it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.32it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.34it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.37it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.89it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.07it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s][A
 58%|█████▊    | 102/175 [00:18<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.61it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.23it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.27it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.66it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.48it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.41it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.18it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.61it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.60it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.58it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.30it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.79it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.25it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.62it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.35it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.52it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.45it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:25<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.93it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.78it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.98it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.89it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.69it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.67it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.21it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.25it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.19it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.08it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.18it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.13it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                   
                                                 [A 82%|████████▏ | 800/980 [1:11:42<15:44,  5.25s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:30:45,934 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-800
[INFO|configuration_utils.py:673] 2024-11-06 04:30:45,954 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:30:45,955 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:30:46,052 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:30:46,053 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-800/special_tokens_map.json
 82%|████████▏ | 801/980 [1:11:48<44:50, 15.03s/it] 82%|████████▏ | 802/980 [1:11:53<35:59, 12.13s/it] 82%|████████▏ | 803/980 [1:11:59<30:09, 10.22s/it] 82%|████████▏ | 804/980 [1:12:03<24:54,  8.49s/it] 82%|████████▏ | 805/980 [1:12:08<21:30,  7.38s/it] 82%|████████▏ | 806/980 [1:12:14<19:59,  6.90s/it] 82%|████████▏ | 807/980 [1:12:18<17:22,  6.03s/it] 82%|████████▏ | 808/980 [1:12:23<16:29,  5.75s/it] 83%|████████▎ | 809/980 [1:12:29<16:17,  5.72s/it] 83%|████████▎ | 810/980 [1:12:33<14:55,  5.27s/it]                                                    83%|████████▎ | 810/980 [1:12:33<14:55,  5.27s/it] 83%|████████▎ | 811/980 [1:12:38<14:29,  5.14s/it] 83%|████████▎ | 812/980 [1:12:43<14:48,  5.29s/it] 83%|████████▎ | 813/980 [1:12:47<13:24,  4.82s/it] 83%|████████▎ | 814/980 [1:12:53<14:03,  5.08s/it] 83%|████████▎ | 815/980 [1:12:57<13:02,  4.74s/it] 83%|████████▎ | 816/980 [1:13:03<14:00,  5.13s/it] 83%|████████▎ | 817/980 [1:13:07<13:32,  4.99s/it] 83%|████████▎ | 818/980 [1:13:13<13:49,  5.12s/it] 84%|████████▎ | 819/980 [1:13:19<14:34,  5.43s/it] 84%|████████▎ | 820/980 [1:13:23<13:42,  5.14s/it]                                                    84%|████████▎ | 820/980 [1:13:23<13:42,  5.14s/it] 84%|████████▍ | 821/980 [1:13:28<12:54,  4.87s/it] 84%|████████▍ | 822/980 [1:13:32<12:28,  4.73s/it] 84%|████████▍ | 823/980 [1:13:37<12:37,  4.82s/it] 84%|████████▍ | 824/980 [1:13:43<13:14,  5.09s/it] 84%|████████▍ | 825/980 [1:13:47<12:46,  4.95s/it] 84%|████████▍ | 826/980 [1:13:52<12:23,  4.83s/it] 84%|████████▍ | 827/980 [1:13:56<12:05,  4.74s/it] 84%|████████▍ | 828/980 [1:14:02<12:48,  5.06s/it] 85%|████████▍ | 829/980 [1:14:07<12:30,  4.97s/it] 85%|████████▍ | 830/980 [1:14:12<12:34,  5.03s/it]                                                    85%|████████▍ | 830/980 [1:14:12<12:34,  5.03s/it] 85%|████████▍ | 831/980 [1:14:17<12:23,  4.99s/it] 85%|████████▍ | 832/980 [1:14:22<12:20,  5.00s/it] 85%|████████▌ | 833/980 [1:14:29<13:33,  5.54s/it] 85%|████████▌ | 834/980 [1:14:34<13:30,  5.55s/it] 85%|████████▌ | 835/980 [1:14:40<13:24,  5.55s/it] 85%|████████▌ | 836/980 [1:14:44<12:29,  5.20s/it] 85%|████████▌ | 837/980 [1:14:50<12:22,  5.19s/it] 86%|████████▌ | 838/980 [1:14:55<12:25,  5.25s/it] 86%|████████▌ | 839/980 [1:14:59<11:12,  4.77s/it] 86%|████████▌ | 840/980 [1:15:05<12:13,  5.24s/it]                                                    86%|████████▌ | 840/980 [1:15:05<12:13,  5.24s/it] 86%|████████▌ | 841/980 [1:15:10<12:07,  5.23s/it] 86%|████████▌ | 842/980 [1:15:14<11:17,  4.91s/it] 86%|████████▌ | 843/980 [1:15:19<10:58,  4.81s/it] 86%|████████▌ | 844/980 [1:15:23<10:23,  4.58s/it] 86%|████████▌ | 845/980 [1:15:27<09:57,  4.43s/it] 86%|████████▋ | 846/980 [1:15:33<10:53,  4.88s/it] 86%|████████▋ | 847/980 [1:15:38<10:41,  4.82s/it] 87%|████████▋ | 848/980 [1:15:42<10:35,  4.81s/it] 87%|████████▋ | 849/980 [1:15:48<11:14,  5.15s/it] 87%|████████▋ | 850/980 [1:15:53<10:59,  5.07s/it]                                                    87%|████████▋ | 850/980 [1:15:53<10:59,  5.07s/it] 87%|████████▋ | 851/980 [1:15:58<10:42,  4.98s/it] 87%|████████▋ | 852/980 [1:16:03<10:39,  5.00s/it] 87%|████████▋ | 853/980 [1:16:08<10:47,  5.10s/it] 87%|████████▋ | 854/980 [1:16:15<11:32,  5.50s/it] 87%|████████▋ | 855/980 [1:16:20<11:01,  5.29s/it] 87%|████████▋ | 856/980 [1:16:24<10:30,  5.08s/it] 87%|████████▋ | 857/980 [1:16:29<10:20,  5.05s/it] 88%|████████▊ | 858/980 [1:16:34<10:09,  5.00s/it] 88%|████████▊ | 859/980 [1:16:40<10:32,  5.23s/it] 88%|████████▊ | 860/980 [1:16:45<10:27,  5.23s/it]                                                    88%|████████▊ | 860/980 [1:16:45<10:27,  5.23s/it] 88%|████████▊ | 861/980 [1:16:50<10:12,  5.15s/it] 88%|████████▊ | 862/980 [1:16:55<10:05,  5.13s/it] 88%|████████▊ | 863/980 [1:17:00<09:51,  5.05s/it] 88%|████████▊ | 864/980 [1:17:05<09:27,  4.89s/it] 88%|████████▊ | 865/980 [1:17:10<09:35,  5.00s/it] 88%|████████▊ | 866/980 [1:17:14<09:07,  4.80s/it] 88%|████████▊ | 867/980 [1:17:19<09:19,  4.95s/it] 89%|████████▊ | 868/980 [1:17:25<09:32,  5.11s/it] 89%|████████▊ | 869/980 [1:17:30<09:35,  5.19s/it] 89%|████████▉ | 870/980 [1:17:36<09:36,  5.24s/it]                                                    89%|████████▉ | 870/980 [1:17:36<09:36,  5.24s/it] 89%|████████▉ | 871/980 [1:17:42<10:06,  5.56s/it] 89%|████████▉ | 872/980 [1:17:47<09:57,  5.53s/it] 89%|████████▉ | 873/980 [1:17:53<09:56,  5.57s/it] 89%|████████▉ | 874/980 [1:17:59<09:47,  5.54s/it] 89%|████████▉ | 875/980 [1:18:04<09:44,  5.56s/it] 89%|████████▉ | 876/980 [1:18:10<09:46,  5.64s/it] 89%|████████▉ | 877/980 [1:18:15<09:23,  5.47s/it] 90%|████████▉ | 878/980 [1:18:19<08:36,  5.07s/it] 90%|████████▉ | 879/980 [1:18:24<08:12,  4.88s/it] 90%|████████▉ | 880/980 [1:18:28<08:07,  4.87s/it]                                                    90%|████████▉ | 880/980 [1:18:28<08:07,  4.87s/it] 90%|████████▉ | 881/980 [1:18:32<07:33,  4.58s/it] 90%|█████████ | 882/980 [1:18:38<08:04,  4.94s/it] 90%|█████████ | 883/980 [1:18:43<08:07,  5.03s/it] 90%|█████████ | 884/980 [1:18:47<07:24,  4.63s/it] 90%|█████████ | 885/980 [1:18:53<07:48,  4.93s/it] 90%|█████████ | 886/980 [1:18:58<07:48,  4.98s/it] 91%|█████████ | 887/980 [1:19:02<07:14,  4.68s/it] 91%|█████████ | 888/980 [1:19:07<07:11,  4.69s/it] 91%|█████████ | 889/980 [1:19:12<07:24,  4.88s/it] 91%|█████████ | 890/980 [1:19:17<07:20,  4.90s/it]                                                    91%|█████████ | 890/980 [1:19:17<07:20,  4.90s/it] 91%|█████████ | 891/980 [1:19:20<06:33,  4.42s/it] 91%|█████████ | 892/980 [1:19:25<06:49,  4.65s/it] 91%|█████████ | 893/980 [1:19:30<06:33,  4.52s/it] 91%|█████████ | 894/980 [1:19:35<06:41,  4.67s/it] 91%|█████████▏| 895/980 [1:19:39<06:26,  4.54s/it] 91%|█████████▏| 896/980 [1:19:43<06:11,  4.42s/it] 92%|█████████▏| 897/980 [1:19:48<06:29,  4.69s/it] 92%|█████████▏| 898/980 [1:19:53<06:33,  4.79s/it] 92%|█████████▏| 899/980 [1:19:57<06:10,  4.57s/it] 92%|█████████▏| 900/980 [1:20:01<05:55,  4.45s/it]                                                    92%|█████████▏| 900/980 [1:20:01<05:55,  4.45s/it][INFO|trainer.py:4021] 2024-11-06 04:39:05,199 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:39:05,199 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:39:05,199 >>   Batch size = 4
{'eval_loss': 0.11411857604980469, 'eval_runtime': 32.3589, 'eval_samples_per_second': 21.632, 'eval_steps_per_second': 5.408, 'epoch': 4.06}
{'loss': 0.0616, 'grad_norm': 1.0388226509094238, 'learning_rate': 3.621430924866348e-06, 'epoch': 4.11}
{'loss': 0.0635, 'grad_norm': 1.4549471139907837, 'learning_rate': 3.217032396915265e-06, 'epoch': 4.17}
{'loss': 0.0627, 'grad_norm': 1.3842037916183472, 'learning_rate': 2.8350173406749973e-06, 'epoch': 4.22}
{'loss': 0.051, 'grad_norm': 1.003929615020752, 'learning_rate': 2.475778302439524e-06, 'epoch': 4.27}
{'loss': 0.0609, 'grad_norm': 1.520695447921753, 'learning_rate': 2.1396844246046903e-06, 'epoch': 4.32}
{'loss': 0.0644, 'grad_norm': 1.436915397644043, 'learning_rate': 1.827081066349459e-06, 'epoch': 4.37}
{'loss': 0.0626, 'grad_norm': 1.2344963550567627, 'learning_rate': 1.538289448755989e-06, 'epoch': 4.42}
{'loss': 0.0634, 'grad_norm': 1.3133584260940552, 'learning_rate': 1.273606324733284e-06, 'epoch': 4.47}
{'loss': 0.069, 'grad_norm': 2.064101457595825, 'learning_rate': 1.0333036740834856e-06, 'epoch': 4.52}
{'loss': 0.0653, 'grad_norm': 1.2250133752822876, 'learning_rate': 8.176284240242638e-07, 'epoch': 4.57}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.69it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.43it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.35it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.37it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:27,  6.00it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.53it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.40it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.73it/s][A
  7%|▋         | 12/175 [00:01<00:28,  5.73it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.95it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.07it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.62it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.42it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.63it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.07it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.16it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.55it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.64it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.96it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.71it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.12it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.61it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.71it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.92it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.25it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.60it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.29it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.35it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.34it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.78it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.49it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.79it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.14it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.60it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.31it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.94it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.14it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.55it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.77it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.88it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.56it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.89it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.39it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.59it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.41it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.88it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.79it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.86it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.24it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.61it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.11it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.52it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.26it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.28it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.31it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.82it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.03it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.57it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.20it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.80it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.35it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.84it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.74it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.20it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.07it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.01it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.61it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.77it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.34it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.25it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.74it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.35it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.52it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.33it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.75it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.48it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.52it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.63it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.76it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.64it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.94it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.78it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.09it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.69it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.67it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.21it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.25it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.22it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.18it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.74it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.91it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                   
                                                 [A 92%|█████████▏| 900/980 [1:20:34<05:55,  4.45s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:39:37,594 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-900
[INFO|configuration_utils.py:673] 2024-11-06 04:39:37,614 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:39:37,615 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:39:37,714 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:39:37,714 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-900/special_tokens_map.json
 92%|█████████▏| 901/980 [1:20:41<19:31, 14.82s/it] 92%|█████████▏| 902/980 [1:20:45<15:13, 11.71s/it] 92%|█████████▏| 903/980 [1:20:50<12:23,  9.66s/it] 92%|█████████▏| 904/980 [1:20:55<10:28,  8.27s/it] 92%|█████████▏| 905/980 [1:21:00<09:17,  7.43s/it] 92%|█████████▏| 906/980 [1:21:06<08:38,  7.01s/it] 93%|█████████▎| 907/980 [1:21:10<07:24,  6.09s/it] 93%|█████████▎| 908/980 [1:21:15<06:54,  5.76s/it] 93%|█████████▎| 909/980 [1:21:20<06:35,  5.57s/it] 93%|█████████▎| 910/980 [1:21:26<06:21,  5.46s/it]                                                    93%|█████████▎| 910/980 [1:21:26<06:21,  5.46s/it] 93%|█████████▎| 911/980 [1:21:31<06:11,  5.38s/it] 93%|█████████▎| 912/980 [1:21:37<06:15,  5.53s/it] 93%|█████████▎| 913/980 [1:21:42<06:01,  5.39s/it] 93%|█████████▎| 914/980 [1:21:47<05:58,  5.43s/it] 93%|█████████▎| 915/980 [1:21:53<05:55,  5.47s/it] 93%|█████████▎| 916/980 [1:21:58<05:51,  5.50s/it] 94%|█████████▎| 917/980 [1:22:03<05:25,  5.17s/it] 94%|█████████▎| 918/980 [1:22:08<05:25,  5.24s/it] 94%|█████████▍| 919/980 [1:22:12<05:00,  4.93s/it] 94%|█████████▍| 920/980 [1:22:18<05:01,  5.02s/it]                                                    94%|█████████▍| 920/980 [1:22:18<05:01,  5.02s/it] 94%|█████████▍| 921/980 [1:22:23<05:08,  5.23s/it] 94%|█████████▍| 922/980 [1:22:29<05:04,  5.25s/it] 94%|█████████▍| 923/980 [1:22:35<05:15,  5.54s/it] 94%|█████████▍| 924/980 [1:22:41<05:18,  5.68s/it] 94%|█████████▍| 925/980 [1:22:45<04:52,  5.32s/it] 94%|█████████▍| 926/980 [1:22:51<04:52,  5.41s/it] 95%|█████████▍| 927/980 [1:22:56<04:39,  5.27s/it] 95%|█████████▍| 928/980 [1:23:01<04:27,  5.15s/it] 95%|█████████▍| 929/980 [1:23:05<04:08,  4.87s/it] 95%|█████████▍| 930/980 [1:23:10<04:05,  4.92s/it]                                                    95%|█████████▍| 930/980 [1:23:10<04:05,  4.92s/it] 95%|█████████▌| 931/980 [1:23:15<04:01,  4.93s/it] 95%|█████████▌| 932/980 [1:23:21<04:09,  5.19s/it] 95%|█████████▌| 933/980 [1:23:26<04:02,  5.16s/it] 95%|█████████▌| 934/980 [1:23:31<03:58,  5.18s/it] 95%|█████████▌| 935/980 [1:23:36<03:44,  4.98s/it] 96%|█████████▌| 936/980 [1:23:40<03:37,  4.95s/it] 96%|█████████▌| 937/980 [1:23:46<03:34,  4.98s/it] 96%|█████████▌| 938/980 [1:23:50<03:17,  4.69s/it] 96%|█████████▌| 939/980 [1:23:55<03:17,  4.83s/it] 96%|█████████▌| 940/980 [1:24:01<03:27,  5.19s/it]                                                    96%|█████████▌| 940/980 [1:24:01<03:27,  5.19s/it] 96%|█████████▌| 941/980 [1:24:06<03:24,  5.25s/it] 96%|█████████▌| 942/980 [1:24:10<03:05,  4.87s/it] 96%|█████████▌| 943/980 [1:24:14<02:52,  4.66s/it] 96%|█████████▋| 944/980 [1:24:21<03:04,  5.13s/it] 96%|█████████▋| 945/980 [1:24:25<02:57,  5.06s/it] 97%|█████████▋| 946/980 [1:24:30<02:50,  5.03s/it] 97%|█████████▋| 947/980 [1:24:36<02:54,  5.29s/it] 97%|█████████▋| 948/980 [1:24:40<02:35,  4.87s/it] 97%|█████████▋| 949/980 [1:24:46<02:40,  5.18s/it] 97%|█████████▋| 950/980 [1:24:51<02:35,  5.17s/it]                                                    97%|█████████▋| 950/980 [1:24:51<02:35,  5.17s/it] 97%|█████████▋| 951/980 [1:24:56<02:24,  4.99s/it] 97%|█████████▋| 952/980 [1:25:01<02:21,  5.05s/it] 97%|█████████▋| 953/980 [1:25:07<02:21,  5.24s/it] 97%|█████████▋| 954/980 [1:25:11<02:10,  5.03s/it] 97%|█████████▋| 955/980 [1:25:16<02:04,  4.99s/it] 98%|█████████▊| 956/980 [1:25:21<01:58,  4.92s/it] 98%|█████████▊| 957/980 [1:25:26<01:53,  4.95s/it] 98%|█████████▊| 958/980 [1:25:30<01:46,  4.84s/it] 98%|█████████▊| 959/980 [1:25:36<01:44,  4.99s/it] 98%|█████████▊| 960/980 [1:25:40<01:35,  4.76s/it]                                                    98%|█████████▊| 960/980 [1:25:40<01:35,  4.76s/it] 98%|█████████▊| 961/980 [1:25:44<01:28,  4.67s/it] 98%|█████████▊| 962/980 [1:25:50<01:28,  4.90s/it] 98%|█████████▊| 963/980 [1:25:55<01:23,  4.90s/it] 98%|█████████▊| 964/980 [1:26:00<01:21,  5.11s/it] 98%|█████████▊| 965/980 [1:26:06<01:18,  5.24s/it] 99%|█████████▊| 966/980 [1:26:11<01:11,  5.08s/it] 99%|█████████▊| 967/980 [1:26:15<01:04,  4.99s/it] 99%|█████████▉| 968/980 [1:26:21<01:00,  5.06s/it] 99%|█████████▉| 969/980 [1:26:26<00:57,  5.24s/it] 99%|█████████▉| 970/980 [1:26:32<00:52,  5.27s/it]                                                    99%|█████████▉| 970/980 [1:26:32<00:52,  5.27s/it] 99%|█████████▉| 971/980 [1:26:37<00:46,  5.19s/it] 99%|█████████▉| 972/980 [1:26:42<00:42,  5.28s/it] 99%|█████████▉| 973/980 [1:26:47<00:35,  5.06s/it] 99%|█████████▉| 974/980 [1:26:51<00:28,  4.82s/it] 99%|█████████▉| 975/980 [1:26:56<00:24,  4.90s/it]100%|█████████▉| 976/980 [1:27:01<00:20,  5.04s/it]100%|█████████▉| 977/980 [1:27:06<00:15,  5.02s/it]100%|█████████▉| 978/980 [1:27:10<00:09,  4.59s/it]100%|█████████▉| 979/980 [1:27:14<00:04,  4.39s/it]100%|██████████| 980/980 [1:27:19<00:00,  4.56s/it]                                                   100%|██████████| 980/980 [1:27:19<00:00,  4.56s/it][INFO|trainer.py:3705] 2024-11-06 04:46:22,605 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-980
[INFO|configuration_utils.py:673] 2024-11-06 04:46:22,624 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:46:22,625 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:46:22,725 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-980/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:46:22,725 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/checkpoint-980/special_tokens_map.json
[INFO|trainer.py:2505] 2024-11-06 04:46:23,072 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 980/980 [1:27:19<00:00,  4.56s/it]100%|██████████| 980/980 [1:27:19<00:00,  5.35s/it]
[INFO|trainer.py:3705] 2024-11-06 04:46:23,073 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5
[INFO|configuration_utils.py:673] 2024-11-06 04:46:23,092 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:46:23,093 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:46:23,189 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:46:23,189 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/special_tokens_map.json
{'eval_loss': 0.11367201805114746, 'eval_runtime': 32.394, 'eval_samples_per_second': 21.609, 'eval_steps_per_second': 5.402, 'epoch': 4.57}
{'loss': 0.0608, 'grad_norm': 1.0265666246414185, 'learning_rate': 6.268021954544096e-07, 'epoch': 4.62}
{'loss': 0.0596, 'grad_norm': 1.095409870147705, 'learning_rate': 4.6102107522336403e-07, 'epoch': 4.67}
{'loss': 0.0599, 'grad_norm': 1.1958204507827759, 'learning_rate': 3.204554146387456e-07, 'epoch': 4.72}
{'loss': 0.0563, 'grad_norm': 1.0554577112197876, 'learning_rate': 2.052496544188487e-07, 'epoch': 4.77}
{'loss': 0.0592, 'grad_norm': 0.8988165855407715, 'learning_rate': 1.1552217627004425e-07, 'epoch': 4.83}
{'loss': 0.0532, 'grad_norm': 1.143957495689392, 'learning_rate': 5.136518124159162e-08, 'epoch': 4.88}
{'loss': 0.0533, 'grad_norm': 1.1859527826309204, 'learning_rate': 1.284459498280266e-08, 'epoch': 4.93}
{'loss': 0.0578, 'grad_norm': 1.1362866163253784, 'learning_rate': 0.0, 'epoch': 4.98}
{'train_runtime': 5239.8438, 'train_samples_per_second': 6.012, 'train_steps_per_second': 0.187, 'train_loss': 0.15122171987076194, 'epoch': 4.98}
***** train metrics *****
  epoch                    =      4.9778
  total_flos               = 329517778GF
  train_loss               =      0.1512
  train_runtime            =  1:27:19.84
  train_samples_per_second =       6.012
  train_steps_per_second   =       0.187
Figure saved at: ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/training_loss.png
Figure saved at: ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_5/training_eval_loss.png
11/06/2024 04:46:23 - WARNING - llamafactory.extras.ploting - No metric eval_accuracy to plot.
[INFO|trainer.py:4021] 2024-11-06 04:46:23,580 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:46:23,580 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:46:23,580 >>   Batch size = 4
  0%|          | 0/175 [00:00<?, ?it/s]  1%|          | 2/175 [00:00<00:22,  7.70it/s]  2%|▏         | 3/175 [00:00<00:23,  7.41it/s]  2%|▏         | 4/175 [00:00<00:23,  7.34it/s]  3%|▎         | 5/175 [00:00<00:31,  5.36it/s]  3%|▎         | 6/175 [00:00<00:30,  5.50it/s]  4%|▍         | 7/175 [00:01<00:27,  6.00it/s]  5%|▍         | 8/175 [00:01<00:27,  6.10it/s]  5%|▌         | 9/175 [00:01<00:25,  6.53it/s]  6%|▌         | 10/175 [00:01<00:30,  5.40it/s]  6%|▋         | 11/175 [00:01<00:28,  5.72it/s]  7%|▋         | 12/175 [00:01<00:28,  5.72it/s]  7%|▋         | 13/175 [00:02<00:29,  5.56it/s]  8%|▊         | 14/175 [00:02<00:27,  5.79it/s]  9%|▊         | 15/175 [00:02<00:26,  5.96it/s]  9%|▉         | 16/175 [00:02<00:31,  5.08it/s] 10%|▉         | 17/175 [00:03<00:34,  4.62it/s] 10%|█         | 18/175 [00:03<00:37,  4.24it/s] 11%|█         | 19/175 [00:03<00:38,  4.01it/s] 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s] 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s] 13%|█▎        | 23/175 [00:04<00:25,  6.07it/s] 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s] 14%|█▍        | 25/175 [00:04<00:26,  5.62it/s] 15%|█▍        | 26/175 [00:04<00:24,  6.06it/s] 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s] 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s] 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s] 17%|█▋        | 30/175 [00:05<00:28,  5.16it/s] 18%|█▊        | 31/175 [00:05<00:31,  4.56it/s] 18%|█▊        | 32/175 [00:05<00:27,  5.16it/s] 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s] 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s] 20%|██        | 35/175 [00:06<00:27,  5.19it/s] 21%|██        | 36/175 [00:06<00:26,  5.18it/s] 21%|██        | 37/175 [00:06<00:26,  5.23it/s] 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s] 22%|██▏       | 39/175 [00:07<00:27,  5.04it/s] 23%|██▎       | 40/175 [00:07<00:23,  5.71it/s] 23%|██▎       | 41/175 [00:07<00:21,  6.12it/s] 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s] 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s] 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s] 26%|██▌       | 45/175 [00:08<00:21,  5.93it/s] 26%|██▋       | 46/175 [00:08<00:20,  6.25it/s] 27%|██▋       | 47/175 [00:08<00:19,  6.59it/s] 27%|██▋       | 48/175 [00:08<00:20,  6.29it/s] 28%|██▊       | 49/175 [00:08<00:23,  5.35it/s] 29%|██▊       | 50/175 [00:08<00:23,  5.34it/s] 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s] 30%|██▉       | 52/175 [00:09<00:25,  4.78it/s] 30%|███       | 53/175 [00:09<00:24,  4.89it/s] 31%|███       | 54/175 [00:09<00:24,  4.91it/s] 31%|███▏      | 55/175 [00:10<00:26,  4.54it/s] 32%|███▏      | 56/175 [00:10<00:27,  4.30it/s] 33%|███▎      | 58/175 [00:10<00:21,  5.50it/s] 34%|███▎      | 59/175 [00:10<00:21,  5.45it/s] 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s] 35%|███▍      | 61/175 [00:11<00:22,  5.05it/s] 36%|███▌      | 63/175 [00:11<00:18,  6.14it/s] 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s] 38%|███▊      | 67/175 [00:11<00:14,  7.29it/s] 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s] 39%|███▉      | 69/175 [00:12<00:14,  7.14it/s] 40%|████      | 70/175 [00:12<00:13,  7.54it/s] 41%|████      | 71/175 [00:12<00:13,  7.78it/s] 41%|████      | 72/175 [00:12<00:17,  5.90it/s] 42%|████▏     | 73/175 [00:12<00:19,  5.21it/s] 42%|████▏     | 74/175 [00:13<00:17,  5.69it/s] 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s] 43%|████▎     | 76/175 [00:13<00:20,  4.91it/s] 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s] 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s] 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s] 46%|████▌     | 80/175 [00:14<00:23,  4.05it/s] 46%|████▋     | 81/175 [00:14<00:23,  4.03it/s] 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s] 48%|████▊     | 84/175 [00:15<00:16,  5.46it/s] 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s] 49%|████▉     | 86/175 [00:15<00:18,  4.82it/s] 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s] 50%|█████     | 88/175 [00:16<00:16,  5.27it/s] 51%|█████     | 89/175 [00:16<00:18,  4.64it/s] 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s] 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s] 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s] 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s] 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s] 54%|█████▍    | 95/175 [00:17<00:13,  5.87it/s] 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s] 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s] 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s] 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s] 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s] 58%|█████▊    | 101/175 [00:18<00:15,  4.87it/s] 58%|█████▊    | 102/175 [00:18<00:15,  4.77it/s] 59%|█████▉    | 103/175 [00:19<00:12,  5.61it/s] 59%|█████▉    | 104/175 [00:19<00:11,  6.24it/s] 60%|██████    | 105/175 [00:19<00:11,  6.28it/s] 61%|██████    | 106/175 [00:19<00:10,  6.65it/s] 61%|██████    | 107/175 [00:19<00:12,  5.47it/s] 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s] 62%|██████▏   | 109/175 [00:20<00:10,  6.18it/s] 63%|██████▎   | 110/175 [00:20<00:11,  5.61it/s] 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s] 64%|██████▍   | 112/175 [00:20<00:11,  5.59it/s] 65%|██████▍   | 113/175 [00:20<00:10,  6.10it/s] 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s] 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s] 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s] 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s] 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s] 68%|██████▊   | 119/175 [00:21<00:11,  4.79it/s] 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s] 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s] 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s] 70%|███████   | 123/175 [00:22<00:11,  4.64it/s] 71%|███████   | 124/175 [00:23<00:12,  4.24it/s] 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s] 72%|███████▏  | 126/175 [00:23<00:10,  4.62it/s] 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s] 73%|███████▎  | 128/175 [00:24<00:10,  4.50it/s] 74%|███████▎  | 129/175 [00:24<00:10,  4.50it/s] 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s] 75%|███████▍  | 131/175 [00:24<00:08,  5.35it/s] 75%|███████▌  | 132/175 [00:24<00:07,  5.52it/s] 77%|███████▋  | 134/175 [00:24<00:06,  6.33it/s] 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s] 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s] 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s] 79%|███████▉  | 139/175 [00:25<00:05,  6.61it/s] 80%|████████  | 140/175 [00:25<00:06,  5.43it/s] 81%|████████  | 141/175 [00:26<00:06,  5.41it/s] 81%|████████  | 142/175 [00:26<00:06,  4.75it/s] 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s] 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s] 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s] 84%|████████▍ | 147/175 [00:27<00:05,  5.07it/s] 85%|████████▌ | 149/175 [00:27<00:04,  5.96it/s] 86%|████████▌ | 150/175 [00:27<00:04,  5.89it/s] 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s] 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s] 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s] 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s] 89%|████████▊ | 155/175 [00:28<00:03,  6.24it/s] 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s] 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s] 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s] 91%|█████████ | 159/175 [00:29<00:02,  6.22it/s] 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s] 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s] 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s] 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s] 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s] 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s] 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s] 95%|█████████▌| 167/175 [00:30<00:01,  6.13it/s] 96%|█████████▌| 168/175 [00:30<00:01,  5.74it/s] 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s] 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s] 98%|█████████▊| 172/175 [00:31<00:00,  5.41it/s] 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s] 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s]100%|██████████| 175/175 [00:32<00:00,  5.42it/s]
[INFO|modelcard.py:449] 2024-11-06 04:46:55,938 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     4.9778
  eval_loss               =     0.1134
  eval_runtime            = 0:00:32.35
  eval_samples_per_second =     21.634
  eval_steps_per_second   =      5.409
