11/06/2024 03:18:54 - WARNING - llamafactory.hparams.parser - We recommend enable mixed precision training.
11/06/2024 03:18:54 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: None
[INFO|configuration_utils.py:673] 2024-11-06 03:18:54,215 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:18:54,216 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,217 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,217 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,217 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,217 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,217 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 03:18:54,577 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:673] 2024-11-06 03:18:54,578 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:18:54,578 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,579 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,579 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,579 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,579 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2204] 2024-11-06 03:18:54,579 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2470] 2024-11-06 03:18:54,933 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
11/06/2024 03:18:54 - WARNING - llamafactory.model.loader - Processor was not found: 'LlamaConfig' object has no attribute 'vision_config'.
11/06/2024 03:18:54 - INFO - llamafactory.data.template - Replace eos token: <|end_of_text|>
11/06/2024 03:18:54 - INFO - llamafactory.data.template - Add pad token: <|end_of_text|>
11/06/2024 03:18:54 - INFO - llamafactory.data.loader - Loading dataset ../../Training_Dataset/C3_orig/my_ft_dataset.json...
Converting format of dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  75%|███████▌  | 5251/7000 [00:00<00:00, 50981.33 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 7000/7000 [00:00<00:00, 35810.89 examples/s]
Running tokenizer on dataset (num_proc=16):   0%|          | 0/7000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6%|▋         | 438/7000 [00:01<00:16, 410.07 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 876/7000 [00:01<00:08, 680.58 examples/s]Running tokenizer on dataset (num_proc=16):  25%|██▌       | 1752/7000 [00:01<00:03, 1396.63 examples/s]Running tokenizer on dataset (num_proc=16):  31%|███▏      | 2190/7000 [00:01<00:02, 1615.51 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▍     | 3066/7000 [00:01<00:01, 2377.17 examples/s]Running tokenizer on dataset (num_proc=16):  50%|█████     | 3504/7000 [00:02<00:01, 1966.35 examples/s]Running tokenizer on dataset (num_proc=16):  56%|█████▋    | 3941/7000 [00:02<00:01, 2025.15 examples/s]Running tokenizer on dataset (num_proc=16):  69%|██████▉   | 4815/7000 [00:02<00:00, 2397.15 examples/s]Running tokenizer on dataset (num_proc=16):  75%|███████▌  | 5252/7000 [00:03<00:00, 2314.44 examples/s]Running tokenizer on dataset (num_proc=16):  88%|████████▊ | 6126/7000 [00:03<00:00, 2615.28 examples/s]Running tokenizer on dataset (num_proc=16):  94%|█████████▍| 6563/7000 [00:03<00:00, 2842.23 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 3074.66 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 7000/7000 [00:03<00:00, 1953.75 examples/s]
[INFO|configuration_utils.py:673] 2024-11-06 03:18:59,848 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:18:59,848 >> Model config LlamaConfig {
  "_name_or_path": "/home/models/Llama-3.2-3B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|modeling_utils.py:3729] 2024-11-06 03:18:59,874 >> loading weights file /home/models/Llama-3.2-3B/model.safetensors.index.json
[INFO|modeling_utils.py:1622] 2024-11-06 03:18:59,874 >> Instantiating LlamaForCausalLM model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1099] 2024-11-06 03:18:59,875 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "eos_token_id": 128001
}

training example:
input_ids:
[128000, 128006, 9125, 128007, 271, 2675, 527, 264, 11190, 18328, 13, 128001, 128006, 882, 128007, 271, 8144, 459, 8029, 3319, 311, 17622, 279, 2038, 3196, 389, 279, 2728, 4729, 11036, 11829, 1121, 1288, 387, 1193, 264, 5822, 3319, 627, 13922, 7998, 1232, 364, 4438, 1690, 14971, 315, 279, 26280, 527, 9191, 1109, 220, 3487, 59050, 364, 2042, 851, 1232, 364, 28414, 46463, 518, 364, 2042, 26443, 1232, 5473, 29543, 1401, 1232, 2570, 43573, 16427, 851, 405, 2025, 16427, 851, 518, 364, 43573, 67300, 851, 405, 28414, 67300, 851, 4181, 364, 6682, 1401, 1232, 2570, 28414, 67300, 851, 518, 364, 2025, 16427, 851, 518, 364, 43573, 67300, 851, 4181, 364, 33210, 1232, 62208, 2048, 1292, 1232, 364, 28414, 518, 364, 6361, 9366, 1232, 2570, 28414, 887, 518, 364, 609, 518, 364, 38475, 518, 364, 97646, 518, 364, 49506, 304, 33151, 518, 364, 2470, 8420, 663, 2186, 5473, 2048, 1292, 1232, 364, 2025, 518, 364, 6361, 9366, 1232, 2570, 2025, 887, 518, 364, 609, 518, 364, 16381, 1614, 518, 364, 425, 663, 2186, 5473, 2048, 1292, 1232, 364, 43573, 518, 364, 6361, 9366, 1232, 2570, 28414, 887, 518, 364, 2025, 887, 518, 364, 79190, 15718, 663, 26516, 3500, 128001, 128006, 78191, 128007, 271, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
inputs:
<|begin_of_text|><|start_header_id|>system<|end_header_id|>

You are a helpful assistant.<|end_of_text|><|start_header_id|>user<|end_header_id|>

Write an SQL query to retrieve the information based on the given database schema.The result should be only a sql query.
{'question': 'How many heads of the departments are older than 56?', 'db_id': 'department_management', 'db_schema': {'foreign key': ['management.head_id->head.head_id','management.department_id->department.department_id'], 'primary key': ['department.department_id', 'head.head_id','management.department_id'], 'tables': [{'table_name': 'department', 'column_names': ['department id', 'name', 'creation', 'ranking', 'budget in billions', 'num employees']}, {'table_name': 'head', 'column_names': ['head id', 'name', 'born state', 'age']}, {'table_name':'management', 'column_names': ['department id', 'head id', 'temporary acting']}]}}<|end_of_text|><|start_header_id|>assistant<|end_header_id|>

SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 4963, 1797, 29771, 4393, 2010, 5401, 4325, 220, 871, 220, 220, 3487, 128001]
labels:
SELECT count(*) FROM head WHERE age  >  56<|end_of_text|>
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.08s/it]
[INFO|modeling_utils.py:4574] 2024-11-06 03:19:02,108 >> All model checkpoint weights were used when initializing LlamaForCausalLM.

[INFO|modeling_utils.py:4582] 2024-11-06 03:19:02,108 >> All the weights of LlamaForCausalLM were initialized from the model checkpoint at /home/models/Llama-3.2-3B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1052] 2024-11-06 03:19:02,111 >> loading configuration file /home/models/Llama-3.2-3B/generation_config.json
[INFO|configuration_utils.py:1099] 2024-11-06 03:19:02,111 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "do_sample": true,
  "eos_token_id": 128001,
  "temperature": 0.6,
  "top_p": 0.9
}

11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
11/06/2024 03:19:02 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
11/06/2024 03:19:02 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
11/06/2024 03:19:02 - INFO - llamafactory.model.model_utils.misc - Found linear modules: o_proj,q_proj,down_proj,up_proj,v_proj,k_proj,gate_proj
11/06/2024 03:19:02 - INFO - llamafactory.model.loader - trainable params: 12,156,928 || all params: 3,224,906,752 || trainable%: 0.3770
[INFO|trainer.py:2243] 2024-11-06 03:19:03,016 >> ***** Running training *****
[INFO|trainer.py:2244] 2024-11-06 03:19:03,016 >>   Num examples = 6,300
[INFO|trainer.py:2245] 2024-11-06 03:19:03,016 >>   Num Epochs = 5
[INFO|trainer.py:2246] 2024-11-06 03:19:03,016 >>   Instantaneous batch size per device = 4
[INFO|trainer.py:2249] 2024-11-06 03:19:03,016 >>   Total train batch size (w. parallel, distributed & accumulation) = 32
[INFO|trainer.py:2250] 2024-11-06 03:19:03,016 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2251] 2024-11-06 03:19:03,016 >>   Total optimization steps = 980
[INFO|trainer.py:2252] 2024-11-06 03:19:03,019 >>   Number of trainable parameters = 12,156,928
  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 1/980 [00:05<1:33:24,  5.72s/it]  0%|          | 2/980 [00:11<1:37:45,  6.00s/it]  0%|          | 3/980 [00:17<1:33:39,  5.75s/it]  0%|          | 4/980 [00:22<1:29:15,  5.49s/it]  1%|          | 5/980 [00:27<1:27:55,  5.41s/it]  1%|          | 6/980 [00:34<1:33:07,  5.74s/it]  1%|          | 7/980 [00:39<1:32:03,  5.68s/it]  1%|          | 8/980 [00:45<1:30:48,  5.61s/it]  1%|          | 9/980 [00:50<1:28:09,  5.45s/it]  1%|          | 10/980 [00:55<1:29:24,  5.53s/it]                                                    1%|          | 10/980 [00:55<1:29:24,  5.53s/it]  1%|          | 11/980 [01:01<1:29:11,  5.52s/it]  1%|          | 12/980 [01:06<1:26:39,  5.37s/it]  1%|▏         | 13/980 [01:11<1:27:15,  5.41s/it]  1%|▏         | 14/980 [01:17<1:25:55,  5.34s/it]  2%|▏         | 15/980 [01:22<1:26:28,  5.38s/it]  2%|▏         | 16/980 [01:28<1:27:02,  5.42s/it]  2%|▏         | 17/980 [01:33<1:26:24,  5.38s/it]  2%|▏         | 18/980 [01:38<1:25:39,  5.34s/it]  2%|▏         | 19/980 [01:44<1:26:00,  5.37s/it]  2%|▏         | 20/980 [01:49<1:24:39,  5.29s/it]                                                    2%|▏         | 20/980 [01:49<1:24:39,  5.29s/it]  2%|▏         | 21/980 [01:54<1:25:45,  5.37s/it]  2%|▏         | 22/980 [01:59<1:21:44,  5.12s/it]  2%|▏         | 23/980 [02:04<1:20:41,  5.06s/it]  2%|▏         | 24/980 [02:09<1:19:46,  5.01s/it]  3%|▎         | 25/980 [02:13<1:18:41,  4.94s/it]  3%|▎         | 26/980 [02:18<1:15:35,  4.75s/it]  3%|▎         | 27/980 [02:24<1:20:59,  5.10s/it]  3%|▎         | 28/980 [02:29<1:22:05,  5.17s/it]  3%|▎         | 29/980 [02:34<1:23:25,  5.26s/it]  3%|▎         | 30/980 [02:40<1:24:59,  5.37s/it]                                                    3%|▎         | 30/980 [02:40<1:24:59,  5.37s/it]  3%|▎         | 31/980 [02:45<1:25:08,  5.38s/it]  3%|▎         | 32/980 [02:51<1:24:04,  5.32s/it]  3%|▎         | 33/980 [02:56<1:26:16,  5.47s/it]  3%|▎         | 34/980 [03:02<1:25:25,  5.42s/it]  4%|▎         | 35/980 [03:06<1:21:46,  5.19s/it]  4%|▎         | 36/980 [03:11<1:18:56,  5.02s/it]  4%|▍         | 37/980 [03:16<1:20:05,  5.10s/it]  4%|▍         | 38/980 [03:22<1:24:32,  5.38s/it]  4%|▍         | 39/980 [03:27<1:20:38,  5.14s/it]  4%|▍         | 40/980 [03:32<1:19:04,  5.05s/it]                                                    4%|▍         | 40/980 [03:32<1:19:04,  5.05s/it]  4%|▍         | 41/980 [03:37<1:18:44,  5.03s/it]  4%|▍         | 42/980 [03:42<1:21:24,  5.21s/it]  4%|▍         | 43/980 [03:48<1:24:42,  5.42s/it]  4%|▍         | 44/980 [03:53<1:19:45,  5.11s/it]  5%|▍         | 45/980 [03:57<1:17:55,  5.00s/it]  5%|▍         | 46/980 [04:02<1:18:00,  5.01s/it]  5%|▍         | 47/980 [04:07<1:17:15,  4.97s/it]  5%|▍         | 48/980 [04:13<1:21:28,  5.25s/it]  5%|▌         | 49/980 [04:18<1:21:02,  5.22s/it]  5%|▌         | 50/980 [04:23<1:17:34,  5.00s/it]                                                    5%|▌         | 50/980 [04:23<1:17:34,  5.00s/it]  5%|▌         | 51/980 [04:29<1:21:02,  5.23s/it]  5%|▌         | 52/980 [04:34<1:20:09,  5.18s/it]  5%|▌         | 53/980 [04:39<1:20:45,  5.23s/it]  6%|▌         | 54/980 [04:45<1:23:39,  5.42s/it]  6%|▌         | 55/980 [04:51<1:26:09,  5.59s/it]  6%|▌         | 56/980 [04:55<1:20:57,  5.26s/it]  6%|▌         | 57/980 [05:01<1:24:19,  5.48s/it]  6%|▌         | 58/980 [05:07<1:23:33,  5.44s/it]  6%|▌         | 59/980 [05:11<1:19:39,  5.19s/it]  6%|▌         | 60/980 [05:17<1:21:14,  5.30s/it]                                                    6%|▌         | 60/980 [05:17<1:21:14,  5.30s/it]  6%|▌         | 61/980 [05:22<1:20:34,  5.26s/it]  6%|▋         | 62/980 [05:26<1:15:19,  4.92s/it]  6%|▋         | 63/980 [05:31<1:14:50,  4.90s/it]  7%|▋         | 64/980 [05:36<1:16:47,  5.03s/it]  7%|▋         | 65/980 [05:42<1:21:33,  5.35s/it]  7%|▋         | 66/980 [05:47<1:19:16,  5.20s/it]  7%|▋         | 67/980 [05:52<1:16:40,  5.04s/it]  7%|▋         | 68/980 [05:57<1:15:29,  4.97s/it]  7%|▋         | 69/980 [06:03<1:20:05,  5.28s/it]  7%|▋         | 70/980 [06:07<1:16:54,  5.07s/it]                                                    7%|▋         | 70/980 [06:07<1:16:54,  5.07s/it]  7%|▋         | 71/980 [06:12<1:13:32,  4.85s/it]  7%|▋         | 72/980 [06:17<1:16:05,  5.03s/it]  7%|▋         | 73/980 [06:23<1:19:25,  5.25s/it]  8%|▊         | 74/980 [06:29<1:23:44,  5.55s/it]  8%|▊         | 75/980 [06:34<1:21:38,  5.41s/it]  8%|▊         | 76/980 [06:39<1:19:21,  5.27s/it]  8%|▊         | 77/980 [06:44<1:18:20,  5.21s/it]  8%|▊         | 78/980 [06:50<1:21:40,  5.43s/it]  8%|▊         | 79/980 [06:56<1:22:35,  5.50s/it]  8%|▊         | 80/980 [07:02<1:24:10,  5.61s/it]                                                    8%|▊         | 80/980 [07:02<1:24:10,  5.61s/it]  8%|▊         | 81/980 [07:06<1:17:05,  5.15s/it]  8%|▊         | 82/980 [07:11<1:18:59,  5.28s/it]  8%|▊         | 83/980 [07:16<1:17:24,  5.18s/it]  9%|▊         | 84/980 [07:21<1:16:23,  5.12s/it]  9%|▊         | 85/980 [07:26<1:12:45,  4.88s/it]  9%|▉         | 86/980 [07:31<1:13:58,  4.97s/it]  9%|▉         | 87/980 [07:37<1:18:17,  5.26s/it]  9%|▉         | 88/980 [07:42<1:17:27,  5.21s/it]  9%|▉         | 89/980 [07:46<1:14:28,  5.02s/it]  9%|▉         | 90/980 [07:53<1:20:26,  5.42s/it]                                                    9%|▉         | 90/980 [07:53<1:20:26,  5.42s/it]  9%|▉         | 91/980 [07:58<1:18:23,  5.29s/it]  9%|▉         | 92/980 [08:04<1:20:38,  5.45s/it]  9%|▉         | 93/980 [08:09<1:18:56,  5.34s/it] 10%|▉         | 94/980 [08:14<1:17:20,  5.24s/it] 10%|▉         | 95/980 [08:19<1:16:32,  5.19s/it] 10%|▉         | 96/980 [08:23<1:13:35,  4.99s/it] 10%|▉         | 97/980 [08:28<1:11:26,  4.85s/it] 10%|█         | 98/980 [08:33<1:10:44,  4.81s/it] 10%|█         | 99/980 [08:38<1:15:40,  5.15s/it] 10%|█         | 100/980 [08:43<1:12:56,  4.97s/it]                                                    10%|█         | 100/980 [08:43<1:12:56,  4.97s/it][INFO|trainer.py:4021] 2024-11-06 03:27:46,538 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:27:46,539 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:27:46,539 >>   Batch size = 4
{'loss': 1.1282, 'grad_norm': 0.9946535229682922, 'learning_rate': 6.998201756702407e-05, 'epoch': 0.05}
{'loss': 0.5708, 'grad_norm': 0.9517399668693542, 'learning_rate': 6.992808874626176e-05, 'epoch': 0.1}
{'loss': 0.4208, 'grad_norm': 0.7650785446166992, 'learning_rate': 6.983826895322193e-05, 'epoch': 0.15}
{'loss': 0.3799, 'grad_norm': 0.6421977877616882, 'learning_rate': 6.971265048381361e-05, 'epoch': 0.2}
{'loss': 0.3317, 'grad_norm': 0.6565311551094055, 'learning_rate': 6.955136241950575e-05, 'epoch': 0.25}
{'loss': 0.3278, 'grad_norm': 0.7423444986343384, 'learning_rate': 6.935457049468728e-05, 'epoch': 0.3}
{'loss': 0.3309, 'grad_norm': 0.8919594287872314, 'learning_rate': 6.912247692636382e-05, 'epoch': 0.36}
{'loss': 0.2789, 'grad_norm': 0.6521375179290771, 'learning_rate': 6.885532020636602e-05, 'epoch': 0.41}
{'loss': 0.2522, 'grad_norm': 0.7129542231559753, 'learning_rate': 6.855337485628312e-05, 'epoch': 0.46}
{'loss': 0.2474, 'grad_norm': 0.7769394516944885, 'learning_rate': 6.82169511453734e-05, 'epoch': 0.51}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.67it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.38it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.31it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.51it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.38it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.77it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.05it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.25it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.63it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.91it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.20it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.70it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.11it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.60it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.90it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.20it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.54it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.25it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.32it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.57it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.75it/s][A
 30%|███       | 53/175 [00:09<00:25,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.89it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.03it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.12it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.57it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.28it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.11it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.88it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.56it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.89it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.39it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.18it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.27it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.02it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.60it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.43it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.89it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.87it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.25it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.62it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.13it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.54it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.32it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.34it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.58it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.21it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.85it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.46it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.62it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.77it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.48it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.48it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.72it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.45it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.50it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.41it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.76it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.96it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.88it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.07it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.67it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.65it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.18it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.22it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.70it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.39it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.86it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.11it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.72it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.89it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 10%|█         | 100/980 [09:15<1:12:56,  4.97s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:28:18,980 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-100
[INFO|configuration_utils.py:673] 2024-11-06 03:28:19,004 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:28:19,005 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:28:19,100 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:28:19,101 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-100/special_tokens_map.json
 10%|█         | 101/980 [09:21<3:38:32, 14.92s/it] 10%|█         | 102/980 [09:27<2:57:01, 12.10s/it] 11%|█         | 103/980 [09:32<2:26:10, 10.00s/it] 11%|█         | 104/980 [09:37<2:06:26,  8.66s/it] 11%|█         | 105/980 [09:42<1:49:39,  7.52s/it] 11%|█         | 106/980 [09:47<1:36:14,  6.61s/it] 11%|█         | 107/980 [09:52<1:30:39,  6.23s/it] 11%|█         | 108/980 [09:57<1:26:47,  5.97s/it] 11%|█         | 109/980 [10:02<1:22:27,  5.68s/it] 11%|█         | 110/980 [10:07<1:18:49,  5.44s/it]                                                    11%|█         | 110/980 [10:07<1:18:49,  5.44s/it] 11%|█▏        | 111/980 [10:12<1:16:02,  5.25s/it] 11%|█▏        | 112/980 [10:17<1:13:58,  5.11s/it] 12%|█▏        | 113/980 [10:22<1:15:24,  5.22s/it] 12%|█▏        | 114/980 [10:27<1:13:22,  5.08s/it] 12%|█▏        | 115/980 [10:31<1:07:46,  4.70s/it] 12%|█▏        | 116/980 [10:36<1:09:26,  4.82s/it] 12%|█▏        | 117/980 [10:41<1:12:17,  5.03s/it] 12%|█▏        | 118/980 [10:46<1:10:57,  4.94s/it] 12%|█▏        | 119/980 [10:51<1:10:04,  4.88s/it] 12%|█▏        | 120/980 [10:55<1:08:16,  4.76s/it]                                                    12%|█▏        | 120/980 [10:55<1:08:16,  4.76s/it] 12%|█▏        | 121/980 [11:01<1:10:30,  4.92s/it] 12%|█▏        | 122/980 [11:06<1:10:22,  4.92s/it] 13%|█▎        | 123/980 [11:11<1:11:50,  5.03s/it] 13%|█▎        | 124/980 [11:16<1:12:38,  5.09s/it] 13%|█▎        | 125/980 [11:21<1:10:49,  4.97s/it] 13%|█▎        | 126/980 [11:25<1:08:24,  4.81s/it] 13%|█▎        | 127/980 [11:30<1:07:27,  4.75s/it] 13%|█▎        | 128/980 [11:35<1:09:54,  4.92s/it] 13%|█▎        | 129/980 [11:40<1:10:31,  4.97s/it] 13%|█▎        | 130/980 [11:46<1:11:32,  5.05s/it]                                                    13%|█▎        | 130/980 [11:46<1:11:32,  5.05s/it] 13%|█▎        | 131/980 [11:51<1:11:49,  5.08s/it] 13%|█▎        | 132/980 [11:56<1:10:46,  5.01s/it] 14%|█▎        | 133/980 [12:01<1:12:21,  5.13s/it] 14%|█▎        | 134/980 [12:06<1:11:17,  5.06s/it] 14%|█▍        | 135/980 [12:11<1:09:43,  4.95s/it] 14%|█▍        | 136/980 [12:15<1:06:46,  4.75s/it] 14%|█▍        | 137/980 [12:19<1:04:39,  4.60s/it] 14%|█▍        | 138/980 [12:24<1:06:53,  4.77s/it] 14%|█▍        | 139/980 [12:29<1:05:02,  4.64s/it] 14%|█▍        | 140/980 [12:34<1:06:57,  4.78s/it]                                                    14%|█▍        | 140/980 [12:34<1:06:57,  4.78s/it] 14%|█▍        | 141/980 [12:39<1:08:09,  4.87s/it] 14%|█▍        | 142/980 [12:44<1:08:59,  4.94s/it] 15%|█▍        | 143/980 [12:48<1:05:26,  4.69s/it] 15%|█▍        | 144/980 [12:53<1:07:57,  4.88s/it] 15%|█▍        | 145/980 [12:58<1:05:56,  4.74s/it] 15%|█▍        | 146/980 [13:03<1:08:01,  4.89s/it] 15%|█▌        | 147/980 [13:08<1:10:34,  5.08s/it] 15%|█▌        | 148/980 [13:14<1:11:20,  5.14s/it] 15%|█▌        | 149/980 [13:19<1:09:48,  5.04s/it] 15%|█▌        | 150/980 [13:24<1:12:03,  5.21s/it]                                                    15%|█▌        | 150/980 [13:24<1:12:03,  5.21s/it] 15%|█▌        | 151/980 [13:29<1:11:36,  5.18s/it] 16%|█▌        | 152/980 [13:35<1:12:42,  5.27s/it] 16%|█▌        | 153/980 [13:40<1:13:34,  5.34s/it] 16%|█▌        | 154/980 [13:46<1:13:25,  5.33s/it] 16%|█▌        | 155/980 [13:51<1:13:45,  5.36s/it] 16%|█▌        | 156/980 [13:57<1:15:21,  5.49s/it] 16%|█▌        | 157/980 [14:03<1:16:28,  5.58s/it] 16%|█▌        | 158/980 [14:08<1:15:31,  5.51s/it] 16%|█▌        | 159/980 [14:14<1:16:19,  5.58s/it] 16%|█▋        | 160/980 [14:19<1:15:38,  5.53s/it]                                                    16%|█▋        | 160/980 [14:19<1:15:38,  5.53s/it] 16%|█▋        | 161/980 [14:23<1:10:32,  5.17s/it] 17%|█▋        | 162/980 [14:28<1:08:37,  5.03s/it] 17%|█▋        | 163/980 [14:34<1:10:29,  5.18s/it] 17%|█▋        | 164/980 [14:39<1:09:19,  5.10s/it] 17%|█▋        | 165/980 [14:45<1:12:53,  5.37s/it] 17%|█▋        | 166/980 [14:49<1:08:30,  5.05s/it] 17%|█▋        | 167/980 [14:53<1:06:11,  4.88s/it] 17%|█▋        | 168/980 [14:58<1:06:06,  4.89s/it] 17%|█▋        | 169/980 [15:03<1:03:40,  4.71s/it] 17%|█▋        | 170/980 [15:07<1:02:12,  4.61s/it]                                                    17%|█▋        | 170/980 [15:07<1:02:12,  4.61s/it] 17%|█▋        | 171/980 [15:12<1:05:47,  4.88s/it] 18%|█▊        | 172/980 [15:17<1:02:34,  4.65s/it] 18%|█▊        | 173/980 [15:21<1:02:51,  4.67s/it] 18%|█▊        | 174/980 [15:27<1:08:57,  5.13s/it] 18%|█▊        | 175/980 [15:32<1:06:16,  4.94s/it] 18%|█▊        | 176/980 [15:36<1:04:25,  4.81s/it] 18%|█▊        | 177/980 [15:41<1:01:35,  4.60s/it] 18%|█▊        | 178/980 [15:45<1:02:21,  4.67s/it] 18%|█▊        | 179/980 [15:50<1:02:20,  4.67s/it] 18%|█▊        | 180/980 [15:55<1:03:11,  4.74s/it]                                                    18%|█▊        | 180/980 [15:55<1:03:11,  4.74s/it] 18%|█▊        | 181/980 [16:00<1:03:51,  4.80s/it] 19%|█▊        | 182/980 [16:05<1:04:20,  4.84s/it] 19%|█▊        | 183/980 [16:09<1:02:45,  4.72s/it] 19%|█▉        | 184/980 [16:15<1:06:22,  5.00s/it] 19%|█▉        | 185/980 [16:20<1:06:06,  4.99s/it] 19%|█▉        | 186/980 [16:25<1:05:38,  4.96s/it] 19%|█▉        | 187/980 [16:30<1:04:36,  4.89s/it] 19%|█▉        | 188/980 [16:34<1:01:49,  4.68s/it] 19%|█▉        | 189/980 [16:39<1:03:16,  4.80s/it] 19%|█▉        | 190/980 [16:43<1:01:14,  4.65s/it]                                                    19%|█▉        | 190/980 [16:43<1:01:14,  4.65s/it] 19%|█▉        | 191/980 [16:48<1:04:03,  4.87s/it] 20%|█▉        | 192/980 [16:53<1:02:42,  4.78s/it] 20%|█▉        | 193/980 [16:57<59:22,  4.53s/it]   20%|█▉        | 194/980 [17:01<58:12,  4.44s/it] 20%|█▉        | 195/980 [17:08<1:06:12,  5.06s/it] 20%|██        | 196/980 [17:14<1:09:42,  5.33s/it] 20%|██        | 197/980 [17:18<1:06:33,  5.10s/it] 20%|██        | 198/980 [17:24<1:10:52,  5.44s/it] 20%|██        | 199/980 [17:29<1:07:52,  5.21s/it] 20%|██        | 200/980 [17:34<1:06:10,  5.09s/it]                                                    20%|██        | 200/980 [17:34<1:06:10,  5.09s/it][INFO|trainer.py:4021] 2024-11-06 03:36:37,513 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:36:37,513 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:36:37,513 >>   Batch size = 4
{'eval_loss': 0.2511550784111023, 'eval_runtime': 32.4411, 'eval_samples_per_second': 21.578, 'eval_steps_per_second': 5.394, 'epoch': 0.51}
{'loss': 0.2325, 'grad_norm': 0.7550572156906128, 'learning_rate': 6.784639477174161e-05, 'epoch': 0.56}
{'loss': 0.2524, 'grad_norm': 1.0709311962127686, 'learning_rate': 6.744208650711076e-05, 'epoch': 0.61}
{'loss': 0.241, 'grad_norm': 1.252759337425232, 'learning_rate': 6.700444180555343e-05, 'epoch': 0.66}
{'loss': 0.2154, 'grad_norm': 0.9554330110549927, 'learning_rate': 6.653391037658466e-05, 'epoch': 0.71}
{'loss': 0.2035, 'grad_norm': 0.9999862313270569, 'learning_rate': 6.603097572305501e-05, 'epoch': 0.76}
{'loss': 0.2063, 'grad_norm': 0.7741378545761108, 'learning_rate': 6.549615464431863e-05, 'epoch': 0.81}
{'loss': 0.1983, 'grad_norm': 1.1174131631851196, 'learning_rate': 6.492999670518712e-05, 'epoch': 0.86}
{'loss': 0.1936, 'grad_norm': 0.9837483763694763, 'learning_rate': 6.433308367121442e-05, 'epoch': 0.91}
{'loss': 0.1942, 'grad_norm': 1.0929865837097168, 'learning_rate': 6.370602891089344e-05, 'epoch': 0.97}
{'loss': 0.1815, 'grad_norm': 1.4762696027755737, 'learning_rate': 6.304947676537848e-05, 'epoch': 1.02}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.42it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.36it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.51it/s][A
  4%|▍         | 7/175 [00:01<00:28,  6.00it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.53it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.79it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.95it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.42it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.05it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.05it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.24it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.04it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.72it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.56it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.89it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.49it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.03it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.12it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.28it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.77it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.56it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.89it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.87it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.58it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.34it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.33it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.74it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.47it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.90it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.69it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.67it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.71it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.39it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.19it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.10it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.89it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.88it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 20%|██        | 200/980 [18:06<1:06:10,  5.09s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:37:09,915 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-200
[INFO|configuration_utils.py:673] 2024-11-06 03:37:09,937 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:37:09,938 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:37:10,031 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:37:10,031 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-200/special_tokens_map.json
 21%|██        | 201/980 [18:12<3:15:25, 15.05s/it] 21%|██        | 202/980 [18:17<2:36:50, 12.10s/it] 21%|██        | 203/980 [18:22<2:06:52,  9.80s/it] 21%|██        | 204/980 [18:27<1:50:11,  8.52s/it] 21%|██        | 205/980 [18:32<1:36:31,  7.47s/it] 21%|██        | 206/980 [18:37<1:24:34,  6.56s/it] 21%|██        | 207/980 [18:43<1:21:19,  6.31s/it] 21%|██        | 208/980 [18:48<1:18:16,  6.08s/it] 21%|██▏       | 209/980 [18:53<1:12:40,  5.66s/it] 21%|██▏       | 210/980 [18:58<1:11:26,  5.57s/it]                                                    21%|██▏       | 210/980 [18:58<1:11:26,  5.57s/it] 22%|██▏       | 211/980 [19:04<1:11:06,  5.55s/it] 22%|██▏       | 212/980 [19:09<1:09:32,  5.43s/it] 22%|██▏       | 213/980 [19:14<1:07:15,  5.26s/it] 22%|██▏       | 214/980 [19:19<1:05:48,  5.15s/it] 22%|██▏       | 215/980 [19:24<1:05:44,  5.16s/it] 22%|██▏       | 216/980 [19:28<1:03:47,  5.01s/it] 22%|██▏       | 217/980 [19:34<1:03:52,  5.02s/it] 22%|██▏       | 218/980 [19:39<1:06:56,  5.27s/it] 22%|██▏       | 219/980 [19:44<1:03:26,  5.00s/it] 22%|██▏       | 220/980 [19:49<1:03:52,  5.04s/it]                                                    22%|██▏       | 220/980 [19:49<1:03:52,  5.04s/it] 23%|██▎       | 221/980 [19:54<1:04:07,  5.07s/it] 23%|██▎       | 222/980 [20:00<1:06:58,  5.30s/it] 23%|██▎       | 223/980 [20:05<1:07:01,  5.31s/it] 23%|██▎       | 224/980 [20:10<1:05:34,  5.20s/it] 23%|██▎       | 225/980 [20:16<1:06:42,  5.30s/it] 23%|██▎       | 226/980 [20:20<1:03:43,  5.07s/it] 23%|██▎       | 227/980 [20:25<1:03:54,  5.09s/it] 23%|██▎       | 228/980 [20:31<1:04:54,  5.18s/it] 23%|██▎       | 229/980 [20:36<1:05:51,  5.26s/it] 23%|██▎       | 230/980 [20:40<1:01:46,  4.94s/it]                                                    23%|██▎       | 230/980 [20:40<1:01:46,  4.94s/it] 24%|██▎       | 231/980 [20:46<1:04:18,  5.15s/it] 24%|██▎       | 232/980 [20:50<1:00:23,  4.84s/it] 24%|██▍       | 233/980 [20:55<1:01:11,  4.91s/it] 24%|██▍       | 234/980 [21:00<1:01:31,  4.95s/it] 24%|██▍       | 235/980 [21:04<58:40,  4.73s/it]   24%|██▍       | 236/980 [21:10<1:01:03,  4.92s/it] 24%|██▍       | 237/980 [21:15<1:01:42,  4.98s/it] 24%|██▍       | 238/980 [21:19<59:07,  4.78s/it]   24%|██▍       | 239/980 [21:25<1:01:07,  4.95s/it] 24%|██▍       | 240/980 [21:30<1:02:28,  5.07s/it]                                                    24%|██▍       | 240/980 [21:30<1:02:28,  5.07s/it] 25%|██▍       | 241/980 [21:35<1:03:11,  5.13s/it] 25%|██▍       | 242/980 [21:41<1:04:03,  5.21s/it] 25%|██▍       | 243/980 [21:46<1:05:14,  5.31s/it] 25%|██▍       | 244/980 [21:51<1:03:48,  5.20s/it] 25%|██▌       | 245/980 [21:56<1:03:19,  5.17s/it] 25%|██▌       | 246/980 [22:01<1:02:40,  5.12s/it] 25%|██▌       | 247/980 [22:06<1:02:03,  5.08s/it] 25%|██▌       | 248/980 [22:11<59:58,  4.92s/it]   25%|██▌       | 249/980 [22:16<1:01:49,  5.07s/it] 26%|██▌       | 250/980 [22:22<1:04:16,  5.28s/it]                                                    26%|██▌       | 250/980 [22:22<1:04:16,  5.28s/it] 26%|██▌       | 251/980 [22:26<58:42,  4.83s/it]   26%|██▌       | 252/980 [22:31<1:01:21,  5.06s/it] 26%|██▌       | 253/980 [22:36<1:01:02,  5.04s/it] 26%|██▌       | 254/980 [22:41<1:00:20,  4.99s/it] 26%|██▌       | 255/980 [22:47<1:04:22,  5.33s/it] 26%|██▌       | 256/980 [22:53<1:05:32,  5.43s/it] 26%|██▌       | 257/980 [22:59<1:08:11,  5.66s/it] 26%|██▋       | 258/980 [23:04<1:04:15,  5.34s/it] 26%|██▋       | 259/980 [23:08<1:01:52,  5.15s/it] 27%|██▋       | 260/980 [23:14<1:02:19,  5.19s/it]                                                    27%|██▋       | 260/980 [23:14<1:02:19,  5.19s/it] 27%|██▋       | 261/980 [23:18<59:41,  4.98s/it]   27%|██▋       | 262/980 [23:23<57:18,  4.79s/it] 27%|██▋       | 263/980 [23:28<59:09,  4.95s/it] 27%|██▋       | 264/980 [23:32<56:14,  4.71s/it] 27%|██▋       | 265/980 [23:36<54:32,  4.58s/it] 27%|██▋       | 266/980 [23:41<55:44,  4.68s/it] 27%|██▋       | 267/980 [23:46<54:29,  4.58s/it] 27%|██▋       | 268/980 [23:51<55:41,  4.69s/it] 27%|██▋       | 269/980 [23:56<58:53,  4.97s/it] 28%|██▊       | 270/980 [24:01<58:18,  4.93s/it]                                                  28%|██▊       | 270/980 [24:01<58:18,  4.93s/it] 28%|██▊       | 271/980 [24:06<59:20,  5.02s/it] 28%|██▊       | 272/980 [24:11<56:44,  4.81s/it] 28%|██▊       | 273/980 [24:15<54:31,  4.63s/it] 28%|██▊       | 274/980 [24:21<58:36,  4.98s/it] 28%|██▊       | 275/980 [24:25<57:22,  4.88s/it] 28%|██▊       | 276/980 [24:30<55:32,  4.73s/it] 28%|██▊       | 277/980 [24:34<55:25,  4.73s/it] 28%|██▊       | 278/980 [24:40<59:20,  5.07s/it] 28%|██▊       | 279/980 [24:45<57:33,  4.93s/it] 29%|██▊       | 280/980 [24:49<53:16,  4.57s/it]                                                  29%|██▊       | 280/980 [24:49<53:16,  4.57s/it] 29%|██▊       | 281/980 [24:53<53:26,  4.59s/it] 29%|██▉       | 282/980 [24:57<52:14,  4.49s/it] 29%|██▉       | 283/980 [25:03<56:27,  4.86s/it] 29%|██▉       | 284/980 [25:09<1:00:30,  5.22s/it] 29%|██▉       | 285/980 [25:15<1:00:47,  5.25s/it] 29%|██▉       | 286/980 [25:20<1:01:16,  5.30s/it] 29%|██▉       | 287/980 [25:25<59:30,  5.15s/it]   29%|██▉       | 288/980 [25:29<56:51,  4.93s/it] 29%|██▉       | 289/980 [25:35<59:52,  5.20s/it] 30%|██▉       | 290/980 [25:39<56:43,  4.93s/it]                                                  30%|██▉       | 290/980 [25:39<56:43,  4.93s/it] 30%|██▉       | 291/980 [25:45<58:27,  5.09s/it] 30%|██▉       | 292/980 [25:49<57:01,  4.97s/it] 30%|██▉       | 293/980 [25:54<55:57,  4.89s/it] 30%|███       | 294/980 [25:59<57:06,  4.99s/it] 30%|███       | 295/980 [26:04<54:57,  4.81s/it] 30%|███       | 296/980 [26:10<57:57,  5.08s/it] 30%|███       | 297/980 [26:15<59:39,  5.24s/it] 30%|███       | 298/980 [26:20<56:45,  4.99s/it] 31%|███       | 299/980 [26:24<55:05,  4.85s/it] 31%|███       | 300/980 [26:29<54:12,  4.78s/it]                                                  31%|███       | 300/980 [26:29<54:12,  4.78s/it][INFO|trainer.py:4021] 2024-11-06 03:45:32,203 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:45:32,203 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:45:32,203 >>   Batch size = 4
{'eval_loss': 0.1820894479751587, 'eval_runtime': 32.4012, 'eval_samples_per_second': 21.604, 'eval_steps_per_second': 5.401, 'epoch': 1.02}
{'loss': 0.1661, 'grad_norm': 0.9885721802711487, 'learning_rate': 6.236410188638105e-05, 'epoch': 1.07}
{'loss': 0.1529, 'grad_norm': 0.7632971405982971, 'learning_rate': 6.16506085429197e-05, 'epoch': 1.12}
{'loss': 0.1493, 'grad_norm': 1.1257436275482178, 'learning_rate': 6.0909729897636034e-05, 'epoch': 1.17}
{'loss': 0.1487, 'grad_norm': 0.9878666996955872, 'learning_rate': 6.014222725342046e-05, 'epoch': 1.22}
{'loss': 0.1631, 'grad_norm': 0.6743207573890686, 'learning_rate': 5.934888927112202e-05, 'epoch': 1.27}
{'loss': 0.1518, 'grad_norm': 1.4455912113189697, 'learning_rate': 5.853053115914608e-05, 'epoch': 1.32}
{'loss': 0.1357, 'grad_norm': 1.0936309099197388, 'learning_rate': 5.7687993835772594e-05, 'epoch': 1.37}
{'loss': 0.1386, 'grad_norm': 0.9292837381362915, 'learning_rate': 5.682214306505567e-05, 'epoch': 1.42}
{'loss': 0.1508, 'grad_norm': 1.1427499055862427, 'learning_rate': 5.5933868567192556e-05, 'epoch': 1.47}
{'loss': 0.1291, 'grad_norm': 1.3414549827575684, 'learning_rate': 5.5024083104275937e-05, 'epoch': 1.52}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.40it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.98it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.73it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.71it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.55it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.05it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.05it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.94it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.26it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.06it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.63it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.91it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.96it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.70it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.12it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.17it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.60it/s][A
 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.24it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.58it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.28it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.59it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.59it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.29it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.54it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.78it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.20it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.57it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.04it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.87it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.76it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.23it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.27it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.47it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.58it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.03it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.29it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.62it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.23it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.60it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.71it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.73it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.45it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.76it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.76it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.07it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.88it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.67it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.21it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.11it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 31%|███       | 300/980 [27:01<54:12,  4.78s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:46:04,602 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-300
[INFO|configuration_utils.py:673] 2024-11-06 03:46:04,623 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:46:04,623 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:46:04,716 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:46:04,716 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-300/special_tokens_map.json
 31%|███       | 301/980 [27:06<2:46:10, 14.68s/it] 31%|███       | 302/980 [27:12<2:15:44, 12.01s/it] 31%|███       | 303/980 [27:17<1:51:29,  9.88s/it] 31%|███       | 304/980 [27:22<1:33:57,  8.34s/it] 31%|███       | 305/980 [27:27<1:24:16,  7.49s/it] 31%|███       | 306/980 [27:33<1:16:52,  6.84s/it] 31%|███▏      | 307/980 [27:37<1:09:02,  6.15s/it] 31%|███▏      | 308/980 [27:43<1:07:58,  6.07s/it] 32%|███▏      | 309/980 [27:48<1:02:07,  5.56s/it] 32%|███▏      | 310/980 [27:53<1:01:35,  5.52s/it]                                                    32%|███▏      | 310/980 [27:53<1:01:35,  5.52s/it] 32%|███▏      | 311/980 [27:57<58:02,  5.21s/it]   32%|███▏      | 312/980 [28:02<54:24,  4.89s/it] 32%|███▏      | 313/980 [28:06<53:12,  4.79s/it] 32%|███▏      | 314/980 [28:10<49:51,  4.49s/it] 32%|███▏      | 315/980 [28:15<53:08,  4.80s/it] 32%|███▏      | 316/980 [28:21<54:09,  4.89s/it] 32%|███▏      | 317/980 [28:25<53:42,  4.86s/it] 32%|███▏      | 318/980 [28:31<54:56,  4.98s/it] 33%|███▎      | 319/980 [28:35<53:45,  4.88s/it] 33%|███▎      | 320/980 [28:40<53:59,  4.91s/it]                                                  33%|███▎      | 320/980 [28:40<53:59,  4.91s/it] 33%|███▎      | 321/980 [28:45<54:01,  4.92s/it] 33%|███▎      | 322/980 [28:50<55:22,  5.05s/it] 33%|███▎      | 323/980 [28:56<56:16,  5.14s/it] 33%|███▎      | 324/980 [29:00<52:57,  4.84s/it] 33%|███▎      | 325/980 [29:05<54:45,  5.02s/it] 33%|███▎      | 326/980 [29:10<53:24,  4.90s/it] 33%|███▎      | 327/980 [29:15<54:29,  5.01s/it] 33%|███▎      | 328/980 [29:20<54:49,  5.04s/it] 34%|███▎      | 329/980 [29:25<52:27,  4.83s/it] 34%|███▎      | 330/980 [29:30<53:28,  4.94s/it]                                                  34%|███▎      | 330/980 [29:30<53:28,  4.94s/it] 34%|███▍      | 331/980 [29:35<53:46,  4.97s/it] 34%|███▍      | 332/980 [29:39<51:04,  4.73s/it] 34%|███▍      | 333/980 [29:44<52:52,  4.90s/it] 34%|███▍      | 334/980 [29:49<51:57,  4.83s/it] 34%|███▍      | 335/980 [29:54<52:25,  4.88s/it] 34%|███▍      | 336/980 [29:59<51:40,  4.82s/it] 34%|███▍      | 337/980 [30:04<52:47,  4.93s/it] 34%|███▍      | 338/980 [30:09<53:15,  4.98s/it] 35%|███▍      | 339/980 [30:13<51:17,  4.80s/it] 35%|███▍      | 340/980 [30:19<53:18,  5.00s/it]                                                  35%|███▍      | 340/980 [30:19<53:18,  5.00s/it] 35%|███▍      | 341/980 [30:25<55:31,  5.21s/it] 35%|███▍      | 342/980 [30:29<52:25,  4.93s/it] 35%|███▌      | 343/980 [30:33<50:38,  4.77s/it] 35%|███▌      | 344/980 [30:38<51:15,  4.84s/it] 35%|███▌      | 345/980 [30:43<50:18,  4.75s/it] 35%|███▌      | 346/980 [30:48<52:03,  4.93s/it] 35%|███▌      | 347/980 [30:53<51:21,  4.87s/it] 36%|███▌      | 348/980 [30:57<49:04,  4.66s/it] 36%|███▌      | 349/980 [31:03<53:55,  5.13s/it] 36%|███▌      | 350/980 [31:09<54:22,  5.18s/it]                                                  36%|███▌      | 350/980 [31:09<54:22,  5.18s/it] 36%|███▌      | 351/980 [31:14<54:36,  5.21s/it] 36%|███▌      | 352/980 [31:20<56:11,  5.37s/it] 36%|███▌      | 353/980 [31:25<56:41,  5.43s/it] 36%|███▌      | 354/980 [31:31<57:11,  5.48s/it] 36%|███▌      | 355/980 [31:36<56:15,  5.40s/it] 36%|███▋      | 356/980 [31:41<54:47,  5.27s/it] 36%|███▋      | 357/980 [31:46<55:22,  5.33s/it] 37%|███▋      | 358/980 [31:51<54:11,  5.23s/it] 37%|███▋      | 359/980 [31:56<51:56,  5.02s/it] 37%|███▋      | 360/980 [32:02<53:34,  5.18s/it]                                                  37%|███▋      | 360/980 [32:02<53:34,  5.18s/it] 37%|███▋      | 361/980 [32:07<53:22,  5.17s/it] 37%|███▋      | 362/980 [32:12<54:12,  5.26s/it] 37%|███▋      | 363/980 [32:17<53:57,  5.25s/it] 37%|███▋      | 364/980 [32:22<53:13,  5.19s/it] 37%|███▋      | 365/980 [32:28<54:43,  5.34s/it] 37%|███▋      | 366/980 [32:33<54:14,  5.30s/it] 37%|███▋      | 367/980 [32:38<52:58,  5.18s/it] 38%|███▊      | 368/980 [32:43<51:43,  5.07s/it] 38%|███▊      | 369/980 [32:48<51:26,  5.05s/it] 38%|███▊      | 370/980 [32:53<51:07,  5.03s/it]                                                  38%|███▊      | 370/980 [32:53<51:07,  5.03s/it] 38%|███▊      | 371/980 [32:58<51:13,  5.05s/it] 38%|███▊      | 372/980 [33:04<53:15,  5.26s/it] 38%|███▊      | 373/980 [33:09<52:40,  5.21s/it] 38%|███▊      | 374/980 [33:14<52:43,  5.22s/it] 38%|███▊      | 375/980 [33:20<54:07,  5.37s/it] 38%|███▊      | 376/980 [33:25<53:28,  5.31s/it] 38%|███▊      | 377/980 [33:31<54:58,  5.47s/it] 39%|███▊      | 378/980 [33:35<51:50,  5.17s/it] 39%|███▊      | 379/980 [33:41<52:47,  5.27s/it] 39%|███▉      | 380/980 [33:46<50:43,  5.07s/it]                                                  39%|███▉      | 380/980 [33:46<50:43,  5.07s/it] 39%|███▉      | 381/980 [33:51<52:10,  5.23s/it] 39%|███▉      | 382/980 [33:56<50:24,  5.06s/it] 39%|███▉      | 383/980 [34:00<48:38,  4.89s/it] 39%|███▉      | 384/980 [34:06<50:12,  5.05s/it] 39%|███▉      | 385/980 [34:11<49:47,  5.02s/it] 39%|███▉      | 386/980 [34:16<50:55,  5.14s/it] 39%|███▉      | 387/980 [34:22<51:44,  5.23s/it] 40%|███▉      | 388/980 [34:26<49:00,  4.97s/it] 40%|███▉      | 389/980 [34:31<49:46,  5.05s/it] 40%|███▉      | 390/980 [34:36<49:02,  4.99s/it]                                                  40%|███▉      | 390/980 [34:36<49:02,  4.99s/it] 40%|███▉      | 391/980 [34:40<46:29,  4.74s/it] 40%|████      | 392/980 [34:46<49:04,  5.01s/it] 40%|████      | 393/980 [34:50<47:59,  4.91s/it] 40%|████      | 394/980 [34:54<44:17,  4.53s/it] 40%|████      | 395/980 [34:59<45:04,  4.62s/it] 40%|████      | 396/980 [35:04<46:05,  4.74s/it] 41%|████      | 397/980 [35:10<49:04,  5.05s/it] 41%|████      | 398/980 [35:15<50:00,  5.16s/it] 41%|████      | 399/980 [35:20<48:44,  5.03s/it] 41%|████      | 400/980 [35:25<47:49,  4.95s/it]                                                  41%|████      | 400/980 [35:25<47:49,  4.95s/it][INFO|trainer.py:4021] 2024-11-06 03:54:28,111 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 03:54:28,111 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 03:54:28,111 >>   Batch size = 4
{'eval_loss': 0.15903045237064362, 'eval_runtime': 32.399, 'eval_samples_per_second': 21.606, 'eval_steps_per_second': 5.401, 'epoch': 1.52}
{'loss': 0.1321, 'grad_norm': 1.1183053255081177, 'learning_rate': 5.4093721542369193e-05, 'epoch': 1.57}
{'loss': 0.1334, 'grad_norm': 0.9041293859481812, 'learning_rate': 5.314373989086838e-05, 'epoch': 1.63}
{'loss': 0.1286, 'grad_norm': 0.8438245058059692, 'learning_rate': 5.217511432013782e-05, 'epoch': 1.68}
{'loss': 0.128, 'grad_norm': 0.7552191615104675, 'learning_rate': 5.1188840158429235e-05, 'epoch': 1.73}
{'loss': 0.1357, 'grad_norm': 0.9772201180458069, 'learning_rate': 5.0185930869114526e-05, 'epoch': 1.78}
{'loss': 0.1205, 'grad_norm': 1.0844191312789917, 'learning_rate': 4.916741700928378e-05, 'epoch': 1.83}
{'loss': 0.1285, 'grad_norm': 1.3153234720230103, 'learning_rate': 4.813434517077809e-05, 'epoch': 1.88}
{'loss': 0.128, 'grad_norm': 0.8145211338996887, 'learning_rate': 4.708777690474576e-05, 'epoch': 1.93}
{'loss': 0.1244, 'grad_norm': 0.9411816596984863, 'learning_rate': 4.6028787630826724e-05, 'epoch': 1.98}
{'loss': 0.0915, 'grad_norm': 1.6928952932357788, 'learning_rate': 4.495846553208613e-05, 'epoch': 2.03}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.38it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.31it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.01it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.81it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.44it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.25it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.63it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.92it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.69it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.60it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.68it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.89it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.76it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.28it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.43it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.58it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.28it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.77it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.57it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.27it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.39it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.58it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.56it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.62it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.24it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.72it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.44it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.61it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.76it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.87it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.66it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.65it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.18it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.22it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.13it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 41%|████      | 400/980 [35:57<47:49,  4.95s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 03:55:00,522 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-400
[INFO|configuration_utils.py:673] 2024-11-06 03:55:00,542 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 03:55:00,542 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 03:55:00,636 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 03:55:00,636 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-400/special_tokens_map.json
 41%|████      | 401/980 [36:03<2:23:48, 14.90s/it] 41%|████      | 402/980 [36:07<1:53:21, 11.77s/it] 41%|████      | 403/980 [36:12<1:34:15,  9.80s/it] 41%|████      | 404/980 [36:17<1:20:18,  8.37s/it] 41%|████▏     | 405/980 [36:24<1:15:05,  7.84s/it] 41%|████▏     | 406/980 [36:28<1:04:57,  6.79s/it] 42%|████▏     | 407/980 [36:33<58:00,  6.07s/it]   42%|████▏     | 408/980 [36:38<55:46,  5.85s/it] 42%|████▏     | 409/980 [36:42<51:26,  5.41s/it] 42%|████▏     | 410/980 [36:47<50:19,  5.30s/it]                                                  42%|████▏     | 410/980 [36:47<50:19,  5.30s/it] 42%|████▏     | 411/980 [36:52<49:09,  5.18s/it] 42%|████▏     | 412/980 [36:58<49:34,  5.24s/it] 42%|████▏     | 413/980 [37:02<47:50,  5.06s/it] 42%|████▏     | 414/980 [37:07<47:18,  5.01s/it] 42%|████▏     | 415/980 [37:12<45:31,  4.83s/it] 42%|████▏     | 416/980 [37:17<46:56,  4.99s/it] 43%|████▎     | 417/980 [37:22<47:23,  5.05s/it] 43%|████▎     | 418/980 [37:28<49:13,  5.26s/it] 43%|████▎     | 419/980 [37:32<44:20,  4.74s/it] 43%|████▎     | 420/980 [37:37<46:50,  5.02s/it]                                                  43%|████▎     | 420/980 [37:37<46:50,  5.02s/it] 43%|████▎     | 421/980 [37:42<47:09,  5.06s/it] 43%|████▎     | 422/980 [37:47<45:16,  4.87s/it] 43%|████▎     | 423/980 [37:52<45:28,  4.90s/it] 43%|████▎     | 424/980 [37:56<44:05,  4.76s/it] 43%|████▎     | 425/980 [38:01<43:10,  4.67s/it] 43%|████▎     | 426/980 [38:06<43:49,  4.75s/it] 44%|████▎     | 427/980 [38:11<44:46,  4.86s/it] 44%|████▎     | 428/980 [38:16<44:42,  4.86s/it] 44%|████▍     | 429/980 [38:21<47:20,  5.16s/it] 44%|████▍     | 430/980 [38:27<48:04,  5.24s/it]                                                  44%|████▍     | 430/980 [38:27<48:04,  5.24s/it] 44%|████▍     | 431/980 [38:32<46:54,  5.13s/it] 44%|████▍     | 432/980 [38:38<48:50,  5.35s/it] 44%|████▍     | 433/980 [38:43<49:08,  5.39s/it] 44%|████▍     | 434/980 [38:48<48:03,  5.28s/it] 44%|████▍     | 435/980 [38:53<45:51,  5.05s/it] 44%|████▍     | 436/980 [38:57<45:08,  4.98s/it] 45%|████▍     | 437/980 [39:02<44:08,  4.88s/it] 45%|████▍     | 438/980 [39:06<41:43,  4.62s/it] 45%|████▍     | 439/980 [39:11<41:44,  4.63s/it] 45%|████▍     | 440/980 [39:16<42:00,  4.67s/it]                                                  45%|████▍     | 440/980 [39:16<42:00,  4.67s/it] 45%|████▌     | 441/980 [39:21<44:49,  4.99s/it] 45%|████▌     | 442/980 [39:26<43:02,  4.80s/it] 45%|████▌     | 443/980 [39:31<43:22,  4.85s/it] 45%|████▌     | 444/980 [39:36<43:32,  4.87s/it] 45%|████▌     | 445/980 [39:41<45:30,  5.10s/it] 46%|████▌     | 446/980 [39:47<46:15,  5.20s/it] 46%|████▌     | 447/980 [39:52<46:42,  5.26s/it] 46%|████▌     | 448/980 [39:57<45:04,  5.08s/it] 46%|████▌     | 449/980 [40:03<48:51,  5.52s/it] 46%|████▌     | 450/980 [40:08<48:01,  5.44s/it]                                                  46%|████▌     | 450/980 [40:08<48:01,  5.44s/it] 46%|████▌     | 451/980 [40:14<48:22,  5.49s/it] 46%|████▌     | 452/980 [40:20<50:05,  5.69s/it] 46%|████▌     | 453/980 [40:25<47:26,  5.40s/it] 46%|████▋     | 454/980 [40:30<45:37,  5.20s/it] 46%|████▋     | 455/980 [40:34<43:16,  4.95s/it] 47%|████▋     | 456/980 [40:38<40:44,  4.66s/it] 47%|████▋     | 457/980 [40:44<42:56,  4.93s/it] 47%|████▋     | 458/980 [40:48<42:43,  4.91s/it] 47%|████▋     | 459/980 [40:53<42:07,  4.85s/it] 47%|████▋     | 460/980 [40:59<44:27,  5.13s/it]                                                  47%|████▋     | 460/980 [40:59<44:27,  5.13s/it] 47%|████▋     | 461/980 [41:04<43:28,  5.03s/it] 47%|████▋     | 462/980 [41:09<43:04,  4.99s/it] 47%|████▋     | 463/980 [41:13<42:13,  4.90s/it] 47%|████▋     | 464/980 [41:19<42:59,  5.00s/it] 47%|████▋     | 465/980 [41:24<43:51,  5.11s/it] 48%|████▊     | 466/980 [41:30<45:09,  5.27s/it] 48%|████▊     | 467/980 [41:35<46:28,  5.44s/it] 48%|████▊     | 468/980 [41:42<48:48,  5.72s/it] 48%|████▊     | 469/980 [41:48<49:21,  5.80s/it] 48%|████▊     | 470/980 [41:53<46:48,  5.51s/it]                                                  48%|████▊     | 470/980 [41:53<46:48,  5.51s/it] 48%|████▊     | 471/980 [41:57<44:44,  5.27s/it] 48%|████▊     | 472/980 [42:02<42:43,  5.05s/it] 48%|████▊     | 473/980 [42:05<39:15,  4.65s/it] 48%|████▊     | 474/980 [42:11<41:29,  4.92s/it] 48%|████▊     | 475/980 [42:15<39:58,  4.75s/it] 49%|████▊     | 476/980 [42:20<39:34,  4.71s/it] 49%|████▊     | 477/980 [42:25<41:22,  4.93s/it] 49%|████▉     | 478/980 [42:31<42:16,  5.05s/it] 49%|████▉     | 479/980 [42:36<43:02,  5.15s/it] 49%|████▉     | 480/980 [42:41<42:39,  5.12s/it]                                                  49%|████▉     | 480/980 [42:41<42:39,  5.12s/it] 49%|████▉     | 481/980 [42:47<44:25,  5.34s/it] 49%|████▉     | 482/980 [42:52<42:22,  5.11s/it] 49%|████▉     | 483/980 [42:57<44:00,  5.31s/it] 49%|████▉     | 484/980 [43:03<43:32,  5.27s/it] 49%|████▉     | 485/980 [43:08<43:46,  5.31s/it] 50%|████▉     | 486/980 [43:14<45:25,  5.52s/it] 50%|████▉     | 487/980 [43:18<42:44,  5.20s/it] 50%|████▉     | 488/980 [43:23<40:22,  4.92s/it] 50%|████▉     | 489/980 [43:28<40:08,  4.91s/it] 50%|█████     | 490/980 [43:32<39:39,  4.86s/it]                                                  50%|█████     | 490/980 [43:32<39:39,  4.86s/it] 50%|█████     | 491/980 [43:37<38:59,  4.78s/it] 50%|█████     | 492/980 [43:42<40:16,  4.95s/it] 50%|█████     | 493/980 [43:48<41:30,  5.11s/it] 50%|█████     | 494/980 [43:53<40:50,  5.04s/it] 51%|█████     | 495/980 [43:57<39:26,  4.88s/it] 51%|█████     | 496/980 [44:02<39:50,  4.94s/it] 51%|█████     | 497/980 [44:08<40:41,  5.06s/it] 51%|█████     | 498/980 [44:13<42:04,  5.24s/it] 51%|█████     | 499/980 [44:18<40:25,  5.04s/it] 51%|█████     | 500/980 [44:22<38:08,  4.77s/it]                                                  51%|█████     | 500/980 [44:22<38:08,  4.77s/it][INFO|trainer.py:4021] 2024-11-06 04:03:25,495 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:03:25,495 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:03:25,495 >>   Batch size = 4
{'eval_loss': 0.14107584953308105, 'eval_runtime': 32.4097, 'eval_samples_per_second': 21.598, 'eval_steps_per_second': 5.4, 'epoch': 2.03}
{'loss': 0.0974, 'grad_norm': 1.1354312896728516, 'learning_rate': 4.387791043683275e-05, 'epoch': 2.08}
{'loss': 0.0889, 'grad_norm': 0.7702850103378296, 'learning_rate': 4.2788232688471e-05, 'epoch': 2.13}
{'loss': 0.0967, 'grad_norm': 1.0324339866638184, 'learning_rate': 4.169055200454803e-05, 'epoch': 2.18}
{'loss': 0.0836, 'grad_norm': 0.8959400057792664, 'learning_rate': 4.058599632616827e-05, 'epoch': 2.23}
{'loss': 0.0908, 'grad_norm': 1.1578104496002197, 'learning_rate': 3.947570065895771e-05, 'epoch': 2.29}
{'loss': 0.1025, 'grad_norm': 0.6697478890419006, 'learning_rate': 3.8360805906768856e-05, 'epoch': 2.34}
{'loss': 0.0952, 'grad_norm': 1.3735157251358032, 'learning_rate': 3.7242457699324954e-05, 'epoch': 2.39}
{'loss': 0.0817, 'grad_norm': 1.0987244844436646, 'learning_rate': 3.612180521500794e-05, 'epoch': 2.44}
{'loss': 0.0736, 'grad_norm': 1.4500689506530762, 'learning_rate': 3.5e-05, 'epoch': 2.49}
{'loss': 0.0948, 'grad_norm': 1.0375465154647827, 'learning_rate': 3.387819478499207e-05, 'epoch': 2.54}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.42it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.32it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.36it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.50it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.39it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.94it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.62it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.42it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.05it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.13it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.05it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.24it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.04it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.72it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:21,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.56it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.26it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:25,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.89it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.49it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.03it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.12it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.58it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.90it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.11it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.88it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.57it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.04it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.62it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.91it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.27it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.32it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.34it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.61it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.23it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.27it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.65it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.39it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.07it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.01it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.56it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.27it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.61it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.77it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.32it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.69it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.71it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.44it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.50it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.60it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.75it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.87it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.66it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.64it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.19it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.20it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.66it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                 
                                                 [A 51%|█████     | 500/980 [44:54<38:08,  4.77s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:03:57,914 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-500
[INFO|configuration_utils.py:673] 2024-11-06 04:03:57,934 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:03:57,935 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:03:58,032 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:03:58,032 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-500/special_tokens_map.json
 51%|█████     | 501/980 [45:00<1:58:40, 14.87s/it] 51%|█████     | 502/980 [45:05<1:34:02, 11.80s/it] 51%|█████▏    | 503/980 [45:11<1:18:41,  9.90s/it] 51%|█████▏    | 504/980 [45:16<1:07:05,  8.46s/it] 52%|█████▏    | 505/980 [45:20<57:59,  7.32s/it]   52%|█████▏    | 506/980 [45:24<48:52,  6.19s/it] 52%|█████▏    | 507/980 [45:28<44:49,  5.69s/it] 52%|█████▏    | 508/980 [45:34<45:21,  5.77s/it] 52%|█████▏    | 509/980 [45:40<45:02,  5.74s/it] 52%|█████▏    | 510/980 [45:45<43:39,  5.57s/it]                                                  52%|█████▏    | 510/980 [45:45<43:39,  5.57s/it] 52%|█████▏    | 511/980 [45:50<41:00,  5.25s/it] 52%|█████▏    | 512/980 [45:55<40:23,  5.18s/it] 52%|█████▏    | 513/980 [46:00<39:31,  5.08s/it] 52%|█████▏    | 514/980 [46:06<42:17,  5.45s/it] 53%|█████▎    | 515/980 [46:11<42:26,  5.48s/it] 53%|█████▎    | 516/980 [46:15<39:11,  5.07s/it] 53%|█████▎    | 517/980 [46:21<39:58,  5.18s/it] 53%|█████▎    | 518/980 [46:27<41:24,  5.38s/it] 53%|█████▎    | 519/980 [46:33<42:21,  5.51s/it] 53%|█████▎    | 520/980 [46:36<38:26,  5.01s/it]                                                  53%|█████▎    | 520/980 [46:36<38:26,  5.01s/it] 53%|█████▎    | 521/980 [46:42<39:46,  5.20s/it] 53%|█████▎    | 522/980 [46:47<39:35,  5.19s/it] 53%|█████▎    | 523/980 [46:52<39:14,  5.15s/it] 53%|█████▎    | 524/980 [46:58<40:35,  5.34s/it] 54%|█████▎    | 525/980 [47:03<39:11,  5.17s/it] 54%|█████▎    | 526/980 [47:08<39:28,  5.22s/it] 54%|█████▍    | 527/980 [47:13<38:23,  5.08s/it] 54%|█████▍    | 528/980 [47:18<38:18,  5.08s/it] 54%|█████▍    | 529/980 [47:23<38:50,  5.17s/it] 54%|█████▍    | 530/980 [47:28<37:28,  5.00s/it]                                                  54%|█████▍    | 530/980 [47:28<37:28,  5.00s/it] 54%|█████▍    | 531/980 [47:34<38:43,  5.17s/it] 54%|█████▍    | 532/980 [47:39<38:57,  5.22s/it] 54%|█████▍    | 533/980 [47:44<37:53,  5.09s/it] 54%|█████▍    | 534/980 [47:48<37:07,  4.99s/it] 55%|█████▍    | 535/980 [47:53<36:36,  4.94s/it] 55%|█████▍    | 536/980 [47:59<37:20,  5.05s/it] 55%|█████▍    | 537/980 [48:04<37:37,  5.10s/it] 55%|█████▍    | 538/980 [48:08<34:53,  4.74s/it] 55%|█████▌    | 539/980 [48:12<34:44,  4.73s/it] 55%|█████▌    | 540/980 [48:17<35:17,  4.81s/it]                                                  55%|█████▌    | 540/980 [48:17<35:17,  4.81s/it] 55%|█████▌    | 541/980 [48:22<34:14,  4.68s/it] 55%|█████▌    | 542/980 [48:27<35:48,  4.91s/it] 55%|█████▌    | 543/980 [48:33<38:10,  5.24s/it] 56%|█████▌    | 544/980 [48:38<37:56,  5.22s/it] 56%|█████▌    | 545/980 [48:43<36:14,  5.00s/it] 56%|█████▌    | 546/980 [48:47<34:43,  4.80s/it] 56%|█████▌    | 547/980 [48:52<34:05,  4.72s/it] 56%|█████▌    | 548/980 [48:56<33:19,  4.63s/it] 56%|█████▌    | 549/980 [49:01<34:08,  4.75s/it] 56%|█████▌    | 550/980 [49:07<35:29,  4.95s/it]                                                  56%|█████▌    | 550/980 [49:07<35:29,  4.95s/it] 56%|█████▌    | 551/980 [49:11<34:04,  4.77s/it] 56%|█████▋    | 552/980 [49:16<35:37,  4.99s/it] 56%|█████▋    | 553/980 [49:22<36:44,  5.16s/it] 57%|█████▋    | 554/980 [49:27<35:33,  5.01s/it] 57%|█████▋    | 555/980 [49:31<34:33,  4.88s/it] 57%|█████▋    | 556/980 [49:36<34:10,  4.84s/it] 57%|█████▋    | 557/980 [49:41<34:20,  4.87s/it] 57%|█████▋    | 558/980 [49:46<33:43,  4.79s/it] 57%|█████▋    | 559/980 [49:50<33:51,  4.83s/it] 57%|█████▋    | 560/980 [49:55<33:09,  4.74s/it]                                                  57%|█████▋    | 560/980 [49:55<33:09,  4.74s/it] 57%|█████▋    | 561/980 [50:00<33:44,  4.83s/it] 57%|█████▋    | 562/980 [50:06<36:17,  5.21s/it] 57%|█████▋    | 563/980 [50:11<34:49,  5.01s/it] 58%|█████▊    | 564/980 [50:17<37:46,  5.45s/it] 58%|█████▊    | 565/980 [50:21<34:43,  5.02s/it] 58%|█████▊    | 566/980 [50:26<34:16,  4.97s/it] 58%|█████▊    | 567/980 [50:30<32:50,  4.77s/it] 58%|█████▊    | 568/980 [50:35<31:55,  4.65s/it] 58%|█████▊    | 569/980 [50:40<33:42,  4.92s/it] 58%|█████▊    | 570/980 [50:46<35:27,  5.19s/it]                                                  58%|█████▊    | 570/980 [50:46<35:27,  5.19s/it] 58%|█████▊    | 571/980 [50:51<34:29,  5.06s/it] 58%|█████▊    | 572/980 [50:56<33:41,  4.95s/it] 58%|█████▊    | 573/980 [51:00<33:06,  4.88s/it] 59%|█████▊    | 574/980 [51:05<32:48,  4.85s/it] 59%|█████▊    | 575/980 [51:10<33:10,  4.91s/it] 59%|█████▉    | 576/980 [51:15<33:12,  4.93s/it] 59%|█████▉    | 577/980 [51:20<33:49,  5.04s/it] 59%|█████▉    | 578/980 [51:25<33:43,  5.03s/it] 59%|█████▉    | 579/980 [51:30<33:08,  4.96s/it] 59%|█████▉    | 580/980 [51:35<32:50,  4.93s/it]                                                  59%|█████▉    | 580/980 [51:35<32:50,  4.93s/it] 59%|█████▉    | 581/980 [51:40<32:25,  4.88s/it] 59%|█████▉    | 582/980 [51:45<32:21,  4.88s/it] 59%|█████▉    | 583/980 [51:51<35:05,  5.30s/it] 60%|█████▉    | 584/980 [51:57<35:40,  5.40s/it] 60%|█████▉    | 585/980 [52:02<35:40,  5.42s/it] 60%|█████▉    | 586/980 [52:08<36:31,  5.56s/it] 60%|█████▉    | 587/980 [52:13<35:23,  5.40s/it] 60%|██████    | 588/980 [52:18<35:15,  5.40s/it] 60%|██████    | 589/980 [52:24<35:06,  5.39s/it] 60%|██████    | 590/980 [52:29<34:04,  5.24s/it]                                                  60%|██████    | 590/980 [52:29<34:04,  5.24s/it] 60%|██████    | 591/980 [52:33<31:29,  4.86s/it] 60%|██████    | 592/980 [52:38<32:31,  5.03s/it] 61%|██████    | 593/980 [52:44<34:55,  5.41s/it] 61%|██████    | 594/980 [52:49<34:18,  5.33s/it] 61%|██████    | 595/980 [52:54<33:23,  5.20s/it] 61%|██████    | 596/980 [52:59<31:22,  4.90s/it] 61%|██████    | 597/980 [53:04<31:27,  4.93s/it] 61%|██████    | 598/980 [53:08<30:44,  4.83s/it] 61%|██████    | 599/980 [53:13<30:11,  4.75s/it] 61%|██████    | 600/980 [53:17<29:18,  4.63s/it]                                                  61%|██████    | 600/980 [53:17<29:18,  4.63s/it][INFO|trainer.py:4021] 2024-11-06 04:12:20,577 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:12:20,578 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:12:20,578 >>   Batch size = 4
{'eval_loss': 0.12004664540290833, 'eval_runtime': 32.4187, 'eval_samples_per_second': 21.592, 'eval_steps_per_second': 5.398, 'epoch': 2.54}
{'loss': 0.0947, 'grad_norm': 1.462143898010254, 'learning_rate': 3.275754230067505e-05, 'epoch': 2.59}
{'loss': 0.0784, 'grad_norm': 1.159787654876709, 'learning_rate': 3.163919409323114e-05, 'epoch': 2.64}
{'loss': 0.0745, 'grad_norm': 1.1304287910461426, 'learning_rate': 3.0524299341042284e-05, 'epoch': 2.69}
{'loss': 0.0828, 'grad_norm': 1.76326322555542, 'learning_rate': 2.9414003673831733e-05, 'epoch': 2.74}
{'loss': 0.0871, 'grad_norm': 1.0278974771499634, 'learning_rate': 2.8309447995451973e-05, 'epoch': 2.79}
{'loss': 0.0909, 'grad_norm': 0.9173547625541687, 'learning_rate': 2.7211767311528996e-05, 'epoch': 2.84}
{'loss': 0.0764, 'grad_norm': 1.072872281074524, 'learning_rate': 2.6122089563167245e-05, 'epoch': 2.9}
{'loss': 0.0757, 'grad_norm': 1.4463225603103638, 'learning_rate': 2.5041534467913865e-05, 'epoch': 2.95}
{'loss': 0.0726, 'grad_norm': 1.0443613529205322, 'learning_rate': 2.3971212369173274e-05, 'epoch': 3.0}
{'loss': 0.0575, 'grad_norm': 1.2063688039779663, 'learning_rate': 2.2912223095254235e-05, 'epoch': 3.05}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.41it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.33it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.36it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.98it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.37it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.94it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:39,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.78it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.41it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.04it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.12it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.60it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.24it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.04it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.15it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.22it/s][A
 22%|██▏       | 38/175 [00:06<00:22,  5.97it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.03it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.72it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.13it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.62it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.22it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.55it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.26it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.32it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:25,  4.88it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.89it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.28it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.42it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.03it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.11it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.57it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.12it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.77it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.88it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.56it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.04it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.02it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.60it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.44it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.14it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.36it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.85it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.45it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.39it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.58it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.56it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.62it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.72it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.44it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.50it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.60it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.75it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.87it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.66it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.65it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.19it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.49it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.20it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.11it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.72it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                 
                                                 [A 61%|██████    | 600/980 [53:49<29:18,  4.63s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:12:53,006 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-600
[INFO|configuration_utils.py:673] 2024-11-06 04:12:53,027 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:12:53,027 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:12:53,121 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:12:53,121 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-600/special_tokens_map.json
 61%|██████▏   | 601/980 [53:54<1:30:18, 14.30s/it] 61%|██████▏   | 602/980 [53:59<1:12:45, 11.55s/it] 62%|██████▏   | 603/980 [54:04<1:00:29,  9.63s/it] 62%|██████▏   | 604/980 [54:09<52:10,  8.33s/it]   62%|██████▏   | 605/980 [54:15<46:53,  7.50s/it] 62%|██████▏   | 606/980 [54:19<40:47,  6.54s/it] 62%|██████▏   | 607/980 [54:24<37:54,  6.10s/it] 62%|██████▏   | 608/980 [54:30<36:18,  5.86s/it] 62%|██████▏   | 609/980 [54:35<34:27,  5.57s/it] 62%|██████▏   | 610/980 [54:40<34:42,  5.63s/it]                                                  62%|██████▏   | 610/980 [54:40<34:42,  5.63s/it] 62%|██████▏   | 611/980 [54:46<34:28,  5.60s/it] 62%|██████▏   | 612/980 [54:52<34:26,  5.61s/it] 63%|██████▎   | 613/980 [54:56<32:17,  5.28s/it] 63%|██████▎   | 614/980 [55:00<29:37,  4.86s/it] 63%|██████▎   | 615/980 [55:04<28:54,  4.75s/it] 63%|██████▎   | 616/980 [55:09<29:00,  4.78s/it] 63%|██████▎   | 617/980 [55:15<29:43,  4.91s/it] 63%|██████▎   | 618/980 [55:19<28:38,  4.75s/it] 63%|██████▎   | 619/980 [55:24<29:07,  4.84s/it] 63%|██████▎   | 620/980 [55:28<27:54,  4.65s/it]                                                  63%|██████▎   | 620/980 [55:28<27:54,  4.65s/it] 63%|██████▎   | 621/980 [55:33<29:04,  4.86s/it] 63%|██████▎   | 622/980 [55:40<31:09,  5.22s/it] 64%|██████▎   | 623/980 [55:46<32:24,  5.45s/it] 64%|██████▎   | 624/980 [55:50<30:10,  5.08s/it] 64%|██████▍   | 625/980 [55:55<30:32,  5.16s/it] 64%|██████▍   | 626/980 [56:00<29:52,  5.06s/it] 64%|██████▍   | 627/980 [56:04<28:49,  4.90s/it] 64%|██████▍   | 628/980 [56:09<28:56,  4.93s/it] 64%|██████▍   | 629/980 [56:16<31:29,  5.38s/it] 64%|██████▍   | 630/980 [56:21<30:20,  5.20s/it]                                                  64%|██████▍   | 630/980 [56:21<30:20,  5.20s/it] 64%|██████▍   | 631/980 [56:26<29:43,  5.11s/it] 64%|██████▍   | 632/980 [56:31<30:05,  5.19s/it] 65%|██████▍   | 633/980 [56:35<28:42,  4.96s/it] 65%|██████▍   | 634/980 [56:40<28:48,  4.99s/it] 65%|██████▍   | 635/980 [56:46<29:31,  5.14s/it] 65%|██████▍   | 636/980 [56:51<28:33,  4.98s/it] 65%|██████▌   | 637/980 [56:56<29:40,  5.19s/it] 65%|██████▌   | 638/980 [57:00<27:51,  4.89s/it] 65%|██████▌   | 639/980 [57:05<27:33,  4.85s/it] 65%|██████▌   | 640/980 [57:10<27:36,  4.87s/it]                                                  65%|██████▌   | 640/980 [57:10<27:36,  4.87s/it] 65%|██████▌   | 641/980 [57:15<27:39,  4.89s/it] 66%|██████▌   | 642/980 [57:20<26:52,  4.77s/it] 66%|██████▌   | 643/980 [57:25<27:34,  4.91s/it] 66%|██████▌   | 644/980 [57:30<28:19,  5.06s/it] 66%|██████▌   | 645/980 [57:36<29:02,  5.20s/it] 66%|██████▌   | 646/980 [57:41<29:53,  5.37s/it] 66%|██████▌   | 647/980 [57:46<29:09,  5.26s/it] 66%|██████▌   | 648/980 [57:51<28:01,  5.06s/it] 66%|██████▌   | 649/980 [57:57<28:44,  5.21s/it] 66%|██████▋   | 650/980 [58:02<29:45,  5.41s/it]                                                  66%|██████▋   | 650/980 [58:02<29:45,  5.41s/it] 66%|██████▋   | 651/980 [58:08<29:03,  5.30s/it] 67%|██████▋   | 652/980 [58:12<28:20,  5.18s/it] 67%|██████▋   | 653/980 [58:18<28:11,  5.17s/it] 67%|██████▋   | 654/980 [58:23<28:04,  5.17s/it] 67%|██████▋   | 655/980 [58:28<27:31,  5.08s/it] 67%|██████▋   | 656/980 [58:33<28:32,  5.29s/it] 67%|██████▋   | 657/980 [58:39<28:15,  5.25s/it] 67%|██████▋   | 658/980 [58:43<27:39,  5.15s/it] 67%|██████▋   | 659/980 [58:48<27:11,  5.08s/it] 67%|██████▋   | 660/980 [58:54<27:10,  5.10s/it]                                                  67%|██████▋   | 660/980 [58:54<27:10,  5.10s/it] 67%|██████▋   | 661/980 [58:58<26:13,  4.93s/it] 68%|██████▊   | 662/980 [59:03<26:54,  5.08s/it] 68%|██████▊   | 663/980 [59:09<27:03,  5.12s/it] 68%|██████▊   | 664/980 [59:14<27:31,  5.23s/it] 68%|██████▊   | 665/980 [59:19<26:59,  5.14s/it] 68%|██████▊   | 666/980 [59:24<26:37,  5.09s/it] 68%|██████▊   | 667/980 [59:29<25:29,  4.89s/it] 68%|██████▊   | 668/980 [59:34<25:43,  4.95s/it] 68%|██████▊   | 669/980 [59:39<25:37,  4.94s/it] 68%|██████▊   | 670/980 [59:42<23:43,  4.59s/it]                                                  68%|██████▊   | 670/980 [59:42<23:43,  4.59s/it] 68%|██████▊   | 671/980 [59:47<23:17,  4.52s/it] 69%|██████▊   | 672/980 [59:51<22:12,  4.33s/it] 69%|██████▊   | 673/980 [59:56<24:24,  4.77s/it] 69%|██████▉   | 674/980 [1:00:01<24:36,  4.83s/it] 69%|██████▉   | 675/980 [1:00:06<24:15,  4.77s/it] 69%|██████▉   | 676/980 [1:00:10<23:37,  4.66s/it] 69%|██████▉   | 677/980 [1:00:15<23:10,  4.59s/it] 69%|██████▉   | 678/980 [1:00:19<22:35,  4.49s/it] 69%|██████▉   | 679/980 [1:00:24<23:24,  4.67s/it] 69%|██████▉   | 680/980 [1:00:28<22:26,  4.49s/it]                                                    69%|██████▉   | 680/980 [1:00:28<22:26,  4.49s/it] 69%|██████▉   | 681/980 [1:00:32<21:18,  4.28s/it] 70%|██████▉   | 682/980 [1:00:36<21:23,  4.31s/it] 70%|██████▉   | 683/980 [1:00:42<22:45,  4.60s/it] 70%|██████▉   | 684/980 [1:00:47<23:15,  4.71s/it] 70%|██████▉   | 685/980 [1:00:51<23:19,  4.74s/it] 70%|███████   | 686/980 [1:00:57<24:41,  5.04s/it] 70%|███████   | 687/980 [1:01:02<24:11,  4.95s/it] 70%|███████   | 688/980 [1:01:08<25:13,  5.18s/it] 70%|███████   | 689/980 [1:01:13<26:04,  5.38s/it] 70%|███████   | 690/980 [1:01:18<24:24,  5.05s/it]                                                    70%|███████   | 690/980 [1:01:18<24:24,  5.05s/it] 71%|███████   | 691/980 [1:01:22<23:40,  4.91s/it] 71%|███████   | 692/980 [1:01:27<23:44,  4.95s/it] 71%|███████   | 693/980 [1:01:31<22:24,  4.69s/it] 71%|███████   | 694/980 [1:01:37<23:54,  5.02s/it] 71%|███████   | 695/980 [1:01:43<25:07,  5.29s/it] 71%|███████   | 696/980 [1:01:48<24:25,  5.16s/it] 71%|███████   | 697/980 [1:01:52<22:49,  4.84s/it] 71%|███████   | 698/980 [1:01:57<22:19,  4.75s/it] 71%|███████▏  | 699/980 [1:02:02<22:26,  4.79s/it] 71%|███████▏  | 700/980 [1:02:07<22:59,  4.93s/it]                                                    71%|███████▏  | 700/980 [1:02:07<22:59,  4.93s/it][INFO|trainer.py:4021] 2024-11-06 04:21:10,287 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:21:10,287 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:21:10,287 >>   Batch size = 4
{'eval_loss': 0.10930611938238144, 'eval_runtime': 32.4285, 'eval_samples_per_second': 21.586, 'eval_steps_per_second': 5.396, 'epoch': 3.05}
{'loss': 0.054, 'grad_norm': 0.7829604148864746, 'learning_rate': 2.186565482922191e-05, 'epoch': 3.1}
{'loss': 0.0564, 'grad_norm': 0.715649425983429, 'learning_rate': 2.0832582990716215e-05, 'epoch': 3.15}
{'loss': 0.0561, 'grad_norm': 1.0185226202011108, 'learning_rate': 1.9814069130885465e-05, 'epoch': 3.2}
{'loss': 0.0492, 'grad_norm': 0.9318780899047852, 'learning_rate': 1.8811159841570772e-05, 'epoch': 3.25}
{'loss': 0.0509, 'grad_norm': 0.8420972228050232, 'learning_rate': 1.7824885679862184e-05, 'epoch': 3.3}
{'loss': 0.0476, 'grad_norm': 0.8661243915557861, 'learning_rate': 1.685626010913162e-05, 'epoch': 3.35}
{'loss': 0.0549, 'grad_norm': 1.1546326875686646, 'learning_rate': 1.5906278457630797e-05, 'epoch': 3.4}
{'loss': 0.0709, 'grad_norm': 0.9422935843467712, 'learning_rate': 1.4975916895724068e-05, 'epoch': 3.45}
{'loss': 0.0498, 'grad_norm': 0.8970642685890198, 'learning_rate': 1.406613143280744e-05, 'epoch': 3.5}
{'loss': 0.0492, 'grad_norm': 0.8306079506874084, 'learning_rate': 1.3177856934944328e-05, 'epoch': 3.56}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.67it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.39it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.31it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.52it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.38it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:27,  5.92it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.05it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.01it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.25it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.63it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.92it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.69it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.59it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.90it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.76it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.58it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.12it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.53it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.57it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.00it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.44it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.87it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.26it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.14it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.30it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.32it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.33it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.84it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.03it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.58it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.21it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.82it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.35it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.85it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.59it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.21it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.25it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.63it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.39it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.15it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.58it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.46it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.25it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.61it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.32it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.60it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.22it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.48it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.34it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.32it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.74it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.46it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.42it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.76it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.07it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.89it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.70it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.39it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.48it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.20it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.11it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.20it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.16it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.89it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 71%|███████▏  | 700/980 [1:02:39<22:59,  4.93s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:21:42,718 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-700
[INFO|configuration_utils.py:673] 2024-11-06 04:21:42,738 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:21:42,739 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:21:42,832 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:21:42,832 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-700/special_tokens_map.json
 72%|███████▏  | 701/980 [1:02:45<1:09:48, 15.01s/it] 72%|███████▏  | 702/980 [1:02:52<57:46, 12.47s/it]   72%|███████▏  | 703/980 [1:02:57<47:31, 10.30s/it] 72%|███████▏  | 704/980 [1:03:02<40:06,  8.72s/it] 72%|███████▏  | 705/980 [1:03:07<34:13,  7.47s/it] 72%|███████▏  | 706/980 [1:03:12<31:23,  6.87s/it] 72%|███████▏  | 707/980 [1:03:17<28:14,  6.21s/it] 72%|███████▏  | 708/980 [1:03:22<27:14,  6.01s/it] 72%|███████▏  | 709/980 [1:03:28<26:22,  5.84s/it] 72%|███████▏  | 710/980 [1:03:33<24:49,  5.52s/it]                                                    72%|███████▏  | 710/980 [1:03:33<24:49,  5.52s/it] 73%|███████▎  | 711/980 [1:03:38<24:15,  5.41s/it] 73%|███████▎  | 712/980 [1:03:43<23:53,  5.35s/it] 73%|███████▎  | 713/980 [1:03:48<23:03,  5.18s/it] 73%|███████▎  | 714/980 [1:03:54<23:47,  5.37s/it] 73%|███████▎  | 715/980 [1:03:59<23:52,  5.40s/it] 73%|███████▎  | 716/980 [1:04:04<22:52,  5.20s/it] 73%|███████▎  | 717/980 [1:04:09<22:52,  5.22s/it] 73%|███████▎  | 718/980 [1:04:14<22:35,  5.18s/it] 73%|███████▎  | 719/980 [1:04:18<21:01,  4.83s/it] 73%|███████▎  | 720/980 [1:04:23<21:24,  4.94s/it]                                                    73%|███████▎  | 720/980 [1:04:23<21:24,  4.94s/it] 74%|███████▎  | 721/980 [1:04:28<21:16,  4.93s/it] 74%|███████▎  | 722/980 [1:04:34<21:51,  5.09s/it] 74%|███████▍  | 723/980 [1:04:38<21:15,  4.96s/it] 74%|███████▍  | 724/980 [1:04:43<21:03,  4.93s/it] 74%|███████▍  | 725/980 [1:04:48<21:17,  5.01s/it] 74%|███████▍  | 726/980 [1:04:52<19:26,  4.59s/it] 74%|███████▍  | 727/980 [1:04:56<18:53,  4.48s/it] 74%|███████▍  | 728/980 [1:05:01<19:40,  4.68s/it] 74%|███████▍  | 729/980 [1:05:06<19:34,  4.68s/it] 74%|███████▍  | 730/980 [1:05:11<19:22,  4.65s/it]                                                    74%|███████▍  | 730/980 [1:05:11<19:22,  4.65s/it] 75%|███████▍  | 731/980 [1:05:16<20:19,  4.90s/it] 75%|███████▍  | 732/980 [1:05:22<21:36,  5.23s/it] 75%|███████▍  | 733/980 [1:05:27<21:14,  5.16s/it] 75%|███████▍  | 734/980 [1:05:33<21:59,  5.36s/it] 75%|███████▌  | 735/980 [1:05:39<23:01,  5.64s/it] 75%|███████▌  | 736/980 [1:05:44<21:22,  5.26s/it] 75%|███████▌  | 737/980 [1:05:49<20:57,  5.18s/it] 75%|███████▌  | 738/980 [1:05:53<20:12,  5.01s/it] 75%|███████▌  | 739/980 [1:05:58<19:33,  4.87s/it] 76%|███████▌  | 740/980 [1:06:03<19:21,  4.84s/it]                                                    76%|███████▌  | 740/980 [1:06:03<19:21,  4.84s/it] 76%|███████▌  | 741/980 [1:06:08<19:47,  4.97s/it] 76%|███████▌  | 742/980 [1:06:13<20:03,  5.06s/it] 76%|███████▌  | 743/980 [1:06:18<19:34,  4.96s/it] 76%|███████▌  | 744/980 [1:06:23<19:44,  5.02s/it] 76%|███████▌  | 745/980 [1:06:28<20:10,  5.15s/it] 76%|███████▌  | 746/980 [1:06:32<18:40,  4.79s/it] 76%|███████▌  | 747/980 [1:06:38<19:47,  5.10s/it] 76%|███████▋  | 748/980 [1:06:45<21:15,  5.50s/it] 76%|███████▋  | 749/980 [1:06:50<21:29,  5.58s/it] 77%|███████▋  | 750/980 [1:06:55<20:08,  5.25s/it]                                                    77%|███████▋  | 750/980 [1:06:55<20:08,  5.25s/it] 77%|███████▋  | 751/980 [1:07:00<19:36,  5.14s/it] 77%|███████▋  | 752/980 [1:07:05<19:46,  5.20s/it] 77%|███████▋  | 753/980 [1:07:10<19:26,  5.14s/it] 77%|███████▋  | 754/980 [1:07:15<19:15,  5.11s/it] 77%|███████▋  | 755/980 [1:07:20<18:37,  4.97s/it] 77%|███████▋  | 756/980 [1:07:26<19:49,  5.31s/it] 77%|███████▋  | 757/980 [1:07:31<19:16,  5.19s/it] 77%|███████▋  | 758/980 [1:07:37<20:21,  5.50s/it] 77%|███████▋  | 759/980 [1:07:42<19:44,  5.36s/it] 78%|███████▊  | 760/980 [1:07:46<18:15,  4.98s/it]                                                    78%|███████▊  | 760/980 [1:07:46<18:15,  4.98s/it] 78%|███████▊  | 761/980 [1:07:51<17:51,  4.89s/it] 78%|███████▊  | 762/980 [1:07:56<17:49,  4.91s/it] 78%|███████▊  | 763/980 [1:08:02<18:42,  5.17s/it] 78%|███████▊  | 764/980 [1:08:07<18:54,  5.25s/it] 78%|███████▊  | 765/980 [1:08:12<18:47,  5.24s/it] 78%|███████▊  | 766/980 [1:08:18<18:55,  5.31s/it] 78%|███████▊  | 767/980 [1:08:23<19:13,  5.42s/it] 78%|███████▊  | 768/980 [1:08:29<19:50,  5.62s/it] 78%|███████▊  | 769/980 [1:08:35<19:53,  5.66s/it] 79%|███████▊  | 770/980 [1:08:40<18:47,  5.37s/it]                                                    79%|███████▊  | 770/980 [1:08:40<18:47,  5.37s/it] 79%|███████▊  | 771/980 [1:08:44<17:49,  5.12s/it] 79%|███████▉  | 772/980 [1:08:48<16:28,  4.75s/it] 79%|███████▉  | 773/980 [1:08:54<17:48,  5.16s/it] 79%|███████▉  | 774/980 [1:08:58<16:36,  4.84s/it] 79%|███████▉  | 775/980 [1:09:04<17:02,  4.99s/it] 79%|███████▉  | 776/980 [1:09:09<17:06,  5.03s/it] 79%|███████▉  | 777/980 [1:09:14<17:22,  5.14s/it] 79%|███████▉  | 778/980 [1:09:20<17:22,  5.16s/it] 79%|███████▉  | 779/980 [1:09:24<16:53,  5.04s/it] 80%|███████▉  | 780/980 [1:09:29<16:50,  5.05s/it]                                                    80%|███████▉  | 780/980 [1:09:29<16:50,  5.05s/it] 80%|███████▉  | 781/980 [1:09:34<16:46,  5.06s/it] 80%|███████▉  | 782/980 [1:09:39<16:38,  5.04s/it] 80%|███████▉  | 783/980 [1:09:45<17:10,  5.23s/it] 80%|████████  | 784/980 [1:09:49<16:11,  4.96s/it] 80%|████████  | 785/980 [1:09:55<16:45,  5.16s/it] 80%|████████  | 786/980 [1:10:01<17:21,  5.37s/it] 80%|████████  | 787/980 [1:10:06<17:06,  5.32s/it] 80%|████████  | 788/980 [1:10:10<15:48,  4.94s/it] 81%|████████  | 789/980 [1:10:15<15:28,  4.86s/it] 81%|████████  | 790/980 [1:10:20<15:50,  5.01s/it]                                                    81%|████████  | 790/980 [1:10:20<15:50,  5.01s/it] 81%|████████  | 791/980 [1:10:26<16:56,  5.38s/it] 81%|████████  | 792/980 [1:10:31<16:32,  5.28s/it] 81%|████████  | 793/980 [1:10:36<15:37,  5.01s/it] 81%|████████  | 794/980 [1:10:41<15:25,  4.98s/it] 81%|████████  | 795/980 [1:10:45<14:53,  4.83s/it] 81%|████████  | 796/980 [1:10:50<14:41,  4.79s/it] 81%|████████▏ | 797/980 [1:10:55<15:07,  4.96s/it] 81%|████████▏ | 798/980 [1:11:01<15:28,  5.10s/it] 82%|████████▏ | 799/980 [1:11:06<15:43,  5.21s/it] 82%|████████▏ | 800/980 [1:11:12<15:43,  5.24s/it]                                                    82%|████████▏ | 800/980 [1:11:12<15:43,  5.24s/it][INFO|trainer.py:4021] 2024-11-06 04:30:15,043 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:30:15,043 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:30:15,043 >>   Batch size = 4
{'eval_loss': 0.10398153960704803, 'eval_runtime': 32.4307, 'eval_samples_per_second': 21.584, 'eval_steps_per_second': 5.396, 'epoch': 3.56}
{'loss': 0.0499, 'grad_norm': 0.9276307821273804, 'learning_rate': 1.2312006164227411e-05, 'epoch': 3.61}
{'loss': 0.0514, 'grad_norm': 0.7469398379325867, 'learning_rate': 1.1469468840853908e-05, 'epoch': 3.66}
{'loss': 0.0505, 'grad_norm': 1.1852271556854248, 'learning_rate': 1.0651110728877976e-05, 'epoch': 3.71}
{'loss': 0.0633, 'grad_norm': 1.1055259704589844, 'learning_rate': 9.857772746579536e-06, 'epoch': 3.76}
{'loss': 0.0525, 'grad_norm': 1.3678661584854126, 'learning_rate': 9.09027010236396e-06, 'epoch': 3.81}
{'loss': 0.053, 'grad_norm': 1.0973938703536987, 'learning_rate': 8.349391457080295e-06, 'epoch': 3.86}
{'loss': 0.0519, 'grad_norm': 1.3634215593338013, 'learning_rate': 7.635898113618957e-06, 'epoch': 3.91}
{'loss': 0.0535, 'grad_norm': 0.818439245223999, 'learning_rate': 6.9505232346215214e-06, 'epoch': 3.96}
{'loss': 0.0426, 'grad_norm': 0.8648288249969482, 'learning_rate': 6.2939710891065405e-06, 'epoch': 4.01}
{'loss': 0.0366, 'grad_norm': 0.6871472001075745, 'learning_rate': 5.666916328785579e-06, 'epoch': 4.06}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.39it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.32it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.34it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.48it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.98it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.09it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.51it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.38it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.72it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.70it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.78it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.61it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.22it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.00it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.80it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.25it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.63it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.92it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.17it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.20it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.69it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.59it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.90it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.76it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.43it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.77it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.12it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.57it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.91it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.12it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.52it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.76it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.89it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.90it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.28it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.45it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.81it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.27it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.63it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.55it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.33it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.35it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.86it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s][A
 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.60it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.22it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.26it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.46it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.48it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.07it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.70it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.63it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.13it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.49it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.72it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.33it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.50it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.31it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.72it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.45it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.61it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.41it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.74it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.62it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.91it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.75it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.06it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.95it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.87it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.06it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.67it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.19it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.24it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.72it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.40it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.22it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.13it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.07it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.88it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.90it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.60it/s][A                                                   
                                                 [A 82%|████████▏ | 800/980 [1:11:44<15:43,  5.24s/it]
100%|██████████| 175/175 [00:32<00:00,  4.60it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:30:47,458 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-800
[INFO|configuration_utils.py:673] 2024-11-06 04:30:47,478 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:30:47,479 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:30:47,560 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:30:47,561 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-800/special_tokens_map.json
 82%|████████▏ | 801/980 [1:11:49<44:51, 15.04s/it] 82%|████████▏ | 802/980 [1:11:55<36:00, 12.14s/it] 82%|████████▏ | 803/980 [1:12:01<30:09, 10.23s/it] 82%|████████▏ | 804/980 [1:12:05<24:54,  8.49s/it] 82%|████████▏ | 805/980 [1:12:10<21:31,  7.38s/it] 82%|████████▏ | 806/980 [1:12:16<20:00,  6.90s/it] 82%|████████▏ | 807/980 [1:12:20<17:23,  6.03s/it] 82%|████████▏ | 808/980 [1:12:25<16:28,  5.75s/it] 83%|████████▎ | 809/980 [1:12:30<16:17,  5.72s/it] 83%|████████▎ | 810/980 [1:12:34<14:54,  5.26s/it]                                                    83%|████████▎ | 810/980 [1:12:34<14:54,  5.26s/it] 83%|████████▎ | 811/980 [1:12:39<14:27,  5.13s/it] 83%|████████▎ | 812/980 [1:12:45<14:47,  5.28s/it] 83%|████████▎ | 813/980 [1:12:49<13:22,  4.81s/it] 83%|████████▎ | 814/980 [1:12:54<14:02,  5.07s/it] 83%|████████▎ | 815/980 [1:12:58<13:01,  4.73s/it] 83%|████████▎ | 816/980 [1:13:04<14:00,  5.12s/it] 83%|████████▎ | 817/980 [1:13:09<13:32,  4.99s/it] 83%|████████▎ | 818/980 [1:13:14<13:49,  5.12s/it] 84%|████████▎ | 819/980 [1:13:21<14:34,  5.43s/it] 84%|████████▎ | 820/980 [1:13:25<13:43,  5.15s/it]                                                    84%|████████▎ | 820/980 [1:13:25<13:43,  5.15s/it] 84%|████████▍ | 821/980 [1:13:29<12:55,  4.87s/it] 84%|████████▍ | 822/980 [1:13:34<12:28,  4.74s/it] 84%|████████▍ | 823/980 [1:13:39<12:37,  4.83s/it] 84%|████████▍ | 824/980 [1:13:44<13:14,  5.10s/it] 84%|████████▍ | 825/980 [1:13:49<12:47,  4.95s/it] 84%|████████▍ | 826/980 [1:13:54<12:23,  4.83s/it] 84%|████████▍ | 827/980 [1:13:58<12:05,  4.74s/it] 84%|████████▍ | 828/980 [1:14:04<12:48,  5.06s/it] 85%|████████▍ | 829/980 [1:14:09<12:30,  4.97s/it] 85%|████████▍ | 830/980 [1:14:14<12:34,  5.03s/it]                                                    85%|████████▍ | 830/980 [1:14:14<12:34,  5.03s/it] 85%|████████▍ | 831/980 [1:14:19<12:22,  4.99s/it] 85%|████████▍ | 832/980 [1:14:24<12:19,  4.99s/it] 85%|████████▌ | 833/980 [1:14:31<13:33,  5.53s/it] 85%|████████▌ | 834/980 [1:14:36<13:29,  5.54s/it] 85%|████████▌ | 835/980 [1:14:42<13:23,  5.54s/it] 85%|████████▌ | 836/980 [1:14:46<12:28,  5.20s/it] 85%|████████▌ | 837/980 [1:14:51<12:21,  5.19s/it] 86%|████████▌ | 838/980 [1:14:57<12:24,  5.24s/it] 86%|████████▌ | 839/980 [1:15:00<11:11,  4.77s/it] 86%|████████▌ | 840/980 [1:15:07<12:12,  5.23s/it]                                                    86%|████████▌ | 840/980 [1:15:07<12:12,  5.23s/it] 86%|████████▌ | 841/980 [1:15:12<12:07,  5.23s/it] 86%|████████▌ | 842/980 [1:15:16<11:17,  4.91s/it] 86%|████████▌ | 843/980 [1:15:21<10:58,  4.81s/it] 86%|████████▌ | 844/980 [1:15:25<10:23,  4.59s/it] 86%|████████▌ | 845/980 [1:15:29<09:58,  4.43s/it] 86%|████████▋ | 846/980 [1:15:35<10:54,  4.88s/it] 86%|████████▋ | 847/980 [1:15:39<10:42,  4.83s/it] 87%|████████▋ | 848/980 [1:15:44<10:35,  4.82s/it] 87%|████████▋ | 849/980 [1:15:50<11:14,  5.15s/it] 87%|████████▋ | 850/980 [1:15:55<10:59,  5.07s/it]                                                    87%|████████▋ | 850/980 [1:15:55<10:59,  5.07s/it] 87%|████████▋ | 851/980 [1:16:00<10:42,  4.98s/it] 87%|████████▋ | 852/980 [1:16:05<10:40,  5.00s/it] 87%|████████▋ | 853/980 [1:16:10<10:48,  5.10s/it] 87%|████████▋ | 854/980 [1:16:17<11:33,  5.50s/it] 87%|████████▋ | 855/980 [1:16:21<11:01,  5.29s/it] 87%|████████▋ | 856/980 [1:16:26<10:30,  5.09s/it] 87%|████████▋ | 857/980 [1:16:31<10:21,  5.05s/it] 88%|████████▊ | 858/980 [1:16:36<10:09,  5.00s/it] 88%|████████▊ | 859/980 [1:16:42<10:33,  5.23s/it] 88%|████████▊ | 860/980 [1:16:47<10:27,  5.23s/it]                                                    88%|████████▊ | 860/980 [1:16:47<10:27,  5.23s/it] 88%|████████▊ | 861/980 [1:16:52<10:13,  5.15s/it] 88%|████████▊ | 862/980 [1:16:57<10:05,  5.13s/it] 88%|████████▊ | 863/980 [1:17:02<09:51,  5.05s/it] 88%|████████▊ | 864/980 [1:17:06<09:27,  4.89s/it] 88%|████████▊ | 865/980 [1:17:11<09:35,  5.00s/it] 88%|████████▊ | 866/980 [1:17:16<09:07,  4.80s/it] 88%|████████▊ | 867/980 [1:17:21<09:19,  4.95s/it] 89%|████████▊ | 868/980 [1:17:27<09:32,  5.11s/it] 89%|████████▊ | 869/980 [1:17:32<09:35,  5.19s/it] 89%|████████▉ | 870/980 [1:17:37<09:36,  5.24s/it]                                                    89%|████████▉ | 870/980 [1:17:37<09:36,  5.24s/it] 89%|████████▉ | 871/980 [1:17:44<10:06,  5.56s/it] 89%|████████▉ | 872/980 [1:17:49<09:57,  5.53s/it] 89%|████████▉ | 873/980 [1:17:55<09:56,  5.58s/it] 89%|████████▉ | 874/980 [1:18:00<09:47,  5.54s/it] 89%|████████▉ | 875/980 [1:18:06<09:44,  5.57s/it] 89%|████████▉ | 876/980 [1:18:12<09:46,  5.64s/it] 89%|████████▉ | 877/980 [1:18:17<09:24,  5.48s/it] 90%|████████▉ | 878/980 [1:18:21<08:37,  5.07s/it] 90%|████████▉ | 879/980 [1:18:25<08:13,  4.88s/it] 90%|████████▉ | 880/980 [1:18:30<08:07,  4.88s/it]                                                    90%|████████▉ | 880/980 [1:18:30<08:07,  4.88s/it] 90%|████████▉ | 881/980 [1:18:34<07:33,  4.58s/it] 90%|█████████ | 882/980 [1:18:40<08:04,  4.94s/it] 90%|█████████ | 883/980 [1:18:45<08:08,  5.03s/it] 90%|█████████ | 884/980 [1:18:49<07:25,  4.64s/it] 90%|█████████ | 885/980 [1:18:54<07:49,  4.94s/it] 90%|█████████ | 886/980 [1:19:00<07:48,  4.99s/it] 91%|█████████ | 887/980 [1:19:04<07:15,  4.68s/it] 91%|█████████ | 888/980 [1:19:08<07:11,  4.69s/it] 91%|█████████ | 889/980 [1:19:14<07:24,  4.89s/it] 91%|█████████ | 890/980 [1:19:19<07:20,  4.90s/it]                                                    91%|█████████ | 890/980 [1:19:19<07:20,  4.90s/it] 91%|█████████ | 891/980 [1:19:22<06:33,  4.42s/it] 91%|█████████ | 892/980 [1:19:27<06:49,  4.65s/it] 91%|█████████ | 893/980 [1:19:31<06:33,  4.52s/it] 91%|█████████ | 894/980 [1:19:36<06:41,  4.67s/it] 91%|█████████▏| 895/980 [1:19:41<06:26,  4.55s/it] 91%|█████████▏| 896/980 [1:19:45<06:11,  4.43s/it] 92%|█████████▏| 897/980 [1:19:50<06:29,  4.69s/it] 92%|█████████▏| 898/980 [1:19:55<06:33,  4.80s/it] 92%|█████████▏| 899/980 [1:19:59<06:10,  4.58s/it] 92%|█████████▏| 900/980 [1:20:03<05:56,  4.46s/it]                                                    92%|█████████▏| 900/980 [1:20:03<05:56,  4.46s/it][INFO|trainer.py:4021] 2024-11-06 04:39:06,796 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:39:06,796 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:39:06,797 >>   Batch size = 4
{'eval_loss': 0.09938124567270279, 'eval_runtime': 32.4142, 'eval_samples_per_second': 21.595, 'eval_steps_per_second': 5.399, 'epoch': 4.06}
{'loss': 0.0405, 'grad_norm': 0.6602109670639038, 'learning_rate': 5.0700032948128865e-06, 'epoch': 4.11}
{'loss': 0.0424, 'grad_norm': 0.9951803684234619, 'learning_rate': 4.5038453556813705e-06, 'epoch': 4.17}
{'loss': 0.04, 'grad_norm': 1.0893232822418213, 'learning_rate': 3.969024276944996e-06, 'epoch': 4.22}
{'loss': 0.0338, 'grad_norm': 0.9878743290901184, 'learning_rate': 3.4660896234153336e-06, 'epoch': 4.27}
{'loss': 0.0387, 'grad_norm': 1.304231882095337, 'learning_rate': 2.9955581944465663e-06, 'epoch': 4.32}
{'loss': 0.0427, 'grad_norm': 0.9386111497879028, 'learning_rate': 2.5579134928892426e-06, 'epoch': 4.37}
{'loss': 0.038, 'grad_norm': 0.8259269595146179, 'learning_rate': 2.1536052282583844e-06, 'epoch': 4.42}
{'loss': 0.0417, 'grad_norm': 1.0735915899276733, 'learning_rate': 1.7830488546265976e-06, 'epoch': 4.47}
{'loss': 0.0465, 'grad_norm': 1.2859842777252197, 'learning_rate': 1.4466251437168797e-06, 'epoch': 4.52}
{'loss': 0.0423, 'grad_norm': 1.106476068496704, 'learning_rate': 1.1446797936339691e-06, 'epoch': 4.57}

  0%|          | 0/175 [00:00<?, ?it/s][A
  1%|          | 2/175 [00:00<00:22,  7.68it/s][A
  2%|▏         | 3/175 [00:00<00:23,  7.40it/s][A
  2%|▏         | 4/175 [00:00<00:23,  7.31it/s][A
  3%|▎         | 5/175 [00:00<00:31,  5.35it/s][A
  3%|▎         | 6/175 [00:00<00:30,  5.49it/s][A
  4%|▍         | 7/175 [00:01<00:28,  5.99it/s][A
  5%|▍         | 8/175 [00:01<00:27,  6.10it/s][A
  5%|▌         | 9/175 [00:01<00:25,  6.51it/s][A
  6%|▌         | 10/175 [00:01<00:30,  5.38it/s][A
  6%|▋         | 11/175 [00:01<00:28,  5.71it/s][A
  7%|▋         | 12/175 [00:02<00:28,  5.69it/s][A
  7%|▋         | 13/175 [00:02<00:29,  5.54it/s][A
  8%|▊         | 14/175 [00:02<00:27,  5.77it/s][A
  9%|▊         | 15/175 [00:02<00:26,  5.93it/s][A
  9%|▉         | 16/175 [00:02<00:31,  5.06it/s][A
 10%|▉         | 17/175 [00:03<00:34,  4.62it/s][A
 10%|█         | 18/175 [00:03<00:37,  4.23it/s][A
 11%|█         | 19/175 [00:03<00:38,  4.01it/s][A
 12%|█▏        | 21/175 [00:03<00:26,  5.81it/s][A
 13%|█▎        | 22/175 [00:03<00:23,  6.43it/s][A
 13%|█▎        | 23/175 [00:04<00:25,  6.06it/s][A
 14%|█▎        | 24/175 [00:04<00:29,  5.14it/s][A
 14%|█▍        | 25/175 [00:04<00:26,  5.61it/s][A
 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s][A
 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s][A
 16%|█▌        | 28/175 [00:04<00:23,  6.25it/s][A
 17%|█▋        | 29/175 [00:05<00:24,  6.05it/s][A
 17%|█▋        | 30/175 [00:05<00:28,  5.14it/s][A
 18%|█▊        | 31/175 [00:05<00:31,  4.54it/s][A
 18%|█▊        | 32/175 [00:05<00:27,  5.14it/s][A
 19%|█▉        | 33/175 [00:05<00:25,  5.64it/s][A
 19%|█▉        | 34/175 [00:06<00:28,  4.92it/s][A
 20%|██        | 35/175 [00:06<00:27,  5.18it/s][A
 21%|██        | 36/175 [00:06<00:26,  5.16it/s][A
 21%|██        | 37/175 [00:06<00:26,  5.21it/s][A
 22%|██▏       | 38/175 [00:06<00:23,  5.95it/s][A
 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s][A
 23%|██▎       | 40/175 [00:07<00:23,  5.70it/s][A
 23%|██▎       | 41/175 [00:07<00:21,  6.10it/s][A
 24%|██▍       | 42/175 [00:07<00:21,  6.16it/s][A
 25%|██▍       | 43/175 [00:07<00:23,  5.60it/s][A
 25%|██▌       | 44/175 [00:07<00:23,  5.69it/s][A
 26%|██▌       | 45/175 [00:08<00:22,  5.91it/s][A
 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s][A
 27%|██▋       | 47/175 [00:08<00:19,  6.58it/s][A
 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s][A
 28%|██▊       | 49/175 [00:08<00:23,  5.34it/s][A
 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s][A
 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s][A
 30%|██▉       | 52/175 [00:09<00:25,  4.77it/s][A
 30%|███       | 53/175 [00:09<00:24,  4.89it/s][A
 31%|███       | 54/175 [00:09<00:24,  4.90it/s][A
 31%|███▏      | 55/175 [00:10<00:26,  4.52it/s][A
 32%|███▏      | 56/175 [00:10<00:27,  4.28it/s][A
 33%|███▎      | 58/175 [00:10<00:21,  5.47it/s][A
 34%|███▎      | 59/175 [00:10<00:21,  5.43it/s][A
 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s][A
 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s][A
 36%|███▌      | 63/175 [00:11<00:18,  6.12it/s][A
 37%|███▋      | 65/175 [00:11<00:16,  6.57it/s][A
 38%|███▊      | 67/175 [00:11<00:14,  7.27it/s][A
 39%|███▉      | 68/175 [00:12<00:15,  6.90it/s][A
 39%|███▉      | 69/175 [00:12<00:14,  7.11it/s][A
 40%|████      | 70/175 [00:12<00:13,  7.51it/s][A
 41%|████      | 71/175 [00:12<00:13,  7.75it/s][A
 41%|████      | 72/175 [00:12<00:17,  5.88it/s][A
 42%|████▏     | 73/175 [00:12<00:19,  5.18it/s][A
 42%|████▏     | 74/175 [00:13<00:17,  5.67it/s][A
 43%|████▎     | 75/175 [00:13<00:17,  5.57it/s][A
 43%|████▎     | 76/175 [00:13<00:20,  4.89it/s][A
 44%|████▍     | 77/175 [00:13<00:22,  4.40it/s][A
 45%|████▍     | 78/175 [00:14<00:23,  4.19it/s][A
 45%|████▌     | 79/175 [00:14<00:22,  4.27it/s][A
 46%|████▌     | 80/175 [00:14<00:23,  4.02it/s][A
 46%|████▋     | 81/175 [00:14<00:23,  4.00it/s][A
 47%|████▋     | 83/175 [00:15<00:16,  5.59it/s][A
 48%|████▊     | 84/175 [00:15<00:16,  5.43it/s][A
 49%|████▊     | 85/175 [00:15<00:18,  4.89it/s][A
 49%|████▉     | 86/175 [00:15<00:18,  4.79it/s][A
 50%|████▉     | 87/175 [00:15<00:18,  4.86it/s][A
 50%|█████     | 88/175 [00:16<00:16,  5.25it/s][A
 51%|█████     | 89/175 [00:16<00:18,  4.62it/s][A
 51%|█████▏    | 90/175 [00:16<00:16,  5.13it/s][A
 52%|█████▏    | 91/175 [00:16<00:18,  4.54it/s][A
 53%|█████▎    | 92/175 [00:16<00:15,  5.29it/s][A
 53%|█████▎    | 93/175 [00:17<00:15,  5.31it/s][A
 54%|█████▎    | 94/175 [00:17<00:15,  5.32it/s][A
 54%|█████▍    | 95/175 [00:17<00:13,  5.84it/s][A
 55%|█████▍    | 96/175 [00:17<00:15,  5.04it/s][A
 55%|█████▌    | 97/175 [00:17<00:17,  4.58it/s][A
 56%|█████▌    | 98/175 [00:18<00:18,  4.21it/s][A
 57%|█████▋    | 99/175 [00:18<00:15,  4.81it/s][A
 57%|█████▋    | 100/175 [00:18<00:17,  4.35it/s][A
 58%|█████▊    | 101/175 [00:18<00:15,  4.85it/s][A
 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s][A
 59%|█████▉    | 103/175 [00:19<00:12,  5.59it/s][A
 59%|█████▉    | 104/175 [00:19<00:11,  6.20it/s][A
 60%|██████    | 105/175 [00:19<00:11,  6.25it/s][A
 61%|██████    | 106/175 [00:19<00:10,  6.64it/s][A
 61%|██████    | 107/175 [00:19<00:12,  5.45it/s][A
 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s][A
 62%|██████▏   | 109/175 [00:20<00:10,  6.16it/s][A
 63%|██████▎   | 110/175 [00:20<00:11,  5.59it/s][A
 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s][A
 64%|██████▍   | 112/175 [00:20<00:11,  5.58it/s][A
 65%|██████▍   | 113/175 [00:20<00:10,  6.09it/s][A
 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s][A
 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s][A
 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s][A
 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s][A
 67%|██████▋   | 118/175 [00:21<00:10,  5.62it/s][A
 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s][A
 69%|██████▊   | 120/175 [00:22<00:12,  4.33it/s][A
 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s][A
 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s][A
 70%|███████   | 123/175 [00:22<00:11,  4.64it/s][A
 71%|███████   | 124/175 [00:23<00:12,  4.24it/s][A
 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s][A
 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s][A
 73%|███████▎  | 127/175 [00:23<00:11,  4.23it/s][A
 73%|███████▎  | 128/175 [00:24<00:10,  4.48it/s][A
 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s][A
 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s][A
 75%|███████▍  | 131/175 [00:24<00:08,  5.34it/s][A
 75%|███████▌  | 132/175 [00:24<00:07,  5.51it/s][A
 77%|███████▋  | 134/175 [00:25<00:06,  6.33it/s][A
 77%|███████▋  | 135/175 [00:25<00:05,  6.74it/s][A
 78%|███████▊  | 136/175 [00:25<00:06,  6.47it/s][A
 79%|███████▉  | 138/175 [00:25<00:04,  7.51it/s][A
 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s][A
 80%|████████  | 140/175 [00:26<00:06,  5.44it/s][A
 81%|████████  | 141/175 [00:26<00:06,  5.43it/s][A
 81%|████████  | 142/175 [00:26<00:06,  4.75it/s][A
 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s][A
 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s][A
 83%|████████▎ | 146/175 [00:27<00:05,  5.76it/s][A
 84%|████████▍ | 147/175 [00:27<00:05,  5.07it/s][A
 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s][A
 86%|████████▌ | 150/175 [00:27<00:04,  5.89it/s][A
 86%|████████▋ | 151/175 [00:27<00:03,  6.08it/s][A
 87%|████████▋ | 152/175 [00:28<00:03,  6.69it/s][A
 87%|████████▋ | 153/175 [00:28<00:03,  6.67it/s][A
 88%|████████▊ | 154/175 [00:28<00:03,  6.21it/s][A
 89%|████████▊ | 155/175 [00:28<00:03,  6.23it/s][A
 89%|████████▉ | 156/175 [00:28<00:02,  6.70it/s][A
 90%|████████▉ | 157/175 [00:28<00:03,  5.38it/s][A
 90%|█████████ | 158/175 [00:29<00:03,  5.48it/s][A
 91%|█████████ | 159/175 [00:29<00:02,  6.19it/s][A
 91%|█████████▏| 160/175 [00:29<00:02,  5.65it/s][A
 92%|█████████▏| 161/175 [00:29<00:02,  6.10it/s][A
 93%|█████████▎| 162/175 [00:29<00:02,  5.19it/s][A
 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s][A
 94%|█████████▎| 164/175 [00:30<00:02,  5.16it/s][A
 94%|█████████▍| 165/175 [00:30<00:01,  5.86it/s][A
 95%|█████████▍| 166/175 [00:30<00:01,  5.63it/s][A
 95%|█████████▌| 167/175 [00:30<00:01,  6.12it/s][A
 96%|█████████▌| 168/175 [00:30<00:01,  5.73it/s][A
 97%|█████████▋| 169/175 [00:31<00:01,  4.89it/s][A
 97%|█████████▋| 170/175 [00:31<00:01,  4.41it/s][A
 98%|█████████▊| 172/175 [00:31<00:00,  5.40it/s][A
 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s][A
 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s][A                                                   
                                                 [A 92%|█████████▏| 900/980 [1:20:36<05:56,  4.46s/it]
100%|██████████| 175/175 [00:32<00:00,  4.59it/s][A
                                                 [A[INFO|trainer.py:3705] 2024-11-06 04:39:39,228 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-900
[INFO|configuration_utils.py:673] 2024-11-06 04:39:39,249 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:39:39,249 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:39:39,334 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:39:39,334 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-900/special_tokens_map.json
 92%|█████████▏| 901/980 [1:20:42<19:31, 14.83s/it] 92%|█████████▏| 902/980 [1:20:47<15:14, 11.72s/it] 92%|█████████▏| 903/980 [1:20:52<12:23,  9.66s/it] 92%|█████████▏| 904/980 [1:20:57<10:28,  8.27s/it] 92%|█████████▏| 905/980 [1:21:02<09:17,  7.43s/it] 92%|█████████▏| 906/980 [1:21:08<08:38,  7.01s/it] 93%|█████████▎| 907/980 [1:21:12<07:24,  6.09s/it] 93%|█████████▎| 908/980 [1:21:17<06:54,  5.76s/it] 93%|█████████▎| 909/980 [1:21:22<06:35,  5.58s/it] 93%|█████████▎| 910/980 [1:21:27<06:22,  5.46s/it]                                                    93%|█████████▎| 910/980 [1:21:27<06:22,  5.46s/it] 93%|█████████▎| 911/980 [1:21:33<06:11,  5.38s/it] 93%|█████████▎| 912/980 [1:21:39<06:16,  5.53s/it] 93%|█████████▎| 913/980 [1:21:44<06:01,  5.40s/it] 93%|█████████▎| 914/980 [1:21:49<05:58,  5.43s/it] 93%|█████████▎| 915/980 [1:21:55<05:55,  5.47s/it] 93%|█████████▎| 916/980 [1:22:00<05:52,  5.50s/it] 94%|█████████▎| 917/980 [1:22:05<05:26,  5.18s/it] 94%|█████████▎| 918/980 [1:22:10<05:25,  5.25s/it] 94%|█████████▍| 919/980 [1:22:14<05:00,  4.93s/it] 94%|█████████▍| 920/980 [1:22:20<05:01,  5.03s/it]                                                    94%|█████████▍| 920/980 [1:22:20<05:01,  5.03s/it] 94%|█████████▍| 921/980 [1:22:25<05:08,  5.23s/it] 94%|█████████▍| 922/980 [1:22:31<05:04,  5.26s/it] 94%|█████████▍| 923/980 [1:22:37<05:15,  5.54s/it] 94%|█████████▍| 924/980 [1:22:43<05:18,  5.68s/it] 94%|█████████▍| 925/980 [1:22:47<04:52,  5.32s/it] 94%|█████████▍| 926/980 [1:22:53<04:52,  5.41s/it] 95%|█████████▍| 927/980 [1:22:58<04:39,  5.28s/it] 95%|█████████▍| 928/980 [1:23:03<04:27,  5.15s/it] 95%|█████████▍| 929/980 [1:23:07<04:08,  4.88s/it] 95%|█████████▍| 930/980 [1:23:12<04:06,  4.92s/it]                                                    95%|█████████▍| 930/980 [1:23:12<04:06,  4.92s/it] 95%|█████████▌| 931/980 [1:23:17<04:01,  4.93s/it] 95%|█████████▌| 932/980 [1:23:23<04:09,  5.20s/it] 95%|█████████▌| 933/980 [1:23:28<04:03,  5.17s/it] 95%|█████████▌| 934/980 [1:23:33<03:58,  5.18s/it] 95%|█████████▌| 935/980 [1:23:38<03:43,  4.98s/it] 96%|█████████▌| 936/980 [1:23:42<03:37,  4.94s/it] 96%|█████████▌| 937/980 [1:23:47<03:33,  4.97s/it] 96%|█████████▌| 938/980 [1:23:51<03:16,  4.68s/it] 96%|█████████▌| 939/980 [1:23:57<03:17,  4.82s/it] 96%|█████████▌| 940/980 [1:24:03<03:27,  5.18s/it]                                                    96%|█████████▌| 940/980 [1:24:03<03:27,  5.18s/it] 96%|█████████▌| 941/980 [1:24:08<03:24,  5.25s/it] 96%|█████████▌| 942/980 [1:24:12<03:05,  4.87s/it] 96%|█████████▌| 943/980 [1:24:16<02:52,  4.66s/it] 96%|█████████▋| 944/980 [1:24:22<03:04,  5.13s/it] 96%|█████████▋| 945/980 [1:24:27<02:57,  5.07s/it] 97%|█████████▋| 946/980 [1:24:32<02:51,  5.03s/it] 97%|█████████▋| 947/980 [1:24:38<02:54,  5.30s/it] 97%|█████████▋| 948/980 [1:24:42<02:35,  4.87s/it] 97%|█████████▋| 949/980 [1:24:48<02:40,  5.18s/it] 97%|█████████▋| 950/980 [1:24:53<02:35,  5.17s/it]                                                    97%|█████████▋| 950/980 [1:24:53<02:35,  5.17s/it] 97%|█████████▋| 951/980 [1:24:58<02:24,  5.00s/it] 97%|█████████▋| 952/980 [1:25:03<02:21,  5.05s/it] 97%|█████████▋| 953/980 [1:25:09<02:21,  5.24s/it] 97%|█████████▋| 954/980 [1:25:13<02:10,  5.04s/it] 97%|█████████▋| 955/980 [1:25:18<02:05,  5.00s/it] 98%|█████████▊| 956/980 [1:25:23<01:58,  4.93s/it] 98%|█████████▊| 957/980 [1:25:28<01:53,  4.96s/it] 98%|█████████▊| 958/980 [1:25:32<01:46,  4.84s/it] 98%|█████████▊| 959/980 [1:25:38<01:44,  4.99s/it] 98%|█████████▊| 960/980 [1:25:42<01:35,  4.77s/it]                                                    98%|█████████▊| 960/980 [1:25:42<01:35,  4.77s/it] 98%|█████████▊| 961/980 [1:25:46<01:28,  4.67s/it] 98%|█████████▊| 962/980 [1:25:52<01:28,  4.91s/it] 98%|█████████▊| 963/980 [1:25:57<01:23,  4.90s/it] 98%|█████████▊| 964/980 [1:26:02<01:21,  5.12s/it] 98%|█████████▊| 965/980 [1:26:08<01:18,  5.25s/it] 99%|█████████▊| 966/980 [1:26:13<01:11,  5.09s/it] 99%|█████████▊| 967/980 [1:26:17<01:05,  5.00s/it] 99%|█████████▉| 968/980 [1:26:23<01:00,  5.07s/it] 99%|█████████▉| 969/980 [1:26:28<00:57,  5.24s/it] 99%|█████████▉| 970/980 [1:26:34<00:52,  5.28s/it]                                                    99%|█████████▉| 970/980 [1:26:34<00:52,  5.28s/it] 99%|█████████▉| 971/980 [1:26:39<00:46,  5.19s/it] 99%|█████████▉| 972/980 [1:26:44<00:42,  5.29s/it] 99%|█████████▉| 973/980 [1:26:49<00:35,  5.06s/it] 99%|█████████▉| 974/980 [1:26:53<00:28,  4.82s/it] 99%|█████████▉| 975/980 [1:26:58<00:24,  4.91s/it]100%|█████████▉| 976/980 [1:27:03<00:20,  5.05s/it]100%|█████████▉| 977/980 [1:27:08<00:15,  5.02s/it]100%|█████████▉| 978/980 [1:27:12<00:09,  4.60s/it]100%|█████████▉| 979/980 [1:27:16<00:04,  4.40s/it]100%|██████████| 980/980 [1:27:21<00:00,  4.57s/it]                                                   100%|██████████| 980/980 [1:27:21<00:00,  4.57s/it][INFO|trainer.py:3705] 2024-11-06 04:46:24,492 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-980
[INFO|configuration_utils.py:673] 2024-11-06 04:46:24,511 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:46:24,512 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:46:24,597 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-980/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:46:24,598 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/checkpoint-980/special_tokens_map.json
[INFO|trainer.py:2505] 2024-11-06 04:46:24,928 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 980/980 [1:27:21<00:00,  4.57s/it]100%|██████████| 980/980 [1:27:21<00:00,  5.35s/it]
[INFO|trainer.py:3705] 2024-11-06 04:46:24,929 >> Saving model checkpoint to ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7
[INFO|configuration_utils.py:673] 2024-11-06 04:46:24,948 >> loading configuration file /home/models/Llama-3.2-3B/config.json
[INFO|configuration_utils.py:742] 2024-11-06 04:46:24,948 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 3072,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 24,
  "num_hidden_layers": 28,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 32.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": true,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.2",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2641] 2024-11-06 04:46:25,036 >> tokenizer config file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/tokenizer_config.json
[INFO|tokenization_utils_base.py:2650] 2024-11-06 04:46:25,037 >> Special tokens file saved in ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/special_tokens_map.json
{'eval_loss': 0.09900370985269547, 'eval_runtime': 32.4312, 'eval_samples_per_second': 21.584, 'eval_steps_per_second': 5.396, 'epoch': 4.57}
{'loss': 0.0383, 'grad_norm': 0.7710416913032532, 'learning_rate': 8.775230736361732e-07, 'epoch': 4.62}
{'loss': 0.0383, 'grad_norm': 0.727411150932312, 'learning_rate': 6.454295053127095e-07, 'epoch': 4.67}
{'loss': 0.0393, 'grad_norm': 0.8829531669616699, 'learning_rate': 4.486375804942438e-07, 'epoch': 4.72}
{'loss': 0.0369, 'grad_norm': 0.7784397006034851, 'learning_rate': 2.8734951618638815e-07, 'epoch': 4.77}
{'loss': 0.0394, 'grad_norm': 0.9620720148086548, 'learning_rate': 1.6173104677806193e-07, 'epoch': 4.83}
{'loss': 0.0329, 'grad_norm': 0.7332190275192261, 'learning_rate': 7.191125373822826e-08, 'epoch': 4.88}
{'loss': 0.0349, 'grad_norm': 1.1062266826629639, 'learning_rate': 1.798243297592372e-08, 'epoch': 4.93}
{'loss': 0.0363, 'grad_norm': 0.8760591149330139, 'learning_rate': 0.0, 'epoch': 4.98}
{'train_runtime': 5241.9092, 'train_samples_per_second': 6.009, 'train_steps_per_second': 0.187, 'train_loss': 0.12823483986513956, 'epoch': 4.98}
***** train metrics *****
  epoch                    =      4.9778
  total_flos               = 329517778GF
  train_loss               =      0.1282
  train_runtime            =  1:27:21.90
  train_samples_per_second =       6.009
  train_steps_per_second   =       0.187
Figure saved at: ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/training_loss.png
Figure saved at: ../Models/llama3B/tp_llama3/C3_orig_train_1_hop_lr_7/training_eval_loss.png
11/06/2024 04:46:25 - WARNING - llamafactory.extras.ploting - No metric eval_accuracy to plot.
[INFO|trainer.py:4021] 2024-11-06 04:46:25,414 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-11-06 04:46:25,414 >>   Num examples = 700
[INFO|trainer.py:4026] 2024-11-06 04:46:25,414 >>   Batch size = 4
  0%|          | 0/175 [00:00<?, ?it/s]  1%|          | 2/175 [00:00<00:22,  7.68it/s]  2%|▏         | 3/175 [00:00<00:23,  7.42it/s]  2%|▏         | 4/175 [00:00<00:23,  7.34it/s]  3%|▎         | 5/175 [00:00<00:31,  5.36it/s]  3%|▎         | 6/175 [00:00<00:30,  5.50it/s]  4%|▍         | 7/175 [00:01<00:28,  5.98it/s]  5%|▍         | 8/175 [00:01<00:27,  6.09it/s]  5%|▌         | 9/175 [00:01<00:25,  6.52it/s]  6%|▌         | 10/175 [00:01<00:30,  5.39it/s]  6%|▋         | 11/175 [00:01<00:28,  5.72it/s]  7%|▋         | 12/175 [00:02<00:28,  5.71it/s]  7%|▋         | 13/175 [00:02<00:29,  5.54it/s]  8%|▊         | 14/175 [00:02<00:27,  5.78it/s]  9%|▊         | 15/175 [00:02<00:26,  5.94it/s]  9%|▉         | 16/175 [00:02<00:31,  5.06it/s] 10%|▉         | 17/175 [00:03<00:34,  4.62it/s] 10%|█         | 18/175 [00:03<00:37,  4.23it/s] 11%|█         | 19/175 [00:03<00:38,  4.00it/s] 12%|█▏        | 21/175 [00:03<00:26,  5.79it/s] 13%|█▎        | 22/175 [00:03<00:23,  6.42it/s] 13%|█▎        | 23/175 [00:04<00:25,  6.05it/s] 14%|█▎        | 24/175 [00:04<00:29,  5.12it/s] 14%|█▍        | 25/175 [00:04<00:26,  5.60it/s] 15%|█▍        | 26/175 [00:04<00:24,  6.04it/s] 15%|█▌        | 27/175 [00:04<00:24,  5.93it/s] 16%|█▌        | 28/175 [00:04<00:23,  6.24it/s] 17%|█▋        | 29/175 [00:05<00:24,  6.04it/s] 17%|█▋        | 30/175 [00:05<00:28,  5.15it/s] 18%|█▊        | 31/175 [00:05<00:31,  4.55it/s] 18%|█▊        | 32/175 [00:05<00:27,  5.16it/s] 19%|█▉        | 33/175 [00:05<00:25,  5.65it/s] 19%|█▉        | 34/175 [00:06<00:28,  4.93it/s] 20%|██        | 35/175 [00:06<00:27,  5.17it/s] 21%|██        | 36/175 [00:06<00:26,  5.16it/s] 21%|██        | 37/175 [00:06<00:26,  5.21it/s] 22%|██▏       | 38/175 [00:06<00:22,  5.96it/s] 22%|██▏       | 39/175 [00:07<00:27,  5.02it/s] 23%|██▎       | 40/175 [00:07<00:23,  5.71it/s] 23%|██▎       | 41/175 [00:07<00:21,  6.12it/s] 24%|██▍       | 42/175 [00:07<00:21,  6.18it/s] 25%|██▍       | 43/175 [00:07<00:23,  5.61it/s] 25%|██▌       | 44/175 [00:07<00:22,  5.70it/s] 26%|██▌       | 45/175 [00:08<00:21,  5.91it/s] 26%|██▋       | 46/175 [00:08<00:20,  6.23it/s] 27%|██▋       | 47/175 [00:08<00:19,  6.57it/s] 27%|██▋       | 48/175 [00:08<00:20,  6.27it/s] 28%|██▊       | 49/175 [00:08<00:23,  5.33it/s] 29%|██▊       | 50/175 [00:08<00:23,  5.33it/s] 29%|██▉       | 51/175 [00:09<00:22,  5.58it/s] 30%|██▉       | 52/175 [00:09<00:25,  4.76it/s] 30%|███       | 53/175 [00:09<00:24,  4.89it/s] 31%|███       | 54/175 [00:09<00:24,  4.90it/s] 31%|███▏      | 55/175 [00:10<00:26,  4.53it/s] 32%|███▏      | 56/175 [00:10<00:27,  4.29it/s] 33%|███▎      | 58/175 [00:10<00:21,  5.48it/s] 34%|███▎      | 59/175 [00:10<00:21,  5.44it/s] 34%|███▍      | 60/175 [00:11<00:24,  4.78it/s] 35%|███▍      | 61/175 [00:11<00:22,  5.04it/s] 36%|███▌      | 63/175 [00:11<00:18,  6.13it/s] 37%|███▋      | 65/175 [00:11<00:16,  6.58it/s] 38%|███▊      | 67/175 [00:11<00:14,  7.28it/s] 39%|███▉      | 68/175 [00:12<00:15,  6.92it/s] 39%|███▉      | 69/175 [00:12<00:14,  7.13it/s] 40%|████      | 70/175 [00:12<00:13,  7.54it/s] 41%|████      | 71/175 [00:12<00:13,  7.78it/s] 41%|████      | 72/175 [00:12<00:17,  5.90it/s] 42%|████▏     | 73/175 [00:12<00:19,  5.19it/s] 42%|████▏     | 74/175 [00:13<00:17,  5.68it/s] 43%|████▎     | 75/175 [00:13<00:17,  5.58it/s] 43%|████▎     | 76/175 [00:13<00:20,  4.91it/s] 44%|████▍     | 77/175 [00:13<00:22,  4.41it/s] 45%|████▍     | 78/175 [00:14<00:23,  4.20it/s] 45%|████▌     | 79/175 [00:14<00:22,  4.29it/s] 46%|████▌     | 80/175 [00:14<00:23,  4.03it/s] 46%|████▋     | 81/175 [00:14<00:23,  4.01it/s] 47%|████▋     | 83/175 [00:15<00:16,  5.61it/s] 48%|████▊     | 84/175 [00:15<00:16,  5.44it/s] 49%|████▊     | 85/175 [00:15<00:18,  4.90it/s] 49%|████▉     | 86/175 [00:15<00:18,  4.80it/s] 50%|████▉     | 87/175 [00:15<00:18,  4.88it/s] 50%|█████     | 88/175 [00:16<00:16,  5.27it/s] 51%|█████     | 89/175 [00:16<00:18,  4.63it/s] 51%|█████▏    | 90/175 [00:16<00:16,  5.15it/s] 52%|█████▏    | 91/175 [00:16<00:18,  4.56it/s] 53%|█████▎    | 92/175 [00:16<00:15,  5.31it/s] 53%|█████▎    | 93/175 [00:17<00:15,  5.34it/s] 54%|█████▎    | 94/175 [00:17<00:15,  5.36it/s] 54%|█████▍    | 95/175 [00:17<00:13,  5.87it/s] 55%|█████▍    | 96/175 [00:17<00:15,  5.05it/s] 55%|█████▌    | 97/175 [00:17<00:16,  4.59it/s] 56%|█████▌    | 98/175 [00:18<00:18,  4.22it/s] 57%|█████▋    | 99/175 [00:18<00:15,  4.83it/s] 57%|█████▋    | 100/175 [00:18<00:17,  4.37it/s] 58%|█████▊    | 101/175 [00:18<00:15,  4.86it/s] 58%|█████▊    | 102/175 [00:19<00:15,  4.75it/s] 59%|█████▉    | 103/175 [00:19<00:12,  5.61it/s] 59%|█████▉    | 104/175 [00:19<00:11,  6.23it/s] 60%|██████    | 105/175 [00:19<00:11,  6.27it/s] 61%|██████    | 106/175 [00:19<00:10,  6.65it/s] 61%|██████    | 107/175 [00:19<00:12,  5.46it/s] 62%|██████▏   | 108/175 [00:19<00:12,  5.40it/s] 62%|██████▏   | 109/175 [00:20<00:10,  6.17it/s] 63%|██████▎   | 110/175 [00:20<00:11,  5.60it/s] 63%|██████▎   | 111/175 [00:20<00:11,  5.47it/s] 64%|██████▍   | 112/175 [00:20<00:11,  5.57it/s] 65%|██████▍   | 113/175 [00:20<00:10,  6.08it/s] 65%|██████▌   | 114/175 [00:21<00:12,  5.02it/s] 66%|██████▌   | 115/175 [00:21<00:10,  5.57it/s] 66%|██████▋   | 116/175 [00:21<00:11,  5.26it/s] 67%|██████▋   | 117/175 [00:21<00:10,  5.28it/s] 67%|██████▋   | 118/175 [00:21<00:10,  5.63it/s] 68%|██████▊   | 119/175 [00:22<00:11,  4.78it/s] 69%|██████▊   | 120/175 [00:22<00:12,  4.34it/s] 69%|██████▉   | 121/175 [00:22<00:11,  4.71it/s] 70%|██████▉   | 122/175 [00:22<00:09,  5.33it/s] 70%|███████   | 123/175 [00:22<00:11,  4.64it/s] 71%|███████   | 124/175 [00:23<00:12,  4.24it/s] 71%|███████▏  | 125/175 [00:23<00:12,  4.14it/s] 72%|███████▏  | 126/175 [00:23<00:10,  4.61it/s] 73%|███████▎  | 127/175 [00:23<00:11,  4.22it/s] 73%|███████▎  | 128/175 [00:24<00:10,  4.48it/s] 74%|███████▎  | 129/175 [00:24<00:10,  4.49it/s] 74%|███████▍  | 130/175 [00:24<00:09,  4.73it/s] 75%|███████▍  | 131/175 [00:24<00:08,  5.35it/s] 75%|███████▌  | 132/175 [00:24<00:07,  5.52it/s] 77%|███████▋  | 134/175 [00:25<00:06,  6.33it/s] 77%|███████▋  | 135/175 [00:25<00:05,  6.74it/s] 78%|███████▊  | 136/175 [00:25<00:06,  6.47it/s] 79%|███████▉  | 138/175 [00:25<00:04,  7.50it/s] 79%|███████▉  | 139/175 [00:25<00:05,  6.62it/s] 80%|████████  | 140/175 [00:26<00:06,  5.45it/s] 81%|████████  | 141/175 [00:26<00:06,  5.43it/s] 81%|████████  | 142/175 [00:26<00:06,  4.75it/s] 82%|████████▏ | 144/175 [00:26<00:05,  5.63it/s] 83%|████████▎ | 145/175 [00:26<00:05,  5.92it/s] 83%|████████▎ | 146/175 [00:27<00:05,  5.77it/s] 84%|████████▍ | 147/175 [00:27<00:05,  5.08it/s] 85%|████████▌ | 149/175 [00:27<00:04,  5.97it/s] 86%|████████▌ | 150/175 [00:27<00:04,  5.89it/s] 86%|████████▋ | 151/175 [00:27<00:03,  6.07it/s] 87%|████████▋ | 152/175 [00:28<00:03,  6.68it/s] 87%|████████▋ | 153/175 [00:28<00:03,  6.66it/s] 88%|████████▊ | 154/175 [00:28<00:03,  6.20it/s] 89%|████████▊ | 155/175 [00:28<00:03,  6.24it/s] 89%|████████▉ | 156/175 [00:28<00:02,  6.73it/s] 90%|████████▉ | 157/175 [00:28<00:03,  5.41it/s] 90%|█████████ | 158/175 [00:29<00:03,  5.50it/s] 91%|█████████ | 159/175 [00:29<00:02,  6.22it/s] 91%|█████████▏| 160/175 [00:29<00:02,  5.67it/s] 92%|█████████▏| 161/175 [00:29<00:02,  6.12it/s] 93%|█████████▎| 162/175 [00:29<00:02,  5.21it/s] 93%|█████████▎| 163/175 [00:30<00:02,  5.06it/s] 94%|█████████▎| 164/175 [00:30<00:02,  5.17it/s] 94%|█████████▍| 165/175 [00:30<00:01,  5.87it/s] 95%|█████████▍| 166/175 [00:30<00:01,  5.64it/s] 95%|█████████▌| 167/175 [00:30<00:01,  6.11it/s] 96%|█████████▌| 168/175 [00:30<00:01,  5.72it/s] 97%|█████████▋| 169/175 [00:31<00:01,  4.90it/s] 97%|█████████▋| 170/175 [00:31<00:01,  4.40it/s] 98%|█████████▊| 172/175 [00:31<00:00,  5.39it/s] 99%|█████████▉| 173/175 [00:31<00:00,  4.89it/s] 99%|█████████▉| 174/175 [00:32<00:00,  4.59it/s]100%|██████████| 175/175 [00:32<00:00,  5.42it/s]
[INFO|modelcard.py:449] 2024-11-06 04:46:57,810 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     4.9778
  eval_loss               =     0.0985
  eval_runtime            = 0:00:32.39
  eval_samples_per_second =     21.609
  eval_steps_per_second   =      5.402
